
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pycsamt.ff.core.avg &#8212; pyCSAMT v1.0.03 documentation</title>
    <link rel="stylesheet" href="../../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">pyCSAMT v1.0.03 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pycsamt.ff.core.avg</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">===============================================================================</span>
<span class="sd">    Copyright Â© 2021  Kouadio K.Laurent</span>
<span class="sd">    </span>
<span class="sd">    This file is part of pyCSAMT.</span>
<span class="sd">    </span>
<span class="sd">    pyCSAMT is free software: you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">    the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>
<span class="sd">    </span>
<span class="sd">    pyCSAMT is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU Lesser General Public License for more details.</span>
<span class="sd">    </span>
<span class="sd">    You should have received a copy of the GNU Lesser General Public License</span>
<span class="sd">    along with pyCSAMT.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>

<span class="sd">===============================================================================</span>

<span class="sd">.. _module-avg:: `pycsamt.ff.core.avg`  </span>

<span class="sd">    :synopsis: Module to deal with AVG file. each section of Avg file is a class </span>
<span class="sd">    Avg file from Zonge Engeneering company is two types . module will read </span>
<span class="sd">    the main file type as Type 1 . the othe type of AVG will rewrite on t</span>
<span class="sd">    the main type. the module can expor that file for other use .</span>
<span class="sd">    </span>
<span class="sd">Created on Wed Nov 18 16:45:35 2020</span>

<span class="sd">@author: KLaurent K. alias @Daniel03</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">re</span> 
<span class="kn">import</span> <span class="nn">warnings</span><span class="o">,</span><span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pycsamt.etc</span> <span class="kn">import</span> <span class="n">infos</span> <span class="k">as</span> <span class="n">infOS</span>
<span class="kn">from</span>  <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>

<span class="kn">from</span> <span class="nn">pycsamt.ff.core.cs</span> <span class="kn">import</span> <span class="n">Site</span> 

<span class="kn">from</span> <span class="nn">pycsamt.ff.core.j</span> <span class="kn">import</span> <span class="n">J_collection</span> 
<span class="kn">from</span> <span class="nn">pycsamt.ff.core.edi</span> <span class="kn">import</span> <span class="n">Edi</span>

<span class="kn">from</span> <span class="nn">pycsamt.ff.processing</span> <span class="kn">import</span> <span class="n">corr</span> 
<span class="kn">from</span> <span class="nn">pycsamt.ff.processing</span> <span class="kn">import</span> <span class="n">callffunc</span> <span class="k">as</span> <span class="n">cfunc</span>
<span class="kn">from</span> <span class="nn">pycsamt.ff.processing</span> <span class="kn">import</span> <span class="n">zcalculator</span> <span class="k">as</span> <span class="n">Zcc</span>
<span class="kn">from</span> <span class="nn">pycsamt.utils._csamtpylog</span> <span class="kn">import</span> <span class="n">csamtpylog</span>
<span class="kn">from</span> <span class="nn">pycsamt.utils</span> <span class="kn">import</span> <span class="n">func_utils</span> <span class="k">as</span> <span class="n">func</span>
<span class="kn">from</span> <span class="nn">pycsamt.utils</span> <span class="kn">import</span> <span class="n">exceptions</span> <span class="k">as</span> <span class="n">CSex</span>


<span class="n">_logger</span><span class="o">=</span><span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>



<div class="viewcode-block" id="Avg"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Avg">[docs]</a><span class="k">class</span> <span class="nc">Avg</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A super class of all content of AVG Zonge file </span>
<span class="sd">    </span>
<span class="sd">        Deal with Zonge Engeering Avg file .</span>
<span class="sd">        </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **data_fn**: str </span>
<span class="sd">                    path to AVG file </span>
<span class="sd">        </span>
<span class="sd">    ================  ===========  =======================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  =======================================</span>
<span class="sd">    Header             class        container of Header informations </span>
<span class="sd">    Data_section       class        container of all Data informations   </span>
<span class="sd">    Skip_flag          str          value to jugde the quality of data </span>
<span class="sd">                                    can filled automatically . If no skp </span>
<span class="sd">                                    value is provide , the program will</span>
<span class="sd">                                    judge quality of provided data </span>
<span class="sd">                                    and set to him a score .</span>
<span class="sd">    ================  ===========  =======================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; Avg_object =Data(data_array=avg_data )</span>
<span class="sd">        &gt;&gt;&gt; stn=DATA.Station.name </span>
<span class="sd">        &gt;&gt;&gt; freq=DATA.Frequency.value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">encodage</span> <span class="o">=</span><span class="s1">&#39;utf8&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span> <span class="o">=</span><span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="o">=</span><span class="n">data_fn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">=</span><span class="n">Header</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span> <span class="o">=</span><span class="n">Data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Skip_flag</span> <span class="o">=</span><span class="n">Skip_flag</span><span class="p">()</span>
        
        

        <span class="bp">self</span><span class="o">.</span><span class="n">_f1_labels</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f2_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;skp&#39;</span><span class="p">,</span><span class="s1">&#39;Station&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39; Freq&#39;</span><span class="p">,</span><span class="s1">&#39;Comp&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39; Amps&#39;</span><span class="p">,</span><span class="s1">&#39;Emag&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;Ephz&#39;</span><span class="p">,</span><span class="s1">&#39;Hmag&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;Hphz&#39;</span><span class="p">,</span><span class="s1">&#39;Resistivity&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;Phase&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%E</span><span class="s1">mag&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;sEphz&#39;</span><span class="p">,</span><span class="s1">&#39;%Hmag&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;sHphz&#39;</span><span class="p">,</span><span class="s1">&#39;%Rho&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;sPhz&#39;</span><span class="p">],[</span><span class="s1">&#39;skp&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;Freq&#39;</span><span class="p">,</span><span class="s1">&#39;Tx.Amp&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;E.mag&#39;</span><span class="p">,</span><span class="s1">&#39;E.phz&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;B.mag&#39;</span><span class="p">,</span><span class="s1">&#39;B.phz&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;Z.mag&#39;</span><span class="p">,</span><span class="s1">&#39;Z.phz&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;ARes.mag&#39;</span><span class="p">,</span><span class="s1">&#39;SRes&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;E.wgt&#39;</span><span class="p">,</span> <span class="s1">&#39;B.wgt&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;E.</span><span class="si">%e</span><span class="s1">rr&#39;</span><span class="p">,</span><span class="s1">&#39;E.perr&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;B.</span><span class="si">%e</span><span class="s1">rr&#39;</span><span class="p">,</span><span class="s1">&#39;B.perr&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;Z.</span><span class="si">%e</span><span class="s1">rr&#39;</span><span class="p">,</span><span class="s1">&#39;Z.perr&#39;</span><span class="p">,</span>
                                                         <span class="s1">&#39;ARes.</span><span class="si">%e</span><span class="s1">rr&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_zmark</span><span class="o">=</span><span class="s1">&#39;$&#39;</span>
                                                    
        <span class="bp">self</span><span class="o">.</span><span class="n">EM_zonge2j</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ExHx&#39;</span><span class="p">:</span><span class="s1">&#39;RXX&#39;</span><span class="p">,</span> 
                            <span class="s1">&#39;ExHy&#39;</span><span class="p">:</span><span class="s1">&#39;RXY&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;EyHx&#39;</span><span class="p">:</span><span class="s1">&#39;RYX&#39;</span><span class="p">,</span> 
                                   <span class="s1">&#39;EyHy&#39;</span><span class="p">:</span><span class="s1">&#39;RYY&#39;</span><span class="p">}</span>
  
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>                       
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_avg_file</span> <span class="p">()</span>
                                      
    <span class="k">def</span> <span class="nf">_read_avg_file</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read avg file and set each objects .</span>
<span class="sd">        </span>
<span class="sd">        The main source protocole to transfert data into corresponding classes. </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ------------</span>
<span class="sd">            * data_fn: str  </span>
<span class="sd">                    path to AVG filename.      </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">data_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="o">=</span><span class="n">data_fn</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="ow">is</span> <span class="kc">None</span>  <span class="p">:</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_avg_file</span><span class="p">(</span><span class="s1">&#39;No AVG file found.Please check &#39;</span>\
                                             <span class="s1">&#39;your pathfile :&lt;</span><span class="si">{0}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
        <span class="c1"># print(self.data_fn)       </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_AVG</span><span class="p">(</span><span class="s1">&#39;could not find </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;reading and checking the AVG file </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)</span>         
        <span class="c1">#-------------------------------------------------------------</span>
        
        <span class="k">if</span>  <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;avg&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;avg&#39;</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span> <span class="o">==</span> <span class="kc">False</span> <span class="p">:</span><span class="c1">#self.data_fn[-4:].lower() != &#39;.avg&#39;or self.data_fn.endswith(&#39;avg&#39;.upper())==False or</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;&lt;Get more infos about AVG&gt; :</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">infOS</span><span class="o">.</span><span class="n">notion</span><span class="o">.</span><span class="n">AVG</span><span class="p">))</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_AVG</span><span class="p">(</span><span class="s1">&#39;file provided is not an AVGfile.Please check your file!&#39;</span><span class="p">)</span>
            
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;avg&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.AVG&#39;</span><span class="p">):</span>
                <span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span> <span class="p">:</span>
                    <span class="n">avg_data_file</span><span class="o">=</span><span class="n">fid</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            
        <span class="c1"># ----now chech the avg file --</span>
        <span class="n">avg_file_type_num</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_validate_avg_file</span><span class="p">(</span><span class="n">avg_dataLines</span> <span class="o">=</span><span class="n">avg_data_file</span><span class="p">)</span>
        <span class="c1">#------------------------------------</span>
                
        <span class="k">if</span> <span class="n">avg_file_type_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1">#-------------  main AVG file :F1 and keep data infos --------------</span>

            <span class="c1"># --&gt; run the headlines thin to find the word &#39;skp&#39;</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="p">,</span> <span class="n">infos</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="n">avg_data_file</span><span class="p">):</span> 
                <span class="k">if</span> <span class="s1">&#39;skp&#39;</span> <span class="ow">in</span> <span class="n">infos</span> <span class="p">:</span> 
                    <span class="n">avg_data_file_infos</span> <span class="o">=</span> <span class="n">avg_data_file</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span>
                    <span class="k">break</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">set_harware_infos</span><span class="p">([</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span>  <span class="ow">in</span> \
                                                        <span class="n">avg_data_file_infos</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)]</span> <span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Tx</span><span class="o">.</span><span class="n">set_transmitter_properties</span> <span class="p">(</span><span class="n">Tx_data</span> <span class="o">=</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span>  <span class="ow">in</span> \
                                                        <span class="n">avg_data_file_infos</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Rx</span><span class="o">.</span><span class="n">set_receiver_properties</span> <span class="p">(</span><span class="n">Rx_data</span> <span class="o">=</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span>  <span class="ow">in</span> \
                                                        <span class="n">avg_data_file_infos</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)])</span>
            
            <span class="n">data_to_array</span> <span class="o">=</span><span class="n">avg_data_file</span> <span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
            <span class="c1"># --- put data on list and array : </span>
            <span class="n">data_to_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">datum</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="n">data_to_array</span> <span class="p">])</span>
            
            <span class="c1"># self.skip.skp_flag==data_to_array[0,0] # fill the skip flag </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Skip_flag</span><span class="o">.</span><span class="n">setandget_skip_flag</span><span class="p">(</span><span class="n">skip_flag</span><span class="o">=</span><span class="n">data_to_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1"># delete the skp array and comp _array </span>
            
            <span class="n">data_to_array</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data_to_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span> <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">_avg_set_components_from_data</span><span class="p">(</span><span class="n">data_array</span> <span class="o">=</span> <span class="n">data_to_array</span><span class="p">,</span>
                                               <span class="n">data_type</span> <span class="o">=</span><span class="n">avg_file_type_num</span><span class="p">)</span> 
            <span class="c1"># Skp_flag(skip_flag=&#39;2&#39;)</span>
            
        <span class="k">elif</span>  <span class="n">avg_file_type_num</span> <span class="o">==</span><span class="mi">2</span> <span class="p">:</span> <span class="c1">#-------------Read ASTATIC file : F2 and keep data infos --------------</span>
            
            <span class="c1"># set zonge Hardwares infos:</span>
            <span class="n">zonge_hardw_infos</span> <span class="o">=</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span>  <span class="ow">in</span> <span class="n">avg_data_file</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">set_harware_infos</span><span class="p">(</span><span class="n">zonge_hardw_infos</span><span class="o">=</span><span class="n">zonge_hardw_infos</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Tx</span><span class="o">.</span><span class="n">set_transmitter_properties</span><span class="p">(</span><span class="n">Tx_data</span><span class="o">=</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="k">for</span> \
                                                                      <span class="n">line</span> <span class="ow">in</span> <span class="n">avg_data_file</span>  <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;$Tx&#39;</span><span class="p">)])</span>
            
            <span class="k">for</span> <span class="n">ss</span><span class="p">,</span> <span class="n">line_avg</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="n">avg_data_file</span><span class="p">):</span> 
                <span class="k">if</span> <span class="n">line_avg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;$Rx&#39;</span><span class="p">):</span>
                    <span class="n">temp_data</span> <span class="o">=</span><span class="n">avg_data_file</span><span class="p">[</span><span class="n">ss</span><span class="p">:]</span> <span class="c1"># keep the remains data + Rx-properties</span>
                    <span class="n">for_surv_configAnnot</span><span class="o">=</span><span class="n">avg_data_file</span><span class="p">[:</span><span class="n">ss</span><span class="p">]</span> <span class="c1"># truncate the data an keep the infos above thin $Rx</span>
                    <span class="k">break</span> 
                
            <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">set_survey_annotations_infos</span> <span class="p">(</span><span class="n">survey_annotations_data</span> <span class="o">=</span><span class="n">for_surv_configAnnot</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyConfiguration</span><span class="o">.</span><span class="n">set_survey_configuration_infos</span> <span class="p">(</span><span class="n">survey_config_data</span><span class="o">=</span><span class="n">for_surv_configAnnot</span><span class="p">)</span>
            
            <span class="n">tem_d</span><span class="p">,</span> <span class="n">rx_infos</span><span class="p">,</span> <span class="n">comp_receiv_info</span><span class="o">=</span><span class="p">[],[],[]</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp_data</span><span class="p">):</span> 
               <span class="c1">#---&gt; seek the data without the mark of the receiver of component list </span>
               <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Z.mag&#39;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;$Rx&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span>
                   <span class="n">ss__temp</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span> <span class="n">ss__temp</span> <span class="p">)</span> <span class="p">:</span> 
                       <span class="k">try</span> <span class="p">:</span> 
                           <span class="n">ss__temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                       <span class="k">except</span> <span class="p">:</span>     <span class="c1">#--&gt; in the case we meet &#39;*&#39; mean no value .</span>
                           <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span> <span class="p">:</span>
                               <span class="n">ss__temp</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                           <span class="k">pass</span> 
                       <span class="c1"># if value==&#39;*&#39;: ss__temp[kk]=&quot;0&quot;</span>
                   <span class="n">tem_d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss__temp</span><span class="p">)</span>
               <span class="k">if</span> <span class="s1">&#39;$Rx&#39;</span> <span class="ow">in</span> <span class="n">item</span> <span class="p">:</span>
                   <span class="n">comp_receiv_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                
               <span class="k">if</span> <span class="s1">&#39;$Rx.GdpStn&#39;</span> <span class="ow">in</span> <span class="n">item</span> <span class="p">:</span>
                   <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                   <span class="n">rx_infos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
               <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;ARes.mag&#39;</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;SRes&#39;</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span> <span class="c1">#- keep the head component infos</span>
                    <span class="n">comp_sect</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            
            <span class="c1">#-set receivers infos </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Rx</span><span class="o">.</span><span class="n">set_receiver_properties</span><span class="p">(</span><span class="n">Rx_data</span> <span class="o">=</span><span class="n">comp_receiv_info</span><span class="p">)</span>
            
            <span class="c1">#--&gt; delete the none value on data </span>
            <span class="k">for</span> <span class="n">sk</span> <span class="p">,</span> <span class="n">itemm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tem_d</span><span class="p">):</span> 
                <span class="k">if</span> <span class="n">itemm</span><span class="o">==</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]:</span> <span class="n">tem_d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span>
            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tem_d</span><span class="p">)</span>
            <span class="n">data_to_array</span><span class="p">,</span> <span class="n">other_comps</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">straighten_cac2CSfile</span> <span class="p">(</span><span class="n">data_array</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                                   <span class="n">component_column_section</span> <span class="o">=</span> <span class="n">comp_sect</span><span class="p">)</span>
            
            <span class="n">freq_counts</span><span class="p">,</span><span class="n">array_of_repeat_frequency</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_to_array</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
                                                    <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
            <span class="n">station_list</span><span class="o">=</span><span class="n">rx_infos</span> <span class="o">*</span> <span class="n">freq_counts</span><span class="o">.</span><span class="n">size</span>
            
            <span class="n">station_array_for_data</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">station_list</span><span class="p">]</span>
            <span class="n">station_array_for_data</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">station_array_for_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">station_array_for_data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">station_array_for_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span><span class="n">data_to_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> 
                <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Trouble occured when reading Astatic file. It seems the frequency are not the &#39;</span>\
                              <span class="s1">&#39;same length along all stations.&#39;</span> <span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn_explicit</span><span class="p">(</span><span class="s1">&#39;it seems something wrong while reading Astatic file.&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">,</span>
                                       <span class="n">filename</span><span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>  <span class="n">lineno</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_avg_file</span><span class="p">(</span><span class="s1">&#39;File might be corrupted. number of frequency must&#39;</span>\
                                                 <span class="s1">&#39; be the same along along all stations.  &#39;</span><span class="p">)</span>
                    
            
            <span class="n">data_to_array</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data_to_array</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
            <span class="c1"># print(data_to_array.shape)</span>
            <span class="c1"># print( station_array_for_data.shape)</span>
            
            <span class="n">data_to_array</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">station_array_for_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">station_array_for_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span> 
                                              <span class="n">data_to_array</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
            <span class="c1"># data_to_array=np.insert(data_to_array, 1, station_array_for_data, axis=1 )</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">_avg_set_components_from_data</span><span class="p">(</span><span class="n">data_array</span> <span class="o">=</span> <span class="n">data_to_array</span><span class="p">,</span>
                                               <span class="n">data_type</span> <span class="o">=</span><span class="n">avg_file_type_num</span><span class="p">,</span> 
                                               <span class="n">add_astatic_data</span><span class="o">=</span> <span class="n">other_comps</span><span class="p">)</span>
            <span class="c1"># -- we assume that if not problem occured thin now ,</span>
            <span class="c1">#  we set skip flag to &#39;2&#39; as good quality data </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Skip_flag</span><span class="o">.</span><span class="n">setandget_skip_flag</span><span class="p">(</span><span class="n">skip_flag</span><span class="o">=</span><span class="s1">&#39;2&#39;</span> <span class="p">)</span> 
        <span class="k">else</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_avg_file</span><span class="p">(</span><span class="s1">&#39;The number provided doesnt not match Avgfile.&#39;</span><span class="p">)</span>
            
            
            
            
<div class="viewcode-block" id="Avg.avg_write_2_to_1"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Avg.avg_write_2_to_1">[docs]</a>    <span class="k">def</span> <span class="nf">avg_write_2_to_1</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">savepath</span> <span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Method to rewrite avg Astatic file (F2) to main file F1 .</span>
<span class="sd">        </span>
<span class="sd">        :param data_fn: ASTATIC FILE </span>
<span class="sd">        :type data_fn: str </span>
<span class="sd">        </span>
<span class="sd">        :param savepath: path to save your rewritten file . </span>
<span class="sd">        :type savepath: str </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="o">=</span><span class="n">data_fn</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_avg_file</span><span class="p">(</span><span class="s1">&#39;No file detected. check your right path .&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_avg_file</span><span class="p">(</span><span class="s1">&#39;No file detected.&#39;</span>\
                                                 <span class="s1">&#39;please check your right path. &#39;</span><span class="p">)</span>
            <span class="c1">#-- check whether the file is astatic file :</span>
                
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;avg&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.AVG&#39;</span><span class="p">):</span>
                <span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span> <span class="p">:</span>
                    <span class="n">avg_data_file</span><span class="o">=</span><span class="n">fid</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>  
                <span class="bp">self</span><span class="o">.</span><span class="n">checker</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_validate_avg_file</span><span class="p">(</span><span class="n">avg_data_file</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checker</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_avg_file</span><span class="p">(</span>
                        <span class="s1">&#39;Input Avgfile &lt; </span><span class="si">{0}</span><span class="s1">&gt; is not Zonge ASTATIC file. &#39;</span>
                            <span class="s1">&#39;Please put the right file !&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)))</span>
                    
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_AVG</span><span class="p">(</span><span class="s1">&#39;No avg file detected ! Please check your file !&#39;</span><span class="p">)</span>
            
        <span class="n">write_lines</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_avg_file</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)</span>
        <span class="n">HW_dict</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">sconfig_dict</span>
        <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">HW_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;astatic&#39;</span> <span class="o">==</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="n">keys</span><span class="o">==</span><span class="s1">&#39;&#39;</span> <span class="p">:</span><span class="k">continue</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span><span class="n">values</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ss</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
            <span class="n">write_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">keys</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">values</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;,&#39;</span><span class="p">]))</span>
                
        
        <span class="c1">#add copyleft.</span>
        <span class="n">write_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">_writer_copyleft</span><span class="o">+</span>
                           <span class="s1">&#39;: </span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> <span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>       
                
         <span class="c1"># start writing configure part.</span>
        <span class="n">write_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_zmark</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{0:&lt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39; ASPACE&#39;</span><span class="p">),</span>
                                    <span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{0:&gt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Rx</span><span class="o">.</span><span class="n">rxLength</span><span class="p">),</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Rx</span><span class="o">.</span><span class="n">unit</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">write_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_zmark</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{0:&lt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39; XMTR&#39;</span><span class="p">),</span>
                                    <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{0:&gt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Tx</span><span class="o">.</span><span class="n">txGdpStn</span><span class="p">)])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># write_lines.append(&#39;&#39;.join([&quot;{0:^9}&quot;.format(idx) for idx in self._f1_labels])+&#39;\n&#39;)</span>
        
        <span class="c1">#------write the interligne labels and markers ---------</span>

        <span class="k">def</span> <span class="nf">draw_fc</span><span class="p">(</span><span class="n">format_len</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{:^3}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^7}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^7}</span><span class="s1">&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;</span><span class="si">{:^7}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^6}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^12}</span><span class="s1">&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;</span><span class="si">{:^8}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^12}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^9}</span><span class="s1">&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;</span><span class="si">{:^12}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^9}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^7}</span><span class="s1">&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;</span><span class="si">{:^7}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^7}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^7}</span><span class="s1">&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;</span><span class="si">{:^7}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^7}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">value_to_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_f1_labels</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">            Drawn formatage chain . </span>
<span class="sd">            </span>
<span class="sd">            :param format_len: list of formatage indicator , flexible .</span>
<span class="sd">            :type format_len: list </span>
<span class="sd">            </span>
<span class="sd">            :param value-to-format: the list of item we want to format.</span>
<span class="sd">            :type value_to_format: list </span>
<span class="sd">                </span>
<span class="sd">            .. note:: user can change the disposal of avg_labels.</span>
<span class="sd">    </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">for</span> <span class="n">ss</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">format_len</span><span class="p">):</span><span class="n">value_to_format</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value_to_format</span><span class="p">[</span><span class="n">ss</span><span class="p">])</span>
            
            <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">new_carf</span> <span class="k">for</span> <span class="n">new_carf</span> <span class="ow">in</span> <span class="n">value_to_format</span><span class="p">])</span>
        
        <span class="n">write_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">draw_fc</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">write_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">write_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;++&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="o">*</span> <span class="s1">&#39;-&#39;</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;10&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="s1">&#39;10&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">,</span><span class="s1">&#39;10&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">]</span> <span class="p">])</span><span class="o">+</span><span class="s1">&#39;+</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1">#------------start write block data -------------------</span>
        <span class="n">stnNames</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Station</span><span class="o">.</span><span class="n">names</span>

        
        <span class="k">def</span> <span class="nf">nan_to_zstar</span><span class="p">(</span><span class="n">nan_array</span><span class="p">,</span> <span class="n">swaper</span><span class="o">=</span><span class="s1">&#39;*&#39;</span> <span class="p">):</span> <span class="c1"># not usefull , we replace nan at the bottom .</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Swapp np.nan number on the data .</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">nan_array</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">nan_array</span><span class="p">,</span> <span class="n">nan</span><span class="o">=-</span><span class="mi">999</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nan_array</span><span class="o">==-</span><span class="mi">999</span><span class="p">,</span> <span class="n">swaper</span><span class="p">,</span> <span class="n">nan_array</span><span class="p">)</span>
        
            <span class="c1">#--bring back all data ----</span>
        <span class="n">stn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Station</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span>  <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">freq</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span>  <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">amps</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Amps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">emag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Emag</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span>  <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ephz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Ephz</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span>  <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">bmag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Hmag</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">bphz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Hphz</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span>  <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">rho</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Resistivity</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span>  <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">phase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pcemag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcEmag</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sephz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">sEphz</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pchmag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcHmag</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span>  <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">shphz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">sHphz</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pcrho</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcRho</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span>  <span class="n">name</span> <span class="ow">in</span> <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sphase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">sPhz</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span>  <span class="n">stnNames</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># build skp_flag  and fill measure component type ...</span>
        <span class="n">skpf</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">stn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],),</span> <span class="bp">self</span><span class="o">.</span><span class="n">Skip_flag</span><span class="o">.</span><span class="n">skip_flag</span><span class="p">)</span>
        
        <span class="n">comps</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">stn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],),</span><span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Rx</span><span class="o">.</span><span class="n">rxComps</span> <span class="p">)</span>
        
        <span class="c1">#----&gt; write data line by line ------</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">skpf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">write_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:^3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">skpf</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{0:^7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">stn</span><span class="p">[</span><span class="n">ii</span><span class="p">])),</span>
                                                        <span class="s1">&#39;</span><span class="si">{0:&gt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">freq</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span> 
                                                        <span class="s1">&#39;</span><span class="si">{0:^7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{0:&lt;6}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amps</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:12.4e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">emag</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:&gt;8}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ephz</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:12.4e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bmag</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:&gt;9}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bphz</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:12.4e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:&gt;9}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">phase</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:&gt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pcemag</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:&gt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sephz</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:&gt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pchmag</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:&gt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">shphz</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:&gt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pcrho</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span>
                                                        <span class="s1">&#39;</span><span class="si">{:&gt;7}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sphase</span><span class="p">[</span><span class="n">ii</span><span class="p">])]))</span>
            <span class="n">write_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            
        <span class="c1">#---- replace np.nan number by zonge star who mean no value ----</span>
        <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">lines</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">write_lines</span> <span class="p">):</span> 
            <span class="k">if</span> <span class="s1">&#39;nan&#39;</span> <span class="ow">in</span> <span class="n">lines</span> <span class="p">:</span> <span class="n">lines</span> <span class="o">=</span><span class="n">lines</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:&gt;3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">))</span>
            <span class="n">write_lines</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">=</span><span class="n">lines</span>
        <span class="c1">#---------------------end nan replacing ----------------        </span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;_2_to_1.avg&#39;</span><span class="p">]),</span> 
                  <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fw</span><span class="p">:</span>
            <span class="n">fw</span><span class="o">.</span><span class="n">writelines</span> <span class="p">(</span><span class="n">write_lines</span><span class="p">)</span>
        <span class="c1">#---move to your savepath---</span>
        <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;_2_to_1.avg&#39;</span><span class="p">]),</span>
                        <span class="n">savepath</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt;  Your &lt;</span><span class="si">{0}</span><span class="s1">&gt; is rewritten to &lt;</span><span class="si">{1}</span><span class="s1">&gt; successfully. &lt;-----&#39;</span><span class="o">.</span>\
              <span class="nb">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">),</span> 
                   <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;_2_to_1.avg&#39;</span><span class="p">])))</span></div>
                
<div class="viewcode-block" id="Avg.avg_to_jfile"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Avg.avg_to_jfile">[docs]</a>    <span class="k">def</span> <span class="nf">avg_to_jfile</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">avg_data_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">station_fn</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_extension</span><span class="o">=</span><span class="s1">&#39;dat&#39;</span><span class="p">,</span> 
                      <span class="n">utm_zone</span><span class="o">=</span><span class="s1">&#39;49N&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to write avg file to Jfile, convert both files , Astatic or plainty</span>
<span class="sd">         avg file to A.G. Jones format.</span>
<span class="sd">        </span>
<span class="sd">        Parameters </span>
<span class="sd">        -----------</span>
<span class="sd">            * avg_data_fn:str </span>
<span class="sd">                        pathLike , path to your avg file </span>
<span class="sd">            * station_fn:  str</span>
<span class="sd">                        pathLike, path to your profile/station file .</span>
<span class="sd">            * j_extension: str</span>
<span class="sd">                        Extension type you want to export file .</span>
<span class="sd">                        *Default* is &quot;.dat&quot;</span>
<span class="sd">            * utm_zone: str</span>
<span class="sd">                        add  if station_profile are not referenced yet.</span>
<span class="sd">                        later , it would be removed .</span>
<span class="sd">            * savepath: str</span>
<span class="sd">                    pathLike , path to save your outpufile </span>
<span class="sd">            * write_info: bool</span>
<span class="sd">                        write the informations of your input file ,  </span>
<span class="sd">                        export informations into Jfile,*Default* is False.</span>
<span class="sd">            * survey_name:   bool, </span>
<span class="sd">                        survey_area  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">savepath</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;savepath&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">write_info</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;writeInfos&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">survey_name</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;survey_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        
        <span class="k">if</span> <span class="n">j_extension</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;.&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">j_extension</span><span class="p">:</span> <span class="n">j_extension</span> <span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">j_extension</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;write Jformat file&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">avg_data_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="o">=</span> <span class="n">avg_data_fn</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_avg_file</span><span class="p">(</span><span class="s2">&quot;Could not find any path to read .&quot;</span>
                                              <span class="s2">&quot;Please provide your right AVG file.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">station_fn</span> <span class="ow">is</span>  <span class="kc">None</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_station</span><span class="p">(</span>
                <span class="s1">&#39;Need  absolutely station file. please provide your &quot;.STN&quot; file.&#39;</span><span class="p">)</span>
        
        <span class="c1">#---&gt; read the avg file </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_avg_file</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)</span>
        
        <span class="c1">#---&gt; read profile_obj from site </span>
        <span class="n">site_obj</span> <span class="o">=</span> <span class="n">Site</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span><span class="n">station_fn</span><span class="p">,</span> <span class="n">utm_zone</span><span class="o">=</span><span class="n">utm_zone</span><span class="p">)</span><span class="c1">#.set_site_info(data_fn=, utm_zone = utm_zone)</span>

        <span class="c1">#---&gt; get the list of stations </span>
        <span class="n">station_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Station</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        
        <span class="c1">#---&gt; Build jnames with survey name </span>
        <span class="k">if</span> <span class="n">survey_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">survey_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">project_area</span> 
            
        <span class="n">j_obj</span><span class="o">=</span><span class="n">J_collection</span><span class="p">()</span>
        <span class="n">jstnnames</span> <span class="o">=</span> <span class="n">j_obj</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">jname</span><span class="p">(</span><span class="n">number_of_sites</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">station_list</span><span class="p">),</span>
                                  <span class="n">survey_name</span><span class="o">=</span><span class="n">survey_name</span><span class="p">)</span>
        <span class="c1">#---&gt; get component and check it with j </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Rx</span><span class="o">.</span><span class="n">rxComps</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">compvalue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">EM_zonge2j</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Rx</span><span class="o">.</span><span class="n">rxComps</span>  <span class="o">==</span> <span class="n">key</span> <span class="p">:</span> 
                <span class="n">jcomp</span> <span class="o">=</span> <span class="n">j_obj</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">jMode</span><span class="p">(</span><span class="n">polarization_type</span> <span class="o">=</span> <span class="n">compvalue</span><span class="p">)</span> 
        <span class="c1">#---&gt; number of periods </span>
        <span class="n">jnperiod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">numfreq</span>
        <span class="n">jperiod</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">value</span> <span class="c1"># frequency value </span>
        <span class="c1"># call data section </span>
        <span class="n">app_rho_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Resistivity</span><span class="o">.</span><span class="n">loc</span> 
        <span class="n">phase_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">loc</span>
        <span class="n">emag_obj</span> <span class="p">,</span><span class="n">hmag_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Emag</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Hmag</span><span class="o">.</span><span class="n">loc</span>  
        <span class="n">c_var_emag_obj</span> <span class="p">,</span> <span class="n">c_var_hmag_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcEmag</span><span class="o">.</span><span class="n">loc</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcHmag</span><span class="o">.</span><span class="n">loc</span>
        <span class="n">c_var_app_rho_obj</span> <span class="p">,</span> <span class="n">std_phase_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcRho</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">sPhz</span><span class="o">.</span><span class="n">loc</span>
        
        <span class="c1">#---&gt; compute rhomax and rhomin </span>
        <span class="n">japp_rho_max</span><span class="p">,</span> <span class="n">japp_rho_min</span> <span class="p">,</span> <span class="n">jphase_max</span><span class="p">,</span> <span class="n">jphase_min</span><span class="p">,</span><span class="n">jwapp_rho</span> <span class="o">=</span><span class="p">[{}</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="c1"># create 4 empy  dicts</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Resistivity</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="n">japp_rho_max</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span> <span class="n">app_rho_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span> <span class="n">Zcc</span><span class="o">.</span><span class="n">compute_sigmas_e_h_and_sigma_rho</span><span class="p">(</span><span class="n">pc_emag</span><span class="o">=</span> <span class="n">c_var_emag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                                                                  <span class="n">pc_hmag</span><span class="o">=</span> <span class="n">c_var_hmag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">,</span>
                                                                  <span class="n">pc_app_rho</span><span class="o">=</span><span class="n">c_var_app_rho_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                                                                  <span class="n">app_rho</span><span class="o">=</span> <span class="n">app_rho_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> 
                                                                  <span class="n">emag</span><span class="o">=</span> <span class="n">emag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                                                                  <span class="n">hmag</span><span class="o">=</span><span class="n">hmag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">japp_rho_min</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span> <span class="n">app_rho_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">Zcc</span><span class="o">.</span><span class="n">compute_sigmas_e_h_and_sigma_rho</span><span class="p">(</span><span class="n">pc_emag</span><span class="o">=</span> <span class="n">c_var_emag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                                                                  <span class="n">pc_hmag</span><span class="o">=</span> <span class="n">c_var_hmag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">,</span>
                                                                  <span class="n">pc_app_rho</span><span class="o">=</span><span class="n">c_var_app_rho_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                                                                  <span class="n">app_rho</span><span class="o">=</span> <span class="n">app_rho_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> 
                                                                  <span class="n">emag</span><span class="o">=</span> <span class="n">emag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                                                                  <span class="n">hmag</span><span class="o">=</span><span class="n">hmag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="n">jphase_max</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span> <span class="mi">180</span> <span class="o">*</span> <span class="p">(</span><span class="n">phase_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">std_phase_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
            <span class="n">jphase_min</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">*</span> <span class="p">(</span><span class="n">phase_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">std_phase_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        
        <span class="c1">#convert phase millirad value in degree : </span>
        <span class="n">phase_obj</span> <span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">phase</span> <span class="o">*</span> <span class="mf">1e-3</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">phase</span> <span class="ow">in</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="c1"># compute jwro and jwpha </span>
        <span class="c1">#we assume to take weight to 1.</span>
        <span class="n">jwapp_rho</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span> <span class="p">,</span>
                    <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">station_list</span><span class="p">,</span> 
                     <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">numfreq</span><span class="p">,),</span> 
                               <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">station_list</span><span class="p">))])}</span>
        
        <span class="kn">import</span> <span class="nn">copy</span>  <span class="c1"># use deep copy to copy the same weight and re  </span>
        <span class="n">jwpha</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">jwapp_rho</span><span class="p">)</span>
        
        <span class="c1">#-----&gt; starting writing Jfiles &lt;----- </span>
                <span class="c1">#--- &gt; start writing </span>
        <span class="n">write_jlines</span> <span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="n">survey_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">code_name</span> <span class="o">=</span> <span class="s1">&#39;ks</span><span class="si">{0:02}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">survey_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">code_name</span> <span class="o">=</span> <span class="n">survey_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{0:02}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">&#39;</span>
        <span class="n">codespace</span><span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="s1">&#39; &#39;</span>
        
        <span class="k">if</span> <span class="n">savepath</span>  <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="c1"># create a folder in your current work directory</span>
           <span class="k">try</span> <span class="p">:</span>
               <span class="n">savepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;_outputJ_&#39;</span><span class="p">)</span>
               <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">savepath</span><span class="p">):</span>
                   <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">savepath</span><span class="p">)</span>
           <span class="k">except</span> <span class="p">:</span> 
               <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It seems the path already exists !&quot;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">ii</span> <span class="p">,</span> <span class="n">stn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">station_list</span><span class="p">)</span> <span class="p">:</span> 
            <span class="c1">#-- &gt; write Head j </span>
            <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">j_obj</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">_comment_mark</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{0:}</span><span class="s1"> :&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j_obj</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">jinfo</span><span class="o">.</span><span class="n">progvers</span><span class="p">)</span> <span class="p">,</span> 
                                        <span class="n">code_name</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">station_list</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span> <span class="n">codespace</span><span class="p">,</span> 
                                        <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">j_obj</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">jfmtime</span><span class="p">),</span> <span class="n">codespace</span><span class="p">,</span> <span class="s1">&#39;RECS&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1">#--&gt; write info : </span>
            <span class="k">if</span> <span class="n">write_info</span> <span class="p">:</span> 
                <span class="k">try</span> <span class="p">:</span>
                    <span class="n">counter_break</span><span class="o">=</span><span class="mi">0</span>
                    <span class="n">lineinfo</span><span class="o">=</span><span class="p">[]</span>
                    <span class="c1">#--&gt; write zongeHardware infos </span>
                    <span class="k">for</span> <span class="n">zongeinfo</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyConfiguration</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Tx</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Rx</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="p">]:</span>
                        <span class="n">lineinfo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j_obj</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">_comment_mark</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">keyinfo</span><span class="p">,</span> <span class="n">valueinfo</span> <span class="ow">in</span> <span class="n">zongeinfo</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">valueinfo</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span> <span class="n">valueinfo</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ss</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">valueinfo</span> <span class="k">if</span> <span class="n">ss</span> <span class="o">!=</span><span class="kc">None</span><span class="p">])</span>
                            <span class="k">if</span> <span class="s1">&#39;None&#39;</span> <span class="ow">in</span> <span class="n">valueinfo</span><span class="p">:</span> <span class="n">valueinfo</span><span class="o">=</span><span class="n">valueinfo</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">valueinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                                <span class="n">lineinfo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}{1:^2}{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">keyinfo</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">valueinfo</span><span class="p">))</span>
                                <span class="n">lineinfo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:3^}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
                                <span class="n">counter_break</span> <span class="o">+=</span><span class="mi">1</span> 
                                <span class="k">if</span> <span class="n">counter_break</span><span class="o">==</span><span class="mi">7</span> <span class="p">:</span><span class="c1">#--&gt; go to line  to let visible info on jfile more visible.</span>
                                    <span class="n">lineinfo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">#&#39;</span><span class="p">)</span>
                                    <span class="n">counter_break</span><span class="o">=</span><span class="mi">0</span>
                        <span class="n">counter_break</span><span class="o">=</span><span class="mi">0</span>           
                        <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lineinfo</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>  
                        <span class="n">lineinfo</span><span class="o">=</span><span class="p">[]</span>

                <span class="k">except</span> <span class="p">:</span><span class="k">pass</span> 
     
            <span class="c1">#--- &gt; write jlabels </span>
            <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:&lt;13}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j_obj</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">_jlabels</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                         <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{0:&gt;13.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_obj</span><span class="o">.</span><span class="n">azim</span><span class="p">[</span><span class="n">stn</span><span class="p">]),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span> <span class="p">))</span>
            <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:&lt;13}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j_obj</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">_jlabels</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                                         <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{0:&gt;13.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_obj</span><span class="o">.</span><span class="n">lat</span><span class="p">[</span><span class="n">stn</span><span class="p">]),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span> <span class="p">))</span>
            <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:&lt;13}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j_obj</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">_jlabels</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                                         <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{0:&gt;13.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_obj</span><span class="o">.</span><span class="n">lon</span><span class="p">[</span><span class="n">stn</span><span class="p">]),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span> <span class="p">))</span>
            <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:&lt;13}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j_obj</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">_jlabels</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
                                         <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{0:&gt;13.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_obj</span><span class="o">.</span><span class="n">elev</span><span class="p">[</span><span class="n">stn</span><span class="p">]),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span> <span class="p">))</span>
            <span class="c1">#---&gt; write jnames , components  and nperiods </span>
            <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jstnnames</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span> 
                                         <span class="s1">&#39;</span><span class="si">{0:&gt;7.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_obj</span><span class="o">.</span><span class="n">azim</span><span class="p">[</span><span class="n">stn</span><span class="p">]),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]))</span>
            <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jcomp</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jnperiod</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># now  write value :</span>
                
            <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jnperiod</span><span class="p">):</span>

                <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{0:&lt;12.3e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jperiod</span><span class="p">[</span><span class="n">jj</span><span class="p">]),</span> 
                                               <span class="s1">&#39;</span><span class="si">{0:^12.3e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app_rho_obj</span> <span class="p">[</span><span class="n">stn</span><span class="p">][</span><span class="n">jj</span><span class="p">]),</span> 
                                               <span class="s1">&#39;</span><span class="si">{0:^12.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">phase_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">][</span><span class="n">jj</span><span class="p">]),</span> 
                                               <span class="s1">&#39;</span><span class="si">{:^12.3e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">japp_rho_max</span><span class="p">[</span><span class="n">stn</span><span class="p">][</span><span class="n">jj</span><span class="p">]),</span> 
                                               <span class="s1">&#39;</span><span class="si">{:^12.3e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">japp_rho_min</span><span class="p">[</span><span class="n">stn</span><span class="p">][</span><span class="n">jj</span><span class="p">]),</span> 
                                               <span class="s1">&#39;</span><span class="si">{:^12.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jphase_max</span><span class="p">[</span><span class="n">stn</span><span class="p">][</span><span class="n">jj</span><span class="p">]),</span> 
                                               <span class="s1">&#39;</span><span class="si">{:^12.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jphase_min</span><span class="p">[</span><span class="n">stn</span><span class="p">][</span><span class="n">jj</span><span class="p">]),</span>
                                               <span class="s1">&#39;</span><span class="si">{:^7.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jwapp_rho</span><span class="p">[</span><span class="n">stn</span><span class="p">][</span><span class="n">jj</span><span class="p">]),</span> 
                                               <span class="s1">&#39;</span><span class="si">{:^7.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jwpha</span><span class="p">[</span><span class="n">stn</span><span class="p">][</span><span class="n">jj</span><span class="p">]),</span>
                                                                 <span class="p">]))</span>

                <span class="n">write_jlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">station_list</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span><span class="n">j_extension</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fj</span><span class="p">:</span>
                <span class="n">fj</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">write_jlines</span><span class="p">)</span>  
            
                
            <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">shutil</span><span class="o">.</span><span class="n">move</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">station_list</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span><span class="n">j_extension</span><span class="p">),</span> <span class="n">savepath</span><span class="p">)</span>
                                                           
            <span class="n">write_jlines</span><span class="o">=</span><span class="p">[]</span>  
            
            
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">77</span><span class="p">)</span> 
        <span class="c1"># if savepath is None :savepath =os.getcwd()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; </span><span class="si">{0}</span><span class="s1"> J-files have been rewritten.</span><span class="se">\n</span><span class="s1">---&gt; see path:&lt;</span><span class="si">{1}</span><span class="s1">&gt; &#39;</span><span class="o">.</span>\
              <span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">station_list</span><span class="p">),</span> <span class="n">savepath</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">77</span><span class="p">)</span></div>
        
        
<div class="viewcode-block" id="Avg.avg_to_edifile"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Avg.avg_to_edifile">[docs]</a>    <span class="k">def</span> <span class="nf">avg_to_edifile</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">profile_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                        <span class="n">savepath</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">apply_filter</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                        <span class="n">reference_frequency</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_points</span><span class="o">=</span><span class="mf">7.</span><span class="p">,</span>
                        <span class="n">dipole_length</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span><span class="n">number_of_skin_depth</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to write avg file to SEG-EDIfile.Convert both files.Astatic or plainty avg file .</span>
<span class="sd">        if ASTATIC file is provided , will add the filter and filter values .</span>
<span class="sd">        if avg file is not astatic file , user an apply</span>
<span class="sd">        filter by setting filter to &quot;tma, ama, or flma&quot;.Once apply ,</span>
<span class="sd">        edifiles will exported by computing resistivities filtered</span>
<span class="sd">        </span>
<span class="sd">        Parameters </span>
<span class="sd">        ----------</span>
<span class="sd">            * data_fn : str </span>
<span class="sd">                        full path to avgfile </span>
<span class="sd">            * savepath : str </span>
<span class="sd">                        outdir to store edifiles if None ,</span>
<span class="sd">                        is your current work directory                </span>
<span class="sd">            * profile_fn: str </span>
<span class="sd">                        full path  to station _profile file</span>
<span class="sd">            * apply_filter: str </span>
<span class="sd">                        add the name of filter to process the</span>
<span class="sd">                        avg file exported in edifiles. </span>
<span class="sd">                        can be  [TMA | AMA| FLMA]</span>
<span class="sd">                        TMA - Trimming Moving Average</span>
<span class="sd">                        AMA - Adaptative Moving avarage , </span>
<span class="sd">                        FLMA - Fixed dipoleLength moving </span>
<span class="sd">                        average (number of point=7)</span>
<span class="sd">                        Dipolelength willbe computed automatically </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">            obj, edi_obj  </span>
<span class="sd">                edi outputfiles or edi filtered file.</span>
<span class="sd">            </span>
<span class="sd">        Holdings additionals parameters </span>
<span class="sd">            </span>
<span class="sd">        ====================  ==========  =====================================</span>
<span class="sd">        Optional                Type        Description            </span>
<span class="sd">        ====================  ==========  =====================================</span>
<span class="sd">        reference_frequency    float        frequency at clean data.Default is </span>
<span class="sd">                                            computed automatically</span>
<span class="sd">        number_of_points=7.    int          number of point to for weighted  </span>
<span class="sd">                                            window,. *Default* is 7.</span>
<span class="sd">        dipole_length          float        length of dipole in meter. For  </span>
<span class="sd">                                            CSAMT, *Default* is 50.</span>
<span class="sd">        number_of_skin_depth   float        number of skin_depth can be 1 to 10</span>
<span class="sd">                                            when using filter AMA. </span>
<span class="sd">                                            *Default* is 3.</span>
<span class="sd">        ====================  ==========  =====================================</span>
<span class="sd">                                     </span>
<span class="sd">        :Example:   </span>
<span class="sd">            </span>
<span class="sd">            &gt;&gt;&gt; from pycsamt.ff.core import avg </span>
<span class="sd">            &gt;&gt;&gt; avg_obj= avg.Avg()</span>
<span class="sd">            &gt;&gt;&gt; avg_obj.avg_to_edifile(data_fn= os.path.join(</span>
<span class="sd">            ...    path_to_avgfile, avgfile) , </span>
<span class="sd">            ...           profile_fn = os.path.join(</span>
<span class="sd">            ...    path_to_avgfile, station_profile_file), </span>
<span class="sd">            ...           savepath =save_edipath, </span>
<span class="sd">            ...           apply_filter=None ) </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">utm_zone</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;utm_zone&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        
        <span class="k">if</span> <span class="n">data_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="o">=</span> <span class="n">data_fn</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_avg_file</span><span class="p">(</span><span class="s2">&quot;Could not find any path to read .&quot;</span>\
                                            <span class="s2">&quot;Please provide your right AVG file.&quot;</span><span class="p">)</span>
        
        
        <span class="c1"># export to savepath </span>
        <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="c1"># create a folder in your current work directory</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="n">savepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;_outputAVG2EDI_&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">savepath</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">savepath</span><span class="p">)</span><span class="c1">#  mode =0o666)</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It seems the path already exists !&quot;</span><span class="p">)</span>
        
        
        <span class="k">if</span> <span class="n">profile_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;No station profile file will detected.&#39;</span>\
                           <span class="s1">&#39; Be aware sure , we will set location longitude ,&#39;</span>\
                               <span class="s1">&#39; latitude and elevation to &lt;0.&gt;&#39;</span><span class="p">)</span>
        
        <span class="c1"># read avg file </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_avg_file</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">profile_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
             <span class="n">site_obj</span> <span class="o">=</span> <span class="n">Site</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span><span class="n">profile_fn</span><span class="p">,</span> <span class="n">utm_zone</span><span class="o">=</span><span class="n">utm_zone</span><span class="p">)</span>
                                                                   
        <span class="c1">#---&gt; get the list of stations </span>
        <span class="n">head_dataid_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Station</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        

        <span class="c1">#-- compute dipole lenght  between station close </span>
        <span class="n">dipole_length</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Station</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">head_dataid_list</span> <span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span>\
            <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Station</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">head_dataid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="c1">#--&gt; nfrequency = </span>
        <span class="n">nfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">size</span>
        
        
        <span class="c1">#------------------------------------------------------------------------------------</span>
        <span class="c1">#---&gt; compute error propagation , phase and resistivity </span>
        <span class="n">app_rho_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Resistivity</span><span class="o">.</span><span class="n">loc</span> 

        <span class="n">phase_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">loc</span>
        <span class="n">emag_obj</span> <span class="p">,</span><span class="n">hmag_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Emag</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Hmag</span><span class="o">.</span><span class="n">loc</span>  
        <span class="n">c_var_emag_obj</span> <span class="p">,</span> <span class="n">c_var_hmag_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcEmag</span><span class="o">.</span><span class="n">loc</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcHmag</span><span class="o">.</span><span class="n">loc</span>
        <span class="n">c_var_app_rho_obj</span> <span class="p">,</span> <span class="n">std_phase_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcRho</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">sPhz</span><span class="o">.</span><span class="n">loc</span>
        <span class="c1">#self.Header.HardwareInfos.astatic_version</span>
        <span class="n">AS_flag</span> <span class="o">=</span><span class="mi">0</span>          <span class="c1"># maker to check whether is plainty avg file or Astatic file </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">numfilterfreq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="c1"># self.Header.HardwareInfos.numfilterfreq is not None :</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Reading Zonge `ASTATIC` file !&#39;</span><span class="p">)</span>
            <span class="n">AS_rho</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Resistivity</span><span class="o">.</span><span class="n">loc_Sres</span>
            <span class="n">AS_flag</span> <span class="o">=</span><span class="mi">1</span>
        
        <span class="n">error_propag_rho</span><span class="p">,</span> <span class="n">error_propag_phs</span> <span class="o">=</span><span class="p">[{}</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># create 2empty  dicts</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Resistivity</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="n">error_propag_rho</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span> <span class="n">app_rho_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span> <span class="n">Zcc</span><span class="o">.</span><span class="n">compute_sigmas_e_h_and_sigma_rho</span><span class="p">(</span>
                                                                <span class="n">pc_emag</span><span class="o">=</span> <span class="n">c_var_emag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                                                                  <span class="n">pc_hmag</span><span class="o">=</span> <span class="n">c_var_hmag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">,</span>
                                                                  <span class="n">pc_app_rho</span><span class="o">=</span><span class="n">c_var_app_rho_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                                                                  <span class="n">app_rho</span><span class="o">=</span> <span class="n">app_rho_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> 
                                                                  <span class="n">emag</span><span class="o">=</span> <span class="n">emag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                                                                  <span class="n">hmag</span><span class="o">=</span><span class="n">hmag_obj</span><span class="p">[</span><span class="n">key</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="n">error_propag_phs</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span> <span class="mi">180</span> <span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">std_phase_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="c1">#  std = sPhz / 100 #converted in radians</span>
  
        
        <span class="c1">#convert phase millirad value in degree : </span>
        <span class="n">phase_obj</span> <span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">phase</span> <span class="o">*</span> <span class="mf">1e-3</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">phase</span> <span class="ow">in</span> <span class="n">phase_obj</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    
        <span class="c1">#-----------------------------------------------------------------------------------------</span>
        <span class="k">if</span> <span class="n">apply_filter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="n">apply_filter</span><span class="o">=</span> <span class="n">apply_filter</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---&gt; ErrorType: Filters&#39; names must a str of&quot;</span>
                              <span class="s2">&quot; `tma` `flma` or `ama`. not </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">apply_filter</span><span class="p">)))</span>
                
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;TypeError ,Filters&#39; names must be a str of&quot;</span>
                              <span class="s2">&quot; `tma` ,`flma` or  `ama`. not </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">apply_filter</span><span class="p">)))</span>
                <span class="n">apply_filter</span><span class="o">=</span><span class="kc">None</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:-^77}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Filter Infos&#39;</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Filter applied&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">apply_filter</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
                
        <span class="k">if</span> <span class="n">apply_filter</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ama&#39;</span><span class="p">,</span> <span class="s1">&#39;tma&#39;</span><span class="p">,</span> <span class="s1">&#39;flma&#39;</span><span class="p">]:</span>
            <span class="c1"># create processing_obj , unique obj for all filters  </span>
            <span class="n">corr_obj</span><span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">shifting</span><span class="p">(</span><span class="n">data_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">,</span>
                                    <span class="n">profile_fn</span><span class="o">=</span><span class="n">profile_fn</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="n">apply_filter</span> <span class="o">==</span><span class="s1">&#39;tma&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span>
                    <span class="s1">&#39;Computing  rho with Trimming moving average (TMA) filter.&#39;</span><span class="p">)</span>
                        
                <span class="c1"># corr_obj= corr.shifting()</span>
                <span class="n">res_TMA</span><span class="o">=</span> <span class="n">corr_obj</span><span class="o">.</span><span class="n">TMA</span><span class="p">(</span><span class="n">number_of_TMA_points</span> <span class="o">=</span><span class="n">number_of_points</span> <span class="p">,</span> 
                                      <span class="n">reference_freq</span><span class="o">=</span><span class="n">reference_frequency</span><span class="p">,</span> 
                                      <span class="p">)</span>
                
                <span class="n">reference_frequency</span> <span class="o">=</span><span class="n">corr_obj</span><span class="o">.</span><span class="n">referencefreq</span>
                
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;TMA filter points&#39;</span><span class="p">,</span> 
                                                  <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">number_of_points</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> Hz.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Reference frequency&#39;</span><span class="p">,</span>
                                                      <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">reference_frequency</span><span class="p">))</span>
                
            <span class="k">elif</span> <span class="n">apply_filter</span> <span class="o">==</span><span class="s1">&#39;flma&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span>
                    <span class="s1">&#39;Computing rho with fixed-length moving average (FLMA) filter.&#39;</span><span class="p">)</span>
     
                <span class="n">res_FLMA</span> <span class="o">=</span> <span class="n">corr_obj</span><span class="o">.</span><span class="n">FLMA</span><span class="p">(</span><span class="n">number_of_dipole</span><span class="o">=</span><span class="n">number_of_points</span><span class="p">,</span> 
                                        <span class="n">reference_freq</span><span class="o">=</span><span class="n">reference_frequency</span><span class="p">)</span>
                
                <span class="n">dipolelength</span><span class="o">=</span> <span class="n">corr_obj</span><span class="o">.</span><span class="n">dipolelength</span>
                <span class="n">reference_frequency</span> <span class="o">=</span><span class="n">corr_obj</span><span class="o">.</span><span class="n">referencefreq</span>

                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;FLMA filter points&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">number_of_points</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> Hz.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Reference frequency&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">reference_frequency</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> m.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Dipole length &#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">dipolelength</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">apply_filter</span> <span class="o">==</span> <span class="s1">&#39;ama&#39;</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span>
                    <span class="s1">&#39;Computing rho with adaptative moving average (AMA) filter.&#39;</span><span class="p">)</span>
    
                <span class="n">res_AMA</span> <span class="o">=</span> <span class="n">corr_obj</span><span class="o">.</span><span class="n">AMA</span><span class="p">(</span><span class="n">number_of_skin_depth</span><span class="o">=</span><span class="n">number_of_skin_depth</span><span class="p">,</span> 
                                        <span class="n">reference_freq</span><span class="o">=</span><span class="n">reference_frequency</span><span class="p">)</span>
  
                <span class="n">dipolelength</span><span class="o">=</span> <span class="n">corr_obj</span><span class="o">.</span><span class="n">dipolelength</span>
                <span class="n">reference_frequency</span> <span class="o">=</span><span class="n">corr_obj</span><span class="o">.</span><span class="n">referencefreq</span>
                
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Number of skin depths&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">number_of_skin_depth</span><span class="p">)))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> Hz.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Reference frequency&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">reference_frequency</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> m.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Dipole length &#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">dipolelength</span><span class="p">))</span>
     
            <span class="k">elif</span> <span class="n">apply_filter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">apply_filter</span>  <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;tma, ama, flma&#39;</span><span class="p">]:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;filter </span><span class="si">%s</span><span class="s1"> provided is UNrecognizing.&#39;</span>
                              <span class="s1">&#39; Pogram worsk currently with : TMA or FLMA ,&#39;</span>
                              <span class="s1">&#39; Please provided the right filters&#39;</span>
                              <span class="s1">&#39; for computing.&#39;</span><span class="o">%</span> <span class="n">apply_filter</span><span class="p">)</span>
                                  
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_processing</span><span class="p">(</span>
                    <span class="s1">&#39;Filters provided is not acceptable.&#39;</span>
                    <span class="s1">&#39; Recognized filters are &quot;TMA&quot;,&quot;AMA&quot; AND &quot;FLMA&quot;&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">apply_filter</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">numfilterfreq</span> <span class="ow">is</span> <span class="kc">None</span>\
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">freq_filter</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                 <span class="n">avgfilter</span><span class="p">,</span> <span class="n">descritipfilter</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>   
    
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">astatic_version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">avgfilter</span> <span class="o">=</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">.</span><span class="si">{1}</span><span class="s2">.Filter =TMA for 5pts.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s1">&#39;Astatic&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">astatic_version</span> <span class="p">)</span>
                <span class="n">descritipfilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
            
            <span class="k">else</span> <span class="p">:</span> <span class="n">avgfilter</span><span class="p">,</span> <span class="n">descritipfilter</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">apply_filter</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">msf</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="n">apply_filter</span> <span class="o">==</span><span class="s1">&#39;flma&#39;</span><span class="p">:</span>
                <span class="n">descritipfilter</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">{0}</span><span class="s1"> dipoles for FLMA filter&#39;</span>\
                    <span class="s1">&#39; at </span><span class="si">{1}</span><span class="s1"> hertz with </span><span class="si">{2}</span><span class="s1"> m dipole length&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">number_of_points</span><span class="p">),</span> <span class="n">reference_frequency</span><span class="p">,</span> <span class="n">dipolelength</span><span class="p">)</span>
                <span class="n">msf</span><span class="o">=</span><span class="s1">&#39;dip&#39;</span>
            <span class="k">elif</span> <span class="n">apply_filter</span> <span class="o">==</span><span class="s1">&#39;tma&#39;</span><span class="p">:</span>
                <span class="n">descritipfilter</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">{0}</span><span class="s1"> points for TMA filter at </span><span class="si">{1}</span><span class="s1"> hertz&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">number_of_points</span><span class="p">),</span> <span class="n">reference_frequency</span><span class="p">)</span>
                <span class="n">msf</span><span class="o">=</span><span class="s1">&#39;pts&#39;</span> 
                
            <span class="k">elif</span> <span class="n">apply_filter</span> <span class="o">==</span><span class="s1">&#39;ama&#39;</span><span class="p">:</span>
                <span class="n">descritipfilter</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">{0}</span><span class="s1"> skin depths for AMA filter at </span><span class="si">{1}</span><span class="s1"> hertz&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">number_of_skin_depth</span><span class="p">),</span> <span class="n">reference_frequency</span><span class="p">)</span>
                <span class="n">number_of_points</span><span class="o">=</span><span class="n">number_of_skin_depth</span>
                <span class="n">msf</span><span class="o">=</span><span class="s1">&#39;sdepths&#39;</span>

            <span class="n">avgfilter</span> <span class="o">=</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">.</span><span class="si">{1}</span><span class="s2">.Filter =</span><span class="si">{2}</span><span class="s2"> for </span><span class="si">{3}</span><span class="s2"> </span><span class="si">{4}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                   <span class="s1">&#39;pycsamt&#39;</span><span class="p">,</span><span class="s1">&#39;v1.0.01&#39;</span><span class="p">,</span> <span class="n">apply_filter</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>  
                   <span class="nb">int</span><span class="p">(</span><span class="n">number_of_points</span><span class="p">)</span> <span class="p">,</span> <span class="n">msf</span><span class="p">)</span>
            
            
        <span class="k">if</span> <span class="n">profile_fn</span>  <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="c1">#---&gt; set to 0. lon , lat and elev if profile _fn is not provided</span>
            <span class="c1">#--&gt; create dictionnary of zero value of lat and lon </span>
            <span class="kn">import</span> <span class="nn">copy</span> 
            <span class="c1">#head_edi_lon = np.full((len(head_dataid_list),), 0., dtype=np.float)</span>
            <span class="n">head_edi_lon</span> <span class="o">=</span> <span class="p">{</span><span class="n">stn</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">stn</span> <span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span> <span class="p">(</span>
                <span class="n">head_dataid_list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">head_dataid_list</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">))}</span>
            <span class="n">head_edi_lat</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">head_edi_lon</span><span class="p">)</span>
            <span class="n">head_edi_elev</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">head_edi_lon</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="n">profile_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
             <span class="n">head_edi_lon</span> <span class="o">=</span> <span class="n">site_obj</span><span class="o">.</span><span class="n">lon</span>
             <span class="n">head_edi_lat</span> <span class="o">=</span> <span class="n">site_obj</span><span class="o">.</span><span class="n">lat</span> 
             <span class="n">head_edi_elev</span> <span class="o">=</span> <span class="n">site_obj</span><span class="o">.</span><span class="n">elev</span> 
        
        <span class="c1">#------------------------START SETTING EDI ATTRIBUTE -----------------------------</span>
        <span class="c1"># import module Hmeasurement and Emeasurement</span>
        <span class="kn">from</span> <span class="nn">pycsamt.ff.core.edi</span> <span class="kn">import</span> <span class="n">Hmeasurement</span><span class="p">,</span> <span class="n">Emeasurement</span>
        <span class="c1"># from pycsamt.utils import gis_tools as gis </span>
        
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">stn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">head_dataid_list</span><span class="p">):</span> <span class="c1">#   for stn in head_dataid_list : #loop for all station or dataid </span>
            <span class="c1">#create Ediobj for eac datalist </span>
            <span class="n">edi_obj</span> <span class="o">=</span><span class="n">Edi</span><span class="p">()</span>
            
            <span class="c1">#====&gt; set edi_obj Header attributes</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">dataid</span><span class="o">=</span> <span class="n">head_dataid_list</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="c1"># ii mean for all the list </span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">acqby</span> <span class="o">=</span> <span class="s1">&#39;Zonge Engineering&#39;</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">acqdate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">dated</span> 
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">fileby</span> <span class="o">=</span> <span class="s2">&quot;AMTAVG_v.</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">version</span><span class="p">)</span> 
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">project_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;project_name &#39;</span><span class="p">,</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">))</span> 
    
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">filedate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">processed</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">prospect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">contractor_name</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">county</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">project_area</span> 
            
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="n">head_edi_lat</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">long</span> <span class="o">=</span> <span class="n">head_edi_lon</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">elev</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">head_edi_elev</span><span class="p">[</span><span class="n">stn</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
            
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">maxsect</span> <span class="o">=</span><span class="mi">1000</span>
            
            
            <span class="c1">#=====&gt;  set edi_obj_info . </span>
            <span class="c1"># edi_obj.Info.maxinfo = 999</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">freq_filter</span>
            
               
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">Source</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">project_name</span><span class="p">)</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">Source</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;survey&#39;</span><span class="p">,</span>  <span class="n">head_dataid_list</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">Source</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;sitename&#39;</span><span class="p">,</span> <span class="n">head_dataid_list</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">Processing</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;processedby&#39;</span><span class="p">,</span> <span class="s1">&#39;pyCSAMT&#39;</span> <span class="p">)</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">Processing</span><span class="o">.</span><span class="n">ProcessingSoftware</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">fileby</span> <span class="p">)</span>
            
    
            <span class="c1">#====&gt; definemeas </span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">DefineMeasurement</span><span class="o">.</span><span class="n">maxchan</span> <span class="o">=</span><span class="mi">4</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">DefineMeasurement</span><span class="o">.</span><span class="n">maxrun</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">head_dataid_list</span><span class="p">)</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">DefineMeasurement</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;reftype&#39;</span> <span class="p">,</span><span class="s1">&#39;CARTesien&#39;</span><span class="p">)</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">DefineMeasurement</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;reflat&#39;</span><span class="p">,</span><span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">lat</span>  <span class="p">)</span> 
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">DefineMeasurement</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;reflong&#39;</span><span class="p">,</span> <span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">long</span><span class="p">)</span> 
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">DefineMeasurement</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;refelev&#39;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">elev</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
            
            <span class="c1"># creating xxmeas object </span>
            <span class="n">codeID_dec</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">edi_obj</span><span class="o">.</span><span class="n">Head</span><span class="o">.</span><span class="n">maxsect</span><span class="p">)</span>
            <span class="c1"># codeID=  &#39;{0:04}{1}&#39;.format(ii * 10 + 1 , codeID_dec[1:] )</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">DefineMeasurement</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;meas_ex&#39;</span><span class="p">,</span> 
                                                  <span class="n">Emeasurement</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">{0:04}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">,</span> 
                                                                                          <span class="n">codeID_dec</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">),</span> 
                                                                          <span class="s1">&#39;chtype&#39;</span><span class="p">:</span><span class="s1">&#39;EX&#39;</span><span class="p">,</span> 
                                                                          <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">dipole_length</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> 
                                                                          <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span>
                                                                          <span class="s1">&#39;x2&#39;</span><span class="p">:</span><span class="n">dipole_length</span><span class="o">/</span><span class="mi">2</span> <span class="p">,</span> 
                                                                          <span class="s1">&#39;y2&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> 
                                                                          <span class="s1">&#39;acqchan&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00&#39;</span><span class="p">,</span> 
                                                                          <span class="s1">&#39;filter&#39;</span><span class="p">:</span><span class="n">avgfilter</span><span class="p">,</span> 
                                                                          <span class="p">}))</span>

            <span class="n">edi_obj</span><span class="o">.</span><span class="n">DefineMeasurement</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;meas_ey&#39;</span><span class="p">,</span>
                                                  <span class="n">Emeasurement</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">{0:04}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">,</span> 
                                                                                          <span class="n">codeID_dec</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> 
                                                                          <span class="s1">&#39;chtype&#39;</span><span class="p">:</span><span class="s1">&#39;EY&#39;</span><span class="p">,</span> 
                                                                          <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> 
                                                                          <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">dipole_length</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
                                                                          <span class="s1">&#39;x2&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> 
                                                                          <span class="s1">&#39;y2&#39;</span><span class="p">:</span><span class="n">dipole_length</span><span class="o">/</span><span class="mi">2</span> <span class="p">,</span> <span class="s1">&#39;acqchan&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00&#39;</span><span class="p">,</span> 
                                                                          <span class="s1">&#39;filter&#39;</span><span class="p">:</span><span class="n">avgfilter</span><span class="p">}))</span>

            <span class="n">edi_obj</span><span class="o">.</span><span class="n">DefineMeasurement</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;meas_hx&#39;</span><span class="p">,</span> 
                                                  <span class="n">Hmeasurement</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">{0:04}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">3</span> <span class="p">,</span> 
                                                                                          <span class="n">codeID_dec</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">),</span> 
                                                                              <span class="s1">&#39;chtype&#39;</span><span class="p">:</span><span class="s1">&#39;HX&#39;</span><span class="p">,</span> 
                                                                              <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> 
                                                                              <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span>
                                                                              <span class="s1">&#39;x2&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> 
                                                                              <span class="s1">&#39;y2&#39;</span><span class="p">:</span><span class="mf">0.</span> <span class="p">,</span> <span class="s1">&#39;acqchan&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00&#39;</span><span class="p">,</span> 
                                                                          <span class="s1">&#39;filter&#39;</span><span class="p">:</span><span class="n">avgfilter</span><span class="p">}))</span>

            <span class="n">edi_obj</span><span class="o">.</span><span class="n">DefineMeasurement</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;meas_hy&#39;</span><span class="p">,</span>
                                                  <span class="n">Hmeasurement</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">{0:04}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">4</span> <span class="p">,</span>
                                                                                          <span class="n">codeID_dec</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> 
                                                                      <span class="s1">&#39;chtype&#39;</span><span class="p">:</span><span class="s1">&#39;HY&#39;</span><span class="p">,</span> 
                                                                      <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> 
                                                                      <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span>
                                                                      <span class="s1">&#39;x2&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> 
                                                                      <span class="s1">&#39;y2&#39;</span><span class="p">:</span><span class="mf">0.</span> <span class="p">,</span> <span class="s1">&#39;acqchan&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00&#39;</span><span class="p">,</span> 
                                                                  <span class="s1">&#39;filter&#39;</span><span class="p">:</span><span class="n">avgfilter</span><span class="p">}))</span>
                
                        
            <span class="c1">#====&gt; EMAPSECT</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">MTEMAP</span><span class="o">.</span><span class="n">sectid</span> <span class="o">=</span> <span class="n">stn</span> 
 
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">MTEMAP</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;nfreq&#39;</span><span class="p">,</span> <span class="n">nfreq</span><span class="p">)</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">MTEMAP</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;maxblks&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">MTEMAP</span><span class="o">.</span><span class="n">ndipole</span><span class="o">=</span>  <span class="nb">len</span><span class="p">(</span><span class="n">head_dataid_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> 
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">MTEMAP</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">descritipfilter</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">MTEMAP</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;hx&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{0:04}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">codeID_dec</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">))</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">MTEMAP</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;hy&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{0:04}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">4</span> <span class="p">,</span> <span class="n">codeID_dec</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">))</span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">MTEMAP</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;chksum&#39;</span><span class="p">,</span> <span class="mi">64</span> <span class="o">*</span> <span class="n">nfreq</span><span class="p">)</span>
            
            <span class="c1"># Frequency blocks , impendance and resistivity blocs </span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">value</span> 
            
            <span class="c1"># set phase and resistitivity including error propagation </span>
            <span class="c1"># compute error propagation  </span>
            <span class="c1">#--&gt;  initialize ndarray(nfreq, 2, 2) </span>
            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span> <span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
            <span class="n">res_array_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span> <span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
            <span class="n">phs_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span> <span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
            <span class="n">phs_array_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span> <span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
   
            <span class="c1">#dictionnary of components . we set only component into XY . </span>
            <span class="n">res_array</span> <span class="p">[:,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">=</span> <span class="n">app_rho_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span>
            <span class="n">res_array_err</span> <span class="p">[:,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="n">error_propag_rho</span> <span class="p">[</span><span class="n">stn</span><span class="p">]</span>
            <span class="n">phs_array</span><span class="p">[:</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">phase_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span> 
            <span class="n">phs_array_err</span>  <span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="o">=</span> <span class="n">error_propag_phs</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="n">AS_flag</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> 
                <span class="n">res_as_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span> <span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
                <span class="n">res_as_array</span> <span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="o">=</span> <span class="n">AS_rho</span> <span class="p">[</span><span class="n">stn</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="n">apply_filter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">fres_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfreq</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span> <span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">apply_filter</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;tma&#39;</span> <span class="p">:</span>
                    <span class="n">fres_array</span>  <span class="p">[:</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="o">=</span> <span class="n">res_TMA</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">apply_filter</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;flma&#39;</span> <span class="p">:</span>
                    <span class="n">fres_array</span>  <span class="p">[:</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="o">=</span> <span class="n">res_FLMA</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">apply_filter</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;ama&#39;</span> <span class="p">:</span>
                    <span class="n">fres_array</span>  <span class="p">[:</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="o">=</span> <span class="n">res_AMA</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span>
                    
            <span class="c1">#---&gt; computing z with resistivities , phase by using propagrations errors </span>
            <span class="n">edi_obj</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">set_res_phase</span><span class="p">(</span><span class="n">res_array</span> <span class="o">=</span> <span class="n">res_array</span><span class="p">,</span> <span class="n">phase_array</span><span class="o">=</span><span class="n">phs_array</span><span class="p">,</span> 
                                    <span class="n">freq</span><span class="o">=</span>  <span class="n">edi_obj</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> 
                                    <span class="n">res_err_array</span><span class="o">=</span><span class="n">res_array_err</span><span class="p">,</span>
                                    <span class="n">phase_err_array</span><span class="o">=</span><span class="n">phs_array_err</span><span class="p">)</span>
            <span class="c1"># write edifiles ...</span>
            <span class="k">if</span> <span class="n">AS_flag</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
                <span class="n">edi_obj</span><span class="o">.</span><span class="n">write_edifile</span><span class="p">(</span><span class="n">savepath</span> <span class="o">=</span> <span class="n">savepath</span><span class="p">,</span> 
                                      <span class="n">add_filter_array</span> <span class="o">=</span><span class="n">res_as_array</span> <span class="p">)</span>
                
            <span class="k">elif</span> <span class="n">apply_filter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
               <span class="n">edi_obj</span><span class="o">.</span><span class="n">write_edifile</span><span class="p">(</span><span class="n">savepath</span> <span class="o">=</span> <span class="n">savepath</span><span class="p">,</span> 
                                     <span class="n">add_filter_array</span> <span class="o">=</span> <span class="n">fres_array</span> <span class="p">)</span>
               
            <span class="k">else</span> <span class="p">:</span> <span class="n">edi_obj</span><span class="o">.</span><span class="n">write_edifile</span><span class="p">(</span><span class="n">savepath</span> <span class="o">=</span> <span class="n">savepath</span><span class="p">)</span>
                
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">77</span><span class="p">)</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; </span><span class="si">{0}</span><span class="s1"> Edi-files have been rewritten.</span><span class="se">\n</span><span class="s1">---&gt; see path:&lt;</span><span class="si">{1}</span><span class="s1">&gt; &#39;</span><span class="o">.</span>\
              <span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">head_dataid_list</span><span class="p">),</span> <span class="n">savepath</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">77</span><span class="p">)</span></div></div>
            
    
<div class="viewcode-block" id="Header"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Header">[docs]</a><span class="k">class</span> <span class="nc">Header</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read the info Header of AVG file and rewrite Avgfile (main type, Type1) .</span>
<span class="sd">    </span>
<span class="sd">    Arguments  </span>
<span class="sd">    ---------</span>
<span class="sd">        **data_fn** : str  </span>
<span class="sd">                path to avgfile</span>
<span class="sd">        </span>
<span class="sd">    ======================  =========  =====================================</span>
<span class="sd">    Attributes              Type        Explanation</span>
<span class="sd">    ======================  =========  =====================================</span>
<span class="sd">    HardwareInfos           class        zonge Hardware  </span>
<span class="sd">    SurveyAnnotation        class        zonge project  informations </span>
<span class="sd">    SurveyConfiguration     class        zonge project/locations settings </span>
<span class="sd">    Tx                      class        special Transmitter  properties </span>
<span class="sd">    Rx                      class        special receiver properties</span>
<span class="sd">    ======================  =========  =====================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg</span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...          &#39;pycsamt&#39;, &quot;data&quot;, &quot;LC101.avg&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj= Avg(data_fn=path) </span>
<span class="sd">        &gt;&gt;&gt; surv_area= avg_obj.Header.SurveyAnnotation.project_area </span>
<span class="sd">        &gt;&gt;&gt; print(survey.area)</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header_infos</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">HardwareInfos</span> <span class="o">=</span><span class="n">ZongeHardware</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">=</span><span class="n">SurveyAnnotation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SurveyConfiguration</span><span class="o">=</span><span class="n">SurveyConfiguration</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tx</span><span class="o">=</span><span class="n">TransmitterProperties</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rx</span><span class="o">=</span><span class="n">ReceiverProperties</span><span class="p">()</span>

        
        <span class="k">for</span> <span class="n">keys</span>  <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>       
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">head_block_infos</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;Hardware infos&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;Survey annotation&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;Survey configuration&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;Transmitter properties&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;Receiver properties&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;end&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="Header.write_header_log"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Header.write_header_log">[docs]</a>    <span class="k">def</span> <span class="nf">write_header_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">savepath</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Method to write your head log. In fact just to see whether your Zonge Infos </span>
<span class="sd">        was set correctly.</span>
<span class="sd">        </span>
<span class="sd">        Parameters </span>
<span class="sd">        ----------</span>
<span class="sd">            * data_fn : str </span>
<span class="sd">                        path to Avgfile</span>
<span class="sd">            * savepath : str </span>
<span class="sd">                        path to your destination file . if None , </span>
<span class="sd">                        path is your current work directory .</span>
<span class="sd">            </span>
<span class="sd">        :Example:</span>
<span class="sd">            </span>
<span class="sd">            &gt;&gt;&gt; from pycsamt.ff.core.avg.Avg import Header</span>
<span class="sd">            &gt;&gt;&gt; Header().write_header_log(data_fn=path,</span>
<span class="sd">            ...               )</span>
<span class="sd">            &gt;&gt;&gt; he=Header()</span>
<span class="sd">            ... he.write_header_log(data_fn=path,</span>
<span class="sd">            ...                   savepath=r&#39;C:/Users\Administrator\Desktop&#39;)</span>
<span class="sd">            ... avg_obj.Header.write_header_log(data_fn=path,</span>
<span class="sd">            ...               savepath=r&#39;C:/Users/Administrator/Desktop&#39;) </span>
<span class="sd">        &quot;&quot;&quot;</span>
         
        <span class="k">if</span> <span class="n">data_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="o">=</span><span class="n">data_fn</span> 
        <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">savepath</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>
            <span class="n">avg_obj</span><span class="o">=</span><span class="n">Avg</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)</span>
            <span class="n">avg_obj</span><span class="o">.</span><span class="n">_read_avg_file</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)</span>
            
        <span class="n">rmlines</span><span class="p">,</span> <span class="n">spac_b</span><span class="p">,</span> <span class="n">retc</span> <span class="o">=</span><span class="p">[],</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">ss</span> <span class="p">,</span> <span class="n">items</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head_block_infos</span><span class="p">)</span> <span class="p">:</span> 
            <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="o">+</span> <span class="n">items</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">ss</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">avg_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">HardwareInfos</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spac_b</span><span class="p">)</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)),</span>
                                            <span class="s1">&#39;</span><span class="si">{0:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">))]))</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">retc</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ss</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span> 
                <span class="k">for</span> <span class="n">keys</span> <span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">avg_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spac_b</span><span class="p">)</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)),</span>
                                            <span class="s1">&#39;</span><span class="si">{0:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">))]))</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">retc</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ss</span><span class="o">==</span><span class="mi">2</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">keys</span> <span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">avg_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyConfiguration</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spac_b</span><span class="p">)</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)),</span>
                                            <span class="s1">&#39;</span><span class="si">{0:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">))]))</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">retc</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ss</span> <span class="o">==</span><span class="mi">3</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">keys</span> <span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">avg_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Tx</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spac_b</span><span class="p">)</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)),</span>
                                            <span class="s1">&#39;</span><span class="si">{0:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">))]))</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">retc</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ss</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">:</span> 
                <span class="k">for</span> <span class="n">keys</span> <span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">avg_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Rx</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spac_b</span><span class="p">)</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)),</span>
                                            <span class="s1">&#39;</span><span class="si">{0:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">))]))</span>
                    <span class="n">rmlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">retc</span><span class="p">)</span>
                    
        <span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">),</span><span class="s1">&#39;_pyCS&#39;</span><span class="p">,</span><span class="s2">&quot;.log&quot;</span><span class="p">]),</span>
                   <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
            <span class="n">fd</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">rmlines</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">move</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">),</span><span class="s1">&#39;_pyCS&#39;</span><span class="p">,</span><span class="s2">&quot;.log&quot;</span><span class="p">]),</span><span class="n">savepath</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Your Hlog file &lt;</span><span class="si">{0}</span><span class="s1">&gt; has been written successfully !&lt;---&#39;</span><span class="o">.</span>\
              <span class="nb">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">),</span><span class="s1">&#39;_pyCS&#39;</span><span class="p">,</span><span class="s2">&quot;.log&quot;</span><span class="p">])))</span></div></div>
            

<div class="viewcode-block" id="SurveyAnnotation"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.SurveyAnnotation">[docs]</a><span class="k">class</span> <span class="nc">SurveyAnnotation</span> <span class="p">(</span><span class="nb">object</span><span class="p">)</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for survey annotations.</span>
<span class="sd">         </span>
<span class="sd">    Arguments  </span>
<span class="sd">    -----------</span>
<span class="sd">        **survey_annotations_data**: list , str  </span>
<span class="sd">                                    path to your annotation file or  </span>
<span class="sd">                                    Filled automatically</span>
<span class="sd">        </span>
<span class="sd">    ======================  =========  =====================================</span>
<span class="sd">    Attributes              Type        Explanation</span>
<span class="sd">    ======================  =========  =====================================</span>
<span class="sd">    project_name            str         project name </span>
<span class="sd">    project_area            str         project area </span>
<span class="sd">    custumer_name           str         company name </span>
<span class="sd">    contractor_name         str         contractor name </span>
<span class="sd">    projet_label            str         label or number </span>
<span class="sd">    acqdate                 str         data acquisition date </span>
<span class="sd">    sconfig_dict            dict        survey annotation</span>
<span class="sd">                                        dictionnary       </span>
<span class="sd">    ======================  =========  =====================================</span>
<span class="sd">    </span>
<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg </span>
<span class="sd">        &gt;&gt;&gt; avg_obj= Avg(data_fn=path) </span>
<span class="sd">        &gt;&gt;&gt; surv_area= avg_obj.Header.SurveyAnnotation.project_area </span>
<span class="sd">        ... survey_area</span>
<span class="sd">        ... avg_obj.Header.SurveyAnnotation.sconfig_dict[&#39;Job.By&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">survey_annotations_data</span> <span class="o">=</span><span class="kc">None</span>  <span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">zon_serv_annotations</span> <span class="o">=</span> <span class="n">survey_annotations_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="o">=</span><span class="s1">&#39;CSAMT_survey&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_area</span> <span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custumer_name</span> <span class="o">=</span><span class="s1">&#39;Zonge Engineering&quot;&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">contractor_name</span> <span class="o">=</span><span class="s1">&#39;Zonge&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_label</span> <span class="o">=</span> <span class="s1">&#39;pyCSAMT&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">acqdate</span> <span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> <span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Job.Name&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="p">,</span> 
                      <span class="s1">&#39;Job.Area&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">project_area</span> <span class="p">,</span> 
                      <span class="s1">&#39;Job.For&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">custumer_name</span><span class="p">,</span> 
                      <span class="s1">&#39;Job.By&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">contractor_name</span><span class="p">,</span> 
                      <span class="s1">&#39;Job.Number&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">project_label</span> <span class="p">,</span> 
                      <span class="s1">&#39;Job.Date&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">acqdate</span><span class="p">,</span> 
                      <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">keys</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SurveyAnnotation</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
                
<div class="viewcode-block" id="SurveyAnnotation.set_survey_annotations_infos"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.SurveyAnnotation.set_survey_annotations_infos">[docs]</a>    <span class="k">def</span> <span class="nf">set_survey_annotations_infos</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">survey_annotations_data</span> <span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set _survey annotations informations .</span>
<span class="sd">        </span>
<span class="sd">        Parameters </span>
<span class="sd">        ----------</span>
<span class="sd">            * survey_annotation : list </span>
<span class="sd">                                container of survey annotations infos. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Reading and setting zonge survey Annotations infos !&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">survey_annotations_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">zon_serv_annotations</span> <span class="o">=</span> <span class="n">survey_annotations_data</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zon_serv_annotations</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No survey_annotations informations found!&#39;</span><span class="p">)</span>
            
            
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zon_serv_annotations</span> <span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span> 
            <span class="k">try</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zon_serv_annotations</span> <span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zon_serv_annotations</span> <span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span> <span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">zon_serv_annotations</span> <span class="o">=</span><span class="n">fid</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Header</span><span class="p">(</span><span class="s2">&quot;Please check your annotation data ! &quot;</span>\
                                                    <span class="s2">&quot;Must be be a list or file &quot;</span><span class="p">)</span> 
            
        <span class="k">for</span> <span class="n">zonsurva</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zon_serv_annotations</span> <span class="p">:</span>

            <span class="n">zonsurva</span> <span class="o">=</span><span class="n">zonsurva</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;job.name&#39;</span> <span class="ow">in</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> 
                <span class="k">if</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="o">=</span><span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;job.area&#39;</span> <span class="ow">in</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">project_area</span> <span class="o">=</span><span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;job.for&#39;</span> <span class="ow">in</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="o">!=</span><span class="s1">&#39;&#39;</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">custumer_name</span> <span class="o">=</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;job.by&#39;</span><span class="ow">in</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="o">!=</span><span class="s1">&#39;&#39;</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">contractor_name</span> <span class="o">=</span>  <span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;job.number&#39;</span><span class="ow">in</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="o">!=</span><span class="s1">&#39;&#39;</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">project_label</span><span class="o">=</span>  <span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;job.date&#39;</span><span class="ow">in</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="o">!=</span><span class="s1">&#39;&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">acqdate</span> <span class="o">=</span>  <span class="n">zonsurva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
                   
        <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Job.Name&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="p">,</span> 
                  <span class="s1">&#39;Job.Area&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">project_area</span> <span class="p">,</span> 
                  <span class="s1">&#39;Job.For&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">custumer_name</span><span class="p">,</span> 
                  <span class="s1">&#39;Job.By&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">contractor_name</span><span class="p">,</span> 
                  <span class="s1">&#39;Job.Number&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">project_label</span> <span class="p">,</span> 
                  <span class="s1">&#39;Job.Date&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">acqdate</span><span class="p">,</span> 
                  <span class="p">}</span></div></div>
        


<div class="viewcode-block" id="SurveyConfiguration"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.SurveyConfiguration">[docs]</a><span class="k">class</span> <span class="nc">SurveyConfiguration</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for survey Survey configuration.</span>
<span class="sd">         </span>
<span class="sd">    Arguments  </span>
<span class="sd">    ---------</span>
<span class="sd">        **survey_config_data** : list </span>
<span class="sd">                                configuration list</span>
<span class="sd">        </span>
<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">    surveyType          str         survey type (CSAMT, TEM, CR, TDIP)        </span>
<span class="sd">    surveyArray         str         array type(for CSAMT:Scalar, Vector, Tensor)</span>
<span class="sd">    lineName            str         line label </span>
<span class="sd">    lineNumber          float       line number </span>
<span class="sd">    azimuth             str         line azimuth ( deg E of N) </span>
<span class="sd">    stnGdpBeg           float       first GDP station number </span>
<span class="sd">    StnGdpInc           float       GDP station number increment</span>
<span class="sd">    stnBeg              float       possibly rescaled first station number</span>
<span class="sd">    stnInc              float       possibly rescaled station number increment</span>
<span class="sd">    stnLeft             float       rescaled station number on  left edge of</span>
<span class="sd">                                    pseudosection plot </span>
<span class="sd">    stnRight            float       rescaled station number on right  edge of  </span>
<span class="sd">                                    pseudosection plot </span>
<span class="sd">    unitLength          float       length units (m,ft)</span>
<span class="sd">    unitEmag            str         field units (nV/m,nV/Am)</span>
<span class="sd">    unitHfield          str         field units (pT,pT/A</span>
<span class="sd">    unitPhase           str         units (mrad,deg)</span>
<span class="sd">    sconfig_dict        dict        surveyconfiguration dict elmts</span>
<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">        </span>
<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core import Avg</span>
<span class="sd">        &gt;&gt;&gt; avg_obj= Avg(data_fn=path) </span>
<span class="sd">        &gt;&gt;&gt; surv_nameLine= avg_obj.Header.SurveyConfiguration.lineName </span>
<span class="sd">        ... surv_nameLine</span>
<span class="sd">        ... avg_obj.Header.SurveyConfiguration.sconfig_dict[&#39;Stn.Right&#39;]</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">survey_config_data</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">zon_surv_config</span> <span class="o">=</span> <span class="n">survey_config_data</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">surveyType</span> <span class="o">=</span><span class="s1">&#39;CSAMT, TEM, CR, TDIP&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">surveyArray</span> <span class="o">=</span><span class="s1">&#39;CSAMT: Scalar, Vector, Tensor&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">lineName</span><span class="o">=</span><span class="s1">&#39;pyCSAMTline&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">lineNumber</span><span class="o">=</span><span class="s1">&#39;float:00&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">azimuth</span> <span class="o">=</span><span class="s1">&#39; 0 deg E of N&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stnGdpBeg</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">stnGdpInc</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">stnBeg</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">stnInc</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">stnLeft</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">stnRight</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">unitLength</span> <span class="o">=</span><span class="s1">&#39;m,ft&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">unitEmag</span> <span class="o">=</span><span class="s1">&#39;nV/mA or micoV/kmA&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">unitHfield</span> <span class="o">=</span><span class="s1">&#39;pT, picoT/A&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">unitPhase</span> <span class="o">=</span><span class="s1">&#39;mrad,deg&#39;</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Survey.Type&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">surveyType</span><span class="p">,</span>
                                    <span class="s1">&#39;Survey.Array&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">surveyArray</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Line.Name&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">lineName</span><span class="p">,</span> 
                                    <span class="s1">&#39;Line.Number&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">lineNumber</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Line.Azimuth&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">azimuth</span><span class="p">,</span> 
                                    <span class="s1">&#39;Stn.GdpBeg&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnGdpBeg</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Stn.GdpInc&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnGdpInc</span><span class="p">,</span> 
                                    <span class="s1">&#39;Stn.Beg&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnBeg</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Stn.Inc&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnInc</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Stn.Left&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnLeft</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Stn.Right&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnRight</span><span class="p">,</span> 
                                    <span class="s1">&#39;Unit.Length&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unitLength</span><span class="p">,</span> 
                                    <span class="s1">&#39;Unit.E&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unitEmag</span><span class="p">,</span> 
                                    <span class="s1">&#39;Unit.B&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unitHfield</span><span class="p">,</span> 
                                    <span class="s1">&#39;Unit.Phase&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unitPhase</span><span class="p">,</span> 
                                    <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="c1"># lista=[key for key in Test.__dict__.keys() if not (key.startswith(&#39;__&#39;) and key.endswith(&#39;__&#39;))]</span>
            <span class="k">if</span> <span class="n">keys</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SurveyConfiguration</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
                
<div class="viewcode-block" id="SurveyConfiguration.set_survey_configuration_infos"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.SurveyConfiguration.set_survey_configuration_infos">[docs]</a>    <span class="k">def</span> <span class="nf">set_survey_configuration_infos</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">survey_config_data</span> <span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set _survey configurations informations . </span>
<span class="sd">        </span>
<span class="sd">        Parameters </span>
<span class="sd">        ----------</span>
<span class="sd">            * survey_config_data : list or pathLike str </span>
<span class="sd">                                container of survey configurations  infos. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Reading and setting survey configurations informations!&#39;</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="n">survey_config_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">zon_surv_config</span> <span class="o">=</span> <span class="n">survey_config_data</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zon_surv_config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Header</span><span class="p">(</span><span class="s2">&quot;No Survey configuration data found.&quot;</span>
                                             <span class="s2">&quot; Please check your configuration file.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zon_surv_config</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span> 
            <span class="k">try</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zon_surv_config</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zon_surv_config</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span> <span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">zon_surv_config</span><span class="o">=</span><span class="n">fid</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Header</span><span class="p">(</span>
                    <span class="s2">&quot;your configuration data must be either a list or a file.&quot;</span><span class="p">)</span>
            
        <span class="c1"># print(self.zon_surv_config)</span>
        <span class="k">for</span> <span class="n">configInfos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zon_surv_config</span> <span class="p">:</span>
            <span class="n">configInfos</span><span class="o">=</span><span class="n">configInfos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;survey.type&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">surveyType</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;survey.array&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">surveyArray</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;line.name&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineName</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;line.number&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineNumber</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;line.azimuth&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">azimuth</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;stn.gdpbeg&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span><span class="bp">self</span><span class="o">.</span><span class="n">stnGdpBeg</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;stn.gdpinc&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span><span class="bp">self</span><span class="o">.</span><span class="n">stnGdpInc</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;stn.beg&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">stnBeg</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;stn.inc&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">stnInc</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;stn.left&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span><span class="bp">self</span><span class="o">.</span><span class="n">stnLeft</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;stn.right&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">stnRight</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;stn.length&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitLength</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;unit.e&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitEmag</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;unit.b&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitHfield</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">if</span> <span class="s1">&#39;unit.phase&#39;</span> <span class="ow">in</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitPhase</span><span class="o">=</span><span class="n">configInfos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Survey.Type&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">surveyType</span><span class="p">,</span>
                                    <span class="s1">&#39;Survey.Array&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">surveyArray</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Line.Name&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">lineName</span><span class="p">,</span> 
                                    <span class="s1">&#39;Line.Number&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">lineNumber</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Line.Azimuth&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">azimuth</span><span class="p">,</span> 
                                    <span class="s1">&#39;Stn.GdpBeg&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnGdpBeg</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Stn.GdpInc&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnGdpInc</span><span class="p">,</span> 
                                    <span class="s1">&#39;Stn.Beg&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnBeg</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Stn.Inc&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnInc</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Stn.Left&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnLeft</span> <span class="p">,</span> 
                                    <span class="s1">&#39;Stn.Right&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">stnRight</span><span class="p">,</span> 
                                    <span class="s1">&#39;Unit.Length&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unitLength</span><span class="p">,</span> 
                                    <span class="s1">&#39;Unit.E&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unitEmag</span><span class="p">,</span> 
                                    <span class="s1">&#39;Unit.B&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unitHfield</span><span class="p">,</span> 
                                    <span class="s1">&#39;Unit.Phase&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unitPhase</span><span class="p">,</span> 
                                    <span class="p">}</span></div></div>
        
        
<div class="viewcode-block" id="TransmitterProperties"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.TransmitterProperties">[docs]</a><span class="k">class</span> <span class="nc">TransmitterProperties</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for transmitter  properties.</span>
<span class="sd">     </span>
<span class="sd">    Arguments  </span>
<span class="sd">    -----------</span>
<span class="sd">        **data_fn** : str  </span>
<span class="sd">                path to avgfile</span>
<span class="sd">        </span>
<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">    txType              str         source type (for NSAMT /CSAMT:Natural, </span>
<span class="sd">                                     Bipole,Loop)</span>
<span class="sd">    txGdpStn            str         transmitter ID from GDP Tx field </span>
<span class="sd">                                    (GDP stn #) (alias = XMTR)</span>
<span class="sd">    txStn               str         rescaled Tx ID </span>
<span class="sd">                                    (rescaled client stn #)</span>
<span class="sd">    txCenter            float       transmitter center-point easting,</span>
<span class="sd">                                    northing,elevation</span>
<span class="sd">                                    (float, length units)</span>
<span class="sd">                                    (aliases = TxCX, TxCY)</span>
<span class="sd">    txHPR               int         transmitter orientation </span>
<span class="sd">                                    heading, pitch, </span>
<span class="sd">                                    roll (Tx heading alias = TxBrg)</span>
<span class="sd">                                    (heading = bipole azimuth, pitch=0, roll=0 </span>
<span class="sd">                                    for z+up or 180 for z positive down)</span>
<span class="sd">    txLength            str         transmitter bipole length or square</span>
<span class="sd">                                    loop width </span>
<span class="sd">                                    (positive float, length units)</span>
<span class="sd">    sconfig_dict        dict        params config dictionnary  </span>
<span class="sd">                                    </span>
<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">    </span>
<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">     </span>
<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core import Avg</span>
<span class="sd">        &gt;&gt;&gt; path= os.path.join(os.environ[&#39;pyCSAMT&#39;], </span>
<span class="sd">        ...                         &#39;pycsamt&#39;, data, &#39;LCS01.AVG&#39;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj= Avg(data_fn=path) </span>
<span class="sd">        &gt;&gt;&gt; avg_obj.Header.Tx.txGdpStn</span>
<span class="sd">        &gt;&gt;&gt; avg_obj.Header.Tx.txStn</span>
<span class="sd">        &gt;&gt;&gt; avg_obj.Header.Tx.sconfig_dict[&#39;Tx.Type&#39;]</span>
<span class="sd">        </span>
<span class="sd">     &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    
        <span class="bp">self</span><span class="o">.</span><span class="n">txType</span> <span class="o">=</span><span class="s1">&#39;NSAMT /CSAMT: Natural, Bipole,Loop&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">txGdpStn</span> <span class="o">=</span><span class="s1">&#39;XMTR &#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">txStn</span><span class="o">=</span><span class="s1">&#39;Tx ID&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">txCenter</span><span class="o">=</span><span class="s1">&#39;TxCX, TxCY&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">txHPR</span><span class="o">=</span><span class="s1">&#39;bipole azimuth, pitch=0, roll=0 for z+up or 180 for z positive down&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">txLength</span><span class="o">=</span><span class="s1">&#39;positive float, length units&#39;</span>
        

        
        <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">keys</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">TransmitterProperties</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span> 
                
<div class="viewcode-block" id="TransmitterProperties.set_transmitter_properties"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.TransmitterProperties.set_transmitter_properties">[docs]</a>    <span class="k">def</span> <span class="nf">set_transmitter_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tx_data</span> <span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set_Tx_properties.</span>
<span class="sd">        </span>
<span class="sd">        :param tx_data: list of Tx-infos from AVG filename </span>
<span class="sd">        :type tx_data:list </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">Tx_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No Tx-proprerties found !&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">Tx_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">for</span> <span class="n">tx_infos</span> <span class="ow">in</span> <span class="n">Tx_data</span> <span class="p">:</span> 
                <span class="k">if</span> <span class="s1">&#39;$ XMTR&#39;</span> <span class="ow">in</span> <span class="n">tx_infos</span> <span class="ow">or</span> <span class="s1">&#39;Tx.GdpStn&#39;</span> <span class="ow">in</span> <span class="n">tx_infos</span><span class="p">:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">txGdpStn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">tx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="s1">&#39;$Tx.Stn&#39;</span> <span class="ow">in</span> <span class="n">tx_infos</span> <span class="p">:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">txStn</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">tx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="s1">&#39;Tx.Type&#39;</span> <span class="ow">in</span> <span class="n">tx_infos</span> <span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">txType</span><span class="o">=</span> <span class="n">tx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;Tx.HPR&#39;</span> <span class="ow">in</span> <span class="n">tx_infos</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">txHPR</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> \
                                                     <span class="n">tx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
                <span class="k">if</span> <span class="s1">&#39;Tx.Length&#39;</span><span class="ow">in</span> <span class="n">tx_infos</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">txLength</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span>
                                                     <span class="n">tx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
                
         <span class="c1"># --&gt; set configuration -dictionnary               </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Tx.Type&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">txType</span><span class="p">,</span> 
                  <span class="s1">&#39;Tx.GdpStn&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">txGdpStn</span><span class="p">,</span> 
                  <span class="s1">&#39;Tx.Stn&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">txStn</span><span class="p">,</span> 
                  <span class="s1">&#39;Tx.Center&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">txCenter</span><span class="p">,</span> 
                  <span class="s1">&#39;Tx.HPR&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">txHPR</span><span class="p">,</span>
                  <span class="s1">&#39;Tx.Length&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">txLength</span><span class="p">,</span>
              <span class="p">}</span></div></div>
        
<div class="viewcode-block" id="ReceiverProperties"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.ReceiverProperties">[docs]</a><span class="k">class</span> <span class="nc">ReceiverProperties</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for receiver  properties.</span>
<span class="sd">      </span>
<span class="sd">    Arguments </span>
<span class="sd">    ---------- </span>
<span class="sd">        **Rx_data** : list or str </span>
<span class="sd">                    Filled automatically or path to your</span>
<span class="sd">                    receiver properties file.</span>

<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">    rxGdpStn            str         receiver GDP station number (alias = Station) </span>
<span class="sd">    rxStn               str         receiver client station number</span>
<span class="sd">    rxHPR               int         EM component heading, pitch, roll </span>
<span class="sd">                                    (floats, Rx heading  alias = RxBrg, ExAzm)</span>
<span class="sd">                                    (heading = x component azimuth in degrees </span>
<span class="sd">                                    east of north, pitch = x  component</span>
<span class="sd">                                    orientation in degrees.  up from </span>
<span class="sd">                                    horizontal, pitch = z cmp  rotation about </span>
<span class="sd">                                    x cmp,  0=z+up, 180 = z+ down)</span>
<span class="sd">    rxLength            str         E-field dipole length or  loop widths(</span>
<span class="sd">                                    positive float(s),length units) </span>
<span class="sd">                                    (alias = aspace)</span>
<span class="sd">                                    (positive float, length units)</span>
<span class="sd">    rxComps             str         EM component/impedance label(ExHx, ExHy, </span>
<span class="sd">                                    EyHx, EyHy, Zxx, Zxy, Zyx, Zyy,  Zvec, Zdet)   </span>
<span class="sd">    sconfig_dict        dict        parameters dict config            </span>
<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">         </span>
<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">     </span>
<span class="sd">    :Example:</span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core import Avg</span>
<span class="sd">        &gt;&gt;&gt; path= os.path.join(os.environ[&#39;pyCSAMT&#39;], </span>
<span class="sd">                                 &#39;pycsamt&#39;, data, &#39;LCS01.AVG&#39;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj= Avg(data_fn=path) </span>
<span class="sd">        ... avg_obj.Header.Rx.txGdpStn</span>
<span class="sd">        ... avg_obj.Header.Rx.txStn</span>
<span class="sd">        ... avg_obj.Header.Rx.sconfig_dict[&#39;Tx.Length&#39;]</span>
<span class="sd">     &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Rx_data</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rx_data</span> <span class="o">=</span><span class="n">Rx_data</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">rxGdpStn</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">rxStn</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">rxHPR</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">rxLength</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rxComps</span><span class="o">=</span><span class="s1">&#39;ExHy&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">=</span><span class="kc">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Rx.GdpStn&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxGdpStn</span><span class="p">,</span> 
                          <span class="s1">&#39;Rx.Stn&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxStn</span><span class="p">,</span> 
                          <span class="s1">&#39;Rx.HPR&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxHPR</span> <span class="p">,</span> 
                          <span class="s1">&#39;Rx.Length&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rxLength</span><span class="p">,</span>
                          <span class="s1">&#39;Rx.Cmp&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxComps</span><span class="p">,</span>
                          <span class="p">}</span>


        <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">keys</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ReceiverProperties</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
                
                
<div class="viewcode-block" id="ReceiverProperties.set_receiver_properties"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.ReceiverProperties.set_receiver_properties">[docs]</a>    <span class="k">def</span> <span class="nf">set_receiver_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Rx_data</span> <span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Methods  to set Receivers - properties infos from AVG files. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        * Rx_data : list, optional</span>
<span class="sd">                    container infos of receivers. The default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Rx_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">rx_data</span> <span class="o">=</span> <span class="n">Rx_data</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No Zonge Rx-proprerties found !&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx_data</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="p">:</span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx_data</span><span class="p">)</span> <span class="o">==</span><span class="kc">True</span> <span class="p">:</span> 
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx_data</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">frx</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rx_data</span> <span class="o">=</span><span class="n">frx</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Header</span><span class="p">(</span><span class="s1">&#39;Argument provided for rx_data are wrong !&#39;</span>\
                                                    <span class="s1">&#39; Must be a list of file.&#39;</span><span class="p">)</span>
                        

        <span class="k">for</span> <span class="n">rx_infos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx_data</span> <span class="p">:</span> 
            
            <span class="k">if</span> <span class="s1">&#39;$Rx.Stn&#39;</span> <span class="ow">in</span> <span class="n">rx_infos</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rxStn</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">rx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                
            <span class="k">if</span> <span class="s1">&#39;Rx.Cmp&#39;</span> <span class="ow">in</span> <span class="n">rx_infos</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxComps</span><span class="o">=</span> <span class="n">rx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                
            <span class="k">if</span> <span class="s1">&#39;Rx.HPR&#39;</span> <span class="ow">in</span> <span class="n">rx_infos</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxHPR</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> \
                                                 <span class="n">rx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;$ ASPACE&#39;</span> <span class="ow">in</span> <span class="n">rx_infos</span><span class="p">)</span> <span class="ow">or</span>  <span class="p">(</span><span class="s1">&#39;Rx.Length&#39;</span><span class="ow">in</span> <span class="n">rx_infos</span><span class="p">)</span> <span class="p">:</span> 
                    <span class="c1">#-- it seems sometimes file got the unit at the end either &#39;m&#39; or ft&#39;</span>
                    <span class="c1"># should remove it before converting on float</span>
                <span class="n">tx</span> <span class="o">=</span> <span class="n">rx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="mi">46</span> <span class="o">&lt;</span> <span class="nb">ord</span><span class="p">(</span><span class="n">rx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">58</span> <span class="p">:</span>  
                    <span class="n">tx</span> <span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">_remove_str_word</span><span class="p">(</span><span class="n">char</span><span class="o">=</span><span class="n">tx</span><span class="p">,</span><span class="n">word_to_remove</span><span class="o">=</span><span class="n">rx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                              <span class="n">deep_remove</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rxLength</span> <span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">tx</span><span class="p">),</span> <span class="n">rx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxLength</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
 
            <span class="k">if</span> <span class="s1">&#39;$Rx.GdpStn&#39;</span> <span class="ow">in</span> <span class="n">rx_infos</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rxGdpStn</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">rx_infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Rx.GdpStn&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxGdpStn</span><span class="p">,</span> 
                          <span class="s1">&#39;Rx.Stn&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxStn</span><span class="p">,</span> 
                          <span class="s1">&#39;Rx.HPR&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxHPR</span> <span class="p">,</span> 
                          <span class="s1">&#39;Rx.Length&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rxLength</span><span class="p">,</span>
                          <span class="s1">&#39;Rx.Cmp&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">rxComps</span><span class="p">,</span>
                          <span class="p">}</span></div></div>

      

<div class="viewcode-block" id="Skip_flag"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Skip_flag">[docs]</a><span class="k">class</span> <span class="nc">Skip_flag</span> <span class="p">(</span><span class="nb">object</span><span class="p">)</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    skip flag values </span>
<span class="sd">    </span>
<span class="sd">        - 0. drop data </span>
<span class="sd">        - 1. skip data </span>
<span class="sd">        - 2. good quality of data</span>
<span class="sd">    </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **skip_flag** : str or int , </span>
<span class="sd">                    skip_flag value set automatically .</span>
<span class="sd">                    some astatic file doesnt mention the number of </span>
<span class="sd">                    skip_flag .Default is &#39;2&#39;.</span>
<span class="sd"> </span>
<span class="sd">    :Example:</span>
<span class="sd">            </span>
<span class="sd">         &gt;&gt;&gt; from pycsamt.ff.core import Avg</span>
<span class="sd">         &gt;&gt;&gt; path= os.path.join(os.environ[&#39;pyCSAMT&#39;], </span>
<span class="sd">         ...                         &#39;pycsamt&#39;, data, &#39;LCS01.AVG&#39;)</span>
<span class="sd">         &gt;&gt;&gt; avg_obj= Avg(data_fn=path) </span>
<span class="sd">         &gt;&gt;&gt; avg_obj.Skip_flag.skip_flag</span>
<span class="sd">         &gt;&gt;&gt; avg_obj.Skip_flag.get_skip_flag</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skip_flag</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_flag</span><span class="o">=</span> <span class="n">skip_flag</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">get_skip_flag</span><span class="o">=</span><span class="kc">None</span> 
        
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_flag_dict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;2&#39;</span><span class="p">:</span><span class="s1">&#39;Good data quality&#39;</span><span class="p">,</span> 
                            <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;Data skipped&#39;</span><span class="p">,</span> 
                            <span class="s1">&#39;0&#39;</span> <span class="p">:</span><span class="s1">&#39;Data rejected&#39;</span><span class="p">,</span> 
                            <span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="s1">&#39;No data obtained&#39;</span><span class="p">}</span>
        
        
        <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> 
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span> <span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
 
        
        
<div class="viewcode-block" id="Skip_flag.setandget_skip_flag"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Skip_flag.setandget_skip_flag">[docs]</a>    <span class="k">def</span> <span class="nf">setandget_skip_flag</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skip_flag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        simple method to set and get skip_flag.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">             * skip_flag:  str </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">skip_flag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="n">skip_flag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_flag_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_config_file</span><span class="p">(</span><span class="s1">&#39;Wrong Input ! skip flag must be&#39;</span>
                                                    <span class="s1">&#39; among : </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_flag_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skip_flag</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">skip_flag</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">keys</span> <span class="p">,</span> <span class="n">values</span>  <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_flag_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="k">if</span> <span class="n">keys</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_flag</span> <span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">get_skip_flag</span> <span class="o">=</span> <span class="n">values</span></div></div>
            
  
<div class="viewcode-block" id="ZongeHardware"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.ZongeHardware">[docs]</a><span class="k">class</span> <span class="nc">ZongeHardware</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Some features of zonge AMTAVG software. </span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">        **zonge_hardw_infos** : list or str , </span>
<span class="sd">                            filled automatically or path to your </span>
<span class="sd">                            hardware setting file.</span>
<span class="sd">            </span>
<span class="sd">    =================  ==========  =========================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    =================  ==========  =========================================</span>
<span class="sd">    version             str         version of AMTAVG software</span>
<span class="sd">    dated               str         date of building Avg file </span>
<span class="sd">    processed           str         date of data preprocessing</span>
<span class="sd">    from_fld_file       str         parent of avg file </span>
<span class="sd">    astactic_version    str         zonge astactic sofware version</span>
<span class="sd">    updated_data        str         date were data were updated </span>
<span class="sd">    numfilterfreq       int         number of point that TMA used to filter </span>
<span class="sd">    freq_filter         float       value of TMA filter frequency</span>
<span class="sd">    end_astatic_file    str         end file description.</span>
<span class="sd">    =================  ==========  =========================================</span>
<span class="sd">        </span>
<span class="sd">    More can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core import Avg</span>
<span class="sd">        &gt;&gt;&gt; path= os.path.join(os.environ[&#39;pyCSAMT&#39;], </span>
<span class="sd">        ...                     &#39;pycsamt&#39;, data, &#39;LCS01.AVG&#39;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj= Avg(data_fn=path) </span>
<span class="sd">        &gt;&gt;&gt; avg_obj.Header.HardwareInfos.freq_filter)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj.Header.HardwareInfos.sconfig_dict[&#39;AMTAVG&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zonge_hardw_infos</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">zonge_hardw_infos</span><span class="o">=</span><span class="n">zonge_hardw_infos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span><span class="s1">&#39;7.76&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_fld_file</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">dated</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">processed</span><span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">astatic_version</span> <span class="o">=</span> <span class="s1">&#39;v3.60&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_data</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">numfilterfreq</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq_filter</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;AMTAVG&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">from_fld_file</span><span class="p">],</span> 
                           <span class="s1">&#39;Dated&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">dated</span><span class="p">,</span>
                           <span class="s1">&#39;Processed&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">processed</span><span class="p">,</span> 
                           <span class="s1">&#39;ASTATIC&#39;</span><span class="p">:[</span><span class="bp">self</span><span class="o">.</span><span class="n">astatic_version</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_data</span> <span class="p">],</span>
                           <span class="s2">&quot;&quot;</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> TMA Filter at </span><span class="si">{1}</span><span class="s1"> hertz&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numfilterfreq</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_filter</span> <span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_writer_copyleft</span> <span class="o">=</span><span class="s1">&#39;@by_pyCSAMT&#39;</span>
            
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ZongeHardware</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        
<div class="viewcode-block" id="ZongeHardware.set_harware_infos"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.ZongeHardware.set_harware_infos">[docs]</a>    <span class="k">def</span> <span class="nf">set_harware_infos</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zonge_hardw_infos</span> <span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set Harwares infos.</span>
<span class="sd">        </span>
<span class="sd">        Parameters </span>
<span class="sd">        ----------</span>
<span class="sd">            * zonge_hardw_infos : list </span>
<span class="sd">                                Hardware informations collected  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Reading and setting Harwware informations !&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">zonge_hardw_infos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">zonge_hardw_infos</span><span class="o">=</span><span class="n">zonge_hardw_infos</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonge_hardw_infos</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Header</span><span class="p">(</span><span class="s1">&#39;No informations from hardware found !&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">type</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonge_hardw_infos</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="p">:</span> 
            <span class="k">try</span> <span class="p">:</span> 
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonge_hardw_infos</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fzh</span> <span class="p">:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">zonge_hardw_infos</span><span class="o">=</span> <span class="n">fzh</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Header</span><span class="p">(</span><span class="s2">&quot;Harware - infos must be either a list or  file !&quot;</span><span class="p">)</span>

        <span class="k">for</span>  <span class="n">infos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonge_hardw_infos</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="s1">&#39;AMTAVG&#39;</span> <span class="ow">in</span> <span class="n">infos</span>  <span class="p">:</span> 
                <span class="n">tem_h</span><span class="o">=</span><span class="n">infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">processed</span> <span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">_remove_str_word</span><span class="p">(</span><span class="n">char</span><span class="o">=</span><span class="n">tem_h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> 
                                                   <span class="n">word_to_remove</span><span class="o">=</span><span class="s1">&#39;Processed&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dated</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">_remove_str_word</span><span class="p">(</span><span class="n">char</span><span class="o">=</span><span class="n">tem_h</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> 
                                                   <span class="n">word_to_remove</span><span class="o">=</span><span class="s1">&#39;Dated&#39;</span><span class="p">)</span>
   
                <span class="bp">self</span><span class="o">.</span><span class="n">from_fld_file</span><span class="o">=</span><span class="n">tem_h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">tem_h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s1">&#39;ASTATIC&#39;</span> <span class="ow">in</span> <span class="n">infos</span> <span class="p">:</span> 
                <span class="n">tem_as</span> <span class="o">=</span><span class="n">infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">astatic_version</span><span class="o">=</span><span class="n">tem_as</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_data</span> <span class="o">=</span><span class="n">tem_as</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s1">&#39;TMA&#39;</span> <span class="ow">in</span> <span class="n">infos</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">end_astatic_file</span> <span class="o">=</span><span class="n">infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">tem_tma</span><span class="o">=</span><span class="n">infos</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">try</span> <span class="p">:</span> 
                  <span class="n">tem_tma</span><span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">tem_tma</span> <span class="p">]</span>
                  
                <span class="k">except</span> <span class="p">:</span> <span class="k">pass</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">numfilterfreq</span> <span class="o">=</span>  <span class="n">tem_tma</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">freq_filter</span> <span class="o">=</span><span class="n">tem_tma</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">sconfig_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;AMTAVG&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">from_fld_file</span><span class="p">],</span> 
                           <span class="s1">&#39;Dated&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">dated</span><span class="p">,</span>
                           <span class="s1">&#39;Processed&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">processed</span><span class="p">,</span> 
                           <span class="s1">&#39;ASTATIC&#39;</span><span class="p">:[</span><span class="bp">self</span><span class="o">.</span><span class="n">astatic_version</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_data</span> <span class="p">],</span> 
                           <span class="s2">&quot;&quot;</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> TMA Filter at </span><span class="si">{1}</span><span class="s1"> hertz&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numfilterfreq</span><span class="p">,</span>
                                                                   <span class="bp">self</span><span class="o">.</span><span class="n">freq_filter</span> <span class="p">)}</span></div></div>

<div class="viewcode-block" id="Data"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Data">[docs]</a><span class="k">class</span> <span class="nc">Data</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AVG Data informations ,  Container of all data infos .</span>
<span class="sd">     </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">        **data_array**  : np.ndarray  </span>
<span class="sd">                       Data collected form the site, It contains all the informations </span>
<span class="sd">                       during survey. It could read a  user own data build </span>
<span class="sd">                       by classifying data according the main AVG file </span>

<span class="sd">    ==================  ==============  =======================================</span>
<span class="sd">    Attributes          Type            Explanation</span>
<span class="sd">    ==================  ==============  =======================================</span>
<span class="sd">    Station             (ndarray, 1)    station length infos . unit : m </span>
<span class="sd">    Frequency           (ndarray, 1)    frequency using during survey ,unit : Hz  </span>
<span class="sd">    Amps                (ndarray, 1)    current induction values using during </span>
<span class="sd">                                        survey , unit : Amp  </span>
<span class="sd">    Emag                (ndarray, 1)    Electric field magnitude(Unit.nV/m,nV/Am) </span>
<span class="sd">    Ephz                (ndarray, 1)    Electric field phase  (unit. mrad)</span>
<span class="sd">    Hmag                (ndarray, 1)    Magnetic field magnitude (Unit.pT,pT/A)</span>
<span class="sd">    Hphz                (ndarray, 1)    Magnetic field phase (unit. mrad)</span>
<span class="sd">    Resistivity         (ndarray, 1)    Cagnard apparent Resistivity</span>
<span class="sd">                                        magnitude (unit.ohm.m)</span>
<span class="sd">    Phase               (ndarray, 1)    Impedance phase (unit. mrad)</span>
<span class="sd">    Z                   (ndarray, 1)    Impedance magnitude  (unit. km/s)</span>
<span class="sd">    pcEmag              (ndarray, 1)    relative |E| error (%)</span>
<span class="sd">    pcHmag              (ndarray, 1)    relative |H| error (%)</span>
<span class="sd">    sEphz               (ndarray, 1)    phase(E) error (unit.mrad)</span>
<span class="sd">    sHphz               (ndarray, 1)    phase(H) error (unit.mrad)</span>
<span class="sd">    sPhz                (ndarray, 1)    phase(Z) error (unit.mrad)</span>
<span class="sd">    pcRho               (ndarray, 1)    relative apparent resistivity</span>
<span class="sd">                                        (rho) error (%)</span>
<span class="sd">    added_astatic_data  (ndarray, 1)    static_corrected-apparent</span>
<span class="sd">                                        resistivity (unit.ohm.m)</span>
<span class="sd">    set_to_degree           bool        phase angle value :if set to True , </span>
<span class="sd">                                        valueof phase will be on degree. make </span>
<span class="sd">                                        sure to converte the data on radian </span>
<span class="sd">                                        anglebefore not in mrad.</span>
<span class="sd">    ==================  ==============  =======================================</span>
<span class="sd">    </span>
<span class="sd">     .. notes :: when data come straightforwardly from AVG file ,</span>
<span class="sd">             data was set respecting the unit provided  User must takes account </span>
<span class="sd">             for data processing .A little bit  conversion is needed.</span>
<span class="sd">             User can use a special function. Normalized_station_value parameter </span>
<span class="sd">             normalize station value . if set to true station will started name</span>
<span class="sd">             from 0 to n</span>
<span class="sd">                ...</span>
<span class="sd">                </span>
<span class="sd">    More attributes can be added by inputing a key word dictionary</span>

<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core import Avg</span>
<span class="sd">        &gt;&gt;&gt; DATA=Data(data_array=avg_data )</span>
<span class="sd">        &gt;&gt;&gt; stn=DATA.Station.name </span>
<span class="sd">        &gt;&gt;&gt; freq=DATA.Frequency.value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_array</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span> <span class="o">=</span><span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span> <span class="o">=</span> <span class="n">data_array</span> 
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Station</span> <span class="o">=</span><span class="n">Station</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Frequency</span><span class="o">=</span><span class="n">Frequency</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Amps</span> <span class="o">=</span><span class="n">Amps</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Emag</span><span class="o">=</span><span class="n">Emag</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ephz</span><span class="o">=</span><span class="n">Ephz</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Hmag</span><span class="o">=</span><span class="n">Hmag</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Hphz</span><span class="o">=</span><span class="n">Hphz</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Resistivity</span><span class="o">=</span><span class="n">Resistivity</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Phase</span> <span class="o">=</span><span class="n">Phase</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">=</span><span class="n">Z_Tensor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pcEmag</span><span class="o">=</span><span class="n">pcEmag</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sEphz</span><span class="o">=</span><span class="n">sEphz</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pcHmag</span><span class="o">=</span><span class="n">pcHmag</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sHphz</span><span class="o">=</span><span class="n">sHphz</span><span class="p">()</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">pcRho</span><span class="o">=</span><span class="n">pcRho</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sPhz</span><span class="o">=</span><span class="n">sPhz</span><span class="p">()</span>
        
   
        <span class="bp">self</span><span class="o">.</span><span class="n">added_astatic_data</span><span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_of_stations</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_station_value</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;normalized_station_value&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;set_phase_angle_to_deg&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
 
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_f</span> <span class="o">=</span> <span class="kc">None</span> 
        
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_avg_set_components_from_data</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">_avg_set_components_from_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_array</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span><span class="n">data_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                                       <span class="n">add_astatic_data</span> <span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set </span>
<span class="sd">        avg_data_components  from Avgfile </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * data_array : np.ndarray </span>
<span class="sd">                        data recovered from avg file. </span>
<span class="sd">                        It must be on numpy array. The default is None.</span>
<span class="sd">            * data_type : int, optional</span>
<span class="sd">                        show the type of Avg file, </span>
<span class="sd">                        must be 1 for plainty file 2 for Astatic file. </span>
<span class="sd">                         *Default* is None.</span>
<span class="sd">            * add_astatic_data : pd.coreDataFrame , optional</span>
<span class="sd">                                added infos from astatic file. </span>
<span class="sd">                                *Default* is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span> <span class="o">=</span><span class="n">data_array</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_AvgData</span><span class="p">(</span><span class="s1">&#39;No Data from avgfile to read.&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">data_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_f</span> <span class="o">=</span><span class="n">data_type</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_AvgData</span><span class="p">(</span><span class="s1">&#39; May check your avg Datafile.&#39;</span><span class="p">)</span>

        
        <span class="n">number_of_freq_array</span> <span class="p">,</span> <span class="n">rep</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">number_of_station_array</span> <span class="p">,</span> <span class="n">rep</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span> <span class="o">=</span> <span class="n">number_of_freq_array</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">number_of_station_array</span><span class="o">.</span><span class="n">size</span>
        <span class="c1"># print(self.numfreq, self.numstation)</span>

        <span class="k">if</span> <span class="n">add_astatic_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">added_astatic_data</span><span class="o">=</span><span class="n">add_astatic_data</span>
            <span class="n">pdf_Z</span><span class="o">=</span> <span class="n">added_astatic_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;SRes&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">pdf_Z</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">_read_zAS_data</span><span class="p">(</span><span class="n">z_abs_array</span> <span class="o">=</span><span class="n">pdf_Z</span> <span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span> <span class="p">)</span>
            
            <span class="c1">#--&gt; set asticatic</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">added_astatic_data</span><span class="o">=</span><span class="n">added_astatic_data</span><span class="p">[</span><span class="s1">&#39;SRes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

            
        <span class="k">def</span> <span class="nf">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="p">,</span> <span class="n">nan_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">keep_str</span> <span class="o">=</span><span class="kc">False</span><span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">                * zstar_array : ndarray </span>
<span class="sd">                            array contain unfloat converter value.</span>
<span class="sd">                            the unconverter value can be a &#39;*&#39;</span>
<span class="sd">                * nan_value : float or np.nan type  </span>
<span class="sd">                            nan_value could be any value either int, float or str.  </span>
<span class="sd">                            If The default is np.nan.</span>
<span class="sd">                * keep_str : bool, optional  </span>
<span class="sd">                            keep the str item on your array.</span>
<span class="sd">            Returns </span>
<span class="sd">            -------</span>
<span class="sd">                array_like </span>
<span class="sd">                    zstrar_array converted </span>
<span class="sd">            &quot;&quot;&quot;</span>
            
            <span class="k">for</span> <span class="n">kk</span> <span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">zstar_array</span><span class="p">):</span> 
                <span class="k">try</span> <span class="p">:</span> <span class="n">zstar_array</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">:</span><span class="n">zstar_array</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="o">=</span><span class="n">nan_value</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">nan_value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="p">:</span> <span class="n">keep_str</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">if</span> <span class="n">keep_str</span> <span class="p">:</span> <span class="k">return</span> <span class="n">zstar_array</span> 
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span> <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="n">zstar_array</span><span class="p">])</span>   
            
        <span class="c1"># try to change the dtype of data if dtype of the dataset is not float </span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]:</span>
            <span class="n">data_transitory</span> <span class="o">=</span><span class="p">[</span><span class="n">zstar_array_to_nan</span><span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="n">rowline</span><span class="p">)</span> <span class="k">for</span> <span class="n">dd</span><span class="p">,</span> <span class="n">rowline</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span><span class="n">list_of_array</span><span class="o">=</span><span class="n">data_transitory</span><span class="p">)</span>
  
        <span class="c1"># populate classes .  </span>
        <span class="c1">#cut of special freq_array and stations</span>
        <span class="c1"># for more certaintly , any value will come must be check whether its possible to convert , if not value </span>
        <span class="c1">#       will set to np.nan </span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Station</span><span class="o">.</span><span class="n">_set_station_</span><span class="p">(</span><span class="n">station_data_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span> 
                                   <span class="n">normalized_station_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">normalized_station_value</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">_set_frequency</span><span class="p">(</span><span class="n">freq_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Amps</span><span class="o">.</span><span class="n">_read_amps_data</span><span class="p">(</span><span class="n">amps_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]),</span> 
                                 <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">)</span>
        <span class="c1"># Amps(amps_array=self._data_array[:,2])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Emag</span><span class="o">.</span><span class="n">_read_emag_data</span><span class="p">(</span><span class="n">e_mag_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]),</span>
                                 <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span> <span class="p">)</span>
        <span class="c1"># Emag(e_mag_array =self._data_array[:,3])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ephz</span><span class="o">.</span><span class="n">_read_ephz_data</span><span class="p">(</span><span class="n">e_phz_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]),</span>
                                 <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">,</span> <span class="n">to_degree</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">set_to_degree</span>  <span class="p">)</span>
        <span class="c1"># Ephz(e_phz_array=self._data_array[:, 4])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Hmag</span><span class="o">.</span><span class="n">_read_hmag_data</span><span class="p">(</span><span class="n">h_mag_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]),</span>
                                 <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span> <span class="p">)</span>
        <span class="c1"># Hmag (h_mag_array =self._data_array[:,5])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Hphz</span><span class="o">.</span><span class="n">_read_hphz_data</span><span class="p">(</span><span class="n">h_phz_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]),</span>
                                 <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">,</span> <span class="n">to_degree</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">set_to_degree</span>  <span class="p">)</span>
        <span class="c1"># Hphz(h_phz_array=self._data_array[:,6])</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span> 
        <span class="c1">#     Resistivity(res_array=self._data[:,7])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Resistivity</span><span class="o">.</span><span class="n">_read_res_data</span><span class="p">(</span><span class="n">res_array</span> <span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]),</span>
                                            <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">)</span>
        <span class="c1">#     Phase (phase_array=self._data[:8])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">_read_phase_data</span><span class="p">(</span><span class="n">phase_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]),</span>
                                            <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span> <span class="p">)</span>
        <span class="c1">#     sPhz(s_phz_data=self._data_array[:-1])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sPhz</span><span class="o">.</span><span class="n">_read_sPhz_data</span><span class="p">(</span><span class="n">sPhase_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> 
                                      <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">)</span>
        <span class="c1">#     pcRho(pc_rho_data=self._data[:,-2])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pcRho</span><span class="o">.</span><span class="n">_read_pcRes_data</span><span class="p">(</span><span class="n">pcRes_array</span> <span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="o">-</span><span class="mi">2</span><span class="p">]),</span>
                                        <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f</span><span class="o">==</span><span class="mi">2</span> <span class="p">:</span> 
        <span class="c1">#     Resistivity(res_array=self._data[:,8])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Resistivity</span><span class="o">.</span><span class="n">_read_res_data</span><span class="p">(</span><span class="n">res_array</span> <span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]),</span>
                                            <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                     <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">,</span> <span class="n">Sres</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">added_astatic_data</span><span class="p">)</span>
        <span class="c1">#     Phase (phase_array=self._data[:7])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">_read_phase_data</span><span class="p">(</span><span class="n">phase_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]),</span>
                                        <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span> <span class="p">)</span>
        <span class="c1">#     sPhz(s_phz_data=self._data_array[:-2])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sPhz</span><span class="o">.</span><span class="n">_read_sPhz_data</span><span class="p">(</span><span class="n">sPhase_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="o">-</span><span class="mi">2</span><span class="p">]),</span>
                                      <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">)</span>
        <span class="c1">#     pcRho(pc_rho_data=self._data[:,-1])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pcRho</span><span class="o">.</span><span class="n">_read_pcRes_data</span><span class="p">(</span><span class="n">pcRes_array</span> <span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> 
                                        <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">)</span>
            
        <span class="c1"># pcEmag(pc_emag_data=self._data[:,-6])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pcEmag</span><span class="o">.</span><span class="n">_read_pcEmag_data</span><span class="p">(</span><span class="n">pc_e_mag_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="o">-</span><span class="mi">6</span><span class="p">]),</span> 
                                      <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">)</span>
        <span class="c1"># sEphz(s_phz_data=self._data[:,-5])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sEphz</span><span class="o">.</span><span class="n">_read_sEphz_data</span> <span class="p">(</span><span class="n">sEphz_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="o">-</span><span class="mi">5</span><span class="p">]),</span>
                                     <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span> <span class="p">)</span>
        <span class="c1"># pcHmag(pc_hmag_data =self._data[:, -4])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pcHmag</span><span class="o">.</span><span class="n">_read_pcHmag_data</span><span class="p">(</span><span class="n">pc_h_mag_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="o">-</span><span class="mi">4</span><span class="p">]),</span>
                                      <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span><span class="p">)</span>
        <span class="c1"># sHphz(s_hphz_data=self._data[:,-3])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sHphz</span><span class="o">.</span><span class="n">_read_sHphz_data</span> <span class="p">(</span><span class="n">sHphz_array</span><span class="o">=</span><span class="n">zstar_array_to_nan</span> <span class="p">(</span><span class="n">zstar_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_array</span><span class="p">[:,</span><span class="o">-</span><span class="mi">3</span><span class="p">]),</span>
                                     <span class="n">number_of_frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_frequencies</span><span class="p">,</span> 
                                 <span class="n">number_of_stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_stations</span> <span class="p">)</span>   </div>
    
       

<div class="viewcode-block" id="Station"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Station">[docs]</a><span class="k">class</span>  <span class="nc">Station</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stations informations </span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    -----------</span>
<span class="sd">        **norm_station_value**: bool </span>
<span class="sd">               If True, station will numbered starting by 0.*Default* is True</span>

<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes        Type          Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of station  columns components </span>
<span class="sd">    max               float         maximum distance of survey lines </span>
<span class="sd">    min               float         minimum distance strated recorded data  </span>
<span class="sd">    names              str          names of stations name filled automaticaly</span>
<span class="sd">    end               str           last station name </span>
<span class="sd">    lengh             float         lenght of the survey </span>
<span class="sd">    unit              str           lines lenght units  may be on [m, km , ft]</span>
<span class="sd">    alldata           nd.array      ndarray of all data value from raw file</span>
<span class="sd">    loc               dict          main attribute location of station: eg</span>
<span class="sd">                                    loc [&#39;S01&#39;] show the distance of station at</span>
<span class="sd">                                    that point. </span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>

<span class="sd">    :Example: </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Station</span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...                      &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; station=Station(path)</span>
<span class="sd">        &gt;&gt;&gt; print(station.loc[&#39;S07&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">station_data_array</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">=</span><span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        

        <span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span> <span class="o">=</span><span class="n">station_data_array</span>
        

        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_station_value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;normalized_station_value&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename_station</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rename_sation&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;unit_of_distance_measured&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">last_station_name</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        

    <span class="k">def</span> <span class="nf">_set_station_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">station_data_array</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rename_station</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                      <span class="n">normalized_station_value</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>  <span class="p">:</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set station on dictionnary of each distance. in fact to easily export for </span>
<span class="sd">        plotting each station . </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * station_data_array : np.ndarray (ndarray,1), optional</span>
<span class="sd">                                station value recorded in the field at each point.</span>
<span class="sd">                                The *default* is None.</span>
<span class="sd">            * rename_station : np.ndarray(ndarray,1), optional</span>
<span class="sd">                                list of station name provided. </span>
<span class="sd">                                *Default* is None.</span>
<span class="sd">            * normalized_station_value : bool, optional</span>
<span class="sd">                                start the value of station by 0.</span>
<span class="sd">                                *Default* is False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">station_data_array</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span> <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="n">station_data_array</span> <span class="p">])</span>
  
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_station</span><span class="p">(</span><span class="s1">&#39;No stations data to read .&#39;</span><span class="p">)</span>
    

        <span class="n">num_station_counts</span> <span class="p">,</span> <span class="n">repsta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
 
        <span class="c1">#---&gt; check if stations_data provided are each the same length. </span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">repsta</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_station</span><span class="p">(</span><span class="s1">&#39;Stations provided must be the same length of reccurency.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">repsta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span> 
        <span class="k">elif</span>  <span class="n">repsta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span><span class="mi">1</span>  <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">num_station_counts</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">])</span>
        <span class="c1">#--- convert station  unit -- Default is &#39;m&#39;---</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span><span class="s1">&#39;km&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span><span class="o">/</span><span class="mf">1e3</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;ft&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span><span class="mf">3.280839895</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span><span class="o">/</span><span class="mf">3.280839895</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;km&#39;</span><span class="p">,</span> <span class="s1">&#39;ft&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Station units provided is incorect.Try  &quot;km&quot; or &quot;ft.&quot; Default is &quot;m.&quot;&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_station</span><span class="p">(</span><span class="s1">&#39;Unit provided &lt;</span><span class="si">{0}</span><span class="s1">&gt; doesnt not match correct units.&#39;</span>\
                                      <span class="s1">&#39;acceptable units are : &quot;m&quot;, &quot;km&quot; or &quot;ft&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
                    
            
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_of_station</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">normalized_station_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">normalized_station_value</span><span class="o">=</span><span class="n">normalized_station_value</span> 
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized_station_value</span>  <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span><span class="p">)</span>
            
        <span class="c1"># the case where the user provide its own name</span>
        <span class="k">if</span> <span class="n">rename_station</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rename_station</span> <span class="o">=</span> <span class="n">rename_station</span> 
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename_station</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="nb">type</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rename_station</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">rename_station</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rename_station</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename_station</span><span class="o">.</span><span class="n">size</span> <span class="p">:</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_station</span><span class="p">(</span><span class="s1">&#39;Stations rename array must have the same length as&#39;</span>\
                                                <span class="s1">&#39; the aray_data provided. lenght or stations_data is :&lt;</span><span class="si">{0}</span><span class="s1">&gt;&#39;</span>
                                                <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rename_station</span>
        <span class="k">elif</span> <span class="n">rename_station</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;S</span><span class="si">{:02}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span>
        
        <span class="c1">#---&gt; duplicate stations names and put on dict</span>
        <span class="k">if</span> <span class="n">repsta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> 
             <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span><span class="n">keys</span><span class="p">:</span><span class="n">values</span> <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)}</span>
        <span class="k">if</span> <span class="n">repsta</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span><span class="mi">1</span> <span class="p">:</span> 
            <span class="c1"># self.names =self.names * repsta [0]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="c1"># print(self.station_data_array)</span>
            <span class="c1"># self.station_data_array=self.station_data_array.reshape ((self.station_data_array.shape[0],1))</span>
            
            <span class="c1"># print(self.station_data_array)</span>
            <span class="c1">#--- build a commun array station-value and truncated on dict.</span>
            <span class="c1"># data_to_truncate =np.concatenate((tem_names, self.station_data_array), axis =1 )</span>
            <span class="n">station_list_truncated</span> <span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">station_data_array</span><span class="p">,</span> 
                                                         <span class="n">number_of_reccurence</span><span class="o">=</span> <span class="n">repsta</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="o">=</span> <span class="p">{</span><span class="n">keys</span><span class="p">:</span><span class="n">values</span> <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">station_list_truncated</span><span class="p">)}</span></div>
            
            

<div class="viewcode-block" id="Frequency"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Frequency">[docs]</a><span class="k">class</span> <span class="nc">Frequency</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Frequency informations - Frequency at which data </span>
<span class="sd">    was measured (Hertz). Frequency on Hz </span>
<span class="sd">        </span>
<span class="sd">    Arguments  </span>
<span class="sd">    ---------</span>
<span class="sd">        **freq_array**  : arrya_like </span>
<span class="sd">                        frequence data array </span>
<span class="sd">                        </span>
<span class="sd">        **normalize_freq_betw** : list  </span>
<span class="sd">                                must be on list of integer value </span>
<span class="sd">                                If float value provided </span>
<span class="sd">                                should be convert on list, same as tuple </span>
<span class="sd"> </span>
<span class="sd">    ======================  ==========  =======================================</span>
<span class="sd">    Attributes              Type        Explanation</span>
<span class="sd">    ======================  ==========  =======================================</span>
<span class="sd">    value                   nd.array    frequency data columns</span>
<span class="sd">                                        components </span>
<span class="sd">    max                     float       Hight frequency </span>
<span class="sd">    min                     float       lower frequency  </span>
<span class="sd">    loc                     dict        main attribute : location </span>
<span class="sd">                                        of station loc [&#39;S01&#39;] show the frequency </span>
<span class="sd">                                        of station at that point. </span>
<span class="sd">    normalize_freq_betw     list        must be a list of integer  be sure that</span>
<span class="sd">                                        the numberprovided will be power </span>
<span class="sd">                                        to 10. eg .(start, end,  nfreq)   </span>
<span class="sd">                                        start - first number will be power by 10 </span>
<span class="sd">                                        0=1:10exp(0) end- last value to be </span>
<span class="sd">                                        interpolated : 4 --&gt; 10(exp)4</span>
<span class="sd">                                        nfreq- number of frequency  : eg : 17 </span>
<span class="sd">                                        *Default* is None </span>
<span class="sd">    ======================  ==========  =======================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>

<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg</span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">              &quot;data&quot;, &quot;avg&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; freq_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; freq_obj =avg_obj.Data_section.Frequency.loc[&#39;S07&#39;]</span>
<span class="sd">        ... print(freq_obj)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq_array</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">normalize_freq_betw</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_freq_array</span> <span class="o">=</span><span class="n">freq_array</span> 
        
        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;normalize_freq_betw&#39;</span><span class="p">,</span> <span class="kc">None</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">numfreq</span><span class="o">=</span><span class="kc">None</span> 
        
        
        <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="nb">list</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> 
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_frequency</span><span class="p">()</span>
        
            
    <span class="k">def</span> <span class="nf">_set_frequency</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq_array</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalize_freq_betw</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set frequency according to each station.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * freq_array : np.ndarray(ndarray, 1)</span>
<span class="sd">                        frequency data provided . The default is None.</span>
<span class="sd">            * normalize_freq_betw : list </span>
<span class="sd">                        list of frequency range to normalize, optional. </span>
<span class="sd">                        The *default* is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="k">if</span> <span class="n">freq_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_freq_array</span> <span class="o">=</span><span class="n">freq_array</span> 
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq_array</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_frequency</span><span class="p">(</span><span class="s1">&#39;No Frequency Data found.&#39;</span><span class="p">)</span>
            
            
        <span class="bp">self</span><span class="o">.</span><span class="n">_freq_array</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span> <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq_array</span><span class="p">])</span>  
        
        <span class="c1">#--&gt; read frequency from AVG data file : </span>
        <span class="n">vacount_freq</span><span class="p">,</span> <span class="n">freq_repeat</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_freq_array</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">numfreq</span> <span class="o">=</span> <span class="n">vacount_freq</span><span class="o">.</span><span class="n">size</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">freq_repeat</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_frequency</span><span class="p">(</span><span class="s1">&#39;Problem occured when reading frequency data.&#39;</span>\
                                              <span class="s1">&#39;All frequency on Avgfile Must be the same length. &#39;</span><span class="p">)</span>
        <span class="c1"># self.value =vacount_freq</span>
        
        <span class="c1"># if normalize_freq_betw is not None : </span>
        <span class="c1">#      self.value =self.normalize_freq_betw()</span>
        
        <span class="c1"># self.max, self.min=self.value.max(), self.value.min()</span>
  
        <span class="n">truncated_freq</span> <span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_freq_array</span> <span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">numfreq</span> <span class="p">)</span>
        
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="n">freq_repeat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">numfreq</span><span class="p">)</span>
        
 
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_freq</span> <span class="p">)}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">normalize_freq_betw</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
             <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        
        
    
<div class="viewcode-block" id="Frequency.normalize_frequency"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Frequency.normalize_frequency">[docs]</a>    <span class="k">def</span> <span class="nf">normalize_frequency</span> <span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">normalize_freq_betw</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method to interpolate frequencies.</span>
<span class="sd">        </span>
<span class="sd">        .. deprecated:: waist_method will replaced on cs module.</span>
<span class="sd"> </span>
<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">            CSex</span>
<span class="sd">                raise Error if input arguments for frequency interpolating is wrong.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            array_like</span>
<span class="sd">                frequency normalized.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">normalize_freq_betw</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span> <span class="o">=</span> <span class="n">normalize_freq_betw</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span><span class="p">)</span> <span class="o">==</span><span class="nb">tuple</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span> <span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span><span class="p">)</span>
                <span class="k">try</span> <span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span> <span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span><span class="p">]</span>
                <span class="k">except</span> <span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s2">&quot;Input interpolated arguments are wrong! arguments type must&quot;</span>\
                                        <span class="s2">&quot; a list of integers. &quot;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Input value of frequency is wrong. Must be&quot;</span>\
                                                  <span class="s2">&quot; a list of integers.&quot;</span><span class="p">)</span>
            <span class="n">lengh_interp</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">normalize_freq_betw</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">freq_new</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">lengh_interp</span><span class="p">)</span>
        <span class="c1"># range value provide if value not in order .  </span>
        <span class="n">freq_new</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="c1"># freq_new=func.interpol_scipy(x_value=np.array([ii for ii in range (self.numfreq)]),</span>
        <span class="c1">#                              y_value =self.vacount_freq, x_new=)</span>
        <span class="k">return</span> <span class="n">freq_new</span></div></div>
        

<div class="viewcode-block" id="Comp"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Comp">[docs]</a><span class="k">class</span> <span class="nc">Comp</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Components measured</span>
<span class="sd">    </span>
<span class="sd">    Holds the following information:</span>
<span class="sd">         </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **comp_name** : str</span>
<span class="sd">                       path to avg filename </span>
<span class="sd">        **new_component** :str  </span>
<span class="sd">                       component type which data will acquired . make sure </span>
<span class="sd">                       once change it , the method to calculate impedande Z and </span>
<span class="sd">                       rotating angle will also change to</span>
<span class="sd">                       </span>
<span class="sd">                       - ExHy Zxy (Ex/Hy)</span>
<span class="sd">                       - EyHz Zyx (Ey/Hx)</span>
<span class="sd">                       - EyHy Zyy (Ey/Hy)</span>
<span class="sd">                       - ExHx Zxx (Ex/Hx)</span>

<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    =================  ==========  ============================================</span>
<span class="sd">    name               str          name of components will filled automatically</span>
<span class="sd">    length             float        lenght of the survey lines </span>
<span class="sd">    =================  ==========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Comp</span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">                          &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; component=Comp(path, component_name=&#39;EyHx&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(component.name)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">component_type</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;ExHy&#39;</span><span class="p">,</span> <span class="s2">&quot;EyHx&quot;</span><span class="p">,</span> <span class="s1">&#39;EyHy&#39;</span><span class="p">,</span> <span class="s1">&#39;ExHx&#39;</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comp_name</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span><span class="n">comp_name</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">new_comp</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;component_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_comp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_comp</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_comp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">component_type</span> <span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">new_comp</span>
                <span class="k">else</span> <span class="p">:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Component provided is wrong !&#39;</span><span class="p">)</span>
                    <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Component provide as new component is wrong&quot;</span>\
                                             <span class="s2">&quot;list of components:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_type</span><span class="p">))</span>
            <span class="k">else</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Components must be a string : a list of arguments below:&quot;</span>\
                              <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_type</span><span class="p">))</span>
                <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Component type is wrong. must a string.&quot;</span>\
                                             <span class="s2">&quot;list of components:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_type</span><span class="p">))</span></div>
                    

<div class="viewcode-block" id="Amps"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Amps">[docs]</a><span class="k">class</span> <span class="nc">Amps</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Square-Wave current (amps)</span>
<span class="sd">    </span>
<span class="sd">    Arguments :</span>
<span class="sd">    ----------</span>
<span class="sd">        **amps_array** : np.ndarray (ndarray, 1)</span>
<span class="sd">                        evolution of current data on the site </span>
<span class="sd">        **number_of_stations** : int  </span>
<span class="sd">                            number of survey_stations . </span>
<span class="sd">        **number_of_frequencies**: int </span>
<span class="sd">                             number of frequencies during</span>
<span class="sd">                             the survey for each station location</span>
<span class="sd">            </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of Amp  column  on avgfile   </span>
<span class="sd">    max               float         maximum current enforce  a that point</span>
<span class="sd">    min               float         minimun current unit :amp (A)  </span>
<span class="sd">    loc               dict          main attribute location of station with </span>
<span class="sd">                                    the current enforce a that point .eg loc </span>
<span class="sd">                                    [&#39;S07&#39;] show the current Amps-data</span>
<span class="sd">                                    at that point</span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg</span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...      &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; amps_obj =avg_obj.Data_section.Amps.loc[&#39;S00&#39;]</span>
<span class="sd">        &gt;&gt;&gt; print(amp_obj)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amps_array</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">_amps_array</span> <span class="o">=</span><span class="n">amps_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_amps_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_amps_data</span><span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_amps_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amps_array</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span>
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read and arange data according each station /amps values .</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * amps_array : ndarray, optional</span>
<span class="sd">                            amps _current observed sites. </span>
<span class="sd">                            The *default* is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                            number of frequencies for survey.</span>
<span class="sd">                            The *default* is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                            number_of stations. </span>
<span class="sd">                            The *default* is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">amps_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_amps_array</span> <span class="o">=</span><span class="n">amps_array</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_amps_array</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No Ampers data !&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
            
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_amps_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_amps_array</span><span class="p">])</span>

        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for the amp are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
            
        <span class="n">vcounts_amps</span><span class="p">,</span> <span class="n">repeat_amp</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_amps_array</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_amps</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_amps</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_amps</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        
        <span class="n">truncated_amps</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_amps_array</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_amps</span> <span class="p">)}</span></div>
        
        
        
<div class="viewcode-block" id="Emag"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Emag">[docs]</a><span class="k">class</span> <span class="nc">Emag</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    E-field magnitude (microVolts/(kiloMeter*Amp))</span>
<span class="sd">    </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **e_mag_array**: ndarray</span>
<span class="sd">                E_field magnitude Class  </span>
<span class="sd">                  </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of Emag  column on avgfile   </span>
<span class="sd">    max               float         maximum E-Field magnitude unit :mV/km*Amp </span>
<span class="sd">    loc               dict          location of E-Field  magnitude value at </span>
<span class="sd">                                    the station lambda.e:g : loc[&#39;S00&#39;] show </span>
<span class="sd">                                    the current  E-mag data of station </span>
<span class="sd">                                    at that point.</span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example: </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg</span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...      &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; emag_obj =avg_obj.Data_section.Emag.loc[&#39;S02&#39;]</span>
<span class="sd">        ... print(emag_obj)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e_mag_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">e_mag_array</span> <span class="o">=</span><span class="n">e_mag_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_mag_array</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_emag_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_emag_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">e_mag_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read and arange data according each </span>
<span class="sd">        station /e_field magnitude values .</span>
<span class="sd">            </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * e_mag_array : ndarray, optional</span>
<span class="sd">                            B-Field magnitude observed at each station.</span>
<span class="sd">                            The *default* is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                                number of frequencies for survey. </span>
<span class="sd">                                The default is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                                number_of stations. The default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">e_mag_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">e_mag_array</span> <span class="o">=</span><span class="n">e_mag_array</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_mag_array</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No E-Field  data found  !&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
            
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e_mag_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_mag_array</span><span class="p">])</span>

        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for the amp are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
            
        <span class="n">vcounts_e_mag</span><span class="p">,</span> <span class="n">repeat_amp</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e_mag_array</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_e_mag</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_e_mag</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_e_mag</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        
        <span class="n">truncated_e_mag</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">e_mag_array</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_e_mag</span> <span class="p">)}</span></div>
        
    
<div class="viewcode-block" id="Ephz"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Ephz">[docs]</a><span class="k">class</span> <span class="nc">Ephz</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    E-field phase (milliRadians)</span>
<span class="sd">    </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **e_phz_array** : ndarray</span>
<span class="sd">                   E_phase data field</span>
<span class="sd">        **to_deg**  : bool </span>
<span class="sd">                   put the Ephz value on degree . </span>
<span class="sd">                  </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of Emag  column  unit - mrad </span>
<span class="sd">    max               float         maximum E-Field magnitude  unit -mV/km*Amp </span>
<span class="sd">    loc               dict          location of E-phase   value at the</span>
<span class="sd">                                    station lambda . e.g - loc[&#39;S46] show the </span>
<span class="sd">                                    current  E-phase data  at the station S46</span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg </span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...      &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; ephz_obj =avg_obj.Data_section.Ephz.loc[&#39;46&#39;]</span>
<span class="sd">        &gt;&gt;&gt; print(ephz_obj)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e_phz_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                 <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span> <span class="n">e_phz_array</span><span class="o">=</span> <span class="n">e_phz_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;to_degree&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_phz_array</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_ephz_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_ephz_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">e_phz_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>  <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read and arange data according each</span>
<span class="sd">        station /E-phase angles values .</span>
<span class="sd">            </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * e_phz_array : ndarray, en rad </span>
<span class="sd">                            E-Field phase observed .</span>
<span class="sd">                            The *default* is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                                number of frequencies for survey.</span>
<span class="sd">                                The *default* is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                                number_of stations. </span>
<span class="sd">                                The *default* is None.</span>
<span class="sd">            * to_degree : bool,</span>
<span class="sd">                        compute angle to degree . </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;to_degree&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_degree</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span> <span class="n">to_degree</span>
        
        <span class="k">if</span> <span class="n">e_phz_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">e_phz_array</span> <span class="o">=</span><span class="n">e_phz_array</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_phz_array</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No E-phase data found  !&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
            
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e_phz_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_phz_array</span><span class="p">])</span>

        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for the E-phase are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="p">:</span> <span class="c1">#---&gt; set angle to degree .</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e_phz_array</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">ephz</span><span class="p">:</span> <span class="n">ephz</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">e_phz_array</span><span class="p">)</span>        
        
            
        <span class="n">vcounts_e_phz</span><span class="p">,</span> <span class="n">repeat_ephz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e_phz_array</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_e_phz</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_e_phz</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_e_phz</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        
        <span class="n">truncated_e_phz</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">e_phz_array</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_e_phz</span> <span class="p">)}</span></div>
        
        
<div class="viewcode-block" id="Hmag"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Hmag">[docs]</a><span class="k">class</span> <span class="nc">Hmag</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    H-field magnitude (picoTesla/Amp)</span>
<span class="sd">    (milliGammas/Amp)  </span>
<span class="sd">    </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **h_mag_array** : ndarray</span>
<span class="sd">                       H/B_field magnitude Class . </span>
<span class="sd">                  </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of Hmag  column  on avgfile  maximum</span>
<span class="sd">    max               float         H-mag magnitude unit -  mV/km*Amp </span>
<span class="sd">    loc               dict          location of H-mag magnitude value at  the </span>
<span class="sd">                                    station lambda . e:g : loc[&#39;S05&#39;]</span>
<span class="sd">                                    show the current  H-mag data</span>
<span class="sd">                                    of station at S05.</span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example: </span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core import Avg </span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...      &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; hmag_obj =avg_obj.Data_section.Hmag.loc[&#39;S05&#39;]</span>
<span class="sd">        ... print(hmag_obj)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h_mag_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">h_mag_array</span> <span class="o">=</span><span class="n">h_mag_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_mag_array</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_hmag_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_hmag_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h_mag_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read and arange data according </span>
<span class="sd">        each station /B_field magnitude  values .</span>
<span class="sd">           </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * h_mag_array : ndarray, optional</span>
<span class="sd">                            B Field measured data on the sites.</span>
<span class="sd">                            The default is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                                    number of frequencies for survey. </span>
<span class="sd">                                    The default is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                                number_of stations. The default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">h_mag_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">h_mag_array</span> <span class="o">=</span><span class="n">h_mag_array</span> 
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_mag_array</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No B-Field  data found  !&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
            
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_mag_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_mag_array</span><span class="p">])</span>

        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for the B-Field are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
            
        <span class="n">vcounts_h_mag</span><span class="p">,</span> <span class="n">repeat_amp</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_mag_array</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_h_mag</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_h_mag</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_h_mag</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        
        <span class="n">truncated_h_mag</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">h_mag_array</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_h_mag</span> <span class="p">)}</span></div>
            
<div class="viewcode-block" id="Hphz"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Hphz">[docs]</a><span class="k">class</span> <span class="nc">Hphz</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    H-field phase (milliRadians)</span>
<span class="sd">    </span>
<span class="sd">    Arguments </span>
<span class="sd">    ---------</span>
<span class="sd">        **h_phz_array** : ndarray</span>
<span class="sd">                        E_phase data field</span>
<span class="sd">         **to_degree**  : bool </span>
<span class="sd">                    put the Hphz value on degree . </span>
<span class="sd">                  </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of Emag  column  unit : mrad   </span>
<span class="sd">    max               float         maximum E-Field magnitude unit :mV/km*Amp </span>
<span class="sd">    loc               dict          location of E-phase  value at the station</span>
<span class="sd">                                    lambda , e.g loc[&#39;S43] show the</span>
<span class="sd">                                    current  E-phase data at the stationS43</span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example: </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Data_section </span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">              &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; hphz_obj =avg_obj.Data_section.Ephz.loc[&#39;43&#39;]</span>
<span class="sd">        ... print(hphz_obj)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h_phz_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                 <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">h_phz_array</span><span class="o">=</span> <span class="n">h_phz_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;to_degree&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span> <span class="n">h_phz_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_hphz_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_hphz_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">h_phz_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>  <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read and arange data according each</span>
<span class="sd">        station /E-phase angles </span>
<span class="sd">            values .</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * e_phz_array : ndarray, en rad </span>
<span class="sd">                            E-Field phase observed . The default is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                            number of frequencies for survey. The default is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                            number_of stations.</span>
<span class="sd">                            The default is None.</span>
<span class="sd">            * to_degree : bool,</span>
<span class="sd">                            compute angle todegree . </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;to_degree&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_degree</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span> <span class="n">to_degree</span>
        
        <span class="k">if</span> <span class="n">h_phz_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">h_phz_array</span><span class="o">=</span><span class="n">h_phz_array</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_phz_array</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No E-phase data found  !&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
            
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_phz_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_phz_array</span><span class="p">])</span>

        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for the E-phase are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="p">:</span> <span class="c1">#---&gt; set angle to degree .</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_phz_array</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">hphz</span><span class="p">:</span> <span class="n">hphz</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">h_phz_array</span><span class="p">)</span>        
        
            
        <span class="n">vcounts_h_phz</span><span class="p">,</span> <span class="n">repeat_hphz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_phz_array</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">repeat_hphz</span><span class="p">):</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s1">&#39;Values of B-phases provided must have the same length&#39;</span>\
                                                            <span class="s1">&#39; for each stations. &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_h_phz</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_h_phz</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_h_phz</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        
        <span class="n">truncated_h_phz</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">h_phz_array</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_h_phz</span> <span class="p">)}</span></div>
        
        
        
<div class="viewcode-block" id="Resistivity"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Resistivity">[docs]</a><span class="k">class</span> <span class="nc">Resistivity</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    based on Cagniard Resistivity (Ohm-Meters) calculation </span>
<span class="sd">    </span>
<span class="sd">     .. see also::Cagniard, L., 1953, Basic theory of the magnetotelluric</span>
<span class="sd">          method of  geophysical prospecting: Geophysics, 18, 605â635,</span>
<span class="sd">          *doi*: 10.1190/1.1437915. </span>
<span class="sd">    </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **res_array**  : str</span>
<span class="sd">                      data array of apparents resistivy calculation.</span>
<span class="sd">                  </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of resistivity column - ohm.m </span>
<span class="sd">    max               float         higher value of Resistivity </span>
<span class="sd">    min               float         minimum value of resitivity on the area</span>
<span class="sd">    mean              float         everage value of the rho </span>
<span class="sd">    loc               dict          location of rho  value at the station lambda </span>
<span class="sd">                                    e.g - loc[&#39;S13] show the current  rho data </span>
<span class="sd">                                    at the station S13</span>
<span class="sd">    Sres              ndarray       Astatic value corrected</span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:  </span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from csammtpy.ff.core.avg import Avg </span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...                  &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; rho_obj =avg_obj.Data_section.Resistivity.loc[&#39;S00&#39;]</span>
<span class="sd">        &gt;&gt;&gt; print(rho.loc[&#39;S00&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res_array</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                 <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">res_array</span><span class="o">=</span><span class="n">res_array</span> 
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Sres</span><span class="o">=</span><span class="kc">None</span> 
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sres</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;added_astatic_rho_array&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_res_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_res_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">res_array</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Sres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span>  <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read resitivity  according each station /Resistivity angles </span>
<span class="sd">            values .</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * res_array : array_like </span>
<span class="sd">                         Resistivity calculated  on the field. </span>
<span class="sd">                         The *default* is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                            number of frequencies for survey. </span>
<span class="sd">                            The *default* is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                            number_of stations. </span>
<span class="sd">                            The *default* is None.</span>
<span class="sd">            * Sres : ndarray, </span>
<span class="sd">                        Zonge Astatic rho calculated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">res_array</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">res_array</span><span class="o">=</span> <span class="n">res_array</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_array</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No Resistivity data found !&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">Sres</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Sres</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">Sres</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sres</span><span class="o">.</span><span class="n">size</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_rho</span><span class="p">(</span><span class="s1">&#39;Resistivity calculated &amp; &#39;</span>\
                                                                                 <span class="s1">&#39;Astatic_array must get the same length!.&#39;</span><span class="p">)</span>
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">res_array</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_array</span><span class="p">])</span>

        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for the Resistivities are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
        
        <span class="n">vcounts_res</span><span class="p">,</span> <span class="n">repeat_hphz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">res_array</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">repeat_hphz</span><span class="p">):</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s1">&#39;Values of Rho provided must have the same length&#39;</span>\
                                                           <span class="s1">&#39; for each stations. &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_res</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_res</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_res</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">res_array</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">truncated_res</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">res_array</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_res</span> <span class="p">)}</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sres</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">vcounts_sres</span><span class="p">,</span> <span class="n">repeat_hphz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Sres</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vSres</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_Sres</span> <span class="o">=</span> <span class="n">vcounts_sres</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sres</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="p">(</span><span class="n">vcounts_res</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">vcounts_sres</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="p">(</span><span class="n">vcounts_res</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">vcounts_sres</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_Sres</span><span class="p">)</span>
            <span class="n">truncated_sres</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sres</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loc_Sres</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_sres</span> <span class="p">)}</span></div>

       
<div class="viewcode-block" id="Phase"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Phase">[docs]</a><span class="k">class</span> <span class="nc">Phase</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Impedance phase  on milliRadians can be calculate using Ephz</span>
<span class="sd">     object and Hphz object </span>
<span class="sd">     </span>
<span class="sd">         * **Phase** = E-phase - H-phase</span>
<span class="sd">        </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **phase_array**  : ndarray</span>
<span class="sd">                        array of phase values got on the field</span>
<span class="sd">         **to_degree** : bool </span>
<span class="sd">                        put the Phase value on degree . </span>
<span class="sd">                  </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of phase  column  </span>
<span class="sd">    max               float         maximum phase value (mrad)</span>
<span class="sd">    min               float         minimum  Phase  (mrad)</span>
<span class="sd">    loc               dict          location of H-phase  value  at the </span>
<span class="sd">                                    station lambda . e:g : loc[&#39;S00&#39;] show the </span>
<span class="sd">                                    current phase data at the station S00</span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>

<span class="sd">    :Example:</span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg </span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...                  &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; phs_obj =avg_obj.Data_section.Phase.loc[&#39;S00&#39;]</span>
<span class="sd">        ... print(phs.loc[&#39;S00&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_array</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>   <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_array</span><span class="o">=</span><span class="n">phase_array</span> 

        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;to_degree&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_res_data</span> <span class="p">()</span>
            
   
    <span class="k">def</span> <span class="nf">_read_phase_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">phase_array</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                     <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method to read phase values obtained on the sites.units on mrads.  </span>
<span class="sd">        Zonge keep the phase values on mrad.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ------------</span>
<span class="sd">            * phase_array : ndarray, optional</span>
<span class="sd">                            phase data aray on the field.</span>
<span class="sd">                            The *default* is None.</span>
<span class="sd">            * number_of_frequencies : TYPE, optional</span>
<span class="sd">                            number of fequency used .</span>
<span class="sd">                            The *default* is None.</span>
<span class="sd">            * number_of_stations : int, optional</span>
<span class="sd">                            number of the stations on the site.</span>
<span class="sd">                            The *default* is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    
 
        <span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;to_degree&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">to_degree</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span> <span class="n">to_degree</span>
        
        <span class="k">if</span> <span class="n">phase_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_array</span> <span class="o">=</span><span class="n">phase_array</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_array</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No Phase data found  !&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>

            
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_array</span><span class="p">])</span>

        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for the Phase are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="p">:</span> <span class="c1">#---&gt; set angle to degree .</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_array</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">phz</span><span class="p">:</span> <span class="n">phz</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_array</span><span class="p">)</span>        
        
            
        <span class="n">vcounts_phz</span><span class="p">,</span> <span class="n">repeat_phz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_array</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_phz</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_phz</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_phz</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        
        <span class="n">truncated_phz</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_array</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_phz</span> <span class="p">)}</span></div>
            
        
<div class="viewcode-block" id="Z_Tensor"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Z_Tensor">[docs]</a><span class="k">class</span> <span class="nc">Z_Tensor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Impedance Tensor Z Calculation :  </span>
<span class="sd">       class can recompute the apparent resistity rho base on impedance Tensor Z.</span>
<span class="sd">       </span>
<span class="sd">    .. seealso:: Zonge, K.L. and Hughes, L.J., 1991, Controlled source audio-frequency </span>
<span class="sd">                magnetotellurics,in Electromagnetic Methods in Applied Geophysics, ed.</span>
<span class="sd">                Nabighian, M.N., Vol. 2,Society of Exploration Geophysicists, pp. 713-809.</span>
<span class="sd">            </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **data_fn** : str</span>
<span class="sd">                path to avg filename. </span>
<span class="sd">                  </span>
<span class="sd">    ================  ===========  ===========  ===============================</span>
<span class="sd">    Attributes         Type          units      Explanation</span>
<span class="sd">    ================  ===========  ===========  ===============================</span>
<span class="sd">    Z                 np.ndarray    V/m         Impedance tensor </span>
<span class="sd">    real              dict          V/m         real part of Z </span>
<span class="sd">    imag              dict                      imaginary part of Z  </span>
<span class="sd">    complex           dict          complex     Z on complex type</span>
<span class="sd">    rho               dict          ohm.m       Resistivity </span>
<span class="sd">    loc               dict                      location of Z value at </span>
<span class="sd">                                                the station lambda .</span>
<span class="sd">                                                e:g loc[&#39;S00] show the</span>
<span class="sd">                                                current Z data at station S00</span>
<span class="sd">    ================  ===========  ===========  ===============================</span>
<span class="sd">    </span>
<span class="sd">    .. note:: all dict-attributes  can be loc with the station name .</span>
<span class="sd">        </span>
<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg impor Z_tensor</span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...                  &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; z_obj=Z_Tensor(path)</span>
<span class="sd">        &gt;&gt;&gt; z_z=Zxy.Z</span>
<span class="sd">        &gt;&gt;&gt; print(z_obj.real[&quot;S00&quot;])</span>
<span class="sd">        &gt;&gt;&gt; print(z_obj.imag[&quot;S00&quot;])</span>
<span class="sd">        &gt;&gt;&gt; print(z_obj.complex[&quot;S00&quot;])</span>
<span class="sd">        &gt;&gt;&gt; print(z_obj.loc[&quot;S00&quot;])</span>
<span class="sd">        &gt;&gt;&gt; print(z_obj.rho[&quot;S00&quot;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z_array</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">phase_array</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z_error</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span> <span class="o">=</span><span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_z</span>  <span class="o">=</span><span class="n">z_array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span><span class="n">phase_array</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">_z_err</span> <span class="o">=</span><span class="n">z_error</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> <span class="o">=</span> <span class="kc">None</span>
        
 
        <span class="bp">self</span><span class="o">.</span><span class="n">_rho</span> <span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">zAS</span> <span class="o">=</span><span class="kc">None</span> 
        
        
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span> <span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">z_pwgt</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">z_megt</span> <span class="o">=</span><span class="kc">None</span> 
            
        <span class="bp">self</span><span class="o">.</span><span class="n">z_as_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Z.mag&#39;</span><span class="p">,</span> <span class="s1">&#39;Z.mwgt&#39;</span><span class="p">,</span><span class="s1">&#39;Z.pwgt&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;E.wgt&#39;</span><span class="p">,</span> <span class="s1">&#39;B.wgt&#39;</span><span class="p">,</span><span class="s1">&#39;Z.</span><span class="si">%e</span><span class="s1">rr&#39;</span> <span class="p">]</span>
        
             
    <span class="nd">@property</span> 
    <span class="k">def</span> <span class="nf">freq</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> 
    
    <span class="nd">@freq</span><span class="o">.</span><span class="n">setter</span> 
    <span class="k">def</span> <span class="nf">freq</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq_array</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">freq_array</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]:</span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span> <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">freq_array</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_frequency</span><span class="p">(</span><span class="s1">&#39;wrong Input frequencies&#39;</span>\
                                                      <span class="s1">&#39; values.must be a float number. &#39;</span><span class="p">)</span>
            
    <span class="nd">@property</span> 
    <span class="k">def</span> <span class="nf">phase</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> 
    <span class="nd">@phase</span><span class="o">.</span><span class="n">setter</span> 
    <span class="k">def</span> <span class="nf">phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phz_array</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">phz_array</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]:</span>
            <span class="k">try</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">phz</span><span class="p">)</span> <span class="k">for</span> <span class="n">phz</span> <span class="ow">in</span> <span class="n">phz_array</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">:</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Phase</span><span class="p">(</span><span class="s1">&#39;Arguments phase values must be int, or float .&#39;</span><span class="p">)</span>
            
    <span class="nd">@property</span> 
    <span class="k">def</span> <span class="nf">z_error</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z_err</span> 
    <span class="nd">@z_error</span><span class="o">.</span><span class="n">setter</span> 
    <span class="k">def</span> <span class="nf">z_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z_error_</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">z_error_</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]:</span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">_z_err</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span> <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="n">z_error_</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">:</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Z</span><span class="p">(</span><span class="s2">&quot;Error z input values are incorrects.&quot;</span><span class="p">)</span>
    
    <span class="nd">@property</span> 
    <span class="k">def</span> <span class="nf">z</span>  <span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span>
    
    <span class="nd">@z</span><span class="o">.</span><span class="n">setter</span> 
    <span class="k">def</span> <span class="nf">z</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zz_array</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">zz_array</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="n">zz_array</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span> <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="n">zz_array</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">:</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Z</span><span class="p">(</span><span class="s1">&#39;z_impedance value must be a complex_number.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zz_array</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]:</span> <span class="c1">#---&gt; provide freq value and phase . </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">=</span> <span class="n">Zcc</span><span class="o">.</span><span class="n">rhophi2z</span><span class="p">(</span><span class="n">phase</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="p">,</span> <span class="n">freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> <span class="p">,</span> 
                                   <span class="n">z_array</span><span class="o">=</span><span class="n">zz_array</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span><span class="o">=</span> <span class="n">zz_array</span>
    
                
    
<div class="viewcode-block" id="Z_Tensor.z_and_zerr_2rhophi"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Z_Tensor.z_and_zerr_2rhophi">[docs]</a>    <span class="k">def</span> <span class="nf">z_and_zerr_2rhophi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z_array</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to compute resistivity and phase phase </span>
<span class="sd">        using Z_values and Zerror _values </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * z_array : complex</span>
<span class="sd">                    Impedance tensor complex_number </span>
<span class="sd">                    The *default* is None.</span>
<span class="sd">            * freq : ndarray, </span>
<span class="sd">                    frequency value.</span>
<span class="sd">                    The *default* is None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            ndarray(ndarray,1)  </span>
<span class="sd">                resistivity value computed in ohm.m</span>
<span class="sd">            ndarray (ndarray, 1), </span>
<span class="sd">                phase angle value  in degree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="k">if</span> <span class="n">z_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">=</span> <span class="n">z_array</span> 
        
        <span class="k">if</span> <span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="o">=</span><span class="n">freq</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Z</span><span class="p">(</span><span class="s1">&#39;None values can not be computed. Check values !&#39;</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">valz</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">valz</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        
        <span class="c1">#-- z is complex number , can be compute using np.angle</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span></div>
    
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rho</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rho</span> 
        
    <span class="nd">@rho</span><span class="o">.</span><span class="n">setter</span> 
    <span class="k">def</span> <span class="nf">rho</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res_array</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">res_array</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]:</span>
            <span class="k">try</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">res_array</span><span class="p">])</span> 
            <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_rho</span><span class="p">(</span><span class="s1">&#39;Resistivities values must be float &#39;</span>\
                                                 <span class="s1">&#39;or integer , not a None type !&#39;</span><span class="p">)</span>
                
    
        
<div class="viewcode-block" id="Z_Tensor.rhophi2rhoph_errors"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.Z_Tensor.rhophi2rhoph_errors">[docs]</a>    <span class="k">def</span> <span class="nf">rhophi2rhoph_errors</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res_array</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">phase_array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">z_error</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute the phase and resistivities error via res_array , phase_array and _z error.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * res_array : ndarray , </span>
<span class="sd">                        resistivity value in ohm.m </span>
<span class="sd">            * phase_array : ndarray , </span>
<span class="sd">                        phase angle value in mradians </span>
<span class="sd">            * z_error : ndarray , </span>
<span class="sd">                        impedance Tensor error </span>
<span class="sd">            * freq : ndarray , </span>
<span class="sd">                        frequency numbers in Hz </span>
<span class="sd">        Returns </span>
<span class="sd">        --------</span>
<span class="sd">           ndarrays </span>
<span class="sd">              resistivities error and phase errors values  .</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;compute rho_phi to resistivities and phases_errors&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">res_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span><span class="n">res_array</span>
        <span class="k">if</span> <span class="n">z_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_error</span> <span class="o">=</span><span class="n">z_error</span> 
        <span class="k">if</span> <span class="n">phase_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">=</span><span class="n">phase_array</span> 
        <span class="k">if</span> <span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="ow">is</span> <span class="kc">None</span>  <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;NoneType can not be computed. please check your data arrays.&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Z</span><span class="p">(</span><span class="s1">&#39;could note compute a Nonetype number. please check numbers.&#39;</span><span class="p">)</span>
        
        <span class="c1"># compute imag part and real part of Z </span>
             
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="o">.</span><span class="n">size</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_Z</span><span class="p">(</span><span class="s1">&#39;Resistivity , freq and phase_array must be the same size. &#39;</span><span class="p">)</span>
        
        <span class="c1"># zz_= np.array([np.sqrt(0.2 * self._freq[ii] * self._rho[ii]) for ii in range (self._freq.size)])</span>
        <span class="n">zz_comp</span> <span class="o">=</span> <span class="n">Zcc</span><span class="o">.</span><span class="n">rhophi2z</span><span class="p">(</span><span class="n">phase</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> 
                               <span class="n">resistivity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span><span class="n">zz_comp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        
        <span class="c1"># zz_ =np.sqrt (0.2 * self._freq * self._rho)</span>
        <span class="c1"># z_real=(np.apply_along_axis(lambda xxr : np.cos(xxr), 0, self._phase)) * zz_ </span>
        <span class="c1"># z_imag =(np.apply_along_axis(lambda xxi: np.cos(xxi), 0, self._phase))* zz_</span>

        <span class="n">res_err</span><span class="p">,</span> <span class="n">phase_err</span> <span class="o">=</span> <span class="n">Zcc</span><span class="o">.</span><span class="n">z_error2r_phi_error</span><span class="p">(</span><span class="n">z_real</span><span class="o">=</span><span class="n">zz_comp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                     <span class="n">z_imag</span><span class="o">=</span><span class="n">zz_comp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
                                                     <span class="n">error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z_error</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">res_err</span> <span class="p">,</span> <span class="n">phase_err</span> </div>
            
    <span class="k">def</span> <span class="nf">_read_zAS_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z_abs_array</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span>
                      <span class="n">number_of_stations</span> <span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set Z_values straightforwardly from Zonge Astatic file . </span>
<span class="sd">       </span>
<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">            * z_array : pd.DataFrame ,</span>
<span class="sd">                        added values from astatic files. </span>
<span class="sd">            * number_of_frequency :  int  , </span>
<span class="sd">                        number of frequency used during surveys.</span>
<span class="sd">            * number_of_stations :int , </span>
<span class="sd">                        differents survey frequencies.</span>
<span class="sd">            * Frequency : array_like</span>
<span class="sd">                        frequency array units in Hz  </span>
<span class="sd">            </span>
<span class="sd">        .. Notes :: </span>
<span class="sd">             appropriate converter  should be </span>
<span class="sd">             - 1Hz --&gt;  6.28140704, </span>
<span class="sd">             - deg-rad --&gt; theta(deg) *np.pi/180 </span>
<span class="sd">             - mu  vaccum permitivity with  scipy.constants.epsilon_0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Transfering Astatic Z data .&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">z_abs_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">zAS</span> <span class="o">=</span> <span class="n">z_abs_array</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zAS</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No zonge Astatic  data found  !&#39;</span><span class="p">)</span>            
            
        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span> <span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="o">=</span> <span class="n">number_of_stations</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zAS</span><span class="p">)</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span> <span class="p">:</span> 
            <span class="k">for</span> <span class="n">wgt</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zAS</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span> 
                <span class="k">if</span> <span class="n">wgt</span> <span class="o">==</span> <span class="s1">&#39;Z.mwgt&#39;</span> <span class="ow">or</span> <span class="n">wgt</span> <span class="o">==</span> <span class="s1">&#39;E.wgt&#39;</span><span class="p">:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">z_mwgt</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zAS</span><span class="p">[</span><span class="n">wgt</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">wgt</span> <span class="o">==</span> <span class="s1">&#39;Z.pwgt&#39;</span> <span class="ow">or</span> <span class="n">wgt</span> <span class="o">==</span><span class="s1">&#39;B.wgt&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">z_pwgt</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zAS</span><span class="p">[</span><span class="s1">&#39;Z.pwgt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">wgt</span> <span class="o">==</span> <span class="s1">&#39;Z.</span><span class="si">%e</span><span class="s1">rr&#39;</span><span class="p">:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">_z_err</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zAS</span><span class="p">[</span><span class="n">wgt</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">wgt</span> <span class="o">==</span> <span class="s1">&#39;Z.mag&#39;</span> <span class="p">:</span> <span class="n">zabs_array</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zAS</span><span class="p">[</span><span class="n">wgt</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
                
                
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="n">zabs_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">zabs_array</span><span class="p">])</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for Z-astatic are wrong.&quot;</span>\
                                          <span class="s2">&quot; check your Zonge AVG file .&quot;</span><span class="p">)</span>        
        
  
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">zabs_array</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">zabs_array</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        <span class="n">truncated_zz</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="n">zabs_array</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_zz</span> <span class="p">)}</span></div>
        

<div class="viewcode-block" id="pcEmag"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.pcEmag">[docs]</a><span class="k">class</span> <span class="nc">pcEmag</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Statistical variation of magnitude values from </span>
<span class="sd">    averaged data blocks.</span>
<span class="sd">    </span>
<span class="sd">    Standard Deviation/Average Emag (percent)</span>
<span class="sd">        </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **pcEmag** : ndarray</span>
<span class="sd">                    data array of statistical variataion</span>
<span class="sd">                    of Emag value on the field.</span>
<span class="sd">            </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of pcEmag  column   on avgfile</span>
<span class="sd">    max               float         maximum % value of pc Emag</span>
<span class="sd">    min               float         minimum % value of pcEmag </span>
<span class="sd">    loc               dict          location of %Ephz magnitude</span>
<span class="sd">                                    value at the station lambda e:g .loc[&#39;S05&#39;]</span>
<span class="sd">                                    show the current  H-mag data </span>
<span class="sd">                                    of station at S05.</span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg </span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...      &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; pcemag_obj =avg_obj.Data_section.pcEmag.loc[&#39;S05&#39;]</span>
<span class="sd">        &gt;&gt;&gt; print(pcemag_obj)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pc_e_mag_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_pcEmag</span> <span class="o">=</span><span class="n">pc_e_mag_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pcEmag</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_pcEmag_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_pcEmag_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pc_e_mag_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read and arange data according each station /Statistical variation of </span>
<span class="sd">            E-Field magnitude values .</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * pc_e_mag_array : ndarray, optional</span>
<span class="sd">                                E-Field std variation  observed at each station.</span>
<span class="sd">                                The default is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                                    number of frequencies for survey. </span>
<span class="sd">                                    The default is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                                number_of stations. The default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pc_e_mag_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_pcEmag</span> <span class="o">=</span><span class="n">pc_e_mag_array</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pcEmag</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No E-mag statistical variation  data found  !&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
            
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pcEmag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pcEmag</span><span class="p">])</span>

        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for the E-mag stat.variation  are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
            
        <span class="n">vcounts_Emag</span><span class="p">,</span> <span class="n">repeat_Emag</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pcEmag</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_Emag</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_Emag</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_Emag</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        
        <span class="n">truncated_pcEmag</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pcEmag</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_pcEmag</span><span class="p">)}</span></div>
        
        
        
<div class="viewcode-block" id="sEphz"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.sEphz">[docs]</a><span class="k">class</span> <span class="nc">sEphz</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Statistical variation of the data blocks averaged for this data point.</span>
<span class="sd">    100 * Standard Deviation of Ephz values (milliradians)</span>
<span class="sd">        </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **sEphz**  : ndarray,</span>
<span class="sd">                   data array of statistical variation of </span>
<span class="sd">                   Ephase value on the field.</span>
<span class="sd">                  </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of sHphz  column  on avgfile   </span>
<span class="sd">    max               float         maximum % value of sHphz</span>
<span class="sd">    min               float         minimum  value of sHphz</span>
<span class="sd">    loc               dict          location of sHphz magnitude</span>
<span class="sd">                                    value at the station lambda</span>
<span class="sd">                                    e.g : loc[&#39;S44&#39;] show the </span>
<span class="sd">                                    current  sHphz data of station at S44</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    </span>
<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg </span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">              &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; shphz_obj =avg_obj.Data_section.sHphz.loc[&#39;S44&#39;]</span>
<span class="sd">        ... print(shphz_obj)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sEphz_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                 <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_sEphz</span><span class="o">=</span> <span class="n">sEphz_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;to_degree&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sEphz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_sEphz_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_sEphz_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sEphz_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>  <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read and arange data according each station /Statistical variation </span>
<span class="sd">        of E-Field angles values </span>
<span class="sd"> </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * shphz_array : ndarray, </span>
<span class="sd">                            en rad E-Field phase observed </span>
<span class="sd">                            The default is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                                    number of frequencies for survey.</span>
<span class="sd">                                    The default is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                                number_of stations. The default is None.</span>
<span class="sd">            * to_degree : bool,</span>
<span class="sd">                        compute angle todegree . </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;to_degree&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_degree</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span> <span class="n">to_degree</span>
        
        <span class="k">if</span> <span class="n">sEphz_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sEphz</span> <span class="o">=</span><span class="n">sEphz_array</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sEphz</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>  <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No stat.variation&#39;</span>\
                                                                         <span class="s1">&#39; B-field-phase data found  !&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span> <span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>    
            
           
        <span class="k">def</span> <span class="nf">_inspect_input</span> <span class="p">(</span><span class="n">input_obj</span> <span class="p">,</span> <span class="n">to_degree</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Ascertain that the value is possible for computing. and put on </span>
<span class="sd">            ndarray (ndarray,1)</span>
<span class="sd">            &quot;&quot;&quot;</span>            
            <span class="k">try</span> <span class="p">:</span> 
                <span class="n">input_obj</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">input_obj</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span>  <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for computing are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">to_degree</span> <span class="p">:</span> <span class="n">input_obj</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">input_obj</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">input_obj</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">_sEphz</span><span class="o">=</span> <span class="n">_inspect_input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sEphz</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="p">:</span> <span class="c1">#---&gt; set angle to degree .</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sEphz</span> <span class="o">=</span><span class="n">_inspect_input</span><span class="p">(</span><span class="n">input_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sEphz</span><span class="p">,</span> <span class="n">to_degree</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>        
        
        <span class="c1"># --&gt; check the maximum angle value and minimum angle value.</span>
        <span class="n">vcounts_sEphz</span><span class="p">,</span> <span class="n">repeat_hphz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sEphz</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_sEphz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_sEphz</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_sEphz</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        <span class="c1">#---&gt; tuncated AVG sHphz value on  dictionnary for easy acces . </span>
        <span class="n">truncated_sEphz</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sEphz</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_sEphz</span><span class="p">)}</span></div>
        
<div class="viewcode-block" id="pcHmag"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.pcHmag">[docs]</a><span class="k">class</span> <span class="nc">pcHmag</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Statistical variation of magnitude values from averaged data blocks.</span>
<span class="sd">        Standard Deviation / Average Hmag (percent)</span>
<span class="sd">        </span>
<span class="sd">     Arguments :</span>
<span class="sd">     ----------</span>
<span class="sd">        **pcHmag**  : ndarray</span>
<span class="sd">                   data array of statistical variataion </span>
<span class="sd">                   of Hmag value on the field.</span>
<span class="sd">                  </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================= =========== =============================================</span>
<span class="sd">    value             nd.array      data of pcHmag  column  on avgfile</span>
<span class="sd">    max               float         maximum % value of pc Hmag</span>
<span class="sd">    min               float         minimum % value of pcHmag </span>
<span class="sd">    loc               dict          location of %Hphz magnitude</span>
<span class="sd">                                    value at the station lambda</span>
<span class="sd">                                    e:g . loc[&#39;S05&#39;] show the current  H-mag </span>
<span class="sd">                                    data  of station at S05.</span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg </span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...      &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; pchmag_obj =avg_obj.Data_section.pcHmag.loc[&#39;S05&#39;]</span>
<span class="sd">        &gt;&gt;&gt; print(pchmag_obj)</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pc_h_mag_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_pcHmag</span> <span class="o">=</span><span class="n">pc_h_mag_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pcHmag</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_pcHmag_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_pcHmag_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pc_h_mag_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read and arange data according each station /Statistical variation of </span>
<span class="sd">            B-Field magnitude values .</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * pc_h_mag_array : ndarray, optional</span>
<span class="sd">                            E-Field std variation  observed at each station. </span>
<span class="sd">                            The default is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                                    number of frequencies for survey. </span>
<span class="sd">                                    The default is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                                number_of stations. The default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pc_h_mag_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_pcHmag</span> <span class="o">=</span><span class="n">pc_h_mag_array</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pcHmag</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No B-mag statistical variation  data found  !&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
            
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pcHmag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pcHmag</span><span class="p">])</span>

        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for the B-mag stat.variation  are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
            
        <span class="n">vcounts_Hmag</span><span class="p">,</span> <span class="n">repeat_Hmag</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pcHmag</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_Hmag</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_Hmag</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_Hmag</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        
        <span class="n">truncated_pcHmag</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pcHmag</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_pcHmag</span><span class="p">)}</span> </div>


<div class="viewcode-block" id="sHphz"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.sHphz">[docs]</a><span class="k">class</span> <span class="nc">sHphz</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Statistical variation of the data blocks averaged for this data point.</span>
<span class="sd">        100 * Standard Deviation of Hphz values (milliradians)</span>
<span class="sd">        </span>
<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">        **shphz**  : ndarray</span>
<span class="sd">                data array of statistical variation of Emag </span>
<span class="sd">                value on the field.</span>
<span class="sd">                  </span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             nd.array      data of sHphz  column on avgfile   </span>
<span class="sd">    max               float         maximum % value of sHphz</span>
<span class="sd">    min               float         minimum  value of sHphz</span>
<span class="sd">    loc               dict          location of sHphz magnitude</span>
<span class="sd">                                    value at the station lambda. </span>
<span class="sd">                                    e:g : loc[&#39;S43&#39;] show the</span>
<span class="sd">                                    current  sHphz data of station at S43.</span>
<span class="sd">    ================  ===========  ============================================</span>

<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example: </span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg impor Avg </span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...      &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; shphz_obj =avg_obj.Data_section.sHphz.loc[&#39;S43&#39;]</span>
<span class="sd">        &gt;&gt;&gt; print(shphz_obj)</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shphz_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                 <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_sHphz</span><span class="o">=</span> <span class="n">shphz_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;to_degree&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sHphz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_sHphz_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_sHphz_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sHphz_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>  <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read and arange data according each station /Statistical variation </span>
<span class="sd">        of B-Field angles. </span>
<span class="sd">            values .</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * shphz_array : ndarray, en rad </span>
<span class="sd">                            E-Field phase observed . </span>
<span class="sd">                            The default is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                            number of frequencies for survey.</span>
<span class="sd">                            The default is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                         number_of stations. The default is None.</span>
<span class="sd">            * to_degree : bool,</span>
<span class="sd">                         compute angle todegree .</span>
<span class="sd">                     </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;to_degree&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_degree</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span> <span class="n">to_degree</span>
        
        <span class="k">if</span> <span class="n">sHphz_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sHphz</span> <span class="o">=</span><span class="n">sHphz_array</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sHphz</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>  <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No stat.variation&#39;</span>\
                                                                         <span class="s1">&#39; B-field-phase data found  !&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span> <span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>    
            
           
        <span class="k">def</span> <span class="nf">_inspect_input</span> <span class="p">(</span><span class="n">input_obj</span> <span class="p">,</span> <span class="n">to_degree</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Ascertain that the value is possible for computing. and put on </span>
<span class="sd">            ndarray (ndarray,1)</span>
<span class="sd">            &quot;&quot;&quot;</span>            
            <span class="k">try</span> <span class="p">:</span> 
                <span class="n">input_obj</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">input_obj</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span>  <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for computing are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">to_degree</span> <span class="p">:</span> 
                <span class="n">input_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">input_obj</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">input_obj</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">_sHphz</span><span class="o">=</span> <span class="n">_inspect_input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sHphz</span><span class="p">)</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="p">:</span> <span class="c1">#---&gt; set angle to degree .</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sHphz</span> <span class="o">=</span><span class="n">_inspect_input</span><span class="p">(</span><span class="n">input_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sHphz</span><span class="p">,</span> <span class="n">to_degree</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>        
        
        <span class="c1"># --&gt; check the maximum angle value and minimum angle value.</span>
        <span class="n">vcounts_shphz</span><span class="p">,</span> <span class="n">repeat_hphz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sHphz</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_shphz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_shphz</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_shphz</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        <span class="c1">#---&gt; tuncated AVG sHphz value on  dictionnary for easy acces . </span>
        <span class="n">truncated_shphz</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sHphz</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_shphz</span><span class="p">)}</span></div>
        
    
<div class="viewcode-block" id="pcRho"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.pcRho">[docs]</a><span class="k">class</span> <span class="nc">pcRho</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Statistical variation of magnitude values </span>
<span class="sd">    from averaged data blocks.</span>
<span class="sd">    Standard Deviation / Average Rho (percent)</span>
<span class="sd">        </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **pcRes** : ndarray</span>
<span class="sd">               statistical variation averaged rho.</span>


<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    value             ndarray       data of pcRho column  on avgfile </span>
<span class="sd">    max               float         maximum % value of pcRho</span>
<span class="sd">    min               float         minimu % value of pcRho </span>
<span class="sd">    loc               dict          location of %Rho magnitude</span>
<span class="sd">                                    value at  the station lambda .</span>
<span class="sd">                                    e:g : loc[&#39;S07&#39;] show  the current  H-mag </span>
<span class="sd">                                    data of station at S07.</span>
<span class="sd">    ================  ===========  ============================================</span>
<span class="sd">    </span>
<span class="sd">     More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example: </span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg import Avg</span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">                          &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; pcrho_obj =avg_obj.Data_section.pcRho.loc[&#39;S00&#39;]</span>
<span class="sd">        ... print(pcrho.loc[&#39;S00&#39;])</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcRes_array</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span>
                 <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                 <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">_pcRes</span><span class="o">=</span><span class="n">pcRes_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sres</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;added_astatic_rho_array&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pcRes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_pcRes_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_pcRes_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcRes_array</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Sres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span>  <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read resitivity  according each station /standard deviation *100</span>
<span class="sd">        for resistivity  values .</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            * pcRes_array: ndarray, en ohm.m</span>
<span class="sd">                            Resistivity calculated  on the field.</span>
<span class="sd">                            The default is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                            number of frequencies for survey. </span>
<span class="sd">                            The default is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                            number_of stations. </span>
<span class="sd">                            The default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">pcRes_array</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_pcRes</span><span class="o">=</span> <span class="n">pcRes_array</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pcRes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No Resistivity data found !&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
        
        <span class="k">try</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pcRes</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pcRes</span><span class="p">])</span>

        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for the Resistivities are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
        
        <span class="n">vcounts_pcres</span><span class="p">,</span> <span class="n">repeat_hphz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pcRes</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">repeat_hphz</span><span class="p">):</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s1">&#39;Values of Rho provided must have the same length&#39;</span>\
                                                           <span class="s1">&#39; for each stations. &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_pcres</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_pcres</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_pcres</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pcRes</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">truncated_pcres</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pcRes</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_pcres</span> <span class="p">)}</span></div>
        

<div class="viewcode-block" id="sPhz"><a class="viewcode-back" href="../../../../csamt.html#pycsamt.ff.core.avg.sPhz">[docs]</a><span class="k">class</span> <span class="nc">sPhz</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Statistical variation of the data blocks averaged for this data point.</span>
<span class="sd">        100 * Standard Deviation of Phase values (milliradians)</span>
<span class="sd">        </span>
<span class="sd">    Arguments </span>
<span class="sd">    ----------</span>
<span class="sd">        **sphz array** : array_like </span>
<span class="sd">                coefficient of  phase variation arrqy </span>
<span class="sd">        **path to avg**:str</span>
<span class="sd">                full path to filename </span>
<span class="sd">                  </span>
<span class="sd">    Holds the following informations:</span>
<span class="sd">        </span>
<span class="sd">    ================  ==========  =============================================</span>
<span class="sd">    Attributes         Type        Explanation</span>
<span class="sd">    ================  ==========  =============================================</span>
<span class="sd">    value             nd.array      data of sPhz  column on avgfile   </span>
<span class="sd">    max               float         maximum % value of sHphz</span>
<span class="sd">    min               float         minimu  value of sHphz</span>
<span class="sd">    loc               dict          location of sPhz magnitude value at </span>
<span class="sd">                                    the station lambda .</span>
<span class="sd">                                    e:g - loc[&#39;S07&#39;] show the current  sPhz data </span>
<span class="sd">                                    of station at S07.</span>
<span class="sd">    ================  ==========  =============================================</span>
<span class="sd">    </span>
<span class="sd">    More attributes can be added by inputing a key word dictionary</span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>

<span class="sd">        &gt;&gt;&gt; from pycsamt.ff.core.avg impor Avg</span>
<span class="sd">        &gt;&gt;&gt; path=os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">        ...     &#39;pycsamt&#39;, &quot;data&quot;, &quot;K1.AVG&quot;)</span>
<span class="sd">        &gt;&gt;&gt; avg_obj=Avg(path)</span>
<span class="sd">        &gt;&gt;&gt; shphz_obj =avg_obj.Data_section.sHphz.loc[&#39;43&#39;]</span>
<span class="sd">        ... print(shphz_obj)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sPhase_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                 <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_sPhs</span><span class="o">=</span> <span class="n">sPhase_array</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;number_of_stations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_frequencies&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;to_degree&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="kc">None</span> 
    
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sPhs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_sPhs_data</span> <span class="p">()</span>
        
        
    <span class="k">def</span> <span class="nf">_read_sPhz_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sPhase_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_frequencies</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                         <span class="n">number_of_stations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>  <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to read and arange data according each station /Statistical variation </span>
<span class="sd">        of zPhase -Field angles. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ------------</span>
<span class="sd">            * shphz_array : ndarray, en rad </span>
<span class="sd">                        E-Field phase observed . </span>
<span class="sd">                        The default is None.</span>
<span class="sd">            * number_of_frequencies : int , optional</span>
<span class="sd">                        number of frequencies for survey.</span>
<span class="sd">                        The default is None.</span>
<span class="sd">            * number_of_stations : int , optional</span>
<span class="sd">                        number_of stations. </span>
<span class="sd">                        The default is None.</span>
<span class="sd">            * to_degree : bool,</span>
<span class="sd">                        compute angle todegree . </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_degree</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;to_degree&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_degree</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="o">=</span> <span class="n">to_degree</span>
            
        
        <span class="k">if</span> <span class="n">sPhase_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sPhs</span> <span class="o">=</span><span class="n">sPhase_array</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sPhs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>  <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No stat.variation&#39;</span>\
                                                                         <span class="s1">&#39; Impedance Z -phase data found  !&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_frequencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="o">=</span> <span class="n">number_of_frequencies</span> 
        <span class="k">else</span> <span class="p">:</span><span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s2">&quot;Please specify the number of frequency !&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number_of_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">number_of_stations</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Please specify the number of stations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">)</span>    
            
           
        <span class="k">def</span> <span class="nf">_inspect_input</span> <span class="p">(</span><span class="n">input_obj</span> <span class="p">,</span> <span class="n">to_degree</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Ascertain that the value is possible for computing. and put on </span>
<span class="sd">            ndarray (ndarray,1) and convert angle as possible to degree.</span>
<span class="sd">            &quot;&quot;&quot;</span>            
            <span class="k">try</span> <span class="p">:</span> 
                <span class="n">input_obj</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">input_obj</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span>  <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_value</span><span class="p">(</span><span class="s2">&quot;Values provided for computing are wrong.&quot;</span>\
                                          <span class="s2">&quot; must be float or integer .&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">to_degree</span> <span class="p">:</span> <span class="n">input_obj</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">input_obj</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">input_obj</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">_sPhs</span><span class="o">=</span><span class="n">_inspect_input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sPhs</span><span class="p">)</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_degree</span> <span class="p">:</span> <span class="c1">#---&gt; set angle to degree .</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sPhs</span> <span class="o">=</span><span class="n">_inspect_input</span><span class="p">(</span><span class="n">input_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sPhs</span><span class="p">,</span> <span class="n">to_degree</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>        
        
        <span class="c1"># --&gt; check the maximum angle value and minimum angle value.</span>
        <span class="n">vcounts_sphz</span><span class="p">,</span> <span class="n">repeat_hphz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sPhs</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span><span class="n">vcounts_sphz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span><span class="n">vcounts_sphz</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vcounts_sphz</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        
        <span class="c1">#---&gt; tuncated AVG sHphz value on  dictionnary for easy acces . </span>
        <span class="n">truncated_sphz</span><span class="o">=</span><span class="n">cfunc</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sPhs</span><span class="p">,</span> 
                                       <span class="n">number_of_reccurence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">polyname</span> <span class="o">=</span> <span class="n">cfunc</span><span class="o">.</span><span class="n">_numbering_station</span><span class="p">(</span><span class="n">number_of_station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_stations</span><span class="p">,</span> 
                               <span class="n">number_of_freq</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nfreq</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span><span class="p">{</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">truncated_sphz</span><span class="p">)}</span></div>
        
        

        


    

    
    
    
    
        
    

</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">pyCSAMT v1.0.03 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Kouadio K. Laurent.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
    </div>
  </body>
</html>