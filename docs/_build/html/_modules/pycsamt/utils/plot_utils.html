
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pycsamt.utils.plot_utils &#8212; pyCSAMT v1.0.03 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pyCSAMT v1.0.03 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pycsamt.utils.plot_utils</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">===============================================================================</span>
<span class="sd">    Copyright Â© 2021  Kouadio K.Laurent</span>
<span class="sd">    </span>
<span class="sd">    This file is part of pyCSAMT.</span>
<span class="sd">    </span>
<span class="sd">    pyCSAMT is free software: you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">    the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>
<span class="sd">    </span>
<span class="sd">    pyCSAMT is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU Lesser General Public License for more details.</span>
<span class="sd">    </span>
<span class="sd">    You should have received a copy of the GNU Lesser General Public License</span>
<span class="sd">    along with pyCSAMT.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>

<span class="sd">===============================================================================</span>

<span class="sd">.. _module-Plot_Utils:: `pycsamt.utils.plot_utils` </span>
<span class="sd">    :synopsis: helpers functions for visualization </span>
<span class="sd">    </span>
<span class="sd">Created on Tue Dec 29 19:18:44 2020</span>

<span class="sd">@author: @Daniel03</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">re</span> <span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pycsamt.etc.infos</span> <span class="kn">import</span> <span class="n">_sensitive</span> <span class="k">as</span> <span class="n">SB</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span> 
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsamt.utils</span> <span class="kn">import</span> <span class="n">exceptions</span> <span class="k">as</span> <span class="n">CSex</span> 
<span class="kn">from</span> <span class="nn">pycsamt.utils.decorator</span> <span class="kn">import</span> <span class="n">deprecated</span><span class="p">,</span> <span class="n">redirect_cls_or_func</span>


<div class="viewcode-block" id="share_props_for_each_plot"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.share_props_for_each_plot">[docs]</a><span class="k">def</span> <span class="nf">share_props_for_each_plot</span><span class="p">(</span><span class="n">number_of_plot</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to set properties for each plot. Easy to customize line and markers.</span>
<span class="sd">    Function can add other properties which are not in kwargs.keys(). </span>
<span class="sd">    It will set according the number of subplotsplots </span>
<span class="sd">    we assume subplot are define on one columns </span>
<span class="sd">    </span>
<span class="sd">    :param number_of_plot: number of subsplot you want show.</span>
<span class="sd">    :type number_of_plot: int </span>
<span class="sd">    </span>
<span class="sd">    :returns: dictionarry of labels and properties. </span>
<span class="sd">    :rtype: dict </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        set multiple labels </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labelprops</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="n">labelprops</span><span class="o">=</span><span class="p">[</span><span class="n">labelprops</span><span class="p">]</span> 
            
        <span class="c1"># labelprops= [&quot;;&quot;, &#39;y&#39;]</span>
        <span class="c1"># chech is the label properties is str , user can forget to put on list , function  will check </span>
        <span class="c1"># at least if there is comma &quot;, &quot; or double point &quot;:&quot; then it will put it on list . </span>
        <span class="k">if</span>  <span class="nb">isinstance</span> <span class="p">(</span><span class="n">labelprops</span><span class="p">,</span> <span class="nb">str</span> <span class="p">):</span> 
            <span class="c1"># if re.match(r&#39;,&#39;, labelprops) is not None  : labelprops= labelprops.split(&#39;,&#39;)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">labelprops</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">labelprops</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span> 
                <span class="n">labelprops</span><span class="o">=</span><span class="n">labelprops</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                <span class="n">labelprops</span> <span class="o">=</span> <span class="n">labelprops</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">labelprops</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span><span class="n">labelprops</span><span class="o">=</span> <span class="n">labelprops</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">labelprops</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="o">&gt;</span><span class="mi">0</span> <span class="p">:</span> <span class="n">labelprops</span> <span class="o">=</span> <span class="n">labelprops</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span><span class="n">labelprops</span><span class="o">=</span><span class="p">[</span><span class="n">labelprops</span><span class="p">]</span>
            
        <span class="c1">#set the default properties if not use the first element of provide properties.</span>
        
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>  <span class="n">lbproperty</span> <span class="o">=</span> <span class="p">[</span><span class="n">default</span> <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_plot</span><span class="p">)]</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">lbproperty</span> <span class="o">=</span> <span class="p">[</span><span class="n">labelprops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_plot</span><span class="p">)]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labelprops</span><span class="p">)</span>  <span class="o">&lt;</span> <span class="n">number_of_plot</span> <span class="p">:</span> 
           <span class="n">lbproperty</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">labelprops</span><span class="p">)]</span><span class="o">=</span><span class="n">labelprops</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">labelprops</span><span class="p">)</span>  <span class="o">&gt;</span> <span class="n">number_of_plot</span> <span class="p">:</span>
            <span class="n">lbproperty</span> <span class="o">=</span> <span class="n">labelprops</span><span class="p">[:</span><span class="n">number_of_plot</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">labelprops</span><span class="p">)</span>  <span class="o">==</span>  <span class="n">number_of_plot</span> <span class="p">:</span> 
            <span class="n">lbproperty</span> <span class="o">=</span> <span class="n">labelprops</span>
        
        <span class="c1"># else :raise CSex.pyCSAMTError_plot_tip(&#39;Number of argument of label properties&#39;\</span>
        <span class="c1">#                                         &#39; provided doesnt not match the number of subplots. Please rectify the numve&#39;)</span>
        <span class="k">return</span> <span class="n">lbproperty</span> 

    <span class="c1"># linewidth =</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lw&#39;</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)</span> <span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
    
    <span class="n">linestyle</span><span class="o">=</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">,</span><span class="mf">2.</span><span class="p">)</span> <span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
    <span class="n">color</span><span class="o">=</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    
    <span class="n">marker</span><span class="o">=</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
   
    <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markerfacecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">markeredgecolor</span> <span class="o">=</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markeredgecolor&#39;</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    
    <span class="n">rotate_angle_xticklabels</span><span class="o">=</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span> <span class="p">(</span><span class="s1">&#39;xtick_label_rotation&#39;</span><span class="p">,</span><span class="mf">45.</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mf">45.</span><span class="p">)</span>
    <span class="n">rotate_angle_yticklabels</span><span class="o">=</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ytick_label_rotation&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    
    <span class="n">x_ticks_labelsize</span> <span class="o">=</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xtick_label_size&#39;</span><span class="p">,</span> <span class="mf">12.</span><span class="p">)</span> <span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">12.</span><span class="p">)</span>
    <span class="n">y_ticks_labelsize</span><span class="o">=</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ytick_label_size&#39;</span><span class="p">,</span> <span class="mf">12.</span><span class="p">)</span> <span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">12.</span><span class="p">)</span>

    <span class="c1"># dict of labelproperties.</span>
    <span class="n">kws</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="n">linewidth</span><span class="p">,</span> 
          <span class="s1">&#39;ls&#39;</span><span class="p">:</span><span class="n">linestyle</span><span class="p">,</span> 
          <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="n">marker</span><span class="p">,</span> 
          <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">color</span><span class="p">,</span> 
          <span class="s1">&#39;markerfacecolor&#39;</span><span class="p">:</span><span class="n">markerfacecolor</span><span class="p">,</span> 
          <span class="s1">&#39;markeredgecolor&#39;</span><span class="p">:</span><span class="n">markeredgecolor</span><span class="p">,</span> 
          <span class="s1">&#39;xtick_label_rotation&#39;</span><span class="p">:</span><span class="n">rotate_angle_xticklabels</span><span class="p">,</span> 
          <span class="s1">&#39;ytick_label_rotation&#39;</span><span class="p">:</span><span class="n">rotate_angle_yticklabels</span><span class="p">,</span> 
          <span class="s1">&#39;xtick_label_size&#39;</span><span class="p">:</span><span class="n">x_ticks_labelsize</span> <span class="p">,</span> 
          <span class="s1">&#39;ytick_label_size&#39;</span><span class="p">:</span><span class="n">y_ticks_labelsize</span><span class="p">}</span>

    <span class="c1">#can add other properties which are not in kwargs .keys ()</span>
    <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">keys</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kws</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">kws</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">set_multiple</span><span class="p">(</span><span class="n">labelprops</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">]))</span>
        
    
    <span class="k">return</span> <span class="n">kws</span></div>

<div class="viewcode-block" id="find_path"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.find_path">[docs]</a><span class="k">def</span> <span class="nf">find_path</span> <span class="p">(</span><span class="n">path</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ptol</span> <span class="o">=</span><span class="mf">0.7</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    check path and return filepath , edipath or jpath .</span>
<span class="sd">    </span>
<span class="sd">    :param path: full  path  to `edi`, `avag` or `j` file or directory </span>
<span class="sd">    :type path: str </span>
<span class="sd">    </span>
<span class="sd">    :param ptol:  tolerance that given by the program to judge if the number </span>
<span class="sd">                    of typical file [EDI|J] </span>
<span class="sd">                    to declare as path found is either &quot;edipath&quot; or &quot;jpath&quot; </span>
<span class="sd">                    if none ,return None . less or equal to 1.</span>
<span class="sd">                    </span>
<span class="sd">    :type ptol: float </span>
<span class="sd">    </span>
<span class="sd">    :returns: specific path </span>
<span class="sd">    :rtype: str </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Can not find path to read.please provided a datapath . &#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span> <span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;isfile&#39;</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">ex</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;.edi&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">))</span><span class="o">&gt;=</span> <span class="n">ptol</span> <span class="p">:</span><span class="k">return</span> <span class="s1">&#39;edipath&#39;</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">ptol</span> <span class="p">:</span> 
                    <span class="n">m</span><span class="o">=</span><span class="p">[]</span>
                    <span class="k">try</span> <span class="p">:</span> <span class="n">m</span><span class="o">=</span> <span class="p">[</span><span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="n">SB</span><span class="o">.</span><span class="n">which_file</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span> <span class="o">==</span><span class="s1">&#39;j&#39;</span> <span class="p">]</span>
                    <span class="k">except</span> <span class="p">:</span> <span class="k">pass</span> 
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">ptol</span> <span class="p">:</span><span class="k">return</span> <span class="s1">&#39;jpath&#39;</span>
                        
        <span class="k">return</span> </div>
                
<div class="viewcode-block" id="get_stationid"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.get_stationid">[docs]</a><span class="k">def</span> <span class="nf">get_stationid</span> <span class="p">(</span><span class="n">stations</span> <span class="p">,</span>  <span class="n">station_id</span><span class="p">)</span> <span class="p">:</span>  
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tip to get station id from user by input either integer of station name .</span>
<span class="sd">    </span>
<span class="sd">    :param stations:  list of stations known</span>
<span class="sd">    :type stations: list</span>
<span class="sd">    </span>
<span class="sd">    :param station_id: staion expect to plot.</span>
<span class="sd">    :type station_id: list, str, or int </span>
<span class="sd">            </span>
<span class="sd">    :returns: constructed list for plotting</span>
<span class="sd">    :rtype: array_like </span>
<span class="sd">    </span>
<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.utils import plot_utils as punc</span>
<span class="sd">        &gt;&gt;&gt; teslist = [&#39;S{0:02}&#39;.format(ii) for ii in range(23)]</span>
<span class="sd">        &gt;&gt;&gt; ss = punc.get_stationid (stations=teslist ,  station_id=(&#39;S04&#39;,13))</span>
<span class="sd">        &gt;&gt;&gt; print(ss)</span>
<span class="sd">    &quot;&quot;&quot;</span>                
    
    <span class="n">sid</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">station_id</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="p">:</span> <span class="n">station_id</span> <span class="o">=</span><span class="p">[</span><span class="n">station_id</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">iid</span> <span class="ow">in</span> <span class="n">station_id</span> <span class="p">:</span> 
        <span class="k">if</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="n">iid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
           <span class="k">for</span> <span class="n">ss</span> <span class="p">,</span> <span class="n">stn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stations</span> <span class="p">):</span> 
               <span class="k">if</span> <span class="n">iid</span>  <span class="o">==</span><span class="n">stn</span> <span class="p">:</span> <span class="n">sid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stn</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iid</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span> 
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">iid</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">stations</span><span class="p">):</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;maximum station number is &lt;</span><span class="si">{0}</span><span class="s1">&gt;.&#39;</span>\
                                                 <span class="s1">&#39;Can not plot beyond this limit. Your stations go to &lt;</span><span class="si">{1}</span><span class="s1">,...,</span><span class="si">{2}</span><span class="s1">&gt;&#39;</span><span class="o">.</span>\
                                                     <span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stations</span><span class="p">),</span> <span class="n">stations</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                  
            <span class="n">sid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stations</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">iid</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#  the stations numberred start from 1 to len(stations)</span>

    <span class="k">return</span> <span class="n">sid</span> </div>
    
<div class="viewcode-block" id="get_frequency_id"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.get_frequency_id">[docs]</a><span class="k">def</span> <span class="nf">get_frequency_id</span> <span class="p">(</span><span class="n">freq_array</span> <span class="p">,</span> <span class="n">frequency_id</span> <span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to get id of frequency . Frequency to plot</span>
<span class="sd">    </span>
<span class="sd">    :param freq_array:  array of frequency</span>
<span class="sd">    :type freq_array:  nd.array,1 </span>
<span class="sd">    </span>
<span class="sd">    :param frequency_id:  frequency to plot .</span>
<span class="sd">    :type frequency_id: list or float  </span>
<span class="sd">    </span>
<span class="sd">    :returns: new close frequency id</span>
<span class="sd">    :rtype: float|list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">freqID</span> <span class="o">=</span><span class="p">[]</span> 
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">freq_array</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="p">:</span> <span class="n">freq_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">freq_array</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frequency_id</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span> <span class="n">frequency_id</span> <span class="o">=</span><span class="p">[</span><span class="n">frequency_id</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">freqid</span> <span class="ow">in</span> <span class="n">frequency_id</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">freqid</span> <span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">try</span> <span class="p">:</span> <span class="n">freqid</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">freqid</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Frequency value must be an integer of float not str &#39;</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">freq_array</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">freqid</span> <span class="o">&gt;</span> <span class="n">freq_array</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Can not find the id &lt;</span><span class="si">{0}</span><span class="s1">&gt;. ID provided is out of the range.Frequency trend to: &lt;</span><span class="si">{1}</span><span class="s1">|</span><span class="si">{2}</span><span class="s1">Hz to </span><span class="si">{3}</span><span class="s1">|</span><span class="si">{4}</span><span class="s1">Hz&gt;.&#39;</span><span class="o">.</span>\
                                                    <span class="nb">format</span><span class="p">(</span><span class="n">freqid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">freq_array</span><span class="o">==</span><span class="n">freq_array</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span><span class="n">freq_array</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                                           <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">freq_array</span><span class="o">==</span><span class="n">freq_array</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="n">freq_array</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;frequency value &lt;</span><span class="si">{0}</span><span class="s1">Hz&gt; is out of the range&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">freqid</span><span class="p">))</span>
        <span class="n">freqID</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">freqid</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">freqID</span></div>

<div class="viewcode-block" id="slice_matrix"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.slice_matrix">[docs]</a><span class="k">def</span> <span class="nf">slice_matrix</span> <span class="p">(</span><span class="n">base_matrix</span> <span class="p">,</span> <span class="n">freq_array</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="mi">2000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function get a matrix and give new matrice slice from limit value  </span>

<span class="sd">    :param base_matrix: arrays (yaxis lenghth, station_length)</span>
<span class="sd">    :type base_matrix: ndarray</span>
<span class="sd">    </span>
<span class="sd">    :param freq_array:  frequency array range </span>
<span class="sd">    :type freq_array: ndarray,1 </span>
<span class="sd">    </span>
<span class="sd">    :param doi: expect to be the depth of investigation from </span>
<span class="sd">                    which data muts be selected in `m` or `km` </span>
<span class="sd">    :type doi:float </span>
<span class="sd">    </span>
<span class="sd">    :returns: matrix sliced according to doi</span>
<span class="sd">    :rtype: ndarray </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fm</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">if</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">doi</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">doi</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span>
                <span class="n">ndoi</span> <span class="o">=</span> <span class="n">doi</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">fm</span><span class="o">=</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="n">doi</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span><span class="n">ndoi</span> <span class="o">=</span> <span class="n">doi</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">try</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">ndoi</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Can not convert &lt;</span><span class="si">{0}</span><span class="s1">&gt; into float number. &#39;</span>\
                               <span class="s1">&#39;Depth of investigation value must be float number.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">doi</span><span class="p">))</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Value provided &lt;</span><span class="si">{0}</span><span class="s1">&gt; must be float number not &lt;</span><span class="si">{1}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">doi</span><span class="p">)))</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">fm</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">*=</span> <span class="mf">1e3</span>   <span class="c1"># convert into m</span>
        
    <span class="n">doi</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">doi</span><span class="p">)</span> <span class="c1"># for consistency , convert to float</span>
    <span class="n">indexMatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">base_matrix</span> <span class="o">&gt;=</span> <span class="n">doi</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># take the first lien that value is greater than </span>

    <span class="k">return</span> <span class="n">base_matrix</span><span class="p">[:</span><span class="n">indexMatrix</span><span class="p">,</span> <span class="p">::],</span> <span class="n">freq_array</span><span class="p">[:</span><span class="n">indexMatrix</span><span class="p">],</span> <span class="n">doi</span> </div>
    
<div class="viewcode-block" id="delineate_curve"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.delineate_curve">[docs]</a><span class="k">def</span> <span class="nf">delineate_curve</span> <span class="p">(</span> <span class="n">dict_loc</span> <span class="p">,</span> <span class="n">value</span> <span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">replace_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to delineate value of rho and phase .</span>
<span class="sd">    </span>
<span class="sd">    :param dict_loc:  dictionnary composed of keys = stations id and values</span>
<span class="sd">    :type  dict_loc: dict </span>
<span class="sd">    </span>
<span class="sd">    :param value: value to delineate curve . for single value. </span>
<span class="sd">    :type  value: float |list </span>
<span class="sd">    </span>
<span class="sd">    :param atol: tolerance parameter &lt;=1 . Most the param is closest to 0 , </span>
<span class="sd">                 most the selected data become severe.default is 0.2</span>
<span class="sd">    :type atol: float   </span>
<span class="sd">                     </span>
<span class="sd">    :param replace_value: could be None or np.nan , Default is np.nan</span>
<span class="sd">    :type replace_value: float or else</span>
<span class="sd">                    </span>
<span class="sd">    :returns: dict of delineate data</span>
<span class="sd">    :rtype: dict</span>

<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.utils import plot_utils as punc</span>
<span class="sd">        &gt;&gt;&gt; ts = np.array([0.1, 0.7, 2, 3, 8, 1000, 58,55, 85, 18])</span>
<span class="sd">        &gt;&gt;&gt; to =np.array([51, 78, 0.25, 188, 256, 7])</span>
<span class="sd">        &gt;&gt;&gt; tt ={&#39;S00&#39;: ts, &#39;S01&#39;:to, &#39;S02&#39;: np.array([0, 5, 125, 789])}</span>
<span class="sd">        &gt;&gt;&gt; print(punc.delineate_curve(dict_loc = tt, value=[50,70], atol = 0.1))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span> 
        <span class="k">try</span> <span class="p">:</span> <span class="n">value</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Delineation value is float number not &lt;</span><span class="si">{0}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Input delineation value is unacceptable. Please enter a float number.&#39;</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">value</span> <span class="o">=</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
        
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">())):</span> 
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span><span class="nb">tuple</span> <span class="p">:</span> <span class="n">value</span> <span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">try</span> <span class="p">:</span> 
            <span class="n">value</span> <span class="o">=</span><span class="nb">sorted</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">value</span><span class="p">])</span> 
        <span class="k">except</span> <span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Delineation value is float number not &lt;</span><span class="si">{0}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Input delineation value is unacceptable. Please enter a float number.&#39;</span><span class="p">)</span>
    <span class="k">try</span> <span class="p">:</span> 
        <span class="n">atol</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">atol</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">atol</span> <span class="o">&gt;</span> <span class="mi">1</span>  <span class="ow">or</span> <span class="n">atol</span> <span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Tolerance value is &lt;=1 (less or egal than 1). Please enter again a new value.&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Tolerance value is assumed to be 0&lt;= atol &lt;=1 .Please check your value.&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">:</span> 
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Tolerance value &lt;</span><span class="si">{0}</span><span class="s1">&gt; provided is wrong. Must be a float number 0&lt;= atol &lt;=1  not a &lt;</span><span class="si">{1}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">atol</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>
        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Unacceptable type tolerance value. Please enter a float number 0&lt;= atol &lt;=1.&#39;</span><span class="p">)</span>
    
    <span class="c1"># loop dictionnary an dkey value .</span>
    <span class="n">delineate_dict</span> <span class="o">=</span><span class="p">{}</span>

    <span class="k">for</span> <span class="n">value_to_find</span>  <span class="ow">in</span> <span class="n">value</span> <span class="p">:</span>
        <span class="n">delineate_data_curve</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">value_in_dict</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dict_loc</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">value_to_find</span> <span class="ow">in</span> <span class="n">value_in_dict</span><span class="p">:</span> 
                 <span class="n">delineate_data_curve</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value_to_find</span><span class="p">)</span>      <span class="c1"># if find , the best one , append it .</span>
            <span class="k">elif</span>  <span class="n">value_to_find</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">value_in_dict</span><span class="p">:</span> 
                <span class="n">tem</span><span class="o">=</span><span class="p">[]</span>
                <span class="n">min_value</span> <span class="o">=</span> <span class="n">value_to_find</span> <span class="o">-</span> <span class="n">atol</span> <span class="o">*</span> <span class="n">value_to_find</span> <span class="c1"># find min max value closest to valueto find</span>
                <span class="n">max_value</span> <span class="o">=</span> <span class="n">value_to_find</span> <span class="o">+</span> <span class="n">atol</span> <span class="o">*</span> <span class="n">value_to_find</span>
                <span class="k">for</span> <span class="n">new_turn_value</span>  <span class="ow">in</span> <span class="n">value_in_dict</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">min_value</span> <span class="o">&lt;=</span> <span class="n">new_turn_value</span> <span class="o">&lt;=</span> <span class="n">max_value</span>  <span class="p">:</span> 
                        <span class="n">tem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_turn_value</span><span class="p">)</span>       
                <span class="k">if</span> <span class="n">tem</span><span class="o">==</span><span class="p">[]</span> <span class="p">:</span> 
                    <span class="n">delineate_data_curve</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replace_value</span><span class="p">)</span>         <span class="c1"># append None value outside the tolerance param.</span>
                <span class="k">elif</span> <span class="n">tem</span> <span class="o">!=</span><span class="p">[]:</span> 
                    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tem</span><span class="p">)</span> <span class="o">-</span> <span class="n">value_to_find</span><span class="p">)</span>
                    <span class="n">minimum</span> <span class="o">=</span> <span class="n">dx</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
                    <span class="n">valueabs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tem</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">dx</span> <span class="o">==</span> <span class="n">minimum</span><span class="p">)]</span> 
                    <span class="n">delineate_data_curve</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">valueabs</span><span class="p">)</span> <span class="p">)</span>
       
        <span class="n">delineate_dict</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value_to_find</span><span class="p">)]</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">delineate_data_curve</span><span class="p">)</span>
  
    <span class="k">return</span> <span class="n">delineate_dict</span></div>
                    
<div class="viewcode-block" id="delineate_sparseMatrix"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.delineate_sparseMatrix">[docs]</a><span class="k">def</span> <span class="nf">delineate_sparseMatrix</span> <span class="p">(</span><span class="n">dict_loc</span><span class="p">,</span> <span class="n">delineate_dict</span><span class="p">,</span> <span class="n">replace_value</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build from delineate dict a matrix according to frequency length . value doesnt </span>
<span class="sd">    exist in the delineate dict will be repalce by replacevalue . Default is `nan`.</span>
<span class="sd">    </span>
<span class="sd">    :param delineate_dict: delineation value </span>
<span class="sd">    :type delineate_dict: dict</span>
<span class="sd">    </span>
<span class="sd">    :param dict_loc: dictionnary composed of keys = stations id and values</span>
<span class="sd">    :type dict_loc: dict </span>
<span class="sd">    </span>
<span class="sd">    :param replace_value: value to replece other value  like build a sparse matrix </span>
<span class="sd">    :type replace_value: float </span>
<span class="sd">    </span>
<span class="sd">    :returns: dit of sparse matrix </span>
<span class="sd">    :rtype: dict </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dictMatrix</span> <span class="o">=</span><span class="p">{}</span>
    <span class="n">dict_loc</span> <span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">dict_loc</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">dd</span><span class="p">,</span> <span class="p">(</span> <span class="n">keys</span> <span class="p">,</span> <span class="n">dvalues</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dict_loc</span><span class="p">):</span> 
        
        <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="p">(</span><span class="n">keyi</span><span class="p">,</span> <span class="n">vv</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">delineate_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="n">dd</span><span class="p">]):</span> 
        <span class="c1">#     if vv[dd] !=np.nan : </span>
            <span class="n">os</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dvalues</span><span class="o">==</span><span class="n">vv</span><span class="p">[</span><span class="n">dd</span><span class="p">],</span> <span class="n">dvalues</span><span class="p">,</span> <span class="n">replace_value</span><span class="p">)</span>
            <span class="n">dictMatrix</span><span class="p">[</span><span class="n">keyi</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span>
            <span class="k">if</span> <span class="n">vv</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span> <span class="o">==</span> <span class="n">replace_value</span> <span class="p">:</span> 
                <span class="n">dictMatrix</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">replace_value</span><span class="p">,</span> <span class="n">dvalues</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
    <span class="k">return</span> <span class="n">dictMatrix</span></div>

<div class="viewcode-block" id="resetting_ticks"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.resetting_ticks">[docs]</a><span class="k">def</span> <span class="nf">resetting_ticks</span> <span class="p">(</span> <span class="n">get_xyticks</span><span class="p">,</span>  <span class="n">number_of_ticks</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    resetting xyticks  modulo , 100</span>
<span class="sd">    </span>
<span class="sd">    :param get_xyticks:  xyticks list  , use to ax.get_x|yticks()</span>
<span class="sd">    :type  get_xyticks: list </span>
<span class="sd">    </span>
<span class="sd">    :param number_of_ticks:  maybe the number of ticks on x or y axis </span>
<span class="sd">    :type number_of_ticks: int</span>
<span class="sd">    </span>
<span class="sd">    :returns: a new_list or ndarray </span>
<span class="sd">    :rtype: list or array_like </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">get_xyticks</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="p">):</span> 
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Arguments get_xyticks must be a list not &lt;</span><span class="si">{0}</span><span class="s1">&gt;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">get_xyticks</span><span class="p">)))</span>
        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;&lt;</span><span class="si">{0}</span><span class="s1">&gt; found. &quot;get_xyticks&quot; must be a list or (nd.array,1).&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">get_xyticks</span><span class="p">)))</span>
    
    <span class="k">if</span> <span class="n">number_of_ticks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_xyticks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">:</span> 
            <span class="n">number_of_ticks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">get_xyticks</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">number_of_ticks</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_xyticks</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">number_of_ticks</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span> 
        <span class="k">try</span> <span class="p">:</span> <span class="n">number_of_ticks</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">number_of_ticks</span><span class="p">)</span> 
        <span class="k">except</span> <span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;&quot;Number_of_ticks&quot; arguments is the times to see the ticks on x|y axis.&#39;</span>\
                          <span class="s1">&#39; Must be integer not &lt;</span><span class="si">{0}</span><span class="s1">&gt;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">number_of_ticks</span><span class="p">)))</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;&lt;</span><span class="si">{0}</span><span class="s1">&gt; detected. Must be integer.&#39;</span><span class="p">)</span>
        
    <span class="n">number_of_ticks</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">number_of_ticks</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_xyticks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">:</span>
        <span class="k">if</span> <span class="n">get_xyticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">%</span><span class="mi">10</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">:</span> 
            <span class="n">get_xyticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span><span class="n">get_xyticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">10</span> <span class="o">-</span> <span class="n">get_xyticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">%</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">get_xyticks</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">%</span><span class="mi">10</span>  <span class="o">!=</span><span class="mi">0</span> <span class="p">:</span> 
            <span class="n">get_xyticks</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span><span class="n">get_xyticks</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span><span class="n">get_xyticks</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">%</span><span class="mi">10</span>
    
        <span class="n">new_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">get_xyticks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_xyticks</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">number_of_ticks</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_xyticks</span><span class="p">)</span><span class="o">&lt;</span> <span class="mi">2</span> <span class="p">:</span> 
        <span class="n">new_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">get_xyticks</span><span class="p">)</span>
 
    <span class="k">return</span>  <span class="n">new_array</span></div>
        
        
<div class="viewcode-block" id="resetting_colorbar_bound"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.resetting_colorbar_bound">[docs]</a><span class="k">def</span> <span class="nf">resetting_colorbar_bound</span><span class="p">(</span><span class="n">cbmax</span> <span class="p">,</span> <span class="n">cbmin</span><span class="p">,</span> <span class="n">number_of_ticks</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to reset colorbar ticks more easy to read </span>
<span class="sd">    </span>
<span class="sd">    :param cbmax: value maximum of colorbar </span>
<span class="sd">    :type cbmax: float </span>
<span class="sd">    </span>
<span class="sd">    :param cbmin: minimum data value </span>
<span class="sd">    :type cbmin: float  minimum data value</span>
<span class="sd">    </span>
<span class="sd">    :param number_of_ticks:  number of ticks should be </span>
<span class="sd">                            located on the color bar . Default is 5.</span>
<span class="sd">    :type number_of_ticks: int </span>
<span class="sd">    </span>
<span class="sd">    :param logscale: set to True if your data are lograith data . </span>
<span class="sd">    :type logscale: bool </span>
<span class="sd">    </span>
<span class="sd">    :returns: array of color bar ticks value.</span>
<span class="sd">    :rtype: array_like </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">round_modulo10</span><span class="p">(</span><span class="n">value</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        round to modulo 10 or logarithm scale  , </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">%</span><span class="n">mod10</span>  <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> <span class="k">return</span> <span class="n">value</span> 
        <span class="k">if</span> <span class="n">value</span> <span class="o">%</span><span class="n">mod10</span>  <span class="o">!=</span><span class="mi">0</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="n">value</span> <span class="o">%</span><span class="p">(</span><span class="n">mod10</span> <span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> <span class="k">return</span> <span class="n">value</span> 
            <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="n">value</span> <span class="o">%</span><span class="n">mod10</span> <span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">number_of_ticks</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span> 
        <span class="k">try</span> <span class="p">:</span> <span class="n">number_of_ticks</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">number_of_ticks</span><span class="p">)</span> 
        <span class="k">except</span> <span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;&quot;Number_of_ticks&quot; arguments is the times to see the ticks on x|y axis.&#39;</span>\
                          <span class="s1">&#39; Must be integer not &lt;</span><span class="si">{0}</span><span class="s1">&gt;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">number_of_ticks</span><span class="p">)))</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;&lt;</span><span class="si">{0}</span><span class="s1">&gt; detected. Must be integer.&#39;</span><span class="p">)</span>
        
    <span class="n">number_of_ticks</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">number_of_ticks</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">logscale</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>  <span class="n">mod10</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span><span class="n">mod10</span> <span class="o">=</span> <span class="mi">10</span> 
       
    <span class="k">if</span> <span class="n">cbmax</span> <span class="o">%</span> <span class="n">cbmin</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> 
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">cbmin</span><span class="p">,</span> <span class="n">cbmax</span> <span class="p">,</span> <span class="n">number_of_ticks</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">cbmax</span><span class="o">%</span> <span class="n">cbmin</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">:</span>
        <span class="n">startpoint</span> <span class="o">=</span> <span class="n">cbmin</span> <span class="o">+</span> <span class="p">(</span><span class="n">mod10</span>  <span class="o">-</span> <span class="n">cbmin</span> <span class="o">%</span> <span class="n">mod10</span> <span class="p">)</span>
        <span class="n">endpoint</span> <span class="o">=</span> <span class="n">cbmax</span> <span class="o">-</span> <span class="n">cbmax</span> <span class="o">%</span> <span class="n">mod10</span>  
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">round_modulo10</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">startpoint</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">number_of_ticks</span><span class="p">)])</span></div>
    
    
<div class="viewcode-block" id="slice_csamt_matrix"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.slice_csamt_matrix">[docs]</a><span class="k">def</span> <span class="nf">slice_csamt_matrix</span> <span class="p">(</span> <span class="n">block_matrix</span> <span class="p">,</span> <span class="n">station_offsets</span><span class="p">,</span> <span class="n">depth_offsets</span><span class="p">,</span> <span class="n">offset_MinMax</span> <span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>  <span class="n">doi</span><span class="o">=</span><span class="s1">&#39;2000m&#39;</span> <span class="p">)</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Using Wannamaker FE elements mesh to define rho matrix blocks , need after inversion to slice the model </span>
<span class="sd">    resistivity according the offset and depth we need . This function is easy tool to slice matrix and to keep</span>
<span class="sd">    the part we need . station offset , depth and model resistivity </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        * block_matrix : ndarray(station_offsets.shape[0], </span>
<span class="sd">                    matrix of station depth Resistivity model</span>
<span class="sd">                    depth_offsets.shape[0])</span>
<span class="sd">        </span>
<span class="sd">        * depth_offset : array_like  </span>
<span class="sd">                   depth of investigation after generating by mesh file :&gt;z_nodes . </span>
<span class="sd">                   </span>
<span class="sd">        * station_offsets : array_like </span>
<span class="sd">                  station _offsets : offset generate by mesh_file :&gt;x_nodes .</span>
<span class="sd">                  </span>
<span class="sd">        * offset_MinMax : tuple  </span>
<span class="sd">              the interval of data to keep . eg if station location start by 0 : </span>
<span class="sd">                  off[0] = min and off[-1]=max (min, max):--&gt; index 0 :</span>
<span class="sd">                  minimum value of station location --&gt;index 1 : maximum value of station location</span>
<span class="sd">                  *default* is (0,1000)</span>
<span class="sd">                        </span>
<span class="sd">        * doi : str , float </span>
<span class="sd">                investigation depth ,  migth be [m|km]. </span>
<span class="sd">                If value is provided is float number , it might take value </span>
<span class="sd">                as a default unit &#39;meter&#39;. i.e : 1000=&quot;1000m&quot;</span>
<span class="sd">                </span>
<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">        tuple </span>
<span class="sd">          new sliced station offset , new sliced depth offset  , new_matrix block , </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">depth_of_investigation</span><span class="p">(</span><span class="n">doi</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :returns: doi in meter whether you provide value in kilometer </span>
<span class="sd">        :rtype:float </span>
<span class="sd">    </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fm</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">if</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">doi</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">doi</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span>
                    <span class="n">ndoi</span> <span class="o">=</span> <span class="n">doi</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">fm</span><span class="o">=</span><span class="mi">1</span>
                <span class="k">elif</span> <span class="n">doi</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span><span class="n">ndoi</span> <span class="o">=</span> <span class="n">doi</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">try</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">ndoi</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Can not convert &lt;</span><span class="si">{0}</span><span class="s1">&gt; into float number. &#39;</span>\
                                   <span class="s1">&#39;Depth of investigation value must be float number.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">doi</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Value provided &lt;</span><span class="si">{0}</span><span class="s1">&gt; must be float number not &lt;</span><span class="si">{1}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">doi</span><span class="p">)))</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">fm</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">*=</span> <span class="mf">1e3</span>   <span class="c1"># convert into m</span>
            
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">doi</span><span class="p">)</span> <span class="c1"># for consistency , convert to float</span>
    
    <span class="n">doi</span><span class="o">=</span> <span class="n">depth_of_investigation</span><span class="p">(</span><span class="n">doi</span><span class="p">)</span>
    
    <span class="c1"># --&gt; get  the depth  depth indice </span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">station_offsets</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="p">:</span> <span class="n">station_offsets</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">station_offsets</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">depth_offsets</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="p">:</span> <span class="n">depth_offsets</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">depth_offsets</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">offset_MinMax</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="p">:</span> <span class="n">offset_MinMax</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_MinMax</span><span class="p">)</span>
    
    <span class="c1">#offsets min and maximal station offsets and depth </span>
    <span class="n">offset_min</span><span class="p">,</span>  <span class="n">offset_max</span> <span class="o">=</span> <span class="n">offset_MinMax</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">offset_MinMax</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="c1">#</span>
    <span class="n">offset_start</span><span class="p">,</span> <span class="n">offset_end</span> <span class="o">=</span> <span class="n">station_offsets</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">station_offsets</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>    
    
    <span class="c1">#check wheren the value provide is on the offset </span>
    <span class="k">if</span> <span class="n">offset_min</span> <span class="o">&lt;</span> <span class="n">offset_start</span> <span class="p">:</span> 
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Povided minimal offset is out of the range !Offset minimal for plottig is =</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">offset_start</span><span class="p">))</span>
        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Povided minimal offset out of the range !Offset minimal for plottig is =</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">offset_start</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">offset_max</span> <span class="o">&gt;</span> <span class="n">offset_end</span>  <span class="p">:</span> 
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Povided maximal offset is out of the range !Offset maximal for plottig is =</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">offset_end</span><span class="p">))</span>
        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Povided maximal offset is out of the range !Offset maximal for plottig is =</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">offset_end</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">doi</span> <span class="o">&gt;</span> <span class="n">depth_offsets</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">:</span> 
        <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;depth &lt;</span><span class="si">{0}</span><span class="s1">&gt; is out of depth range. Maximum depth for  is=</span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="n">depth_offsets</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
    <span class="c1"># make sure that station offset and and depth are not  in decrease oder</span>
    <span class="n">sflip</span><span class="p">,</span><span class="n">dflip</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
    <span class="k">if</span> <span class="n">depth_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">depth_offsets</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> 
        <span class="n">depth_offsets</span> <span class="o">=</span><span class="n">depth_offsets</span> <span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sflip</span> <span class="o">=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">station_offsets</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">station_offsets</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> 
        <span class="n">station_offsets</span><span class="o">=</span> <span class="n">station_offsets</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dflip</span><span class="o">=</span><span class="mi">1</span>
        
    <span class="c1"># check whether index values are present on depth array </span>
    <span class="n">ind_depth_s</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">depth_offsets</span><span class="o">==</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">ind_depth_e</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">depth_offsets</span><span class="o">==</span><span class="n">doi</span><span class="p">)</span>

    <span class="c1">#if not : </span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_depth_s</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">dd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">depth_offsets</span><span class="p">):</span> 
                <span class="k">if</span> <span class="n">dd</span> <span class="o">&gt;</span> <span class="mf">0.</span> <span class="p">:</span> 
                    <span class="n">dmax</span> <span class="p">,</span> <span class="n">dmin</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dd</span><span class="o">-</span><span class="mf">0.</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">depth_offsets</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
                    <span class="k">if</span> <span class="n">dmax</span> <span class="o">&lt;</span> <span class="n">dmin</span> <span class="p">:</span> 
                        <span class="n">ind_depth_s</span> <span class="o">=</span><span class="n">ii</span> 
                        <span class="k">break</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">ind_depth_s</span> <span class="o">=</span> <span class="n">ii</span><span class="o">-</span><span class="mi">1</span>
                        <span class="k">break</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_depth_e</span><span class="p">)</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
        <span class="k">for</span> <span class="n">ji</span><span class="p">,</span> <span class="n">de</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">depth_offsets</span><span class="p">):</span> 
                <span class="k">if</span> <span class="n">de</span> <span class="o">&gt;</span> <span class="n">doi</span> <span class="p">:</span> 
                    <span class="n">dmax</span> <span class="p">,</span> <span class="n">dmin</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">de</span><span class="o">-</span><span class="n">doi</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">depth_offsets</span><span class="p">[</span><span class="n">ji</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">doi</span><span class="p">)</span> 
                    <span class="k">if</span> <span class="n">dmax</span> <span class="o">&lt;</span> <span class="n">dmin</span> <span class="p">:</span> 
                        <span class="n">ind_depth_e</span> <span class="o">=</span> <span class="n">ji</span> 
                        <span class="k">break</span>
                    <span class="k">else</span> <span class="p">:</span> 
                        <span class="n">ind_depth_e</span> <span class="o">=</span> <span class="n">ji</span><span class="o">-</span><span class="mi">1</span>
                        <span class="k">break</span>

      <span class="c1">#--&gt; get for the station offset</span>
    <span class="c1">#checker whether station index are presents </span>
    <span class="n">ind_offs_s</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">station_offsets</span><span class="o">==</span><span class="n">offset_min</span><span class="p">)</span>
    <span class="n">ind_offs_e</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">station_offsets</span><span class="o">==</span><span class="n">offset_max</span><span class="p">)</span>
     
    <span class="c1"># if not : </span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_offs_s</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
        <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">offs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">station_offsets</span><span class="p">):</span> 
                <span class="k">if</span> <span class="n">offs</span> <span class="o">&gt;</span> <span class="n">offset_min</span> <span class="p">:</span> 
                    <span class="c1">#claculate the difference betwen </span>
                    <span class="n">maxoff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">offs</span><span class="o">-</span> <span class="n">offset_min</span><span class="p">)</span> 
                    <span class="n">minoff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">station_offsets</span><span class="p">[</span><span class="n">jj</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">offset_min</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">maxoff</span> <span class="o">&lt;</span> <span class="n">minoff</span><span class="p">:</span>
                        <span class="n">ind_offs_s</span> <span class="o">=</span> <span class="n">jj</span>
                        <span class="k">break</span>
                    <span class="k">else</span> <span class="p">:</span> 
                        <span class="n">ind_offs_s</span> <span class="o">=</span> <span class="n">jj</span><span class="o">-</span><span class="mi">1</span>
                        <span class="k">break</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_offs_e</span><span class="p">)</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
         <span class="k">for</span> <span class="n">je</span><span class="p">,</span> <span class="n">offs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">station_offsets</span><span class="p">):</span> 
                <span class="k">if</span> <span class="n">offs</span><span class="o">&gt;</span> <span class="n">offset_max</span> <span class="p">:</span> 
                    <span class="c1">#claculate the difference betwen </span>
                    <span class="n">maxoff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">offs</span><span class="o">-</span><span class="n">offset_max</span><span class="p">)</span> 
                    <span class="n">minoff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">station_offsets</span><span class="p">[</span><span class="n">je</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">offset_max</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">maxoff</span> <span class="o">&lt;</span> <span class="n">minoff</span><span class="p">:</span> 
                        <span class="n">ind_offs_e</span> <span class="o">=</span> <span class="n">je</span>
                        <span class="k">break</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">ind_offs_e</span> <span class="o">=</span> <span class="n">je</span> <span class="o">-</span><span class="mi">1</span> 
                        <span class="k">break</span>
     
    <span class="c1"># convert to integer and leave array for indexing </span>
    <span class="n">ind_depth_s</span><span class="p">,</span> <span class="n">ind_depth_e</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ind_depth_s</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">ind_depth_e</span><span class="p">)</span> 
    <span class="n">ind_offs_s</span><span class="p">,</span> <span class="n">ind_offs_e</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ind_offs_s</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">ind_offs_e</span><span class="p">)</span>
    
    <span class="c1"># for add +1 for the last index so to take the last value</span>
    <span class="n">ind_offs_e</span> <span class="o">+=+</span><span class="mi">1</span>
    <span class="n">ind_depth_e</span> <span class="o">+=</span><span class="mi">1</span> 
 
    <span class="n">new_station_offsets</span><span class="o">=</span> <span class="n">station_offsets</span><span class="p">[</span><span class="n">ind_offs_s</span><span class="p">:</span> <span class="n">ind_offs_e</span><span class="p">]</span>
    <span class="n">new_depth_offsets</span><span class="o">=</span> <span class="n">depth_offsets</span><span class="p">[</span><span class="n">ind_depth_s</span><span class="p">:</span><span class="n">ind_depth_e</span><span class="p">]</span>

    <span class="c1"># Flip indexing if values array are sorted in highest to lower (depth even stations locations)</span>
    <span class="k">if</span> <span class="n">sflip</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
        <span class="c1"># flips station -index </span>
        <span class="n">ind_offs_s</span> <span class="o">=</span> <span class="o">-</span> <span class="n">ind_offs_e</span>
        <span class="n">ind_offs_e</span> <span class="o">=</span> <span class="o">-</span> <span class="n">ind_offs_s</span>
        <span class="n">new_station_offsets</span><span class="o">=</span> <span class="n">new_station_offsets</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
   

    <span class="k">if</span> <span class="n">dflip</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> 
        <span class="c1"># flips depth-index </span>
        <span class="n">ind_depth_s</span> <span class="o">=</span> <span class="o">-</span> <span class="n">ind_depth_e</span>
        <span class="n">ind_depth_e</span> <span class="o">=</span> <span class="o">-</span> <span class="n">ind_depth_s</span>
        <span class="n">new_depth_offsets</span><span class="o">=</span><span class="n">new_depth_offsets</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        

        
    <span class="n">new_block_matrix</span> <span class="o">=</span> <span class="n">block_matrix</span><span class="p">[</span><span class="n">ind_depth_s</span><span class="p">:</span><span class="n">ind_depth_e</span><span class="p">,</span> <span class="n">ind_offs_s</span><span class="p">:</span><span class="n">ind_offs_e</span><span class="p">]</span> 
    
    <span class="k">return</span>   <span class="p">(</span><span class="n">new_station_offsets</span><span class="p">,</span>  <span class="n">new_depth_offsets</span><span class="p">,</span> <span class="n">new_block_matrix</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="controle_delineate_curve"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.controle_delineate_curve">[docs]</a><span class="k">def</span> <span class="nf">controle_delineate_curve</span><span class="p">(</span><span class="n">res_deline</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">phase_deline</span> <span class="o">=</span><span class="kc">None</span> <span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    fonction to controle delineate value given  and return value ceilling .</span>
<span class="sd">    </span>
<span class="sd">    :param  res_deline:  resistivity  value todelineate. unit of Res in `ohm.m`</span>
<span class="sd">    :type  res_deline: float|int|list  </span>
<span class="sd">    </span>
<span class="sd">    :param  phase_deline:   phase value to  delineate , unit of phase in degree</span>
<span class="sd">    :type phase_deline: float|int|list  </span>
<span class="sd">    </span>
<span class="sd">    :returns: delineate resistivity or phase values </span>
<span class="sd">    :rtype: array_like </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fmt</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;resistivity, phase&#39;</span><span class="p">]</span>
 
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">xx_deline</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">res_deline</span> <span class="p">,</span> <span class="n">phase_deline</span><span class="p">]):</span> 
        <span class="k">if</span> <span class="n">xx_deline</span> <span class="ow">is</span>  <span class="ow">not</span> <span class="kc">None</span>  <span class="p">:</span> 
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
                <span class="k">try</span> <span class="p">:</span><span class="n">xx_deline</span><span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Value &lt;</span><span class="si">{0}</span><span class="s1">&gt; to delineate &lt;</span><span class="si">{1}</span><span class="s1">&gt; is unacceptable.&#39;</span>\
                                                      <span class="s1">&#39; Please ckeck your value.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">,</span> <span class="n">fmt</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">))]</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">)]</span>
  
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xx_deline</span> <span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="n">xx_deline</span> <span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">)</span>
                <span class="k">try</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">xx_deline</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">xx</span><span class="p">)))</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">xx_deline</span><span class="p">]</span>
                    <span class="k">elif</span>  <span class="n">ii</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> <span class="n">xx_deline</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">xx_deline</span><span class="p">]</span>
                        
                <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Value to delineate &lt;</span><span class="si">{0}</span><span class="s1">&gt; is unacceptable.&#39;</span>\
                                                      <span class="s1">&#39; Please ckeck your value.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span>
                <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">xx_deline</span></div>

<div class="viewcode-block" id="depth_of_investigation"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.depth_of_investigation">[docs]</a><span class="k">def</span> <span class="nf">depth_of_investigation</span><span class="p">(</span><span class="n">doi</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     Depth of investigation converter </span>

<span class="sd">    :param doi: depth of investigation  if value float is provided , it will considered as </span>
<span class="sd">                default units in meter</span>
<span class="sd">    :type doi: str|float </span>
<span class="sd">    </span>
<span class="sd">    :returns doi:value in meter</span>
<span class="sd">    :rtype: float           </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fm</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">if</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">doi</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">doi</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span>
                <span class="n">ndoi</span> <span class="o">=</span> <span class="n">doi</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">fm</span><span class="o">=</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="n">doi</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span><span class="n">ndoi</span> <span class="o">=</span> <span class="n">doi</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">try</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">ndoi</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Can not convert &lt;</span><span class="si">{0}</span><span class="s1">&gt; into float number. &#39;</span>\
                               <span class="s1">&#39;Depth of investigation value must be float number.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">doi</span><span class="p">))</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="s1">&#39;Value provided &lt;</span><span class="si">{0}</span><span class="s1">&gt; must be float number not &lt;</span><span class="si">{1}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">doi</span><span class="p">)))</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">fm</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">*=</span> <span class="mf">1e3</span>   <span class="c1"># convert into m</span>
        
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">doi</span><span class="p">)</span> <span class="c1"># for consistency , convert to float</span></div>


<div class="viewcode-block" id="build_new_station_id"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.build_new_station_id">[docs]</a><span class="k">def</span> <span class="nf">build_new_station_id</span> <span class="p">(</span><span class="n">station_id</span> <span class="p">,</span> <span class="n">new_station_name</span> <span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fonction to build new station id including station name provided , if the length provided </span>
<span class="sd">        doesnt match the length of station id </span>
<span class="sd">        </span>
<span class="sd">    :param station id: new sites names </span>
<span class="sd">    :type station id: list </span>
<span class="sd">    </span>
<span class="sd">    :param mess:  message for debugging, Default is None </span>
<span class="sd">    :type  mess: str  </span>
<span class="sd">             </span>
<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.utils import plot_utils as punc</span>
<span class="sd">        &gt;&gt;&gt; ts =[   28.,  200.,  400.,  600.,  800., 1000., 1200., 1400., 1600., 1800., 1807.]</span>
<span class="sd">        &gt;&gt;&gt; sto = [&#39;S{0}&#39;.format(i) for i in range(7)]</span>
<span class="sd">        &gt;&gt;&gt; print(sto)</span>
<span class="sd">        &gt;&gt;&gt; stn, fu =punc.build_new_station_id(station_id = sto, new_station_name =ts)</span>
<span class="sd">        &gt;&gt;&gt; print(stn, fu)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mess</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">get_len_new_station_id</span> <span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">new_station_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_station_name</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="p">:</span> 
                <span class="n">new_station_name</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">new_station_name</span><span class="p">)]</span> <span class="c1"># convert value to string </span>
    <span class="k">else</span> <span class="p">:</span> 
        <span class="n">new_station_name</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">stn</span><span class="p">)</span> <span class="k">for</span> <span class="n">stn</span> <span class="ow">in</span> <span class="n">new_station_name</span><span class="p">]</span> <span class="c1"># for consistenncy rebuild sites name and keep on str value </span>
    <span class="k">if</span> <span class="n">get_len_new_station_id</span> <span class="o">&lt;</span>  <span class="nb">len</span><span class="p">(</span><span class="n">station_id</span> <span class="p">):</span> 
        <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;Length of sites names provided =</span><span class="si">{0}</span><span class="s1">. It doesnt match the length of  station id =</span><span class="si">{1}</span><span class="s1">.&#39;</span>\
            <span class="s1">&#39; new sites names will build including your sites names provided.&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_station_name</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">station_id</span> <span class="p">))</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="n">mess</span><span class="p">)</span>

        
        <span class="n">station_id</span> <span class="o">=</span>  <span class="n">new_station_name</span> <span class="o">+</span> <span class="n">station_id</span><span class="p">[</span><span class="n">get_len_new_station_id</span><span class="p">:]</span>
    
    <span class="k">elif</span> <span class="n">get_len_new_station_id</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">station_id</span><span class="p">)</span> <span class="p">:</span> 
        <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;Length of sites names provided =</span><span class="si">{0}</span><span class="s1">. It doesnt match the length of  station id =</span><span class="si">{1}</span><span class="s1">.&#39;</span>\
            <span class="s1">&#39; new sites names will be reduced according the length of station id.&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_station_name</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">station_id</span> <span class="p">))</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="n">mess</span><span class="p">)</span>
        
        <span class="n">station_id</span> <span class="o">=</span> <span class="n">new_station_name</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">station_id</span><span class="p">)</span> <span class="p">]</span>

    <span class="k">else</span> <span class="p">:</span> <span class="n">station_id</span> <span class="o">=</span> <span class="n">new_station_name</span> 
    
    <span class="k">return</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id_</span><span class="p">)</span> <span class="k">for</span> <span class="n">id_</span> <span class="ow">in</span> <span class="n">station_id</span><span class="p">]</span> <span class="p">,</span> <span class="n">mess</span></div>

<div class="viewcode-block" id="get_conductive_and_resistive_zone"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.get_conductive_and_resistive_zone">[docs]</a><span class="k">def</span> <span class="nf">get_conductive_and_resistive_zone</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">site_names</span><span class="p">,</span> <span class="n">purpose</span> <span class="o">=</span><span class="s1">&#39;groundwater&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kws</span><span class="p">):</span> 
    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to get the probability of conductive and resistive zone . It is not absolutely True </span>
<span class="sd">    but give an overview of decison . It is not sufficient to declare that the zone is </span>
<span class="sd">    favorable for any drill , but just work with probability </span>

<span class="sd">    :param data: resistivity datata of survey area </span>
<span class="sd">    :type data: ndarray </span>
<span class="sd">    </span>
<span class="sd">    :param site_name: list of sites names </span>
<span class="sd">    :type site_name: list </span>
<span class="sd">    </span>
<span class="sd">    :param purpose: type of exploration , default is `groundwater` </span>
<span class="sd">    :type purpose: str </span>
<span class="sd">    </span>
<span class="sd">    :returns: report of exploration area </span>
<span class="sd">    :rtype: str </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">fmt_text</span> <span class="p">(</span><span class="n">data_text</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="n">leftspace</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">return_to_line</span> <span class="o">=</span><span class="mi">77</span><span class="p">)</span> <span class="p">:</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allow to format report with data text , fm and leftspace </span>
<span class="sd">        :param  data_text: a long text </span>
<span class="sd">        :type  data_text: str  </span>
<span class="sd">            </span>
<span class="sd">        :param fmt:  type of underline text </span>
<span class="sd">        :type fmt: str</span>

<span class="sd">        :param leftspace: How many space do you want before starting wrinting report .</span>
<span class="sd">        :type leftspae: int </span>
<span class="sd">        </span>
<span class="sd">        :param return_to_line: number of character to return to line</span>
<span class="sd">        :type return_to_line: int </span>
<span class="sd">        &quot;&quot;&quot;</span>
    
        <span class="n">return_to_line</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">return_to_line</span><span class="p">)</span>
        <span class="n">begin_text</span><span class="o">=</span> <span class="n">leftspace</span> <span class="o">*</span><span class="s1">&#39; &#39;</span>
        <span class="n">text</span><span class="o">=</span> <span class="n">begin_text</span> <span class="o">+</span> <span class="s1">&#39;~&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">return_to_line</span> <span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">begin_text</span>
    
        <span class="n">ss</span><span class="o">=</span><span class="mi">0</span>
        
        <span class="k">for</span>  <span class="n">ii</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_text</span><span class="p">)</span> <span class="p">:</span> <span class="c1"># loop the text </span>
            <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_text</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span>          <span class="c1"># if find the last character of text </span>
                <span class="c1">#text = text + data_text[ss:] + &#39; {0}\n&#39;.format(fmt) # take the remain and add return chariot </span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">+</span> <span class="s1">&#39; </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span> <span class="o">+</span> <span class="n">begin_text</span> <span class="o">+</span><span class="s1">&#39;~&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">return_to_line</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>         <span class="c1"># add a fmt strinmg to finish </span>
     
                <span class="k">break</span> 
            <span class="k">if</span> <span class="n">ss</span> <span class="o">==</span> <span class="n">return_to_line</span> <span class="p">:</span>                        <span class="c1"># if enconter 50character then return chariot </span>
                <span class="k">if</span> <span class="n">data_text</span><span class="p">[</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span><span class="s1">&#39; &#39;</span> <span class="p">:</span> 
                    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">- </span><span class="si">{1}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">text</span><span class="p">,</span>  <span class="n">fmt</span><span class="p">,</span> <span class="n">begin_text</span> <span class="o">+</span> <span class="n">fmt</span> <span class="p">)</span> <span class="c1">#     if the word is brken then add &quot;-&quot; and return chariot </span>
                <span class="k">else</span> <span class="p">:</span> 
                    <span class="n">text</span> <span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">begin_text</span><span class="o">+</span><span class="n">fmt</span> <span class="p">)</span> 
                <span class="n">ss</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">num</span>    <span class="c1"># add charatecter  </span>
            <span class="n">ss</span> <span class="o">+=</span><span class="mi">1</span>
    
        <span class="k">return</span> <span class="n">text</span> 
    
    <span class="c1"># other functions arguments</span>
    
    <span class="n">model_offsets</span><span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;model_offsets&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">site_offsets</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;site_offsets&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    
    
    <span class="n">purpose_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
                <span class="p">[</span><span class="mf">3.1e2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">]))</span>  <span class="c1"># we assume the resistivity for groundater is ranged</span>
                                        <span class="c1"># between [3.1e3 1e0] = elecetrical props of fresh water</span>
    
    <span class="n">average_rho_data</span> <span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># return an ndarray of average _rho  </span>
    <span class="n">mins</span><span class="o">=</span> <span class="n">average_rho_data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

    <span class="c1"># imins,  =np.where(average_rho_data==mins) # get the position of minimum value</span>
    <span class="n">imins</span> <span class="o">=</span> <span class="n">average_rho_data</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>

    <span class="n">maxs</span> <span class="o">=</span><span class="n">average_rho_data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="c1"># imaxs, =np.where(average_rho_data==maxs) # get the position of maximum  value </span>
    <span class="n">imaxs</span> <span class="o">=</span> <span class="n">average_rho_data</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
 
    <span class="c1"># get the average value on the set of each line </span>
    <span class="n">mean_set_</span><span class="o">=</span> <span class="n">average_rho_data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>         <span class="c1"># find the average value ....</span>
    
    <span class="c1"># mean</span>
    <span class="c1"># check the mimum and compare to purpose value </span>
     <span class="c1"># print(&#39;{0:=^77}&#39;.format(&#39;Occam Response plot infos&#39;))</span>
     
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Average Rho on survey area is = </span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">mean_set_</span><span class="p">),</span> <span class="s1">&#39;â¦.m.&#39;</span><span class="p">))</span>
    
    <span class="k">if</span>  <span class="n">imins</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">site_names</span><span class="p">)</span> <span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Probably very conductive zone is = </span><span class="si">{0}</span><span class="s1"> with rho = </span><span class="si">{1}</span><span class="s1"> â¦.m.&#39;</span><span class="o">.</span>\
              <span class="nb">format</span><span class="p">(</span><span class="n">site_names</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">imins</span><span class="p">)],</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">mins</span><span class="p">)))</span>
    <span class="k">if</span>  <span class="n">imaxs</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">site_names</span><span class="p">)</span> <span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Probably very resistive zone is = </span><span class="si">{0}</span><span class="s1"> with rho = </span><span class="si">{1}</span><span class="s1"> â¦.m.&#39;</span><span class="o">.</span>\
              <span class="nb">format</span><span class="p">(</span><span class="n">site_names</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">imaxs</span><span class="p">)],</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">maxs</span><span class="p">)))</span> 
    
    <span class="c1"># make a ratio minimum value and maxmim ration </span>
    <span class="n">temcon</span><span class="p">,</span> <span class="n">temres</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># build empty list for min sites names and </span>
    <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">iindex</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span> <span class="p">([</span><span class="n">imins</span><span class="p">,</span> <span class="n">imaxs</span><span class="p">],</span> <span class="p">[</span><span class="n">mins</span><span class="p">,</span> <span class="n">maxs</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">site_names</span><span class="p">):</span> <span class="c1"># if the value is greater than sites names length , we assume that is them occam </span>
        <span class="c1"># model objet then bring model file </span>
            <span class="k">if</span> <span class="n">model_offsets</span> <span class="ow">is</span> <span class="kc">None</span>  <span class="ow">or</span> <span class="n">site_offsets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
                <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39; !Could not find Occam 2D model resistivity value . Could not provide a report.&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;Too many minimum value find ! Need Occam model resistivity data and model station data&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;to provide a report.&#39;</span><span class="p">])</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
        
            <span class="n">icc</span><span class="p">,</span> <span class="n">offs_value</span> <span class="o">=</span> <span class="n">find_closest_station</span><span class="p">(</span><span class="n">offset_indice</span><span class="o">=</span> <span class="n">index</span> <span class="p">,</span> 
                                                     <span class="n">model_offsets</span> <span class="o">=</span> <span class="n">model_offsets</span><span class="p">,</span>
                                                     <span class="n">site_offsets</span> <span class="o">=</span><span class="n">site_offsets</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
                <span class="n">snn</span> <span class="o">=</span> <span class="n">site_names</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">icc</span><span class="p">)]</span> <span class="c1"># build conductive ssites names </span>
                <span class="k">if</span> <span class="n">snn</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">temcon</span><span class="p">:</span>   <span class="c1"># sometime the names of station is close , keep one , if not keep all </span>
                                        <span class="c1"># else pass </span>
                    <span class="n">temcon</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">snn</span><span class="p">,</span> <span class="n">iindex</span><span class="p">))</span>  <span class="c1"># keep station </span>
                    
            <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> 
                <span class="n">snn</span> <span class="o">=</span> <span class="n">site_names</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">icc</span><span class="p">)]</span> <span class="c1"># build conductive ssites names</span>
                <span class="k">if</span> <span class="n">snn</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">temres</span><span class="p">:</span>              
                    <span class="n">temres</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">snn</span><span class="p">,</span> <span class="n">iindex</span><span class="p">))</span>
        
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temcon</span><span class="p">)</span> <span class="o">&gt;</span><span class="mi">0</span> <span class="p">:</span> 
        <span class="k">for</span> <span class="n">stn</span><span class="p">,</span> <span class="n">rhoval</span>  <span class="ow">in</span> <span class="n">temcon</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temcon</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">:</span> <span class="c1"># if many conductive zone has ben selected then : </span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt; </span><span class="si">{0}</span><span class="s1"> Probably  conductive zones has been selected :&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temcon</span><span class="p">)))</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Probably very conductive zone is = </span><span class="si">{0}</span><span class="s1"> with rho = </span><span class="si">{1}</span><span class="s1"> â¦.m.&#39;</span><span class="o">.</span>\
                  <span class="nb">format</span><span class="p">(</span><span class="n">stn</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">rhoval</span><span class="p">)))</span>
                
            <span class="n">imins</span> <span class="o">=</span><span class="n">site_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">stn</span><span class="p">)</span> <span class="c1"># get the real minimum and the value of resistivities</span>
            <span class="n">mins</span> <span class="o">=</span> <span class="n">rhoval</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temres</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> 
        <span class="k">for</span> <span class="n">stn</span><span class="p">,</span> <span class="n">rhoval</span> <span class="ow">in</span> <span class="n">temres</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temres</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">:</span> <span class="c1"># if many conductive zone has ben selected then : </span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt; </span><span class="si">{0}</span><span class="s1"> Probably  resistives zones has been selected :&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temres</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Probably very resistive zone is = </span><span class="si">{0}</span><span class="s1"> with rho = </span><span class="si">{1}</span><span class="s1"> â¦.m.&#39;</span><span class="o">.</span>\
                  <span class="nb">format</span><span class="p">(</span><span class="n">stn</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">rhoval</span><span class="p">)))</span>
                
            <span class="n">imaxs</span> <span class="o">=</span><span class="n">site_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">stn</span><span class="p">)</span>
            <span class="n">maxs</span> <span class="o">=</span> <span class="n">rhoval</span>
   
            
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- However :&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">. &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Minimum ratio is&#39;</span><span class="p">,</span>  <span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span> <span class="n">mins</span><span class="o">/</span><span class="n">mean_set_</span><span class="p">,</span><span class="mi">7</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; </span><span class="si">{0:&lt;27}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Maximum ratio is&#39;</span><span class="p">,</span>  <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">maxs</span><span class="o">/</span><span class="n">mean_set_</span><span class="p">,</span> <span class="mi">7</span><span class="p">)))</span>
    
    <span class="k">if</span> <span class="n">purpose</span> <span class="o">==</span><span class="s1">&#39;groundwater&#39;</span><span class="p">:</span>
        <span class="n">p_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">purpose_value</span> <span class="o">/</span> <span class="n">mins</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>        <span class="c1"># presumed a prefect zone (conductive)</span>
        <span class="c1"># p_ratio_max : maximal trend of condictive zone </span>
        <span class="c1">#p_ratio _min : minimu trend of conductive zone : </span>
            
        <span class="n">p_ratio_max</span><span class="p">,</span> <span class="n">p_ratio_min</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">3.1e2</span><span class="p">)</span><span class="o">/</span><span class="n">mins</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1e0</span><span class="p">)</span> <span class="o">/</span> <span class="n">mins</span> 
         
        <span class="c1"># pseudo_trust = (mins/mean_set_ / p_ratio) * 100</span>
        <span class="n">pseudo_trust</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean_set_</span><span class="o">/</span> <span class="n">mins</span><span class="p">)</span> <span class="o">*</span><span class="mi">100</span> 
        <span class="k">if</span> <span class="n">pseudo_trust</span> <span class="o">&gt;</span>  <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span> <span class="n">p_ratio_max</span> <span class="o">*</span><span class="mi">100</span> <span class="p">:</span> 
             <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39; resistive medium and could be &#39;</span><span class="p">,</span>
                             <span class="s1">&#39;  hydrogeologically UNfavorable zone.&#39;</span> <span class="p">])</span>
             <span class="n">fm</span><span class="o">=</span><span class="s1">&#39;However,&#39;</span>
             <span class="c1"># mess = &#39;hydrogeologically UNfavorable&#39;</span>
             
        <span class="k">elif</span> <span class="n">pseudo_trust</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span> <span class="n">p_ratio_min</span> <span class="o">*</span><span class="mi">100</span>  <span class="p">:</span> 
            <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;medium too conductive and must be aware of that zone.&#39;</span>
            <span class="n">fm</span><span class="o">=</span><span class="s1">&#39;However,&#39;</span>
            
        <span class="k">else</span> <span class="p">:</span> 
             <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;hydrogeologically favorable zone and could be a right drilling point.&#39;</span> 
             <span class="n">fm</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
        
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;!IMPORTANT NOTE! :&#39;</span><span class="p">)</span>
        <span class="n">bfreport</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;This present report is&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;  for </span><span class="si">{0}</span><span class="s1">  exploration purpose.&#39;</span><span class="p">,</span>  
                           <span class="s1">&#39;If your survey purpose if far from&#39;</span><span class="p">,</span>
                           <span class="s1">&#39; </span><span class="si">{0}</span><span class="s1"> exploration , please ignore it.&#39;</span><span class="p">])</span>
        <span class="n">bfreport</span> <span class="o">=</span><span class="n">bfreport</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">purpose</span><span class="p">)</span>
        
        <span class="n">fttext</span> <span class="o">=</span> <span class="n">fmt_text</span><span class="p">(</span><span class="n">data_text</span> <span class="o">=</span> <span class="n">bfreport</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">leftspace</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="n">fttext</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Report:&#39;</span><span class="p">)</span>

        <span class="n">report</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
            <span class="s1">&#39;In the case of </span><span class="si">{0}</span><span class="s1"> exploration, along the survey line,&#39;</span><span class="p">,</span>
            <span class="s1">&#39; site </span><span class="si">{1}</span><span class="s1"> seems to be the best conductive zone with reliability &#39;</span><span class="p">,</span>
            <span class="s1">&#39; ratio estimates to  = </span><span class="si">{2}</span><span class="s1"> </span><span class="si">% c</span><span class="s1">ompared to the threshold = </span><span class="si">{3}</span><span class="s1"> %.&#39;</span><span class="p">,</span>
            <span class="s1">&#39; </span><span class="si">{4}</span><span class="s1"> Site </span><span class="si">{1}</span><span class="s1"> is considered as </span><span class="si">{5}</span><span class="s1">. &#39;</span>
                    <span class="p">])</span>
        <span class="n">report</span><span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">purpose</span><span class="p">,</span> 
                              <span class="n">site_names</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">imins</span><span class="p">)],</span>
                              <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">pseudo_trust</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> 
                              <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">p_ratio</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                              <span class="n">fm</span><span class="p">,</span> 
                              <span class="n">mess</span><span class="p">)</span>
        <span class="n">caution</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;The present  report is NOT absolute. It might be&#39;</span><span class="p">,</span>
                          <span class="s1">&#39; taken with cautiousness because in groundwater &#39;</span><span class="p">,</span> 
                          <span class="s1">&#39; exploration, many other parameters are considering&#39;</span><span class="p">,</span>
                          <span class="s1">&#39; before a possible drilling decison. We hope in  &#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;the next release, introduce an intelligent drill &#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;estimator `StarGain` to give better precision of &#39;</span><span class="p">,</span>
                          <span class="s1">&#39; absolute point  with tolerance value by considering&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;  multiple other parameters. &#39;</span><span class="p">])</span>
        
        <span class="c1"># generate a reading report </span>
        <span class="n">textr</span> <span class="o">=</span> <span class="n">fmt_text</span><span class="p">(</span><span class="n">data_text</span> <span class="o">=</span> <span class="n">report</span> <span class="o">+</span> <span class="n">caution</span> <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">textr</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="fmt_text"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.fmt_text">[docs]</a><span class="k">def</span> <span class="nf">fmt_text</span> <span class="p">(</span><span class="n">data_text</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="n">leftspace</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">return_to_line</span> <span class="o">=</span><span class="mi">77</span><span class="p">)</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allow to format report with data text , fm and leftspace </span>

<span class="sd">    :param  data_text: a long text </span>
<span class="sd">    :type  data_text: str  </span>
<span class="sd">        </span>
<span class="sd">    :param fmt:  type of underline text </span>
<span class="sd">    :type fmt: str</span>

<span class="sd">    :param leftspae: How many space do you want before starting wrinting report .</span>
<span class="sd">    :type leftspae: int </span>
<span class="sd">    </span>
<span class="sd">    :param return_to_line: number of character to return to line</span>
<span class="sd">    :type return_to_line: int </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">return_to_line</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">return_to_line</span><span class="p">)</span>
    <span class="n">begin_text</span><span class="o">=</span> <span class="n">leftspace</span> <span class="o">*</span><span class="s1">&#39; &#39;</span>
    <span class="n">text</span><span class="o">=</span> <span class="n">begin_text</span> <span class="o">+</span> <span class="n">fmt</span><span class="o">*</span><span class="p">(</span><span class="n">return_to_line</span> <span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">begin_text</span>

    
    <span class="n">ss</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="k">for</span>  <span class="n">ii</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_text</span><span class="p">)</span> <span class="p">:</span> <span class="c1"># loop the text </span>
        <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_text</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span>          <span class="c1"># if find the last character of text </span>
            <span class="c1">#text = text + data_text[ss:] + &#39; {0}\n&#39;.format(fmt) # take the remain and add return chariot </span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">+</span> <span class="s1">&#39; </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span> <span class="o">+</span> <span class="n">begin_text</span> <span class="o">+</span><span class="n">fmt</span><span class="o">*</span><span class="p">(</span><span class="n">return_to_line</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>         <span class="c1"># add a fmt strinmg to finish </span>
 
            <span class="k">break</span> 
        <span class="k">if</span> <span class="n">ss</span> <span class="o">==</span> <span class="n">return_to_line</span> <span class="p">:</span>                        <span class="c1"># if enconter 50character then return chariot </span>
            <span class="k">if</span> <span class="n">data_text</span><span class="p">[</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span><span class="s1">&#39; &#39;</span> <span class="p">:</span> 
                <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1">- </span><span class="se">\n</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">text</span><span class="p">,</span>  <span class="n">fmt</span><span class="p">,</span> <span class="n">begin_text</span> <span class="o">+</span> <span class="n">fmt</span> <span class="p">)</span> <span class="c1">#     if the word is brken then add &quot;-&quot; and return chariot </span>
            <span class="k">else</span> <span class="p">:</span> 
                <span class="n">text</span> <span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">begin_text</span><span class="o">+</span><span class="n">fmt</span> <span class="p">)</span> 
            <span class="n">ss</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="n">num</span>    <span class="c1"># add charatecter  </span>
        <span class="n">ss</span> <span class="o">+=</span><span class="mi">1</span>

    <span class="k">return</span> <span class="n">text</span> </div>

<div class="viewcode-block" id="find_closest_station"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.find_closest_station">[docs]</a><span class="k">def</span> <span class="nf">find_closest_station</span><span class="p">(</span> <span class="n">offset_indice</span> <span class="p">,</span>  <span class="n">model_offsets</span> <span class="p">,</span> <span class="n">site_offsets</span> <span class="p">)</span>  <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Get the indice of the closest offset </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        * offset_indice: int </span>
<span class="sd">             if the indix of the offset at the selected resistivity point. </span>
<span class="sd">        * model_offset: array_like  </span>
<span class="sd">            is a large band of x_nodes resistivities  gnerated by mesh files </span>
<span class="sd">        </span>
<span class="sd">        * sites_offsets: array_like </span>
<span class="sd">             the data set offset from Occam Data file </span>
<span class="sd">        </span>
<span class="sd">    Returns </span>
<span class="sd">    --------</span>
<span class="sd">        indexoff : int</span>
<span class="sd">             index of data offset </span>
<span class="sd">        get_offs : float</span>
<span class="sd">               value of the offset at that index </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">offs_value</span><span class="o">=</span> <span class="n">model_offsets</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">offset_indice</span><span class="p">)]</span> <span class="c1">#  keep the offset value form model </span>

    <span class="k">for</span>  <span class="n">ii</span> <span class="p">,</span> <span class="n">iof</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">site_offsets</span><span class="p">)</span> <span class="p">:</span>  <span class="c1"># loop the data offset and find the offset in model more close to data offset</span>
        <span class="k">if</span> <span class="n">iof</span> <span class="o">&gt;</span> <span class="n">offs_value</span> <span class="p">:</span>  <span class="c1"># compared both offsets values </span>
            <span class="n">minabs</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">iof</span> <span class="o">-</span> <span class="n">offs_value</span><span class="p">)</span> <span class="c1"># find the distance between offset from model and offset from ocam data </span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="n">maxabs</span> <span class="o">=</span> <span class="nb">abs</span> <span class="p">(</span><span class="n">site_offsets</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">offs_value</span><span class="p">)</span> <span class="c1"># if ii -1 not possible to find then take absolue distance from ... </span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">maxabs</span><span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">iof</span> <span class="o">-</span><span class="n">offs_value</span><span class="p">)</span>            <span class="c1"># ... from data offsets </span>
            <span class="k">if</span> <span class="n">minabs</span> <span class="o">&lt;=</span> <span class="n">maxabs</span> <span class="p">:</span>  <span class="c1"># if minimum offset is found at index ii of offset iof than take the index and the iofs value </span>
                <span class="n">indexoff</span><span class="p">,</span> <span class="n">get_offs</span>  <span class="o">=</span> <span class="n">ii</span><span class="p">,</span> <span class="n">iof</span>
                <span class="k">break</span>
            <span class="k">else</span> <span class="p">:</span>  
                <span class="n">indexoff</span><span class="p">,</span> <span class="n">get_offs</span> <span class="o">=</span> <span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">site_offsets</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># if ii-1 exist then get the previous offset from data offset .</span>
                <span class="k">break</span>
      <span class="c1"># return indice of data offset so to find the sites names and the offset at that sites  index </span>
    
    <span class="k">return</span> <span class="n">indexoff</span><span class="p">,</span> <span class="n">get_offs</span></div>
    
<div class="viewcode-block" id="find_local_maxima_minima"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.find_local_maxima_minima">[docs]</a><span class="k">def</span> <span class="nf">find_local_maxima_minima</span> <span class="p">(</span><span class="n">array</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to find minimum local and maximum local  on array </span>
<span class="sd">    </span>
<span class="sd">    :param data: value of array to find minima , maxima </span>
<span class="sd">    :type data: array_like </span>
<span class="sd">    </span>
<span class="sd">    :returns: tuple of index of minima  and maxima local index and </span>
<span class="sd">             array of minima maxima  value</span>
<span class="sd">    :rtype: array_like</span>
<span class="sd">    </span>
<span class="sd">    :Example: </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.utils import func_utils as func</span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.utils import plot_utils as punc</span>
<span class="sd">        &gt;&gt;&gt; ts =np.array([2, 3, 4, 7, 9, 0.25, 18, 28, 86, 10, 5])</span>
<span class="sd">        &gt;&gt;&gt; te=np.array([0.2, .3, 18, 1.6, 0.2, 0.6, 0.7, 0.8, 0.9, 1., 23.])</span>
<span class="sd">        &gt;&gt;&gt; th =func.concat_array_from_list([ts, te], concat_axis=1)</span>
<span class="sd">        .. tth =th.T</span>
<span class="sd">        ... print(tth)</span>
<span class="sd">        ... print(punc.find_local_maxima_minima(tth[0]))</span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">localmm</span><span class="p">,</span> <span class="n">indexlmm</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
    
    <span class="n">error_mess</span> <span class="o">=</span><span class="s1">&#39;Can not convert value to float number. Arry to find locals&#39;</span>\
                <span class="s1">&#39; minmum and maximum must be an aray of float numbers.&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span> <span class="c1"># put on list </span>
        <span class="k">try</span> <span class="p">:</span>  <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">array</span><span class="p">])</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_parameter_number</span><span class="p">(</span><span class="n">error_mess</span><span class="p">)</span>
            
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
        <span class="k">try</span> <span class="p">:</span>
            <span class="n">array</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">array</span><span class="p">)])</span>
        <span class="k">except</span> <span class="p">:</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="n">error_mess</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span> 
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="n">array</span> <span class="p">)</span>
            
    <span class="n">d0</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span>               <span class="c1"># get the initial value , use the initial at starting points </span>
    <span class="n">localmm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d0</span><span class="p">)</span>              <span class="c1">#... can be either local maximum or local minimum </span>
    <span class="n">indexlmm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>              <span class="c1"># append index of starting point d0</span>
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>  <span class="c1"># let go for maximum data </span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="n">d0</span> <span class="p">:</span> <span class="c1">#0.3       # try to find maximum |speudo maximum but get the minimum index when</span>
                <span class="k">if</span> <span class="n">f</span><span class="o">==</span><span class="mi">2</span> <span class="p">:</span>
                    <span class="n">localmm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">indexlmm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">f</span><span class="o">=</span><span class="mi">1</span>
                <span class="n">d0</span><span class="o">=</span><span class="n">value</span>                <span class="c1"># reinitialize pseudo maximum value </span>
            <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">d0</span> <span class="p">:</span>           <span class="c1"># # try to find minimum|speudo minimum but get the maximum index when</span>
                <span class="k">if</span> <span class="n">f</span><span class="o">==</span> <span class="mi">1</span> <span class="p">:</span> 
                    <span class="n">localmm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">indexlmm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    
                <span class="n">f</span><span class="o">=</span><span class="mi">2</span>
                <span class="n">d0</span><span class="o">=</span><span class="n">value</span>                <span class="c1"># # reinitialize pseudo minimum value </span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span><span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>       <span class="c1"># at the end take the last value to close the loop whether is minimum or maximum </span>
                <span class="n">localmm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  
                <span class="n">indexlmm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
                
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indexlmm</span><span class="p">)</span> <span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">localmm</span><span class="p">)</span>            </div>
        
<div class="viewcode-block" id="average_rho_with_locals_minmax"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.average_rho_with_locals_minmax">[docs]</a><span class="k">def</span> <span class="nf">average_rho_with_locals_minmax</span><span class="p">(</span><span class="n">array</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    How to compute mean value between local maxima and local minima </span>
<span class="sd">    and keep locals minima and maxima value on the final data </span>
<span class="sd">    </span>
<span class="sd">    :param array: data to compute the local minima and local maxima </span>
<span class="sd">    :type array: array_like </span>
<span class="sd">    </span>
<span class="sd">    :returns: array mean with data local value averaged </span>
<span class="sd">    :rtype: array_like</span>
<span class="sd">    </span>
<span class="sd">    :Example: </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.utils import plot_utils as punc</span>
<span class="sd">        &gt;&gt;&gt; mean1= punc.average_rho_with_locals_minmax(tth[0])</span>
<span class="sd">        &gt;&gt;&gt; mean2= punc.average_rho_with_locals_minmax(tth[1])</span>
<span class="sd">        &gt;&gt;&gt; print(mean1)</span>
<span class="sd">        &gt;&gt;&gt; print(mean2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tem</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">indexmm</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span> <span class="n">find_local_maxima_minima</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="c1"># find the local and maxium local index</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexmm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>              <span class="c1"># once it as a singe value  </span>
        <span class="k">return</span> <span class="n">array</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">indexmm</span><span class="p">)]</span>      <span class="c1"># for consistency</span>
    
    <span class="n">s_index</span> <span class="o">=</span><span class="n">indexmm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                 <span class="c1">#   next index as str</span>
    
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">indexmm</span><span class="p">):</span> <span class="c1">#[ 0,  4,  5,  8, 10] #s_index = 4</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="n">indexmm</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                                    
            <span class="n">tem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>    <span class="c1"># put single value on array for conacatenation </span>
            <span class="k">break</span>
        
        <span class="k">if</span> <span class="n">ii</span> <span class="o">!=</span><span class="mi">0</span> <span class="p">:</span>                     <span class="c1"># start a counter at index &gt;0</span>
            <span class="n">s_index</span> <span class="o">=</span> <span class="n">indexmm</span><span class="p">[</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">ndiff</span> <span class="o">=</span> <span class="n">s_index</span> <span class="o">-</span> <span class="n">index</span>         <span class="c1"># take the next index and substract the present index s_index </span>
                                        <span class="c1"># ndiff = 4-0 (indexmm[1]-index (indexmm[0])) = 4 &gt;1 </span>
        <span class="k">if</span> <span class="n">ndiff</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
            <span class="n">tem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>   <span class="c1">#add local minimum array[0]= 2</span>
            
        <span class="k">if</span> <span class="n">ndiff</span> <span class="o">&gt;</span><span class="mi">1</span> <span class="p">:</span> 
            <span class="n">mean_mm</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">s_index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># [0:4+1]take the mean between [index0 : index 9 +1]--&gt; [0:5]</span>
            <span class="c1">#moy = array[ii :indexmm[ii+1]] = array[0]-array[5]= moy (array[2:5] 2:9 /mean</span>
            <span class="n">tem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>
            <span class="n">nn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">mean_mm</span><span class="p">,</span> <span class="n">ndiff</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 25/5 =5 ( 5, 3) 2 5 5 5 9 (ndiff =4-0-1)=3</span>
            <span class="n">tem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>
               
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">tem</span><span class="p">))</span></div>

<div class="viewcode-block" id="average_rho_in_deeper"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.average_rho_in_deeper">[docs]</a><span class="k">def</span> <span class="nf">average_rho_in_deeper</span> <span class="p">(</span><span class="n">dep_array</span><span class="p">,</span> <span class="n">rho_array</span><span class="p">,</span> <span class="n">step_descent</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to average rho in deep according to the value provided . In fact </span>
<span class="sd">    averaged rho in shorter depth distance allow us to understand the conductive zone. </span>
<span class="sd">    in approximately. The most conductive zone is detected as the zone with </span>
<span class="sd">    lower resistivities values . But fixing values as averaged rho , can build a </span>
<span class="sd">    specific strata that could match this zone .</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ------------</span>
<span class="sd">        * dep_array : array_like </span>
<span class="sd">                the imaged depth (doi)</span>
<span class="sd">            </span>
<span class="sd">        * rho_array: array_like</span>
<span class="sd">                resistivity array  </span>
<span class="sd">            </span>
<span class="sd">        * step_descent : float </span>
<span class="sd">                value to step descent </span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">        array_like </span>
<span class="sd">             rho average for each station  # dep_averaged for each station</span>

<span class="sd">    :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.utils import plot_utils as punc</span>
<span class="sd">        &gt;&gt;&gt; pseudo_depth=np.array([  0. ,  6. , 13. , 20.  ,29. , 39.,  49. ,</span>
<span class="sd">        ...                       59. , 69. , 89., 109. ,129., 149. ,179.,</span>
<span class="sd">        ...                  209. ,249. ,289., 339., 399., 459. ,529. ,609., </span>
<span class="sd">        ...                  699., 799., 899., 999.])</span>
<span class="sd">        &gt;&gt;&gt; pseudo_depth = np.arange(0, 1220, 20)</span>
<span class="sd">        &gt;&gt;&gt; rho = np.random.randn(len(pseudo_depth))</span>
<span class="sd">        &gt;&gt;&gt; rho_aver, dep_aver= average_rho_in_deep(dep_array=pseudo_depth,</span>
<span class="sd">        ...                                        rho_array=rho, </span>
<span class="sd">        ...                                        step_descent=20.)</span>
<span class="sd">        &gt;&gt;&gt; rho_2,dep_2 =   average_rho_in_deeper (dep_array= pseudo_depth,</span>
<span class="sd">        ...                                         rho_array=rho,</span>
<span class="sd">        ...                                         step_descent=1000) </span>
<span class="sd">        &gt;&gt;&gt;  print(pseudo_depth)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span><span class="p">,</span><span class="n">r</span> <span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">rm</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">step_descent</span>
    
    <span class="k">for</span> <span class="n">index</span> <span class="p">,</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dep_array</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">depth</span> <span class="o">&lt;=</span> <span class="n">step_descent</span> <span class="p">:</span>      <span class="c1"># value less than step descent must be averaged </span>
            <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>             <span class="c1"># keep resistivities values onto list </span>
            <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_array</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="n">step_descent</span> <span class="p">:</span>       <span class="c1"># if the next value is greater than the previous one </span>
        
            <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span><span class="p">[]:</span>                  <span class="c1"># ccheck if kist is not enmpty </span>
            
                <span class="n">dm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>  <span class="c1"># rebuild resistivities values with rho averaged </span>
                <span class="n">rm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)))</span>
                <span class="n">step_descent</span> <span class="o">+=</span> <span class="n">value</span>               <span class="c1">#increment the next descent to step of descent </span>
                <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="n">depth</span><span class="p">]</span>       <span class="c1"># initialise new list by adding the index value greater one </span>
                <span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="n">rho_array</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span>
              
        <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span><span class="n">dep_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>                  <span class="c1"># it length last value ==1 , means is the last value of depth</span>
                <span class="n">dm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dep_array</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                <span class="n">rm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_array</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">!=</span><span class="mi">1</span> <span class="p">:</span>               <span class="c1"># averaged the reamin rho values  </span>
                <span class="n">dm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
                <span class="n">rm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)))</span>
      

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">rm</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dm</span><span class="p">))</span></div>


<div class="viewcode-block" id="average_rho_in_deep"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.average_rho_in_deep">[docs]</a><span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;function deprecated , it&#39;s does not cover the total depth when last value is outside the model depth range. &quot;</span><span class="p">)</span>
<span class="nd">@redirect_cls_or_func</span><span class="p">(</span><span class="n">average_rho_in_deeper</span><span class="p">,</span><span class="s2">&quot;Function replaced , it redirects to </span><span class="si">{average_rho_in_deeper}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">average_rho_in_deep</span> <span class="p">(</span><span class="n">dep_array</span><span class="p">,</span> <span class="n">rho_array</span><span class="p">,</span> <span class="n">step_descent</span><span class="p">)</span>   <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to average rho in deep according to the value provided . In fact </span>
<span class="sd">    averaged rho in smalled depth distance allow us to understand the conductive zone. </span>
<span class="sd">    in approximated. The most conductive zone is detected as the zone with </span>
<span class="sd">    lower resistivities values . But fixing values as averaged rho , can build a </span>
<span class="sd">    specific strata that could match the zone .</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">        * dep_array : array_like</span>
<span class="sd">                the imaged depth (doi)</span>
<span class="sd">        * resistivity : array_like </span>
<span class="sd">                resistivity ate the station </span>
<span class="sd">        * step_descent : float </span>
<span class="sd">                value to step descent </span>
<span class="sd">    Returns </span>
<span class="sd">    --------</span>
<span class="sd">    array_like </span>
<span class="sd">         rho average for each station # dep_averaged for each station</span>
<span class="sd">  </span>
<span class="sd">    :Example: </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.utils import plot_utils as punc</span>
<span class="sd">        &gt;&gt;&gt; pseudo_depth = np.arange(0, 1201.,100)</span>
<span class="sd">        &gt;&gt;&gt; print(pseudo_depth)</span>
<span class="sd">        &gt;&gt;&gt; dep_aver= dep(dep_array=pseudo_depth, value=100)</span>
<span class="sd">        &gt;&gt;&gt; print(dep_aver)</span>
<span class="sd">        &gt;&gt;&gt; print(pseudo_depth.shape)</span>
<span class="sd">        &gt;&gt;&gt; print(dep_aver.shape)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tem</span><span class="p">,</span> <span class="n">rm</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
    <span class="n">step_descent</span>  <span class="o">=</span><span class="n">depth_of_investigation</span><span class="p">(</span><span class="n">step_descent</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step_descent</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span> 
        <span class="k">try</span> <span class="p">:</span> 
            <span class="n">step_descent</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">step_descent</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_geoinputargument</span><span class="p">(</span>
                <span class="s1">&#39;Could not convert depth value =</span><span class="si">{}</span><span class="s1"> to float. Please check your value.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step_descent</span><span class="p">))</span>
    
    
    <span class="k">if</span> <span class="n">step_descent</span> <span class="o">&lt;</span> <span class="n">dep_array</span><span class="o">.</span><span class="n">min</span><span class="p">():</span> 
        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span>
            <span class="s1">&#39;Value provided =</span><span class="si">{0}</span><span class="s1"> m is less than the minimum depth =</span><span class="si">{1}</span><span class="s1"> m.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step_descent</span><span class="p">,</span> <span class="n">dep_array</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
    
    <span class="k">if</span> <span class="n">step_descent</span> <span class="o">&gt;</span> <span class="n">dep_array</span><span class="o">.</span><span class="n">max</span><span class="p">():</span> 
        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span>
            <span class="s1">&#39;Value provided is = </span><span class="si">{0}</span><span class="s1"> m is greater than maximum depth =</span><span class="si">{1}</span><span class="s1">m.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step_descent</span><span class="p">,</span> <span class="n">dep_array</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
        
    <span class="n">mm</span><span class="o">=</span><span class="mi">0</span> 
    <span class="n">_init_depth</span> <span class="o">=</span><span class="n">step_descent</span>
  
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dep_array</span><span class="p">):</span>  <span class="c1"># index = 0</span>

        <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;=</span> <span class="n">step_descent</span> <span class="p">:</span> <span class="c1"># if value is greater than the maximum depth for the fist time </span>
            <span class="n">dep_averaged</span> <span class="o">=</span> <span class="n">dep_array</span><span class="p">[</span><span class="n">mm</span><span class="p">:</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1">#[0 :20] 20 is ouut : 0--19 </span>
            <span class="n">rho_averaged</span><span class="o">=</span>  <span class="n">rho_array</span><span class="p">[</span><span class="n">mm</span><span class="p">:</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">tem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">dep_averaged</span><span class="p">,</span> <span class="n">index</span> <span class="o">-</span> <span class="n">mm</span><span class="p">))</span> <span class="c1">#3-0=3</span>
            <span class="n">rm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">rho_averaged</span><span class="p">,</span> <span class="n">index</span> <span class="o">-</span> <span class="n">mm</span><span class="p">))</span> 
            <span class="n">mm</span><span class="o">=</span> <span class="n">index</span>               <span class="c1"># mm= 3 (20)</span>
           
            <span class="n">step_descent</span> <span class="o">+=</span> <span class="n">_init_depth</span>    <span class="c1"># value = 20+20 = 40</span>
    
            
            
        <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="n">dep_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>               <span class="c1"># last value then check if value is modulo the init depth </span>
            
            <span class="k">if</span> <span class="n">depth</span> <span class="o">%</span> <span class="n">_init_depth</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="n">step_descent</span> <span class="p">:</span> <span class="c1"># assume the last depth is less than the next assigned depth </span>

                <span class="n">dep_averaged</span> <span class="o">=</span> <span class="n">dep_array</span><span class="p">[</span><span class="n">mm</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="n">rho_averaged</span><span class="o">=</span>  <span class="n">rho_array</span><span class="p">[</span><span class="n">mm</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="n">tem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">dep_averaged</span><span class="p">,</span> <span class="n">index</span> <span class="o">-</span><span class="n">mm</span> <span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># add +1 because of python nanems start count from 0</span>
                <span class="n">rm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">rho_averaged</span><span class="p">,</span> <span class="n">index</span> <span class="o">-</span><span class="n">mm</span> <span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        

        
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">rm</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">tem</span><span class="p">))</span></div>
    

<div class="viewcode-block" id="get_station_id_input_resistivities"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.get_station_id_input_resistivities">[docs]</a><span class="k">def</span> <span class="nf">get_station_id_input_resistivities</span><span class="p">(</span><span class="n">station_rho_value</span><span class="p">,</span> <span class="n">number_of_layer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a special station input resistivities is much benefit and </span>
<span class="sd">    more close to reality of plot . Indeeed , it take only the maximum value of resistivities </span>
<span class="sd">    below the site and the minimum , then cut out 7  Considering all the model data and </span>
<span class="sd">    choose the max resistivities and the minim resistivities to build automatic </span>
<span class="sd">    resistivities whom COULD match the deth is less sure .</span>
<span class="sd">    Geeting a input resitivities to aplom the site , give a merly and better interpretation. </span>

<span class="sd">    :param station_rho_value: value of resistivities under the </span>
<span class="sd">                                site thin the maximum depth </span>
<span class="sd">    :type station_rho_value: array_like</span>
<span class="sd">    </span>
<span class="sd">    :param number_of_layer: number of layer to top to bottom.</span>
<span class="sd">    :type number_of_layer: int </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">number_of_layer</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">number_of_layer</span> <span class="o">=</span><span class="mf">7.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number_of_layer</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span> 
        <span class="k">try</span> <span class="p">:</span> 
            <span class="n">number_of_layer</span> <span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">number_of_layer</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span>
                <span class="s1">&#39;Could not convert number of  layer =</span><span class="si">{0}</span><span class="s1"> value into integer.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">number_of_layer</span><span class="p">)))</span>
            
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number_of_layer</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span> 
        <span class="k">try</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">number_of_layer</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">:</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span>
                <span class="s1">&#39;Could not convert number of layer =</span><span class="si">{}</span><span class="s1"> to integer.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_of_layer</span><span class="p">))</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">number_of_layer</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">number_of_layer</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">station_rho_value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span> 
        <span class="k">try</span> <span class="p">:</span> 
            <span class="n">station_rho_value</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">station_rho_value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">station_rho_value</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]:</span> 
                <span class="n">station_rho_value</span><span class="o">=</span> <span class="n">station_rho_value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_geoinputargument</span><span class="p">(</span>
                <span class="s1">&#39;Could not convert resistivities values &#39;</span>
                <span class="s1">&#39;to float number. Please provide a right values.&#39;</span><span class="p">)</span>
                  
                                                               
    
    <span class="c1"># get maxrho and min rho </span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">station_rho_value</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">station_rho_value</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">number_of_layer</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="build_resistivity_barplot"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.build_resistivity_barplot">[docs]</a><span class="k">def</span> <span class="nf">build_resistivity_barplot</span><span class="p">(</span><span class="n">depth_values</span> <span class="p">,</span> <span class="n">res_values</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allow to build bar plot resistivity function of  investigation depth .</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        * depth_values : aray_like </span>
<span class="sd">                model investigation depth </span>
<span class="sd">                </span>
<span class="sd">        * res_values : array_like </span>
<span class="sd">                model_resistivities at each depth values </span>
<span class="sd">            </span>
<span class="sd">    Returns </span>
<span class="sd">    ---------</span>
<span class="sd">        d : array_like </span>
<span class="sd">            resistivity barplot depth .</span>
<span class="sd">        r : array_like </span>
<span class="sd">               specific structure resistivities </span>
<span class="sd">        sumd : float</span>
<span class="sd">            checker number that cover in fact the total depth. </span>
<span class="sd">            this numbe must absolutely match the total depth .</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mess</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;Depth and resistivity arrays have no the same Length .&quot;</span><span class="p">,</span>
                    <span class="s2">&quot; Length Depth is =</span><span class="si">{0}</span><span class="s2"> and length depth is = </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">depth_values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_values</span><span class="p">))</span>
                    <span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">depth_values</span><span class="p">)</span> <span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="n">res_values</span><span class="p">)</span> <span class="p">:</span> 
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_geodrill_inputarguments</span><span class="p">(</span>
            <span class="s1">&#39;Error size. Depth and resistivity must have the same length.&#39;</span><span class="p">)</span>
    
    <span class="c1"># lop the resistivities array </span>
    <span class="n">v</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="p">[],[]</span>
    <span class="c1"># mm = res_values [0]</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res_values</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="n">res_values</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="c1"># if res egal the last value s, check the previous </span>
            <span class="k">if</span> <span class="n">res_values</span> <span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">!=</span> <span class="n">res_values</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="p">:</span> <span class="c1"># then append the last depth index to close the loop </span>
                <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="n">res_values</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="p">:</span> <span class="c1"># then clean the last index  of depth and replace it by the last one </span>
                <span class="c1"># v[-1]= depth_values [-1]</span>
                <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth_values</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
                
        <span class="k">elif</span> <span class="n">res</span> <span class="o">!=</span><span class="n">res_values</span><span class="p">[</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> 
            <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth_values</span> <span class="p">[</span><span class="n">ii</span><span class="p">])</span>
            <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
            
    <span class="c1"># thens substract the difference between depth values so all the sum must be egal to the maximum depth </span>
    <span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>        <span class="c1"># because the minimum depth start by 0 , then append  first value depth </span>
    
    <span class="k">for</span> <span class="n">dd</span> <span class="p">,</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">v</span><span class="p">):</span> 
        <span class="k">if</span> <span class="n">dd</span> <span class="o">&gt;</span><span class="mi">0</span> <span class="p">:</span> 
            <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">dd</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># </span>
            
    <span class="c1"># check the sum if it covers the total depth .</span>
    <span class="n">d</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">sumd</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="c1"># sanitize array and eliminate all negative values and zeros </span>
    <span class="n">d</span><span class="p">[</span><span class="n">d</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mf">0.</span>           <span class="c1"># then sanitize </span>
    <span class="n">d</span> <span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">d</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">d</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sumd</span></div>

<div class="viewcode-block" id="annotate_tip"><a class="viewcode-back" href="../../../utils.html#pycsamt.utils.plot_utils.annotate_tip">[docs]</a><span class="k">def</span> <span class="nf">annotate_tip</span><span class="p">(</span><span class="n">layer_thickness</span> <span class="p">,</span> <span class="n">layer_names</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A tip to group text with the same resistivities one layer when the layer </span>
<span class="sd">    are successively the same .</span>
<span class="sd">    </span>
<span class="sd">    :param layer_thickness: thickness of layer</span>
<span class="sd">    :type layer_thickness: array_like |list </span>
<span class="sd">    </span>
<span class="sd">    :param layer_names: names of layers , geological structures names </span>
<span class="sd">    :type layer_names: list or array_like </span>
<span class="sd">    </span>
<span class="sd">    :returns: v ,  layer  thickness in depth </span>
<span class="sd">    :rtype: array_like </span>
<span class="sd">    </span>
<span class="sd">    :returns: ni ,  list : name of layer </span>
<span class="sd">    :rtype: array_like </span>
<span class="sd">  </span>
<span class="sd">    :Example: </span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from pycsamt.utils import plot_utils as punc</span>
<span class="sd">        &gt;&gt;&gt; rocks = [&#39;Massive sulfide&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;,</span>
<span class="sd">             &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;, </span>
<span class="sd">             &#39;Massive sulfide&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;] </span>
<span class="sd">        &gt;&gt;&gt; resprops = [0.0, 49.0,69.0,89.0,109.0,129.0,</span>
<span class="sd">                        149.0,179.0,249.0,699.0,799.0,899.0]</span>
<span class="sd">        &gt;&gt;&gt; thickness, lnames = punc.annotate_tip(layer_thickness=resprops, layer_names=rocks)</span>
<span class="sd">        &gt;&gt;&gt;print(thickness)</span>
<span class="sd">        &gt;&gt;&gt; print(lnames)</span>
<span class="sd">        &gt;&gt;&gt; v, ni</span>
<span class="sd">        ...  [24.5, 149.0, 474.0, 799.0]</span>
<span class="sd">        ...  [&#39;Massive sulfide&#39;, &#39;Igneous rocks&#39;, &#39;Massive sulfide&#39;, &#39;Igneous rocks&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_thickness</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span> 
        <span class="k">return</span> <span class="n">layer_thickness</span><span class="p">,</span> <span class="n">layer_names</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_thickness</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
        <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;None value is provided, Please specify at least the thickness of one truth layer.&#39;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_tip</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
    
    <span class="n">top</span> <span class="o">=</span> <span class="n">layer_thickness</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="n">layer_thickness</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ni</span><span class="o">=</span><span class="p">[</span><span class="n">layer_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">v</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">thickvalues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layer_thickness</span><span class="p">):</span> 
        <span class="k">if</span> <span class="n">ii</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_thickness</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span>  <span class="c1"># controle whether the layer is the same name with previous ones </span>
                <span class="k">if</span> <span class="n">layer_names</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span> <span class="n">layer_names</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="p">:</span> 
                    <span class="n">mean</span> <span class="o">=</span> <span class="n">top</span> <span class="o">+</span> <span class="p">(</span><span class="n">thickvalues</span> <span class="o">-</span> <span class="n">top</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># we reached the bottom (top +center)</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
                    
                <span class="k">if</span> <span class="n">layer_names</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="n">layer_names</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="p">:</span>  <span class="c1"># then do the mean with previous one </span>
                    <span class="n">mean</span> <span class="o">=</span><span class="n">top</span> <span class="o">+</span> <span class="p">(</span><span class="n">layer_thickness</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">top</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># mean for the previous layers </span>
                    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
                    <span class="n">mean</span> <span class="o">=</span> <span class="n">layer_thickness</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">thickvalues</span><span class="o">-</span> <span class="n">layer_thickness</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>  <span class="c1">#top +center </span>
                    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
                    <span class="n">ni</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_names</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>                <span class="c1"># then append the last names </span>
            
            <span class="k">elif</span> <span class="n">layer_names</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="n">layer_names</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="p">:</span> <span class="c1"># if the name is the same that the previous values </span>
                <span class="n">bottom</span> <span class="o">=</span> <span class="n">thickvalues</span> <span class="c1"># the bottom of previous layer  is the top of layer ii</span>
                <span class="n">mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">top</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">top</span>         <span class="c1"># center the annotate text (top + center)</span>
                <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>                  <span class="c1"># keep values and layer names </span>
                <span class="n">ni</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_names</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>                <span class="c1"># append the name of layer </span>
                <span class="n">top</span> <span class="o">=</span><span class="n">bottom</span>                     <span class="c1"># top becomes the bottom </span>


    <span class="k">return</span> <span class="n">v</span><span class="p">,</span> <span class="n">ni</span>  </div>
    
    
   

<span class="c1"># if __name__==&#39;__main__&#39;:</span>
    
<span class="c1">#     RES=np.array([1.200000e-01, 1.200000e-01 ,1.200000e-01, 1.200000e-01, 1.200000e-01,</span>
<span class="c1">#              1.200000e-01, 1.200000e-01, 1.138263e+04, 1.138263e+04, 2.276514e+04,</span>
<span class="c1">#              3.414765e+04, 4.553016e+04 ,3.414765e+04, 2.276514e+04, 1.138263e+04,</span>
<span class="c1">#              1.138263e+04, 1.200000e-01, 1.200000e-01, 1.200000e-01, 1.200000e-01,</span>
<span class="c1">#              1.200000e-01, 1.200000e-01, 1.200000e-01, 1.138263e+04 ,2.276514e+04,</span>
<span class="c1">#              6.829517e+04])</span>
<span class="c1">#     pseudo_depth=np.array([  0. ,  6. , 13. , 20.  ,29. , 39.,  49. , 59. , 69. , 89., 109. ,129., 149. ,179.,</span>
<span class="c1">#                       209. ,249. ,289., 339., 399., 459. ,529. ,609., 699., 799., 899., 999.])</span>
    
<span class="c1">#     barT,bar_res,  sumd = build_resistivity_barplot(depth_values=pseudo_depth ,</span>
<span class="c1">#             res_values=RES)</span>
    
 
<span class="c1">#     rocks = [&#39;Massive sulfide&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;,</span>
<span class="c1">#              &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;, </span>
<span class="c1">#              &#39;Massive sulfide&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;, &#39;Igneous rocks&#39;] </span>

<span class="c1">#     resprops = [0.0, 49.0,69.0,89.0,109.0,129.0,149.0,179.0,249.0,699.0,799.0,899.0]</span>
    
<span class="c1">#     thickness, lnames = annotate_tip(layer_thickness=resprops, layer_names=rocks)</span>


    

    

    
    

    
    
    
    
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pyCSAMT v1.0.03 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Kouadio K. Laurent.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
    </div>
  </body>
</html>