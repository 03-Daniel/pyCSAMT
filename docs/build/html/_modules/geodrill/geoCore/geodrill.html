
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>geodrill.geoCore.geodrill &#8212; pyCSAMT v1.0.01 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pyCSAMT v1.0.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for geodrill.geoCore.geodrill</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">===============================================================================</span>
<span class="sd">    Copyright Â© 2021  Kouadio K.Laurent</span>
<span class="sd">    </span>
<span class="sd">    This file is part of pyCSAMT.</span>
<span class="sd">    </span>
<span class="sd">    pyCSAMT is free software: you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">    the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>
<span class="sd">    </span>
<span class="sd">    pyCSAMT is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU Lesser General Public License for more details.</span>
<span class="sd">    </span>
<span class="sd">    You should have received a copy of the GNU Lesser General Public License</span>
<span class="sd">    along with pyCSAMT.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>

<span class="sd">===============================================================================  </span>
<span class="sd">    </span>
<span class="sd">    . Special module to deal with inversion file ,and geologica data and Borehole data </span>
<span class="sd">    . Can read , create an output file directly use by Oasis Montaj of Geosoft</span>
<span class="sd">        corporation and Goldern Software.Can also build borehode data and</span>
<span class="sd">    .  generate a report of survey location . Deal with geostrata </span>
<span class="sd">    . module to incorporate conventional geological codes , pattern and colors. </span>
<span class="sd">    </span>
<span class="sd">Created on Sat Sep 19 12:37:42 2020</span>

<span class="sd">@author: Daniel03</span>
<span class="sd">     </span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">copy</span> 
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>

<span class="kn">import</span>  <span class="nn">csamtpy.utils.exceptions</span> <span class="k">as</span> <span class="nn">CSex</span>
<span class="kn">from</span> <span class="nn">csamtpy.modeling</span> <span class="kn">import</span> <span class="n">occam2d</span>
<span class="c1"># from csamtpy.utils.avg_utils import ReadFile as rfi</span>
<span class="kn">from</span> <span class="nn">csamtpy.ff.core.cs</span> <span class="kn">import</span> <span class="n">Profile</span>

<span class="kn">from</span> <span class="nn">csamtpy.utils</span> <span class="kn">import</span> <span class="n">func_utils</span> <span class="k">as</span> <span class="n">func</span>
<span class="kn">from</span> <span class="nn">csamtpy.utils</span> <span class="kn">import</span> <span class="n">plot_utils</span> <span class="k">as</span> <span class="n">punc</span>
<span class="kn">from</span> <span class="nn">csamtpy.utils</span> <span class="kn">import</span> <span class="n">Agso</span>
<span class="kn">from</span> <span class="nn">geodrill.geoCore</span> <span class="kn">import</span> <span class="n">structural</span> <span class="k">as</span> <span class="n">STRL</span>
<span class="kn">from</span> <span class="nn">geodrill.geoDB.sql_recorder</span> <span class="kn">import</span> <span class="n">GeoDataBase</span> 

<span class="k">try</span> <span class="p">:</span> 
    <span class="kn">from</span> <span class="nn">csamtpy.utils._csamtpylog</span> <span class="kn">import</span> <span class="n">csamtpylog</span>
    <span class="n">_logger</span><span class="o">=</span><span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="k">except</span> <span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span> <span class="p">:</span> 
      <span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">spSTAT</span>
      <span class="n">scipy_version</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">vers</span><span class="p">)</span> <span class="k">for</span> <span class="n">vers</span> <span class="ow">in</span> <span class="n">sp</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)]</span> 
      <span class="k">if</span> <span class="n">scipy_version</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span> 
          <span class="k">if</span> <span class="n">scipy_version</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="p">:</span>
              <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Note: need scipy version 1.4.0 or more . It may probably  get a trouble when import &quot;stats&quot; attribute&#39;</span>
                            <span class="s1">&#39;under such version.It may probably move from &#39;</span><span class="p">,</span> <span class="ne">ImportWarning</span><span class="p">)</span>
              <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Note: need scipy version 0.14.0 or higher or for stats.linearegress. Under such version&#39;</span>
                              <span class="s1">&#39;it might not work.&#39;</span><span class="p">)</span>
      <span class="c1"># from sp import stats </span>
      <span class="n">stats_import</span> <span class="o">=</span><span class="kc">True</span> 
          
<span class="k">except</span> <span class="p">:</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Could not find scipy.stats, cannot use method linearregression&#39;</span>
                  <span class="s1">&#39;check installation you can get scipy from scipy.org.&#39;</span><span class="p">)</span>
    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Could not find scipy.stats, cannot use method linearegress&#39;</span>
                    <span class="s1">&#39;check installation you can get scipy from scipy.org.&#39;</span><span class="p">)</span>
    
    <span class="n">stats_import</span> <span class="o">=</span><span class="kc">False</span> 


<div class="viewcode-block" id="Geodrill"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geodrill">[docs]</a><span class="k">class</span> <span class="nc">Geodrill</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to manage data from Occam2D and Model so to create section of each  </span>
<span class="sd">    sites and it depth.Each station constitues an attribute framed by two closest  </span>
<span class="sd">    point of station offsets from model resistivities.</span>
<span class="sd">    Deal with  True resistivities get on the survey or with others firms. </span>
<span class="sd">    In fact , input truth resistivities values into our model , produce an accuracy </span>
<span class="sd">    underground map.The challenge to build pseudolog allow to know how layers are </span>
<span class="sd">    disposal in underground so to emphasize the large conductive zone  especially </span>
<span class="sd">    in the case of groundwater exploration.  Program works in combinaison with</span>
<span class="sd">    geophysic data especially Occam 2D inversion data,  and  geological data.</span>
<span class="sd">    Actually the program deal only with  Occam 2D inversion files or  Bo Yang</span>
<span class="sd">    (x,y,z) files. We intend to extendlater with other external softares but</span>
<span class="sd">    can generate output directly see use with Golder sofware(&#39;surfer&#39;). If user</span>
<span class="sd">     has a golder software installed on its computer , It can use  output files </span>
<span class="sd">     generated here  to produce 2D map so to compare both maps to see how far </span>
<span class="sd">    is the difference between  Model map and detail-sequences map ) </span>
<span class="sd">    &quot;pseudosequences model&quot; could match better the reality of underground).</span>
<span class="sd">    Details sequences map is most closest to the reality  When {step descent}</span>
<span class="sd">    parameter is not too  small at all. Indeed True geological data allow</span>
<span class="sd">    to harmonize the value of resistivity produced by Occam2D model so to force </span>
<span class="sd">    the pogramm to make a correlation  between data fromtruth layers and the model</span>
<span class="sd">    values.</span>

<span class="sd">    NB : In this section all resistivites are in ohm.meter not in log10.</span>

<span class="sd">    arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        model_fn  : str , </span>
<span class="sd">               full path to Occam model  file .</span>
<span class="sd">                                                       </span>
<span class="sd">        iter_fn :  str                </span>
<span class="sd">                full path to occam iteration  file</span>
<span class="sd">                                                        </span>
<span class="sd">        data_fn  :  str , </span>
<span class="sd">               full path to occam_data file </span>
<span class="sd">        input_resistivities :   array_like, </span>
<span class="sd">                        Truth values of resistivities </span>

<span class="sd">        step_descent  : float  , </span>
<span class="sd">                                step to enforce the model resistivities to</span>
<span class="sd">                                  keep the  truth layers values as reference</span>
<span class="sd">                                  .Step to cut out data and to  force resistivites </span>
<span class="sd">                                 calcualted to match the reference data as input </span>
<span class="sd">                                 resistivities if not provided the step will be</span>
<span class="sd">                                 20% of D0I</span>
<span class="sd">        input_layers :  array_like , </span>
<span class="sd">                        True input_layers names : geological </span>
<span class="sd">                        informations of encountered layers </span>

<span class="sd">    ================================================================================</span>
<span class="sd">    attributes               type                  explanation </span>
<span class="sd">    ================================================================================</span>
<span class="sd">    </span>
<span class="sd">    doi                      str                depth of investigation might</span>
<span class="sd">                                                be float or str like &quot;1km&quot; =1000</span>
<span class="sd">    depth_scale             str                 scale of imaging depth can be </span>
<span class="sd">                                                     &quot;km&quot; or &quot;m&quot;.  Default is&quot;m&quot; </span>
<span class="sd">    lc_AD_curves            dict                customize line color of average curve </span>
<span class="sd">                                                and details sequences </span>
<span class="sd">    elevation               array_like              elevation of survey area </span>
<span class="sd">    iter2dat_fn             str                full path to Bo Yang (x, y, z) </span>
<span class="sd">                                                    model_file </span>
<span class="sd">    bln_file                str                full path to station location file </span>
<span class="sd">                                                additional file issue from Bo Yang</span>
<span class="sd">                                                (x, y, z file)</span>
<span class="sd">    =================================================================================</span>
<span class="sd">    eg::: </span>
<span class="sd">        &gt;&gt;&gt; from geodrill.geoCore.geodrill import Geodrill </span>
<span class="sd">        &gt;&gt;&gt; path =os.path.join(os.environ [&#39;pyCSAMT&#39;], &#39;csamtpy&#39;, &#39;data&#39;, &#39;occam2D&#39;)</span>
<span class="sd">        &gt;&gt;&gt; geo_obj = Geodrill( input_resistivities=[300, 500, 1000, 2000, 4000, 6000],</span>
<span class="sd">                               input_layers =[&#39;alluvium&#39;, &#39;amphibolite&#39;,&#39;altered rock&#39;,</span>
<span class="sd">                                                            &#39;augen gneiss&#39;, &#39;granite&#39;],</span>
<span class="sd">                               mesh_fn=os.path.join(path, &#39;Occam2DMesh&#39;)</span>
<span class="sd">                               iter_fn = os.path.join(path, &#39;ITER17.iter&#39;), </span>
<span class="sd">                               model_fn =os.path.join(path, &#39;Occam2DModel&#39;) , </span>
<span class="sd">                               data_fn =os.path.join(path, &#39;OccamDataFile.dat&#39;),</span>
<span class="sd">                               doi=&#39;1km&#39;, </span>
<span class="sd">                               step_descent=200., </span>
<span class="sd">                                  )</span>
<span class="sd">        &gt;&gt;&gt; geo_obj.geo_build_strata_logs()</span>
<span class="sd">        ....geo_obj.geo_name_S01</span>
<span class="sd">        ... geo_obj.geo_name_S00</span>
<span class="sd">        ... geo_obj.geo_name_S46</span>
<span class="sd">        ... geo_obj.geo_d</span>
<span class="sd">        ... geo_obj.geo_drr</span>
<span class="sd">        ... geo_obj.geo_daver</span>
<span class="sd">        ... geo_obj.geo_depth </span>
<span class="sd">        ... geo_obj.geo_dstep_descent</span>
<span class="sd">   </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">geo_rocks_properties</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;basement rocks&quot;</span> <span class="p">:</span>          <span class="p">[</span><span class="mf">1e99</span><span class="p">,</span><span class="mf">1e6</span> <span class="p">],</span>
                    <span class="s2">&quot;igneous rocks&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">],</span> 
                    <span class="s2">&quot;duricrust&quot;</span>   <span class="p">:</span>             <span class="p">[</span><span class="mf">5.1e3</span> <span class="p">,</span> <span class="mf">5.1e2</span><span class="p">],</span>
                    <span class="s2">&quot;gravel/sand&quot;</span> <span class="p">:</span>             <span class="p">[</span><span class="mf">1e4</span>  <span class="p">,</span> <span class="mf">7.943e0</span><span class="p">],</span>
                    <span class="s2">&quot;conglomerate&quot;</span>    <span class="p">:</span>         <span class="p">[</span><span class="mf">1e4</span>  <span class="p">,</span> <span class="mf">8.913e1</span><span class="p">],</span>
                    <span class="s2">&quot;dolomite/limestone&quot;</span> <span class="p">:</span>      <span class="p">[</span><span class="mf">1e5</span> <span class="p">,</span>  <span class="mf">1e3</span><span class="p">],</span>
                   <span class="s2">&quot;permafrost&quot;</span>  <span class="p">:</span>              <span class="p">[</span><span class="mf">1e5</span>  <span class="p">,</span> <span class="mf">4.169e2</span><span class="p">],</span>
                    <span class="s2">&quot;metamorphic rocks&quot;</span> <span class="p">:</span>       <span class="p">[</span><span class="mf">5.1e2</span> <span class="p">,</span> <span class="mf">1e1</span><span class="p">],</span>
                    <span class="s2">&quot;tills&quot;</span>  <span class="p">:</span>                   <span class="p">[</span><span class="mf">8.1e2</span> <span class="p">,</span> <span class="mf">8.512e1</span><span class="p">],</span>
                    <span class="s2">&quot;standstone conglomerate&quot;</span> <span class="p">:</span>  <span class="p">[</span><span class="mf">1e4</span> <span class="p">,</span> <span class="mf">8.318e1</span><span class="p">],</span>
                    <span class="s2">&quot;lignite/coal&quot;</span><span class="p">:</span>               <span class="p">[</span><span class="mf">7.762e2</span> <span class="p">,</span> <span class="mf">1e1</span><span class="p">],</span>
                    <span class="s2">&quot;shale&quot;</span>   <span class="p">:</span>                   <span class="p">[</span><span class="mf">5.012e1</span> <span class="p">,</span> <span class="mf">3.20e1</span><span class="p">],</span>
                    <span class="s2">&quot;clay&quot;</span>   <span class="p">:</span>                    <span class="p">[</span><span class="mf">1e2</span> <span class="p">,</span>  <span class="mf">5.012e1</span><span class="p">],</span>
                    <span class="s2">&quot;saprolite&quot;</span> <span class="p">:</span>                 <span class="p">[</span><span class="mf">6.310e2</span> <span class="p">,</span> <span class="mf">3.020e1</span><span class="p">],</span>
                    <span class="s2">&quot;sedimentary rocks&quot;</span><span class="p">:</span>          <span class="p">[</span><span class="mf">1e4</span> <span class="p">,</span> <span class="mf">1e0</span><span class="p">],</span>
                    <span class="s2">&quot;fresh water&quot;</span>  <span class="p">:</span>              <span class="p">[</span><span class="mf">3.1e2</span> <span class="p">,</span><span class="mf">1e0</span><span class="p">],</span>
                    <span class="s2">&quot;salt water&quot;</span>   <span class="p">:</span>              <span class="p">[</span><span class="mf">1e0</span> <span class="p">,</span> <span class="mf">1.41e0</span><span class="p">],</span>
                    <span class="s2">&quot;massive sulphide&quot;</span> <span class="p">:</span>           <span class="p">[</span><span class="mf">1e0</span>   <span class="p">,</span>  <span class="mf">1e-2</span><span class="p">],</span>
                    <span class="s2">&quot;sea water&quot;</span>     <span class="p">:</span>             <span class="p">[</span><span class="mf">1.231e-1</span> <span class="p">,</span><span class="mf">1e-1</span><span class="p">],</span>
                    <span class="s2">&quot;ore minerals&quot;</span>  <span class="p">:</span>             <span class="p">[</span><span class="mf">1e0</span>   <span class="p">,</span> <span class="mf">1e-4</span><span class="p">],</span>
                    <span class="s2">&quot;graphite&quot;</span>    <span class="p">:</span>               <span class="p">[</span><span class="mf">3.1623e-2</span><span class="p">,</span> <span class="mf">3.162e-3</span><span class="p">]</span>
        
        <span class="p">}</span>
    
    <span class="n">geo_params</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;model_x_nodes&#39;</span><span class="p">,</span> <span class="s1">&#39;model_z_nodes&#39;</span><span class="p">,</span> <span class="s1">&#39;model_res&#39;</span><span class="p">,</span> <span class="s1">&#39;station_names&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;station_location&#39;</span><span class="p">,</span> <span class="s1">&#39;elevation&#39;</span><span class="p">]</span>
    <span class="n">geoparams</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;geo_offsets&#39;</span><span class="p">,</span> <span class="s1">&#39;geo_depth&#39;</span><span class="p">,</span> <span class="s1">&#39;geo_res&#39;</span><span class="p">,</span> <span class="s1">&#39;geo_name&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;geo_location&#39;</span><span class="p">,</span> <span class="s1">&#39;geo_elevation&#39;</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iter2dat_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">model_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">data_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">iter_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">mesh_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span>
                 <span class="n">bln_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span> <span class="o">=</span> <span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">iter2dat_fn</span> <span class="o">=</span> <span class="n">iter2dat_fn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="o">=</span><span class="n">data_fn</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">iter_fn</span> <span class="o">=</span><span class="n">iter_fn</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_fn</span> <span class="o">=</span><span class="n">mesh_fn</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">model_fn</span> <span class="o">=</span><span class="n">model_fn</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">bln_fn</span> <span class="o">=</span><span class="n">bln_fn</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_layers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_resistivities&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;doi&#39;</span><span class="p">,</span> <span class="s1">&#39;1km&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;elevation&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;step_descent&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    
        
        
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_params</span> <span class="p">:</span>  <span class="c1"># Initialise attributes to None value to recover it later  </span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter2dat_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">set_geodata</span><span class="p">()</span>
    
<div class="viewcode-block" id="Geodrill.set_geodata"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geodrill.set_geodata">[docs]</a>    <span class="k">def</span> <span class="nf">set_geodata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">iter2dat_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span>  <span class="n">model_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">data_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                    <span class="n">iter_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">mesh_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Readmodel data and collected from each site its value from surface to depth </span>
<span class="sd">        </span>
<span class="sd">        EG :: </span>
<span class="sd">            &gt;&gt;&gt; form csamtpy.geodrill import Geodrill </span>
<span class="sd">            (1) read with Occam 2D output file  </span>
<span class="sd">                </span>
<span class="sd">            &gt;&gt;&gt; path_occam2d = os.path.join(os.environ [&#39;pyCSAMT&#39;], &#39;csamtpy&#39;, &#39;data&#39;, &#39;occam2D&#39;)</span>
<span class="sd">            &gt;&gt;&gt; path_i2d =os.path.join(os.environ [&#39;pyCSAMT&#39;], &#39;csamtpy&#39;, &#39;data&#39;, &#39;_iter2dat_2&#39;)</span>
<span class="sd">         </span>
<span class="sd">            &gt;&gt;&gt; geo_obj =Geodrill(model_fn  = os.path.join(path_occam2d,&#39;Occam2DModel&#39;), </span>
<span class="sd">                              mesh_fn = os.path.join(path_occam2d, &#39;Occam2DMesh&#39;), </span>
<span class="sd">                              iter_fn = os.path.join(path_occam2d, &#39;ITER17.iter&#39;), </span>
<span class="sd">                              data_fn = os.path.join(path_occam2d, &#39;OccamDataFile.dat&#39;))</span>
<span class="sd">            </span>
<span class="sd">            (2)--&gt; Read with only iter2dat file and bln file </span>
<span class="sd">            geo_obj =Geodrill(iter2dat_fn  = os.path.join(path_i2d, &#39;K1.iter.dat&#39;), </span>
<span class="sd">                              bln_fn = os.path.join(path_i2d, &#39;K1.bln&#39;),)</span>
<span class="sd">        </span>

<span class="sd">            ... geo_model_off = geo_obj.model_x_nodes</span>
<span class="sd">            ... geo_model_res= geo_obj.model_res</span>
<span class="sd">            ... geoS01 = geo_obj.geo_name_S01</span>
<span class="sd">            ... geoS00= geo_obj.geo_name_S00</span>
<span class="sd">            ... geoS46=geo_obj.geo_name_S46</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:-^77}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;GeoDrill *Data* info&#39;</span><span class="p">))</span>
        
        <span class="k">def</span> <span class="nf">frame_each_site_into_3_offsets</span><span class="p">(</span><span class="n">site_name</span><span class="p">,</span> <span class="n">model_res</span><span class="p">,</span> <span class="n">model_offset</span><span class="p">,</span> <span class="n">site_offset</span><span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Fonction to frame each site into 3 offsets and put array </span>
<span class="sd">            params : site_names : str </span>
<span class="sd">                                    name of site : eg S01 </span>
<span class="sd">                    model_res : ndarray(depth, station_offset) </span>
<span class="sd">                                        resistivity ndarray </span>
<span class="sd">                    model_offste : array_like </span>
<span class="sd">                                        the offset fenerated by mesh </span>
<span class="sd">                    site _offset : float </span>
<span class="sd">                                the offset of that site  : 15.0 m  </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># fist check if site offset in in model offset</span>
            <span class="n">model_offset</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">model_offset</span><span class="p">])</span>
            <span class="n">site_offset</span> <span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">site_offset</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
 
            <span class="k">if</span> <span class="n">site_offset</span> <span class="ow">in</span> <span class="n">model_offset</span> <span class="p">:</span> 
         
                <span class="c1"># get new index </span>
                <span class="n">new_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">model_offset</span><span class="o">==</span><span class="n">site_offset</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">new_off</span> <span class="o">=</span> <span class="n">model_offset</span><span class="p">[</span><span class="n">new_index</span><span class="p">]</span>
        
            <span class="k">elif</span> <span class="n">site_offset</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_offset</span> <span class="p">:</span>
     
                <span class="k">if</span> <span class="n">site_offset</span> <span class="o">&gt;</span> <span class="n">model_offset</span><span class="o">.</span><span class="n">max</span> <span class="p">():</span> <span class="c1"># the case where offset is much larger than the mesh (very rare case )</span>
                    <span class="n">new_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">model_offset</span><span class="o">==</span><span class="n">model_offset</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">new_off</span> <span class="o">=</span> <span class="n">model_offset</span><span class="o">.</span><span class="n">max</span> <span class="p">()</span>
                <span class="k">else</span> <span class="p">:</span> 
                    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model_offset</span><span class="p">):</span> 
                        <span class="k">if</span> <span class="n">di</span> <span class="o">&gt;</span> <span class="n">site_offset</span> <span class="p">:</span> <span class="c1"># if value of model is greater than check the closest site offset </span>
                            <span class="n">dx0</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">site_offset</span> <span class="o">-</span><span class="n">di</span> <span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># compute the distance betewn di and offset (dxmax )</span>
                        <span class="c1"># try co compute the previous and the next point distance </span>
                        <span class="c1"># use try because sometimes , previous point is none if model value is at index 0 </span>
                        <span class="c1"># if model value at index 0 , then dx0 = dmin </span>
                            <span class="k">try</span> <span class="p">:</span> <span class="n">dxmin</span> <span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">model_offset</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">site_offset</span><span class="p">)</span>
                            <span class="k">except</span> <span class="p">:</span> <span class="n">dxmin</span> <span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">dx0</span> <span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">dx0</span> <span class="o">&lt;=</span>  <span class="n">dx0</span> <span class="p">:</span> 
                                <span class="n">new_off</span> <span class="p">,</span> <span class="n">new_index</span> <span class="o">=</span> <span class="n">di</span><span class="p">,</span> <span class="n">ii</span>  
                                <span class="k">break</span> 
                            <span class="k">elif</span> <span class="n">dxmin</span> <span class="o">&lt;</span> <span class="n">dx0</span> <span class="p">:</span> 
                                 <span class="n">new_off</span><span class="p">,</span> <span class="n">new_index</span> <span class="o">=</span> <span class="n">model_offset</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ii</span><span class="o">-</span><span class="mi">1</span> <span class="c1"># take the preious </span>
                                 <span class="k">break</span> 
     
            <span class="c1"># now get the list of resistivity between this index </span>
          
            <span class="k">if</span> <span class="n">new_off</span> <span class="o">==</span> <span class="n">model_offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="c1"># the first site index then take ii+1, ii+2 </span>
                <span class="n">dm0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span> <span class="p">((</span><span class="n">model_res</span><span class="p">[:,</span><span class="n">new_index</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">model_res</span><span class="p">[:,</span> <span class="n">new_index</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> 
                                       <span class="n">model_res</span><span class="p">[:,</span><span class="n">new_index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">model_res</span><span class="p">[:,</span> <span class="n">new_index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> 
                                       <span class="n">model_res</span><span class="p">[:,</span><span class="n">new_index</span> <span class="o">+</span><span class="mi">2</span> <span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">model_res</span><span class="p">[:,</span> <span class="n">new_index</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span> 
                                       
                                       <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">new_off</span> <span class="o">==</span> <span class="n">model_offset</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> 
                <span class="n">dm0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span> <span class="p">((</span><span class="n">model_res</span><span class="p">[:,</span><span class="n">new_index</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">model_res</span><span class="p">[:,</span> <span class="n">new_index</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> 
                                       <span class="n">model_res</span><span class="p">[:,</span><span class="n">new_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">model_res</span><span class="p">[:,</span> <span class="n">new_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> 
                                       <span class="n">model_res</span><span class="p">[:,</span><span class="n">new_index</span> <span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">model_res</span><span class="p">[:,</span> <span class="n">new_index</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span>
                                       <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="k">else</span> <span class="p">:</span> 
                <span class="n">dm0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span> <span class="p">((</span><span class="n">model_res</span><span class="p">[:,</span><span class="n">new_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">model_res</span><span class="p">[:,</span> <span class="n">new_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> 
                                       <span class="n">model_res</span><span class="p">[:,</span><span class="n">new_index</span> <span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">model_res</span><span class="p">[:,</span> <span class="n">new_index</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> 
                                       <span class="n">model_res</span><span class="p">[:,</span><span class="n">new_index</span> <span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">model_res</span><span class="p">[:,</span> <span class="n">new_index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span>
                                       <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                
            <span class="k">return</span> <span class="n">site_name</span><span class="p">,</span> <span class="n">dm0</span> 

 
        <span class="c1"># ----&gt; attributes statements </span>
        <span class="k">if</span> <span class="n">model_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_fn</span> <span class="o">=</span><span class="n">model_fn</span> 
        <span class="k">if</span> <span class="n">data_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="o">=</span><span class="n">data_fn</span> 
        <span class="k">if</span> <span class="n">iter_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_fn</span> <span class="o">=</span><span class="n">iter_fn</span> 
        <span class="k">if</span> <span class="n">mesh_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_fn</span> <span class="o">=</span><span class="n">mesh_fn</span> 
        
        <span class="k">if</span> <span class="n">iter2dat_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter2dat_fn</span> <span class="o">=</span> <span class="n">iter2dat_fn</span> 
        
        <span class="c1"># then assert all input files </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter2dat_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Read Geodata from  Bo Yang Iter2Dat files &#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bln_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;No (*bln) station file found. Need sites names and sites locations.&#39;</span><span class="p">,</span>
                               <span class="s1">&#39; Use mode &quot;Iter2Dat&quot;  :&lt;from csamtpy.modeling.occam2d import Iter2Dat&gt; : to write a *bln file &#39;</span><span class="p">,</span> 
                               <span class="s1">&#39; use a Profile module : &lt; from csamtpy.ff.core.cs import Profile &gt; .&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39; You can also use occam2D output files like model, mesh, data, and iteration files.&#39;</span><span class="p">])</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;! Error reading *.bln flile !&#39;</span> <span class="o">+</span> <span class="n">mess</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_geodrill_inputarguments</span><span class="p">(</span><span class="s1">&#39;! Error reading *.bln flile ! &#39;</span>\
                                                              <span class="s1">&#39;No (*bln) station file found. Need sites names and sites locations.&#39;</span><span class="p">)</span>
            <span class="n">i2d_obj</span> <span class="o">=</span> <span class="n">occam2d</span><span class="o">.</span><span class="n">Iter2Dat</span><span class="p">(</span><span class="n">iter2dat_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iter2dat_fn</span><span class="p">,</span>
                                       <span class="n">bln_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bln_fn</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">model_x_nodes</span><span class="o">=</span> <span class="n">i2d_obj</span><span class="o">.</span><span class="n">model_x_nodes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span> <span class="o">=</span> <span class="n">i2d_obj</span><span class="o">.</span><span class="n">model_z_nodes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_res</span> <span class="o">=</span> <span class="n">i2d_obj</span><span class="o">.</span><span class="n">model_res</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span> <span class="o">=</span> <span class="n">i2d_obj</span><span class="o">.</span><span class="n">station_names</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">station_location</span> <span class="o">=</span> <span class="n">i2d_obj</span><span class="o">.</span><span class="n">station_location</span>
   
            
        <span class="k">else</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Read Geodata from  Occam2D files  &#39;</span><span class="p">)</span>
            <span class="c1"># check if all attributes are not None </span>
            <span class="k">for</span> <span class="n">attr</span> <span class="p">,</span> <span class="n">ins</span>  <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;model_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;iter_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;data_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;mesh_fn&#39;</span><span class="p">],</span>
                                   <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model_fn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_fn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_fn</span><span class="p">]):</span> 
                <span class="k">if</span> <span class="n">ins</span> <span class="o">==</span><span class="kc">None</span> <span class="p">:</span> 
                    <span class="n">msg</span> <span class="o">=</span><span class="s1">&#39; !No </span><span class="si">{0}</span><span class="s1"> file found ! Please provide the Occam 2D </span><span class="si">{0}</span><span class="s1"> file&#39;</span><span class="o">.</span>\
                        <span class="nb">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_geoinputargument</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                
            <span class="c1"># Recreate object and get ncessaries attributes </span>
            <span class="n">model_obj</span><span class="o">=</span> <span class="n">occam2d</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">model_fn</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_fn</span><span class="p">,</span> <span class="n">iter_fn</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iter_fn</span><span class="p">,</span> 
                                    <span class="n">mesh_fn</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_fn</span> <span class="p">)</span>
            <span class="n">data_obj</span> <span class="o">=</span><span class="n">occam2d</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">)</span>
            
            <span class="c1"># then get important attributes and re</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_x_nodes</span> <span class="o">=</span><span class="n">model_obj</span><span class="o">.</span><span class="n">model_station_offsets</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span> <span class="o">=</span><span class="n">model_obj</span><span class="o">.</span><span class="n">model_depth_offsets</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_res</span> <span class="o">=</span> <span class="n">model_obj</span><span class="o">.</span><span class="n">model_resistivity</span> 
            <span class="c1"># get from data sites names and station location and elevation </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span> <span class="o">=</span><span class="n">data_obj</span><span class="o">.</span><span class="n">data_sites</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">station_location</span> <span class="o">=</span> <span class="n">data_obj</span><span class="o">.</span><span class="n">data_offsets</span>
            
        <span class="c1"># build for each site an array of three values framed into the main sites </span>
        <span class="c1">#    get the the offset of the site </span>
        <span class="c1"># build a dictionnary of geoname</span>
        
        <span class="c1">#------Mange DOI (investigation depth) --------</span>
        
        <span class="c1"># check the depth of investigation and ge the new_nodel matrix </span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="o">=</span> <span class="mf">1000.</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="o">=</span><span class="n">punc</span><span class="o">.</span><span class="n">depth_of_investigation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doi</span><span class="p">)</span> <span class="c1"># return meter value</span>

        <span class="c1"># for consistency let check how the depth is ranged : Depth is  minimum to max depth , if not flip data </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="c1"># chech the doi data and compare to max depth data </span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="o">.</span><span class="n">max</span> <span class="p">():</span> 
            <span class="n">mess</span><span class="o">=</span><span class="s1">&#39;Maximum Input doi value = </span><span class="si">{0}</span><span class="s1"> m is larger&#39;</span>\
                          <span class="s1">&#39; than model depth = </span><span class="si">{1}</span><span class="s1"> m. Investigation depth &quot;doi&quot; will be resetting at = &quot;</span><span class="si">{1}</span><span class="s1">&quot;m.&#39;</span><span class="o">.</span>\
                              <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>         <span class="c1"># resseting doi to maximum value in model depth </span>
            
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">debug</span> <span class="p">(</span><span class="n">mess</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="p">:</span> 
            <span class="n">dep_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>  <span class="c1"># if doi is the  max depth , </span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;geo_depth&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="p">)</span>
                
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span>  <span class="o">&lt;</span>     <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>         <span class="c1"># resize model _resistivity </span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_res</span><span class="p">,</span> <span class="p">(</span><span class="n">dep_index</span> <span class="o">+</span><span class="mi">1</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_res</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;geo_depth&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="p">[:</span><span class="n">dep_index</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># resize the large depth to doi max  </span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; resetting model doi to = </span><span class="si">{0}</span><span class="s1"> m depth !&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doi</span><span class="p">))</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">dep</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="p">)</span> <span class="p">:</span> 
                <span class="k">if</span> <span class="n">dep</span>  <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span>  <span class="p">:</span>       <span class="c1"># seek the depth index that match better the  input doi 1014&gt;1000 :index=23,</span>
                    <span class="n">dep_index</span> <span class="o">=</span> <span class="n">index</span><span class="o">-</span><span class="mi">1</span>     <span class="c1"># get the previous index dep_index = 22</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_res</span><span class="p">,</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_res</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="c1"># index because of python count (add+1) to depth index</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="p">[</span><span class="n">dep_index</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; resetting model doi to =</span><span class="si">{0}</span><span class="s1"> m depth !&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doi</span><span class="p">))</span>
                    
                    <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;geo_depth&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_z_nodes</span><span class="p">[:</span><span class="n">index</span><span class="p">])</span>
                    <span class="k">break</span> 
                
        <span class="c1"># build geo_station_names and geodict rho </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_d</span> <span class="o">=</span><span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span> <span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span> <span class="p">:</span> 
    
            <span class="n">site_offset_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)]</span>
            
            <span class="n">geo_name</span> <span class="p">,</span> <span class="n">geodat</span> <span class="o">=</span> <span class="n">frame_each_site_into_3_offsets</span><span class="p">(</span><span class="n">site_name</span><span class="o">=</span> <span class="n">name</span><span class="p">,</span> 
                                                               <span class="n">model_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_res</span><span class="p">,</span> 
                                                               <span class="n">model_offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model_x_nodes</span><span class="p">,</span> 
                                                               <span class="n">site_offset</span><span class="o">=</span><span class="n">site_offset_value</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;geo_name_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geo_name</span><span class="p">),</span> <span class="n">geodat</span><span class="p">)</span>
            <span class="c1"># convert resistivities value from log10 rho to ohm meter </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geo_d</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;geo_name_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geo_name</span><span class="p">)))</span> <span class="c1"># </span></div>
            
            <span class="c1"># self.geo_dict[name]=  getattr(self, &#39;geo_name_{0}&#39;.format(geo_name))</span>
            
  
<div class="viewcode-block" id="Geodrill.geo_replace_rho"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geodrill.geo_replace_rho">[docs]</a>    <span class="k">def</span> <span class="nf">geo_replace_rho</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_resistivity_range</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">input_layers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span> 
        
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Allow ro replace the calculated resistivities from model to real resistivites obtained </span>
<span class="sd">       on survey area with other companies. The accuracy depend How many number of resistivites are.</span>
<span class="sd">       More resitivities ,more accuracy in the designed of underground model geostratigrapyhy model.</span>
<span class="sd">        params : </span>
<span class="sd">            input_resistivity_range :array_like , </span>
<span class="sd">                                an array of resistivity on the site</span>
<span class="sd">            input_layers : list or array , </span>
<span class="sd">                            layers_names , eg :[granite, fault, river ]</span>
<span class="sd">            depth_range : an array _like , </span>
<span class="sd">                            an array _of depth of specific layer </span>
<span class="sd">        Eg : [500, 70, 189] , depth [10, 25, 100]</span>
<span class="sd">            -----------------------------------------------------</span>
<span class="sd">            Structure	Rho mean value (Î©.m)	Rho range  (Î©.m)</span>
<span class="sd">            -----------------------------------------------------</span>
<span class="sd">            Granite	                2000	       1000-3000</span>
<span class="sd">            Fault fracture zone 	120	           60-180</span>
<span class="sd">            River water 	         68	           66-70</span>
<span class="sd">            ----------------------------------------------------</span>

<span class="sd">        &quot;&quot;&quot;</span>
  
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter2dat_fn</span> <span class="ow">is</span> <span class="kc">None</span>  <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">set_geodata</span><span class="p">()</span> <span class="c1"># loead attribute </span>
        
        <span class="k">def</span> <span class="nf">find_and_replace_rho</span><span class="p">(</span><span class="n">rowlines</span><span class="p">,</span> <span class="n">value_range</span><span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Small function replacement function, the model&#39;s resistivities are </span>
<span class="sd">            replaced by the true value of the survey. T higher the replacement is,</span>
<span class="sd">            the more prominent the specificities of the layers become.</span>
<span class="sd"> </span>
<span class="sd">            params : </span>
<span class="sd">                rowlines :      array_like </span>
<span class="sd">                            array of resistivities values </span>
<span class="sd">                value_range :   array_like </span>
<span class="sd">                                array of resistivities from survey area.</span>
<span class="sd">                return :        </span>
<span class="sd">                    rowlines , new data range </span>
<span class="sd">                                </span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># for consistency convert to float value </span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="n">value_range</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">value_range</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_geodrill_inputarguments</span><span class="p">(</span><span class="s1">&#39;Value provided as resistivity&#39;</span>\
                                                                <span class="s1">&#39; range must be an array of float number.&#39;</span><span class="p">)</span>
            <span class="n">tem</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">value_range</span> <span class="p">:</span>     <span class="c1"># loop the value range </span>
                <span class="n">op</span> <span class="o">=</span> <span class="n">rowlines</span><span class="o">-</span><span class="n">mm</span>        <span class="c1"># substract rowlines from value range to seek the minimum close</span>
                <span class="n">op</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">aj</span><span class="p">)</span> <span class="k">for</span> <span class="n">aj</span> <span class="ow">in</span> <span class="n">op</span><span class="p">])</span> <span class="c1"># keep absolute value for difference </span>
                <span class="n">tem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>                      <span class="c1"># keep it on temporray list  </span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span><span class="n">tem</span><span class="p">)</span>   <span class="c1"># concat list to axis =0 order </span>
            
            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rowlines</span><span class="p">)):</span>         <span class="c1"># loop the rowlines line now </span>
                <span class="n">us</span><span class="o">=</span><span class="n">ts</span><span class="p">[:,</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>                <span class="c1"># keep minimum index </span>
                <span class="n">rowlines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">=</span><span class="n">value_range</span><span class="p">[</span><span class="n">us</span><span class="p">]</span>        <span class="c1"># change the resistivity values </span>
                
            <span class="k">return</span> <span class="n">rowlines</span>
        
        
        <span class="k">def</span> <span class="nf">ascertain_input_layers</span><span class="p">(</span><span class="n">input_layers</span><span class="p">,</span> <span class="n">input_rho</span><span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Function to assert the length of input layers and the input resistivities </span>
<span class="sd">            to avoid miscomputation </span>
<span class="sd">            params : </span>
<span class="sd">                input_layers : array_like |list </span>
<span class="sd">                            list of input</span>
<span class="sd">                input_rho : list </span>
<span class="sd">                            layer list of resistivities provided </span>
<span class="sd">            return new list of input layers </span>
<span class="sd">        </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">ilay</span> <span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ly</span><span class="p">)</span> <span class="k">for</span> <span class="n">ly</span> <span class="ow">in</span> <span class="n">input_layers</span><span class="p">]</span>      <span class="c1"># for consistency put on string if user provide a digit</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_rho</span><span class="p">)</span> <span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">ilay</span><span class="p">):</span> 
                <span class="k">return</span> <span class="n">ilay</span>
            
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_rho</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilay</span><span class="p">):</span> 
                <span class="n">sec_res</span> <span class="o">=</span> <span class="n">input_rho</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ilay</span><span class="p">):]</span>         <span class="c1"># get the last value of resistivities  to find the structres names ans structures sresistivities </span>
                <span class="n">geos</span> <span class="o">=</span><span class="n">Geodrill</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">resistivities_range</span><span class="o">=</span><span class="n">sec_res</span><span class="p">)</span> <span class="c1"># get the name of structure as possible </span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">geos</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">:</span> <span class="n">tm</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
                <span class="k">else</span> <span class="p">:</span><span class="n">tm</span> <span class="o">=</span><span class="s1">&#39;&#39;</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; !We added other </span><span class="si">{0}</span><span class="s1"> geological struture</span><span class="si">{1}</span><span class="s1">. You may ignore it.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">geos</span><span class="p">),</span> <span class="n">tm</span><span class="p">))</span>
                <span class="n">ilay</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">geos</span><span class="p">)</span>                       <span class="c1"># then , extend the list </span>
                <span class="k">return</span> <span class="n">ilay</span> 
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilay</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_rho</span><span class="p">):</span> 
                <span class="n">ilay</span> <span class="o">=</span> <span class="n">ilay</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">input_rho</span><span class="p">)]</span>            <span class="c1"># truncated the list </span>
                <span class="k">return</span> <span class="n">ilay</span> 
        
        
        <span class="c1"># if range of resistivity is provided then use it for average </span>
        <span class="k">if</span> <span class="n">input_resistivity_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="o">=</span> <span class="n">input_resistivity_range</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39; !Without any input resistivities values, we can not set only your layer names.&#39;</span>\
                          <span class="s1">&#39; Bring more details about your layers by adding their corresponding resistivities values.&#39;</span><span class="p">)</span>
            <span class="c1"># print(&#39;--&gt;!&#39;)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span><span class="o">=</span><span class="kc">None</span>       <span class="c1">#abort the input layers by renitializing to NoneType values</span>
            
         
        <span class="n">auto_mess</span><span class="o">=</span><span class="s1">&#39;&#39;</span>            <span class="c1"># keep automatic message </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">n_layers</span> <span class="o">=</span><span class="mf">7.</span>  <span class="c1"># number of slices layer juged by the program 7 </span>
            <span class="k">else</span> <span class="p">:</span> <span class="n">n_layers</span> <span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span><span class="p">)</span>
            
            <span class="n">mess</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;Resistivity range is not provided . Sites Depth will be cout out into </span><span class="si">{0}</span><span class="s2"> slices as possible layers &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span> <span class="n">n_layers</span><span class="p">)),</span> 
                          <span class="s2">&quot;  below the site. If the number of slices doesnt suit the purpose , please change the number &quot;</span><span class="p">,</span>
                          <span class="s2">&quot;  of slices using argument &lt;input_layers&gt; to provided the real layer&#39;s names.&quot;</span><span class="p">])</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
           
          
            <span class="c1"># get the model resistivities minimum and maximum from selected doi, it is much  better </span>
            <span class="c1"># than  to select min max into the  global resistivities models.  </span>
            
            <span class="n">minmax</span><span class="o">=</span><span class="p">[(</span><span class="n">res_values</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">res_values</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="k">for</span> <span class="n">stn</span><span class="p">,</span> <span class="n">res_values</span>  <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_d</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span> <span class="c1">#</span>
            <span class="n">maxres</span><span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">mm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">minmax</span><span class="p">])</span>
            <span class="n">minres</span><span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">mm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">minmax</span><span class="p">])</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span> <span class="n">minres</span><span class="p">,</span> <span class="n">maxres</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span> <span class="n">n_layers</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># rounded to 2 , because resistiviris are in ohm-m.</span>
            <span class="n">auto_mess</span> <span class="o">=</span><span class="s1">&#39;Automatic&#39;</span>
 
            
        <span class="k">if</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span>  <span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span> 
            <span class="k">try</span> <span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_geoinputargument</span><span class="p">(</span><span class="s1">&#39;Can not converted value &lt;</span><span class="si">%s</span><span class="s1">&gt; into float number.&#39;</span>\
                                                              <span class="s1">&#39; Please provide a float number.&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="p">)</span>
                
        <span class="c1"># Display infos </span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;**</span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> Layers sliced&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">auto_mess</span> <span class="p">),</span><span class="s1">&#39;=&#39;</span> <span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span>  <span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;**</span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> (Î©.m)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> Rho range&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">auto_mess</span> <span class="p">),</span><span class="s1">&#39;=&#39;</span> <span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span>  <span class="p">)</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;**</span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39; Minimum rho &#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span> <span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s1">&#39;Î©.m&#39;</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;**</span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39; Minimum rho &#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;Î©.m&#39;</span> <span class="p">))</span>
       
        <span class="c1"># so to get the structures for each input resistivities </span>
                 <span class="c1"># ascertain unput layers first if no misleading value is inputted </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="c1"># rebuild new list of layer by adding necessary strutures or substracting unecessaries structures</span>
            <span class="n">formations</span><span class="o">=</span> <span class="n">ascertain_input_layers</span><span class="p">(</span><span class="n">input_layers</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span><span class="p">,</span>
                                                  <span class="n">input_rho</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">)</span>
        <span class="c1">#     self.depth_range =depth_range </span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">formations</span> <span class="o">=</span> <span class="n">Geodrill</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span><span class="o">=</span><span class="n">formations</span> 
        

        <span class="c1"># self.__setattr__(&#39;geo_dict_rho&#39;, nOne)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_drr</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_d</span><span class="p">)</span>              <span class="c1"># use deep copy to make difference between two dict data set </span>
        
        
        <span class="n">tem</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># dictionnary opf  replacement rho</span>
        <span class="k">for</span> <span class="n">key</span> <span class="p">,</span> <span class="n">geovalue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_drr</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span> 
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">rowlines</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">geovalue</span><span class="p">):</span> 
               <span class="n">out_aver</span> <span class="o">=</span><span class="n">find_and_replace_rho</span><span class="p">(</span><span class="n">rowlines</span><span class="o">=</span> <span class="n">rowlines</span><span class="p">,</span>
                                     <span class="n">value_range</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">)</span>
               <span class="n">tem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out_aver</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geo_drr</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span><span class="n">list_of_array</span><span class="o">=</span><span class="n">tem</span><span class="p">)</span>
            <span class="n">tem</span><span class="o">=</span><span class="p">[]</span></div>
            

            
<div class="viewcode-block" id="Geodrill.get_structure"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geodrill.get_structure">[docs]</a>    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">get_structure</span> <span class="p">(</span><span class="n">resistivities_range</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function to get according the range of resistivities values , </span>
<span class="sd">        the corresponding associated geological rocks </span>
<span class="sd">        </span>
<span class="sd">        The list of electrical properties of rocks is not exhaustive ,</span>
<span class="sd">        can be fill by others </span>
<span class="sd">        params : </span>
<span class="sd">            resistivities_range : array_like </span>
<span class="sd">                                    array of input_resistivities </span>
<span class="sd">        </span>
<span class="sd">            return the list of geological structures form go_electrical _rocks properties </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resistivities_range</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span> <span class="c1"># only single value provided than put on list.</span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="n">resistivities_range</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">resistivities_range</span><span class="p">)]</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_geodrill_inputarguments</span><span class="p">(</span><span class="s1">&#39;Can not convert &lt;</span><span class="si">%s</span><span class="s1">&gt; to float number !Input resistivity &#39;</span>\
                                                                <span class="s1">&#39;must be a float number not &lt;</span><span class="si">%s</span><span class="s1">&gt;!&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">resistivities_range</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">resistivities_range</span><span class="p">)))</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resistivities_range</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>  <span class="c1"># for consistency , chek again input values </span>
            <span class="k">try</span> <span class="p">:</span>  <span class="n">resistivities_range</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">resistivities_range</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_geodrill_inputarguments</span><span class="p">(</span><span class="s1">&#39;Input argument provided is wrong. &#39;</span>\
                                                                <span class="s1">&#39;Please check your resistivities range, values must be a float number.&#39;</span><span class="p">)</span>
             
        <span class="n">geo_structures</span><span class="o">=</span><span class="p">[]</span>                   <span class="c1"># in fact append the idde of resistivities values located </span>
                                            <span class="c1"># so to be sure that the resistivities will match exactly the layer found in geo_electricl_property of rocks </span>
        <span class="n">f</span><span class="o">=</span><span class="kc">False</span> 
        <span class="k">for</span> <span class="n">resr</span> <span class="ow">in</span> <span class="n">resistivities_range</span> <span class="p">:</span>
            <span class="n">f</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">for</span> <span class="n">rocks</span><span class="p">,</span> <span class="n">eprops</span> <span class="ow">in</span> <span class="n">Geodrill</span><span class="o">.</span><span class="n">geo_rocks_properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
                <span class="k">if</span> <span class="n">eprops</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">resr</span> <span class="o">&lt;</span> <span class="n">eprops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> 
                    <span class="n">f</span><span class="o">=</span><span class="kc">True</span>
                    <span class="n">geo_structures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rocks</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
                    
                    <span class="k">break</span> 
            <span class="k">if</span> <span class="n">f</span><span class="o">==</span><span class="kc">False</span> <span class="p">:</span> 
                <span class="n">geo_structures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;*! Struture not found&#39;</span><span class="p">)</span>
                
        <span class="k">return</span> <span class="n">geo_structures</span></div>
 
<div class="viewcode-block" id="Geodrill.get_average_rho"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geodrill.get_average_rho">[docs]</a>    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">get_average_rho</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">transpose</span> <span class="o">=</span><span class="kc">False</span> <span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to average rho to one point to onother . </span>
<span class="sd">        It show the lowest point and the maximum point averaged . Function averaged rho </span>
<span class="sd">        value between local maximum and local minima values . </span>
<span class="sd">        if data  values of station are located on columnlines , set transpose to True </span>
<span class="sd">        then rotate the matrix to find minima and maxima  locals value then calculated averaged rho </span>
<span class="sd">        after will return matrix transpose as the same shape as inputted .</span>
<span class="sd">        .Defaut is **False** . </span>
<span class="sd">        </span>
<span class="sd">        params : </span>
<span class="sd">            data_array : ndarray </span>
<span class="sd">                    data of resistivities collected at the site point </span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data_array</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]:</span>  <span class="c1"># be sure data type is on float value</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="n">data_array</span><span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It seems somethings wrong happened during data conversion to float values.&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;Could not convert value&#39;</span>\
                                                       <span class="s1">&#39; to float numbers , Please check your data!&#39;</span><span class="p">)</span>
            
      
        <span class="k">if</span> <span class="n">transpose</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>          <span class="c1"># transpose the data to loop the rownlines in first times </span>
            <span class="n">data_array</span> <span class="o">=</span><span class="n">data_array</span><span class="o">.</span><span class="n">T</span>
        
        <span class="n">exem</span> <span class="o">=</span><span class="p">[</span><span class="n">punc</span><span class="o">.</span><span class="n">average_rho_with_locals_minmax</span><span class="p">(</span><span class="n">rowlines</span><span class="p">)</span>
               <span class="k">for</span> <span class="n">rowlines</span> <span class="ow">in</span> <span class="n">data_array</span> <span class="p">]</span>         <span class="c1"># build list of array transposed  and concat vaue </span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span><span class="n">exem</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">transpose</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>          <span class="c1"># transpose the data to keep finally the same shape  </span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">T</span>
            
        <span class="k">return</span> <span class="n">new_data</span></div>
        
  
<div class="viewcode-block" id="Geodrill.geo_build_strata_logs"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geodrill.geo_build_strata_logs">[docs]</a>    <span class="k">def</span> <span class="nf">geo_build_strata_logs</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_resistivities</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">input_layers</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                               <span class="n">step_descent</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="sd">&quot;&quot;&quot;&quot;</span>
<span class="sd">        Read resistivits data  got on survey area and build geological strata block. </span>
<span class="sd">        If constrained_electrical_properties_of_rocks is False , will build a log </span>
<span class="sd">        by considering the  conventional electrical property of rocks </span>
<span class="sd">        can be find though this link : </span>
<span class="sd">        https://www.eoas.ubc.ca/ubcgif/iag/foundations/properties/resistivity.htm</span>
<span class="sd">        list is not exhaustive and depend of the geological formations of </span>
<span class="sd">        survey area. </span>
<span class="sd">        </span>
<span class="sd">        params : </span>
<span class="sd">            input_resistivity :array_like </span>
<span class="sd">                        an array of resistivity on the site</span>
<span class="sd">            step_descent : float </span>
<span class="sd">                        depth value to averaged rho . Must be smaller as possible </span>
<span class="sd">                                    if None , it take the 2% times the investigation depth  </span>
<span class="sd">            input_layers : list or array </span>
<span class="sd">                        layers_names , eg :[granite, fault, river ]</span>
<span class="sd">        </span>
<span class="sd">        Use constrained_electrical_properties_of_rocks</span>
<span class="sd">        -------------------------------------------------------------------------</span>
<span class="sd">        rocks                           max Rho                   Min Rho (ohm-m)</span>
<span class="sd">        =========================================================================</span>
<span class="sd">        igneous rocks                   10^6                        10^3 </span>
<span class="sd">        duricrust                       5.10^3                      5.10^2</span>
<span class="sd">        gravel and sand                 10^4                        10^2.90(800)</span>
<span class="sd">        conglomerate                    10^4                        10^1.95(90)</span>
<span class="sd">        dolomite/limestone              10^5                        10^3</span>
<span class="sd">        permafrost                      10^5                        10^2.62(750)</span>
<span class="sd">        metamorphic rocks               5.10^2                      10.^1</span>
<span class="sd">        tills                           8.10^2                      10^1.93(85)</span>
<span class="sd">        standstone conglomerate         10^4                        10^1.92 (80)</span>
<span class="sd">        lignite/coal                    10^2.89(790)                10^1</span>
<span class="sd">        shales                          10^1.7(50)                  10^1.48(30)</span>
<span class="sd">        clays                           10^2                        10^1.7(50)</span>
<span class="sd">        saprolite                       10^2.08(120)                10^1.48(30)</span>
<span class="sd">        sedimentary rocks               10^4                        10^0</span>
<span class="sd">        fresh water                     3.10^2                      10^0</span>
<span class="sd">        salt water                      10^0                        10^-0.15</span>
<span class="sd">        massive sulfide                 10^0                        10^-2</span>
<span class="sd">        sea water                       10^-0.09(0.8)               10^-1</span>
<span class="sd">        ore minerals                    10^0                        10^-4</span>
<span class="sd">        Graphite                        10^-2.5                     10^-3.5</span>
<span class="sd">        =========================================================================</span>
<span class="sd">        Note : list is not Exhaustive </span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get_conductive_zone</span> <span class="p">(</span><span class="n">dep_array</span><span class="p">,</span> <span class="n">rho_array</span><span class="p">,</span> <span class="n">step_in_deep</span><span class="p">)</span>   <span class="p">:</span>
            
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Get a conductive zone is important for many purposes .In the case of </span>
<span class="sd">            groundwater exploration for instance, sometimes in deeper, because of </span>
<span class="sd">            heterogeneities of structures in underground , it is much difficult </span>
<span class="sd">            to take some minima rho as a conductive area or conductiv productive </span>
<span class="sd">            veification drill point. To be sure that this point is really among</span>
<span class="sd">            a good saturated zone, it is better to get   averaged rho in some </span>
<span class="sd">            distance and to see how the layer resistivity value goes on on this range,</span>
<span class="sd">            whether it&#39;s an effective conductive zone or overlapping zone. In addition , </span>
<span class="sd">            fixing resistivities values at specific distance depth allow us to detect </span>
<span class="sd">            the unsatured zone as weel as the satured zone at the set of </span>
<span class="sd">            investigation depth imaged. This technique allow us to build a pseudo</span>
<span class="sd">            specific strata that could match the zone .</span>
<span class="sd">          </span>
<span class="sd">            params : dep_array : array_like , the imaged depth </span>
<span class="sd">                    step_in_deep : float </span>
<span class="sd">                                value to averaged resistivities in deeper</span>
<span class="sd">                        </span>
<span class="sd">                    rho_array :  array_like ,</span>
<span class="sd">                        the resistivities at the sites depth {Top to bottom}</span>
<span class="sd">            </span>
<span class="sd">            return array_like : rho average for each station </span>
<span class="sd">                                 dep_averaged for each station</span>
<span class="sd">            </span>
<span class="sd">            Note : Much large is the step , the accuracy become weak , it must be </span>
<span class="sd">                        as possible 1/20 of investigation depth (doi)</span>
<span class="sd">            eg ::</span>
<span class="sd">                    &gt;&gt;&gt; pseudo_depth = np.arange(0, 1201.,100)</span>
<span class="sd">                    &gt;&gt;&gt; print(pseudo_depth)</span>
<span class="sd">                    ... dep_aver= dep(dep_array=pseudo_depth, value=100)</span>
<span class="sd">                    ... print(dep_aver)</span>
<span class="sd">                    ... print(pseudo_depth.shape)</span>
<span class="sd">                    ... print(dep_aver.shape)</span>
<span class="sd">            &quot;&quot;&quot;</span>
   
            <span class="n">step_in_deep</span>  <span class="o">=</span><span class="n">punc</span><span class="o">.</span><span class="n">depth_of_investigation</span><span class="p">(</span><span class="n">step_in_deep</span><span class="p">)</span>
            
            <span class="n">v</span><span class="p">,</span><span class="n">r</span> <span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">rm</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
            
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step_in_deep</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span> 
                <span class="k">try</span> <span class="p">:</span> 
                    <span class="n">step_in_deep</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">step_in_deep</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">:</span> 
                    <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_geoinputargument</span><span class="p">(</span><span class="s1">&#39;Could not convert depth value =</span><span class="si">{}</span><span class="s1"> to float. Please check your value.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step_in_deep</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">step_in_deep</span><span class="o">&lt;</span> <span class="n">dep_array</span><span class="o">.</span><span class="n">min</span><span class="p">():</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_geoinputargument</span><span class="p">(</span><span class="s1">&#39;Value provided =</span><span class="si">{0}</span><span class="s1"> m is less than the minimum depth =</span><span class="si">{1}</span><span class="s1"> m.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step_in_deep</span><span class="p">,</span> <span class="n">dep_array</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
            
            <span class="k">if</span> <span class="n">step_in_deep</span> <span class="o">&gt;</span> <span class="n">dep_array</span><span class="o">.</span><span class="n">max</span><span class="p">():</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_geoinputargument</span><span class="p">(</span><span class="s1">&#39;Value provided is = </span><span class="si">{0}</span><span class="s1"> m is greater than maximum depth =</span><span class="si">{1}</span><span class="s1">m.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step_in_deep</span><span class="p">,</span> <span class="n">dep_array</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
                
            <span class="n">_init_depth</span> <span class="o">=</span><span class="n">step_in_deep</span>
            
            <span class="k">for</span> <span class="n">index</span> <span class="p">,</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dep_array</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">depth</span> <span class="o">&lt;=</span> <span class="n">step_in_deep</span> <span class="p">:</span>      <span class="c1"># value less than step descent must be averaged </span>
                    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>             <span class="c1"># keep resistivities values onto list </span>
                    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_array</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
        
                <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="n">step_in_deep</span> <span class="p">:</span>       <span class="c1"># if the next value is greater than the previous one </span>
                    <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span><span class="p">[]:</span>                  <span class="c1"># ccheck if kist is not enmpty </span>
                    
                        <span class="n">dm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>  <span class="c1"># rebuild resistivities values with rho averaged </span>
                        <span class="n">rm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)))</span>
                        <span class="n">step_in_deep</span> <span class="o">+=</span> <span class="n">_init_depth</span>              <span class="c1">#increment the next descent to step of descent </span>
                        <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="n">depth</span><span class="p">]</span>       <span class="c1"># initialise new list by adding the index value greater one </span>
                        <span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="n">rho_array</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span>
                      
                <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span><span class="n">dep_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>                  <span class="c1"># it length last value ==1 , means is the last value of depth</span>
                        <span class="n">dm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dep_array</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                        <span class="n">rm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_array</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">!=</span><span class="mi">1</span> <span class="p">:</span>               <span class="c1"># averaged the reamin rho values  </span>
                        <span class="n">dm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
                        <span class="n">rm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)))</span>
              
        
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">rm</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dm</span><span class="p">))</span>
            

        <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;qc&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">0</span><span class="p">)</span>          <span class="c1"># set quality control in the data </span>
        
        <span class="c1">#------  STATEMENT OF INPUT ARGUMENTS------------------ </span>
        <span class="c1"># check data files if provided (Dont need to check all )</span>
        <span class="k">if</span> <span class="n">input_resistivities</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="o">=</span> <span class="n">input_resistivities</span> 
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter2dat_fn</span> <span class="ow">is</span>  <span class="kc">None</span> <span class="p">:</span>  <span class="c1"># read to populate attributes </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geo_replace_rho</span><span class="p">()</span>
            
        <span class="k">if</span> <span class="n">input_layers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="c1"># rebuild input_layers </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span> <span class="o">=</span> <span class="n">ascertain_layers_with_its_resistivities</span><span class="p">(</span><span class="n">real_layer_names</span><span class="o">=</span> <span class="n">input_layers</span><span class="p">,</span> 
                                                                        <span class="n">real_layer_resistivities</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">)</span> 
            
          

        <span class="k">if</span> <span class="n">step_descent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span> <span class="o">=</span> <span class="n">step_descent</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> 
        

        <span class="c1"># ---------------get the geodictionnary from from geodata average ---------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_daver</span> <span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">stn</span><span class="p">,</span> <span class="n">vrho</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="c1"># transpose data so to read rowlines S01,S02 etc </span>

            <span class="bp">self</span><span class="o">.</span><span class="n">geo_daver</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Geodrill</span><span class="o">.</span><span class="n">get_average_rho</span><span class="p">(</span> <span class="n">data_array</span><span class="o">=</span> <span class="n">vrho</span><span class="p">,</span> <span class="n">transpose</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
        <span class="c1"># if constrained_electrical_properties_of_rocks is True : </span>
        <span class="c1">#     for ii in range (7): </span>
        <span class="c1">#         for stn ,constrainedrho in self.geo_daver.items(): </span>
        <span class="c1">#             self.geo_daver[stn] =  Geodrill.get_average_rho( data_array= constrainedrho, transpose =True)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">qc</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">25</span> 
        <span class="c1">#----- set attribute of geo_dstep_descent ---------------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_dstep_descent</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">stn</span> <span class="p">,</span> <span class="n">geo_sd_values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="c1"># for ii in range(3) :</span>
                
            <span class="n">mv</span><span class="o">=</span> <span class="p">[</span><span class="n">get_conductive_zone</span><span class="p">(</span><span class="n">dep_array</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="p">,</span>
                                     <span class="n">rho_array</span><span class="o">=</span><span class="n">geo_sd_values</span><span class="p">[:,</span><span class="n">ii</span><span class="p">],</span> 
                                     <span class="n">step_in_deep</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span> <span class="c1"># concat three array </span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">geo_dstep_descent</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span><span class="n">mv</span><span class="p">,</span> <span class="n">concat_axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                
        <span class="c1">#------------------build a dict of pseudosequences layer and resistivities ----------------------</span>
        
        <span class="c1"># build at dictionnary of strata from resistivities in the model and themoel depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Build the pseudosequences of strata.&#39;</span><span class="p">)</span>
        
        <span class="c1"># if constrained_electrical_properties_of_rocks is False : </span>
            <span class="c1"># build layer according to geo_drr (geo_replacedrho)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_dpseudo_sequence</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_dpseudo_sequence_rho</span> <span class="o">=</span><span class="p">[{}</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
        <span class="n">sc</span><span class="o">=</span><span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;geo_secure_pseudo_sequence&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
         
        <span class="k">for</span> <span class="n">stn</span> <span class="p">,</span> <span class="n">georr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_drr</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="c1"># for jj in range(3): </span>
            <span class="k">if</span> <span class="n">stn</span> <span class="o">==</span><span class="s1">&#39;S00&#39;</span> <span class="p">:</span>            <span class="c1"># first station id framed into three started at the left  </span>
                <span class="n">svm</span> <span class="o">=</span> <span class="n">punc</span><span class="o">.</span><span class="n">build_resistivity_barplot</span><span class="p">(</span><span class="n">depth_values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="p">,</span>
                                           <span class="n">res_values</span><span class="o">=</span><span class="n">georr</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">stn</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="c1"># lst station id names start is lopcated at the right </span>
                <span class="n">svm</span> <span class="o">=</span> <span class="n">punc</span><span class="o">.</span><span class="n">build_resistivity_barplot</span><span class="p">(</span><span class="n">depth_values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="p">,</span>
                                           <span class="n">res_values</span><span class="o">=</span><span class="n">georr</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">else</span> <span class="p">:</span>          <span class="c1"># station id located at the midle framed into three stations </span>
                <span class="n">svm</span> <span class="o">=</span> <span class="n">punc</span><span class="o">.</span><span class="n">build_resistivity_barplot</span><span class="p">(</span><span class="n">depth_values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="p">,</span>
                                           <span class="n">res_values</span><span class="o">=</span><span class="n">georr</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
                

            <span class="n">sc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">svm</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">geo_dpseudo_sequence</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span><span class="o">=</span> <span class="n">svm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>      <span class="c1"># the thickness of layers </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geo_dpseudo_sequence_rho</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span><span class="o">=</span><span class="n">svm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>   <span class="c1"># the resistivities of layers </span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_secure_pseudo_sequence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
        
        <span class="c1">#---------------- Quality control --------------------------------.--------------------</span>
        <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39; !Your data passes safety the Quality Control of Geodrill&#39;</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_secure_pseudo_sequence</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qc</span> <span class="o">+=.</span><span class="mi">25</span> 
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_secure_pseudo_sequence</span><span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> <span class="p">):</span> <span class="c1">#chek whether total thickness </span>
                                                                <span class="c1">#cover the total depth</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qc</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">25</span> 
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Data provided are inconsistencies ,&#39;</span>\
                          <span class="s1">&#39; Please you may try to undestand carefuuly the code.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Data provided are inconsistencies ,&#39;</span>\
                          <span class="s1">&#39; Please you may try to undestand carefuuly the code.&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">qc</span> <span class="o">==</span><span class="mf">1.</span> <span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mess</span><span class="p">))</span>
            
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;**</span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39; QC flux rate&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span> <span class="p">,</span> <span class="mf">100.</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">qc</span><span class="p">,</span> <span class="s1">&#39;%&#39;</span> <span class="p">))</span>
        
        <span class="c1">#------------------------rewrite info with real layers resistivities if provided and layers names ---</span>
        <span class="c1"># self.input_layers, _  , _= Geodrill.get_geo_formation_properties(structures_resistivities= self.input_resistivities,)</span>
        
        
        <span class="c1">#-------------------Print Info -------------------------------------------------</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;**</span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39; Number of layers&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span> <span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span><span class="p">)</span> <span class="p">))</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">77</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&lt;25}{1:&lt;25}</span><span class="s1"> </span><span class="si">{2:&lt;25}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Structure&#39;</span><span class="p">,</span> <span class="s1">&#39;Rho mean value (Î©.m)&#39;</span><span class="p">,</span> 
                                             <span class="s1">&#39;Rho range  (Î©.m)&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">77</span><span class="p">)</span>
  
    
        <span class="k">for</span> <span class="n">ij</span>  <span class="p">,</span> <span class="p">(</span><span class="n">ires</span><span class="p">,</span> <span class="n">geos</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span> <span class="p">)):</span> 
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="p">)</span> <span class="o">&gt;</span><span class="mi">1</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">ij</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
                    <span class="n">rho_rg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ires</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="p">[</span><span class="n">ij</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">rho_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">((</span><span class="n">ires</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="p">[</span><span class="n">ij</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">ires</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> 
                     <span class="n">rho_rg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">[</span><span class="n">ij</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">[</span><span class="n">ij</span><span class="p">])</span>
                     <span class="n">rho_mean</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">[</span><span class="n">ij</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">[</span><span class="n">ij</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span> 
                    <span class="n">rho_rg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">[</span><span class="n">ij</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">[</span><span class="n">ij</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">rho_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">[</span><span class="n">ij</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">[</span><span class="n">ij</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">rho_rg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ires</span><span class="p">)</span>
                <span class="n">rho_mean</span> <span class="o">=</span> <span class="n">ires</span>
                
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&lt;25}{1:&lt;25}</span><span class="s1"> </span><span class="si">{2:&gt;25}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geos</span><span class="p">,</span> <span class="n">rho_mean</span><span class="p">,</span><span class="n">rho_rg</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">77</span><span class="p">)</span> </div>
        
        
<div class="viewcode-block" id="Geodrill.get_geo_formation_properties"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geodrill.get_geo_formation_properties">[docs]</a>    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">get_geo_formation_properties</span> <span class="p">(</span><span class="n">structures_resistivities</span><span class="p">,</span> <span class="n">real_layer_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">constrained_electrical_properties_of_rocks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="o">**</span><span class="n">kwargs</span>
                                      <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of stuctures and their names of after replaced , flexible tools.  </span>
<span class="sd">        wherever structures provided, the name, color ,  as well as the pattern .</span>
<span class="sd">        if constrained electrical properties if True , will keep the resistivities with their </span>
<span class="sd">        corresponding layers as reference. If the layer names if found on the data Base then , </span>
<span class="sd">        will return its pattern and color else defaultcolor is black and patter is &quot;+.-&quot;.</span>
<span class="sd">        if constrained_electrical_properties_of_rocks is False , will check under data base </span>
<span class="sd">        to find the resistivities that match better the layers </span>
<span class="sd">        </span>
<span class="sd">        params : </span>
<span class="sd">            structures resistivities  : array_like </span>
<span class="sd">                                resistivities of structures </span>
<span class="sd">            real_layer_names : array_like |list </span>
<span class="sd">                                    names of layer of survey area </span>
<span class="sd">                                if not provided , will use resistivities to find the closet </span>
<span class="sd">                                layer that match the best the resistivities </span>
<span class="sd">            constrained_electrical_properties_of_rocks: bool : </span>
<span class="sd">                                set to True mean the realy_layer is provided. if not program </span>
<span class="sd">                                will enforce to False , will use default conventional layers</span>
<span class="sd">                                Default is False, assume to povided layer names for  accuracy</span>
<span class="sd">        return : </span>
<span class="sd">            f_name : array_like </span>
<span class="sd">                            names of formations find with their corresponding rho </span>
<span class="sd">            f_pattern : array_like </span>
<span class="sd">                                patter of differents geological formations </span>
<span class="sd">            f_color :   array_like   </span>
<span class="sd">                        color of differents geological formations </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">unknow_layer_color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;default_layer_color&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="n">unknow_layer_pattern</span> <span class="o">=</span>  <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;default_layer_pattern&#39;</span><span class="p">,</span> <span class="s2">&quot;.//&quot;</span><span class="p">)</span>
        
        <span class="n">find_pattern</span> <span class="p">,</span> <span class="n">__f_db</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>             <span class="c1"># flag to find pattern , flag to raise error for unsuccessufful connection to database </span>
        <span class="n">pattern</span><span class="p">,</span> <span class="n">geo_color</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> 
        
        <span class="n">geoformation_obj</span> <span class="o">=</span><span class="n">STRL</span><span class="o">.</span><span class="n">Geo_formation</span><span class="p">()</span>
        <span class="n">geof_names</span> <span class="o">=</span> <span class="n">geoformation_obj</span><span class="o">.</span><span class="n">names</span> 
        
        
        <span class="k">if</span> <span class="n">constrained_electrical_properties_of_rocks</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="n">real_layer_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="c1">#check weither the layer of resistivities</span>
                                    <span class="c1">#are the same dimension and return new layer with same dimension with rho</span>
                <span class="n">real_layer_names</span> <span class="o">=</span> <span class="n">ascertain_layers_with_its_resistivities</span><span class="p">(</span><span class="n">real_layer_names</span> <span class="o">=</span><span class="n">real_layer_names</span><span class="p">,</span>
                                                                       <span class="n">real_layer_resistivities</span><span class="o">=</span> <span class="n">structures_resistivities</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span> 
                <span class="n">msg</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">{constrained_electrical_properties_of_rocks}</span><span class="s2"> argument is set to &lt;True&gt; as default value &quot;</span><span class="p">,</span>
                              <span class="s2">&quot;  unfortunately , you did not provide any layer&#39;s names with its resistivity values.&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot; We can not set layer&#39; resistivities and layer&#39; names as reference data.&quot;</span><span class="p">,</span>
                              <span class="s2">&quot; We will ressetting </span><span class="si">{constrained_electrical_properties_of_rocks}</span><span class="s2"> to False. However&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot; be sure that layer&#39;s provided automatically don&#39;t match exactly the underground informations.&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;To accurate informations, you need ABSOLUTELY to provided layer&#39; resistivities as well as its names get on the field or any other firms.&quot;</span><span class="p">])</span>
                
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Important Note :!&#39;</span> <span class="p">)</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">punc</span><span class="o">.</span><span class="n">fmt_text</span><span class="p">(</span><span class="n">data_text</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="n">return_to_line</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                
                <span class="n">constrained_electrical_properties_of_rocks</span> <span class="o">=</span> <span class="kc">False</span> 
           
        <span class="k">if</span> <span class="n">constrained_electrical_properties_of_rocks</span> <span class="ow">is</span> <span class="kc">False</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="n">real_layer_names</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">real_layer_names</span> <span class="o">=</span> <span class="n">Geodrill</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">structures_resistivities</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">real_layer_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>  <span class="c1"># enforce to use the layer&#39;s names provided by the user (constrained is True) </span>
                <span class="n">real_layer_names</span> <span class="o">=</span> <span class="n">ascertain_layers_with_its_resistivities</span><span class="p">(</span><span class="n">real_layer_names</span> <span class="o">=</span><span class="n">real_layer_names</span><span class="p">,</span>
                                                                       <span class="n">real_layer_resistivities</span><span class="o">=</span> <span class="n">structures_resistivities</span><span class="p">)</span> 

        <span class="c1">#-------------------------------------CONNECT TO GEODATABASE -----------------------------</span>
        <span class="c1"># connect to geodataBase </span>
        <span class="k">try</span> <span class="p">:</span> 
            <span class="n">geodatabase_obj</span> <span class="o">=</span> <span class="n">GeoDataBase</span> <span class="p">()</span>
    
        <span class="k">except</span> <span class="p">:</span>
            <span class="n">__f_db</span><span class="o">=</span> <span class="mi">0</span> 
        <span class="c1">#-----------------------SEARCH ON DATABASE -------------------*</span>
        <span class="k">if</span> <span class="n">geodatabase_obj</span><span class="o">.</span><span class="n">success</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
            <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;----&gt; Successfull connexion to geoDataBase !&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">res</span><span class="p">,</span>  <span class="n">lnames</span>  <span class="ow">in</span> <span class="nb">zip</span> <span class="p">(</span> <span class="n">structures_resistivities</span><span class="p">,</span> <span class="n">real_layer_names</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">geodatabase_obj</span><span class="o">.</span> <span class="n">_get_geo_structure</span><span class="p">(</span><span class="n">structure_name</span> <span class="o">=</span><span class="n">lnames</span><span class="p">)</span> 
                    <span class="k">if</span> <span class="n">geodatabase_obj</span><span class="o">.</span><span class="n">geo_structure_exists</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>  <span class="c1"># ckek geostructure existence</span>
                    
                        <span class="k">if</span> <span class="n">geodatabase_obj</span><span class="o">.</span><span class="n">colorMPL</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>  
                            <span class="c1"># rebuild the tuple of mpl colors blocked as string in database  </span>
                            <span class="n">lnames_color</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span> <span class="nb">float</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> 
                                                    <span class="n">geodatabase_obj</span><span class="o">.</span><span class="n">colorMPL</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
                            
                            <span class="n">geo_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lnames_color</span><span class="p">)</span> <span class="c1"># append rgb colors not include alpha </span>
                        
                        <span class="k">else</span> <span class="p">:</span> 
                            <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;Sorry ! </span><span class="si">{0}</span><span class="s1"> matplotlib color is  not filled yet in our DataBase.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lnames</span><span class="p">)</span>
                            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                            <span class="n">geo_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unknow_layer_color</span><span class="p">)</span> <span class="c1"># then append default colors </span>
                            
                        <span class="k">if</span> <span class="n">geodatabase_obj</span><span class="o">.</span><span class="n">hatch</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span> 
                            
                            <span class="n">pattern</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geodatabase_obj</span><span class="o">.</span><span class="n">hatch</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                        
                        <span class="k">else</span> <span class="p">:</span> 
                            <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;Sorry ! </span><span class="si">{0}</span><span class="s1"> matplotlib pattern is not filled yet in our DataBase.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lnames</span><span class="p">)</span>
                            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                            <span class="n">pattern</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unknow_layer_pattern</span><span class="p">)</span>
                        
                    <span class="k">elif</span> <span class="n">geodatabase_obj</span><span class="o">.</span><span class="n">geo_structure_exists</span> <span class="ow">is</span> <span class="kc">False</span>   <span class="p">:</span> 
                        <span class="c1"># then aborted the process and go to search into strata and strutral modules </span>
                        <span class="n">__f_db</span><span class="o">=</span><span class="mi">0</span>
                        
                        <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39; Actually </span><span class="si">{0}</span><span class="s1"> does not exist in our dataBase,&#39;</span>\
                            <span class="s1">&#39; we alternatively use other ways to suitable respond to your request.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lnames</span><span class="p">)</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                        <span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                        <span class="k">break</span>
   
            <span class="n">geodatabase_obj</span><span class="o">.</span><span class="n">manage_geoDataBase</span><span class="o">.</span><span class="n">closeDB</span><span class="p">()</span> <span class="c1"># close de DB</span>
            
        <span class="c1">#-------------------------SEARCH ON STRATA AND STRUCTURAL MODULES ----------------------*</span>
        <span class="k">if</span> <span class="n">geodatabase_obj</span><span class="o">.</span><span class="n">success</span> <span class="o">==</span><span class="mi">0</span> <span class="ow">or</span>  <span class="n">__f_db</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> 
            <span class="n">geo_color</span> <span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># clean initialise  and restart searching </span>
            
            <span class="k">for</span> <span class="n">res</span><span class="p">,</span>  <span class="n">lnames</span>  <span class="ow">in</span> <span class="nb">zip</span> <span class="p">(</span> <span class="n">structures_resistivities</span><span class="p">,</span> <span class="n">real_layer_names</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">lnames</span> <span class="ow">in</span> <span class="n">geof_names</span> <span class="p">:</span>  <span class="c1"># if exist on geoformation array names then get the index and the coorsponding values </span>
                   
                   <span class="c1">#-------------------------------------------------------------------</span>
                   <span class="k">if</span> <span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">lnames</span>  <span class="p">:</span> <span class="n">new_lnames</span> <span class="o">=</span> <span class="n">lnames</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="c1"># be sure to find attribute names</span>
                   <span class="k">else</span> <span class="p">:</span> <span class="n">new_lnames</span> <span class="o">=</span><span class="n">lnames</span>
                   
                   <span class="n">col</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">geoformation_obj</span><span class="p">,</span> <span class="n">new_lnames</span><span class="p">)[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="c1"># for consistency </span>
                   <span class="n">geo_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    
                <span class="k">elif</span> <span class="n">lnames</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">geof_names</span> <span class="p">:</span> <span class="c1">#check wether the names belongs to structural pattern </span>
                   <span class="k">if</span> <span class="n">lnames</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">STRL</span><span class="o">.</span><span class="n">geo_pattern</span><span class="o">.</span><span class="n">pattern</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                       <span class="n">geo_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">STRL</span><span class="o">.</span><span class="n">geo_pattern</span><span class="o">.</span><span class="n">pattern</span><span class="p">[</span><span class="n">lnames</span><span class="o">.</span><span class="n">lower</span><span class="p">()][</span><span class="mi">1</span><span class="p">])</span>
                   <span class="k">else</span> <span class="p">:</span>
                       <span class="n">geo_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">unknow_layer_color</span><span class="p">)</span>
      
                 <span class="c1"># actually will use the default pattern : Then check the resistivities inot geoelectrical </span>
                 <span class="c1">#    propertty. if structures found , then took it pattern </span>
                  
                <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="p">(</span> <span class="n">keyprop</span> <span class="p">,</span> <span class="n">resprops</span><span class="p">)</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">Geodrill</span><span class="o">.</span><span class="n">geo_rocks_properties</span><span class="o">.</span><span class="n">items</span> <span class="p">())</span> <span class="p">:</span> 
                    <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">resprops</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">res</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">resprops</span><span class="p">)</span> <span class="p">:</span> <span class="c1">#resprops)[-1] &lt;= res &lt;= resprops[0] :</span>
                        <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">keyprop</span><span class="p">:</span>  <span class="c1"># split and search for their appropriate pattern</span>
                            <span class="k">if</span> <span class="n">res</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">resprops</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="p">:</span> <span class="n">keyprop</span><span class="o">=</span><span class="n">keyprop</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># take the first na</span>
                            <span class="k">else</span> <span class="p">:</span> <span class="n">keyprop</span><span class="o">=</span><span class="n">keyprop</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                            
                        <span class="n">pat</span> <span class="o">=</span><span class="n">STRL</span><span class="o">.</span><span class="n">geo_pattern</span><span class="o">.</span><span class="n">pattern</span><span class="p">[</span><span class="n">keyprop</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>       <span class="c1"># keep it pattern</span>
                        <span class="n">pattern</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span>
                        <span class="n">find_pattern</span> <span class="o">=</span><span class="kc">True</span>                           <span class="c1"># switch on flag </span>
                        <span class="k">break</span>  <span class="c1"># dont need to continue to take other pattern </span>
                        
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Geodrill</span><span class="o">.</span><span class="n">geo_rocks_properties</span><span class="o">.</span><span class="n">items</span> <span class="p">())</span> <span class="ow">and</span> <span class="n">find_pattern</span> <span class="ow">is</span> <span class="kc">False</span> <span class="p">:</span> <span class="c1"># mean no pattern </span>
                    <span class="c1"># is found after looping all items of dictionnary </span>
                        <span class="n">pattern</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">unknow_layer_pattern</span><span class="p">)</span>
                        
                <span class="n">find_pattern</span> <span class="o">=</span><span class="kc">False</span>      <span class="c1"># resetting flag to False (switch off )</span>

        <span class="k">return</span> <span class="n">real_layer_names</span><span class="p">,</span> <span class="n">geo_color</span> <span class="p">,</span> <span class="n">pattern</span>      </div>
                       
<div class="viewcode-block" id="Geodrill.to_golden_software"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geodrill.to_golden_software">[docs]</a>    <span class="k">def</span> <span class="nf">to_golden_software</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_resistivities</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">input_layers</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                               <span class="n">step_descent</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="n">filename</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">savepath</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Output average files, rehoreplaced files, spseudosequennces files and station locations files </span>
<span class="sd">        will generate 3 outputs for Golden software plots : </span>
<span class="sd">        1. One model for rho averaged (*_aver), transitory data betwen the calculated rho and true rho.</span>
<span class="sd">        2. second for rho value replaced . Replaced calcualted model structures resistivities </span>
<span class="sd">        to their closest resistivities as resistivities reference from input resistivities.</span>
<span class="sd">        3. the most important files: the  cut out resistivities value with step descent (._sd) </span>
<span class="sd">            show most dominant stratigraphy sequences .</span>
<span class="sd">        4. the station location file (.bln)</span>
<span class="sd">    </span>
<span class="sd">        Plot the 3 files in Golden software to see transition from model calculation to truth</span>
<span class="sd">        sequence detail models which is most closest to reality.</span>

<span class="sd">        params : </span>
<span class="sd">            input_resistivities :   array_like </span>
<span class="sd">                                    Truth values of resistivities </span>
<span class="sd">            filename :str :         name of output file </span>
<span class="sd">            step_descent :  float</span>
<span class="sd">                                    Step to cut out data and to  force resistivites calcualted </span>
<span class="sd">                                     to match the reference data as input resistivities </span>
<span class="sd">                                     if not provided the step will be 20% of D0I</span>
<span class="sd">            input_layers  : array_like </span>
<span class="sd">                                    True input_layers names ( geological informations of</span>
<span class="sd">                                            encountered layers )</span>
<span class="sd">            savepath :  str </span>
<span class="sd">                                full path to the savepath ,</span>
<span class="sd">                                if None , will create folder name to savepath </span>
<span class="sd">            </span>
<span class="sd">        =======================================================================</span>
<span class="sd">        other params          type                   explanation </span>
<span class="sd">        ========================================================================</span>
<span class="sd">        elevation              array_like              elevation of survey area </span>
<span class="sd">        to_negative_depth      bool                    export deth in negative </span>
<span class="sd">                                                              value or positive </span>
<span class="sd">                                                        default is &quot;negative&quot;</span>
<span class="sd">        scale                  str                     scale to export data .</span>
<span class="sd">                                                        Must be &quot;m|km&quot;.</span>
<span class="sd">                                                            default is &quot;m&quot;</span>
<span class="sd">        =======================================================================</span>
<span class="sd">    </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">elevation</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;elevation&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">write_negative_depth</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;to_negative_depth&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">scale</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">scale</span><span class="o">=</span> <span class="s1">&#39;m&#39;</span>
        
        <span class="c1"># rescale data </span>
        <span class="k">if</span> <span class="n">scale</span> <span class="o">==</span><span class="s1">&#39;m&#39;</span><span class="p">:</span> 
            <span class="n">df</span> <span class="o">=</span><span class="mf">1.</span> 
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span><span class="s1">&#39;km&#39;</span><span class="p">:</span> 
            <span class="n">df</span> <span class="o">=</span><span class="mf">1000.</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="n">df</span> <span class="o">=</span><span class="mf">1.</span>
        
        <span class="k">if</span> <span class="n">input_layers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span> <span class="o">=</span> <span class="n">input_layers</span> 
        <span class="k">if</span> <span class="n">input_resistivities</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span>  <span class="o">=</span> <span class="n">input_resistivities</span> 
        <span class="k">if</span> <span class="n">step_descent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span><span class="o">=</span> <span class="n">step_descent</span> 
        <span class="k">if</span> <span class="n">elevation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="o">=</span> <span class="n">elevation</span> 
        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">mess</span><span class="o">=</span><span class="s1">&#39;!Elevation is not provided. We gonna set to 0.&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&#39;</span><span class="o">+</span><span class="n">mess</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_location</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>  <span class="c1"># assume station location exist</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="c1"># check elevation length with station location </span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="o">=</span> <span class="n">geo_length_checker</span><span class="p">(</span><span class="n">main_param</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="p">,</span>
                                                <span class="n">optional_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span><span class="p">,</span> 
                <span class="n">param_names</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;station location&#39;</span><span class="p">,</span> <span class="s1">&#39;elevation&#39;</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
        
        <span class="c1"># now read files </span>
        <span class="k">if</span>  <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">geo_build_strata_logs</span><span class="p">()</span>
        <span class="k">else</span> <span class="p">:</span> 
            <span class="n">mess</span> <span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;Need ABSOLUTELY an input resistivities get on the field or other companies &quot;</span><span class="p">,</span> 
                           <span class="s2">&quot; Input resistivities MUST provided in order to take data as reference resistivities.&quot;</span><span class="p">,</span> 
                           <span class="s2">&quot; please provided a least a truth resitivities of one layer.&quot;</span><span class="p">])</span>
            
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_geoinputargument</span><span class="p">(</span><span class="s2">&quot;Can not write details sequences log files ! Please provided at least one&quot;</span>\
                                                          <span class="s2">&quot; truth layer resistivity.&quot;</span><span class="p">)</span>
        
        <span class="n">matrix_rhoaver</span> <span class="p">,</span><span class="n">matrix_rhorr</span><span class="p">,</span> <span class="n">matrix_rho_stepdescent</span> <span class="o">=</span><span class="p">[[]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="n">site</span> <span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="c1"># station id to read is the first index =0</span>
                <span class="n">index</span> <span class="o">=</span><span class="mi">0</span> 
            <span class="k">if</span> <span class="n">site</span> <span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="n">index</span> <span class="o">=</span><span class="mi">2</span> <span class="c1"># station id  to read is the 2index </span>
            <span class="k">else</span> <span class="p">:</span> <span class="n">index</span> <span class="o">=</span><span class="mi">1</span>  <span class="c1"># read th middle array </span>
    
            <span class="n">matrix_rhorr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_drr</span><span class="p">[</span><span class="n">site</span><span class="p">][:,</span> <span class="n">index</span><span class="p">])</span>
            <span class="n">matrix_rhoaver</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_daver</span><span class="p">[</span><span class="n">site</span><span class="p">][:,</span> <span class="n">index</span><span class="p">])</span>
            <span class="n">matrix_rho_stepdescent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_dstep_descent</span><span class="p">[</span><span class="n">site</span><span class="p">][:,</span> <span class="n">index</span> <span class="p">])</span>
                
        <span class="c1"># build a matrix of all data collected </span>

        <span class="n">matrix_rhorr</span><span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span><span class="n">matrix_rhorr</span><span class="p">,</span> <span class="n">concat_axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">matrix_rhoaver</span><span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span><span class="n">matrix_rhoaver</span><span class="p">,</span> <span class="n">concat_axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">matrix_rho_stepdescent</span><span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span> <span class="n">matrix_rho_stepdescent</span><span class="p">,</span> <span class="n">concat_axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># create empty list to collect infos of read values</span>
        <span class="n">write_averlines</span> <span class="p">,</span> <span class="n">write_rrlines</span><span class="p">,</span> <span class="n">write_stepdescent_lines</span> <span class="p">,</span> <span class="n">write_blnfiles</span> <span class="o">=</span><span class="p">[[]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
        
        <span class="c1"># writes multilines in the same times </span>
        
        <span class="k">if</span> <span class="n">write_negative_depth</span>  <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span>  <span class="o">*=-</span><span class="mi">1</span>
                <span class="c1"># scalled station location and geo_depth </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span> <span class="o">/=</span><span class="n">df</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">station_location</span> <span class="o">/=</span><span class="n">df</span>
        
        <span class="k">for</span> <span class="n">writes_lines</span> <span class="p">,</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="nb">zip</span> <span class="p">(</span> <span class="p">[</span><span class="n">write_averlines</span> <span class="p">,</span> <span class="n">write_rrlines</span><span class="p">,</span> <span class="n">write_stepdescent_lines</span><span class="p">],</span> 
                                          <span class="p">[</span><span class="n">matrix_rhoaver</span><span class="p">,</span> <span class="n">matrix_rhorr</span><span class="p">,</span> <span class="n">matrix_rho_stepdescent</span><span class="p">]):</span>
            
            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="p">))</span> <span class="p">:</span> 
                <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">)):</span> 
                    <span class="n">writes_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
                        <span class="s1">&#39;</span><span class="si">{0:&gt;15.7f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="p">[</span><span class="n">jj</span><span class="p">]),</span>
                        <span class="s1">&#39;</span><span class="si">{0:&gt;15.7f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="p">[</span><span class="n">ii</span><span class="p">]),</span> 
                        <span class="s1">&#39;</span><span class="si">{0:&gt;15.7f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">]),</span>
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="p">]))</span>
                   
                
      <span class="c1"># create fileame if not provided </span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;.</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> 
            <span class="n">filename</span> <span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">.</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
         
        <span class="k">for</span>  <span class="n">ikey</span><span class="p">,</span> <span class="n">stn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">)</span> <span class="p">:</span> 
            <span class="n">write_blnfiles</span> <span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:&lt;7.6f}</span><span class="s1">,&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="p">[</span><span class="n">ikey</span><span class="p">]),</span> 
                                                <span class="s1">&#39;</span><span class="si">{0:&lt;7.6f}</span><span class="s1">,&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elevation</span><span class="p">[</span><span class="n">ikey</span><span class="p">]),</span>
                                                <span class="s1">&#39;</span><span class="si">{0:&lt;4}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]))</span>
            
        <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="c1"># create a folder in your current work directory</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="n">savepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;_outputGeoSD_&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">savepath</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">savepath</span><span class="p">)</span><span class="c1">#  mode =0o666)</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It seems the path already exists !&quot;</span><span class="p">)</span>
                
        <span class="c1">#writes files </span>
        <span class="k">for</span> <span class="n">ii</span> <span class="p">,</span> <span class="p">(</span><span class="n">tfiles</span> <span class="p">,</span> <span class="n">wfiles</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;_aver&#39;</span><span class="p">,</span> <span class="s1">&#39;_rr&#39;</span><span class="p">,</span> <span class="s1">&#39;_sd&#39;</span><span class="p">,</span> <span class="s1">&#39;_yb&#39;</span><span class="p">],</span> 
                                                    <span class="p">[</span><span class="n">write_averlines</span><span class="p">,</span> <span class="n">write_rrlines</span><span class="p">,</span> 
                                                     <span class="n">write_stepdescent_lines</span><span class="p">,</span>  <span class="n">write_blnfiles</span><span class="p">])):</span> 
            <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">mm</span><span class="o">=</span><span class="s1">&#39;bln&#39;</span>
            <span class="k">else</span> <span class="p">:</span><span class="n">mm</span><span class="o">=</span><span class="s1">&#39;dat&#39;</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">.</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tfiles</span><span class="p">,</span> <span class="n">mm</span><span class="p">)]),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fw</span> <span class="p">:</span> 
                <span class="n">fw</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">wfiles</span><span class="p">)</span>
                
        <span class="c1">#savefile inot it savepath </span>
        <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="kn">import</span> <span class="nn">shutil</span> 
            <span class="k">try</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="p">[</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_aver.dat&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;_rr.dat&#39;</span><span class="p">,</span>
                                            <span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;_sd.dat&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_yb.bln&#39;</span><span class="p">]):</span>
                    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="n">file</span><span class="p">)</span> <span class="p">,</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">savepath</span> <span class="p">,</span> <span class="n">file</span><span class="p">))</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It seems the files already exists !&quot;</span><span class="p">)</span>
                
        <span class="n">filenames</span> <span class="o">=</span><span class="p">[</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_aver.dat&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;_rr.dat&#39;</span><span class="p">,</span>
                                            <span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;_sd.dat&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_yb.bln&#39;</span><span class="p">]</span>   

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; geo output files </span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">  &amp; </span><span class="si">{3}</span><span class="s1">&#39;</span>\
              <span class="s1">&#39;have been successfully written to  &lt;</span><span class="si">{4}</span><span class="s1">&gt;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">filenames</span><span class="p">,</span> <span class="n">savepath</span><span class="p">))</span></div>
           
<div class="viewcode-block" id="Geodrill.to_oasis_montaj"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geodrill.to_oasis_montaj">[docs]</a>    <span class="k">def</span> <span class="nf">to_oasis_montaj</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">model_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">iter_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span><span class="n">profile_fn</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                         <span class="n">mesh_fn</span><span class="o">=</span><span class="kc">None</span>  <span class="p">,</span> <span class="n">data_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">savepath</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span> 
        
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        write output to oasis montaj when station loocation and profile coordinates are provided .</span>
<span class="sd">        We assune before using this method , you are already the coordinates files at disposal(*stn) ,</span>
<span class="sd">        if not  use the method {to_golden_software}.Coordinated files are Easting Northing value  </span>
<span class="sd">        not in degree decimals . It uses occam 2D outputfiles or Bo Yang iter2Dat file </span>
<span class="sd">                                also add profile XY coordinates (utm_zone )</span>
<span class="sd">        </span>
<span class="sd">        params :</span>
<span class="sd">            model_fn :      str  </span>
<span class="sd">            full path to Occam2D model file </span>
<span class="sd">            mesh_fn :       str   </span>
<span class="sd">            full path to Occam2D mesh file </span>
<span class="sd">            data_fn :       str    </span>
<span class="sd">            full path to Occam2D data file </span>
<span class="sd">            iter_fn :       str    </span>
<span class="sd">                            full path to Occam2D iteration file </span>
<span class="sd">                            OR Bo Yang (x, y, z ) files  </span>
<span class="sd">            iter2dat_fn : str      </span>
<span class="sd">                        full path to iter2dat file </span>
<span class="sd">                            (see _occam2d module to see which file is it. or call  </span>
<span class="sd">                                  occam2d.Iter2Dat.__doc__)</span>
<span class="sd">            bln :           str  </span>
<span class="sd">            full path to satation location file </span>
<span class="sd">            * profile files (Easting , Northing Coordinates) , </span>
<span class="sd">                                    see csamtpy.ff.Core.cs.Profile.__doc__</span>
<span class="sd">                profile_fn         str  </span>
<span class="sd">                                    full path to station profile file . You can   </span>
<span class="sd">                                     useProfile module to rewrite _coordinate files </span>
<span class="sd">                                            </span>
<span class="sd">       </span>
<span class="sd">        =======================================================================</span>
<span class="sd">        Other params               Type                     Explanation </span>
<span class="sd">        =======================================================================</span>
<span class="sd">        filename            str                New name of output file .</span>
<span class="sd">                                                Default is None </span>
<span class="sd">        normalize_depth     bool               Set the depth ega spacing depth .</span>
<span class="sd">                                                    In fact for oasis</span>
<span class="sd">                                               montaj , depth must be equidistant  </span>
<span class="sd">                                               the same  spacing when image in</span>
<span class="sd">                                               deeper. default is True </span>
<span class="sd">                                               if false , will generate </span>
<span class="sd">                                               depth as Occam2D mesh z nodes </span>
<span class="sd">        easting             array_like        Easting UTM coordinates .</span>
<span class="sd">                                                Profile *Stn file is </span>
<span class="sd">                                               provided, no need to input. </span>
<span class="sd">                                                   default is None </span>
<span class="sd">        northing            array_like        Northing coordinates . </span>
<span class="sd">                                                If station coordinates</span>
<span class="sd">                                              is provided from *stn file .</span>
<span class="sd">                                                  It will detect </span>
<span class="sd">                                              automatically.default is None.</span>
<span class="sd">        elevation           array_like        Elevation area . Default is None.</span>
<span class="sd">        scalled_east_north  tuple             scalled the easting and northing. </span>
<span class="sd">                                               Substract or add value to easting</span>
<span class="sd">                                               or northing values . </span>
<span class="sd">                                              the first index1= easting and </span>
<span class="sd">                                              index2  = Nothing. for more details</span>
<span class="sd">                                             . Default is not scalled : (0,0)</span>
<span class="sd">        output_s_XY           bool           Scalled coordinates  output files. </span>
<span class="sd">                                               Default is True </span>
<span class="sd">        write_negative_depth  bool           utput negative depth. Default is True</span>
<span class="sd">        input_rho             array_like      Input resistivities of True</span>
<span class="sd">                                                geological formations (optional)</span>
<span class="sd">                                                 if input resistivities is provided </span>
<span class="sd">                                                will generated output step descent </span>
<span class="sd">                                                files (_sd),  roughness_rho (_rr)</span>
<span class="sd">                                               , rho_averaged (_aver). Default is </span>
<span class="sd">                                                output the main resistivty model. </span>
<span class="sd">        input_layers         list|array_like  list of true names of layers (optional) </span>
<span class="sd">        step_descent         float             Step to cut out data and to  </span>
<span class="sd">                                                force resistivites calcualted </span>
<span class="sd">                                                to match the reference data as </span>
<span class="sd">                                                input resistivities </span>
<span class="sd">                                            if not provided the step will be</span>
<span class="sd">                                            20% of D0I.(opt)                  </span>
<span class="sd">        writeType            str             Writer format *.csv or *.xlsx .</span>
<span class="sd">                                                Default is *.xlsx</span>
<span class="sd">        add_header           bool            Add head on exported sheet. </span>
<span class="sd">                                                set False to mask heads.</span>
<span class="sd">                                                 Default is True.</span>
<span class="sd">        csv_separateType     str            Indicated for csv exported files.</span>
<span class="sd">                                                The type of comma</span>
<span class="sd">                                                  delimited. Defaut is &#39;,&#39;</span>
<span class="sd">        to_log10             bool            if True : will ouput all </span>
<span class="sd">                                            resistivities data to  log10 values </span>
<span class="sd">                                                             </span>
<span class="sd">        ========================================================================</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">create_model_matrix</span> <span class="p">(</span><span class="n">station_names</span><span class="p">,</span> <span class="n">geo_dict_rho</span><span class="p">,</span> <span class="n">transpose</span> <span class="o">=</span><span class="kc">True</span><span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            simple function to generate matrix from geo_dictionnary data </span>
<span class="sd">            main site is frames into3 stations </span>
<span class="sd">            params :</span>
<span class="sd">                station _names  : </span>
<span class="sd">                    list ,name of stations </span>
<span class="sd">            geo_dict_rho : dict ,</span>
<span class="sd">                            dictionnary of model_resistivities </span>
<span class="sd">                                can  be a step _descent dict , </span>
<span class="sd">                                geo_average_or geo_replace rho </span>
<span class="sd">            transpose :  bool ,</span>
<span class="sd">                                if transpose is True , depth will be a xoffset </span>
<span class="sd">                                and and station names as y offsets</span>
<span class="sd">                                </span>
<span class="sd">            return : </span>
<span class="sd">                model_rho_matrix : matrix , depth &amp; station locations </span>
<span class="sd">                </span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">model_rho_matrix</span> <span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">station_names</span> <span class="p">:</span> 
                <span class="k">if</span> <span class="n">site</span> <span class="o">==</span><span class="n">station_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="c1"># station id to read is the first index =0</span>
                    <span class="n">index</span> <span class="o">=</span><span class="mi">0</span> 
                <span class="k">if</span> <span class="n">site</span> <span class="o">==</span><span class="n">station_names</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="n">index</span> <span class="o">=</span><span class="mi">2</span> <span class="c1"># station id  to read is the 2index </span>
                <span class="k">else</span> <span class="p">:</span> <span class="n">index</span> <span class="o">=</span><span class="mi">1</span>  <span class="c1"># read th middle array </span>
                <span class="n">model_rho_matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geo_dict_rho</span><span class="p">[</span><span class="n">site</span><span class="p">][:,</span> <span class="n">index</span><span class="p">])</span>
                
            <span class="n">model_rho_matrix</span><span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span><span class="n">model_rho_matrix</span> <span class="p">,</span> <span class="n">concat_axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">transpose</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> <span class="n">model_rho_matrix</span><span class="o">=</span> <span class="n">model_rho_matrix</span><span class="o">.</span><span class="n">T</span>
            
            <span class="k">return</span> <span class="n">model_rho_matrix</span>
            
            
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">77</span><span class="p">)</span>
        <span class="n">normalize_depth</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;normalize_depth&#39;</span><span class="p">,</span> <span class="kc">True</span> <span class="p">)</span>
        <span class="n">iter2dat_fn</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;iter2dat_fn&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">bln_fn</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bln_fn&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">easting</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;easting&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">northing</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;northing&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">elevation</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;elevation&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">scalled_east_north</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;scalled_east_north&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">output_sprofile</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output_s_XY&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">write_negative_depth</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;to_negative_depth&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">to_log10</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;to_log10&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        
        <span class="c1"># write -externals files : Step descent , average rho </span>

        <span class="n">input_rho</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_resistivities&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">input_layers</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_layers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">step_descent</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;step_descent&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
 
        <span class="k">if</span> <span class="n">input_rho</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span>  <span class="o">=</span> <span class="n">input_rho</span> 
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">write_external_files</span><span class="o">=</span><span class="kc">True</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="n">write_external_files</span> <span class="o">=</span> <span class="kc">False</span>
            

        <span class="c1"># write sheet </span>
        <span class="n">writeType</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;writeType&#39;</span><span class="p">,</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">)</span>
        <span class="n">csvsetHeader</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;add_header&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">csvsep</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;csv_separateType&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">writeIndex</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;write_index_on_sheet&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
    
 
        <span class="c1"># create filename if not provided </span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">profile_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">profile_fn</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;.</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">filename</span> <span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">.</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>

        <span class="c1"># statements of arguments ----</span>

        <span class="k">for</span> <span class="n">mattar</span><span class="p">,</span> <span class="n">mfile</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;model_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;mesh_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;data_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;iter_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;iter2dat_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;bln_fn&#39;</span> <span class="p">],</span>   
                                  <span class="p">[</span><span class="n">model_fn</span><span class="p">,</span> <span class="n">mesh_fn</span><span class="p">,</span> <span class="n">data_fn</span><span class="p">,</span> <span class="n">iter_fn</span><span class="p">,</span> <span class="n">iter2dat_fn</span><span class="p">,</span> <span class="n">bln_fn</span> <span class="p">]):</span>
            <span class="k">if</span> <span class="n">mfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mattar</span><span class="p">,</span> <span class="n">mfile</span><span class="p">)</span>
        
        <span class="c1"># -----------------------------------Buil profile object ------------------------------------------</span>
        <span class="k">if</span> <span class="n">elevation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="o">=</span> <span class="n">elevation</span> 
        <span class="n">profile_obj</span> <span class="o">=</span> <span class="n">Profile</span> <span class="p">()</span>
        <span class="n">profile_obj</span><span class="o">.</span><span class="n">read_stnprofile</span><span class="p">(</span><span class="n">profile_fn</span> <span class="p">,</span> <span class="n">easting</span><span class="o">=</span><span class="n">easting</span><span class="p">,</span> <span class="n">northing</span> <span class="o">=</span><span class="n">northing</span> <span class="p">,</span> 
                                                 <span class="n">elevation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span><span class="p">)</span>
        <span class="n">profile_obj</span><span class="o">.</span><span class="n">straighten_profileline</span> <span class="p">(</span> <span class="n">reajust</span><span class="o">=</span><span class="n">scalled_east_north</span> <span class="p">,</span> <span class="n">output</span> <span class="o">=</span><span class="n">output_sprofile</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Dipole length&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">dipole_length</span><span class="p">,</span> <span class="s1">&#39;m.&#39;</span>  <span class="p">))</span>
        
        <span class="n">profile_angle</span><span class="p">,</span> <span class="n">geo_electric_strike</span> <span class="o">=</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">get_profile_angle</span><span class="p">()</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39; profile angle &#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span>
                                              <span class="nb">round</span><span class="p">(</span><span class="n">profile_angle</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;deg N.E&#39;</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;geo_electric strike&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span>
                                              <span class="nb">round</span><span class="p">(</span><span class="n">geo_electric_strike</span> <span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;deg N.E&#39;</span> <span class="p">))</span>
        
        <span class="c1"># In the case where elevation is contain on the profile stn file , get elevation </span>
        <span class="k">if</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">elev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="o">=</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">elev</span> 
        
        <span class="c1"># build section Infos </span>
        <span class="c1">#Stations	Easting_X_m	Northing_Y_m	Elev_H_m	x_m	, Norm_h_m	offsets_m	DOI_max_m</span>
        <span class="n">info_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;easting_X_m&#39;</span><span class="p">,</span> <span class="s1">&#39;northing_Y_m&#39;</span><span class="p">,</span> <span class="s1">&#39;elev_H_m&#39;</span><span class="p">,</span> <span class="s1">&#39;position_x_m&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;nivelize_h_m&#39;</span><span class="p">,</span> <span class="s1">&#39;offset_m&#39;</span><span class="p">,</span> <span class="s1">&#39;doi&#39;</span><span class="p">]</span>
        <span class="c1">#normalH </span>
        <span class="n">nivelize_elevation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">elev</span> <span class="o">-</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">elev</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># stn position </span>
        <span class="k">if</span> <span class="n">write_negative_depth</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">=-</span><span class="mi">1</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> 
        <span class="k">else</span> <span class="p">:</span> <span class="n">doi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doi</span> 
        <span class="n">infos_oasis_montaj</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span><span class="n">list_of_array</span><span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span> <span class="p">,</span>
                                                                  <span class="n">profile_obj</span><span class="o">.</span><span class="n">east</span> <span class="p">,</span> 
                                                                  <span class="n">profile_obj</span><span class="o">.</span><span class="n">north</span> <span class="p">,</span> 
                                                                  <span class="n">profile_obj</span><span class="o">.</span><span class="n">elev</span> <span class="p">,</span> 
                                                                  <span class="n">profile_obj</span><span class="o">.</span><span class="n">stn_position</span> <span class="p">,</span> 
                                                                  <span class="n">nivelize_elevation</span> <span class="p">,</span> 
                                                                  <span class="bp">self</span><span class="o">.</span><span class="n">station_location</span> <span class="p">,</span> 
                                                                  <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],),</span> <span class="n">doi</span><span class="p">),</span>
                                                                  <span class="p">],</span> 
                                                                 <span class="n">concat_axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#-----------------------Build main data for oasis -----------------------------------------------------</span>
        
        <span class="c1"># manage the depth info and create matrix of depth </span>
        <span class="n">spacing_depth</span> <span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Spacing depth&#39;</span><span class="p">,</span><span class="s1">&#39;~=&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">spacing_depth</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;m.&#39;</span> <span class="p">))</span>
        
        <span class="k">if</span> <span class="n">normalize_depth</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="c1"># get the step_deth </span>
            <span class="n">geo_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span> <span class="p">)))</span>
            <span class="n">spacing_depth</span> <span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Depth normalized !&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;new spacing depth&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">spacing_depth</span><span class="p">),</span> <span class="s1">&#39;m&#39;</span> <span class="p">))</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; UNnormalized  depth!&#39;</span><span class="p">)</span>
           
        <span class="n">depth_oasis_montaj</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">geo_depth</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">geo_depth</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span>
                              <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span> <span class="p">)</span> <span class="c1"># build a mtrix of depth</span>
        <span class="n">depth_oasis_montaj</span> <span class="o">=</span> <span class="n">depth_oasis_montaj</span> <span class="o">.</span><span class="n">T</span>          <span class="c1"># Transpose the depth </span>
        
        <span class="k">if</span> <span class="n">write_negative_depth</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span><span class="n">depth_oasis_montaj</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
            
        <span class="c1"># build data </span>
        
        <span class="n">model_oasis_montaj</span> <span class="o">=</span> <span class="n">create_model_matrix</span> <span class="p">(</span><span class="n">station_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">,</span> 
                                                  <span class="n">geo_dict_rho</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_d</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">to_log10</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="n">model_oasis_montaj</span> <span class="p">)</span>
        
        <span class="n">data_oasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">infos_oasis_montaj</span><span class="p">,</span> <span class="n">depth_oasis_montaj</span><span class="p">,</span> <span class="n">model_oasis_montaj</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># buidd pandas columns </span>
        <span class="n">depres_pandas_columns</span> <span class="o">=</span> <span class="n">info_list</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;dep_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dd</span><span class="p">))</span> <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">geo_depth</span><span class="p">]</span> <span class="o">+</span>\
            <span class="p">[</span><span class="s1">&#39;res_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dd</span><span class="p">))</span> <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">geo_depth</span><span class="p">]</span> 
            
            
        <span class="n">oas_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_oasis</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">depres_pandas_columns</span><span class="p">)</span>
        
        <span class="n">fex</span><span class="o">=</span><span class="mi">0</span>  <span class="c1"># falg to write external files </span>
        <span class="k">if</span> <span class="n">write_external_files</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">input_layers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span> <span class="o">=</span> <span class="n">input_layers</span>
            <span class="k">if</span> <span class="n">step_descent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span> <span class="o">=</span> <span class="n">step_descent</span> 
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;! No input resistivities provided! Could not write external geo-files.&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39; If you expect to write external GEO {step_descent  - roughness  and average_rho} files,&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39; You ABSOLUTELY need  to provided at least a truth resistivity values&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39; of some geological formation of the area.&#39;</span><span class="p">])</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">punc</span><span class="o">.</span><span class="n">fmt_text</span><span class="p">(</span><span class="n">mess</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">))</span>
                
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">debug</span> <span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">geo_build_strata_logs</span><span class="p">(</span><span class="n">input_resistivities</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">,</span> 
                                           <span class="n">input_layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span><span class="p">,</span>
                                           <span class="n">step_descent</span><span class="o">=</span><span class="n">step_descent</span><span class="p">)</span>
             
            <span class="c1"># now build matrix of all external files </span>
            <span class="n">model_step_descent</span> <span class="o">=</span> <span class="n">create_model_matrix</span> <span class="p">(</span><span class="n">station_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">,</span> 
                                                  <span class="n">geo_dict_rho</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_dstep_descent</span><span class="p">)</span>   
            <span class="n">model_geo_roughness</span> <span class="o">=</span> <span class="n">create_model_matrix</span> <span class="p">(</span><span class="n">station_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">,</span> 
                                                  <span class="n">geo_dict_rho</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_drr</span><span class="p">)</span>
            <span class="n">model_average_rho</span> <span class="o">=</span> <span class="n">create_model_matrix</span> <span class="p">(</span><span class="n">station_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">,</span> 
                                                  <span class="n">geo_dict_rho</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_daver</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">to_log10</span> <span class="p">:</span> 
                <span class="n">model_step_descent</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">model_step_descent</span><span class="p">)</span>
                <span class="n">model_geo_roughness</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">model_geo_roughness</span><span class="p">)</span>
                <span class="n">model_average_rho</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="n">model_average_rho</span><span class="p">)</span>
            
            <span class="n">data_oas_stepDescent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">infos_oasis_montaj</span><span class="p">,</span> <span class="n">depth_oasis_montaj</span><span class="p">,</span><span class="n">model_step_descent</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">data_oas_roughness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">infos_oasis_montaj</span><span class="p">,</span> <span class="n">depth_oasis_montaj</span><span class="p">,</span> <span class="n">model_geo_roughness</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">data_oas_averageRho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">infos_oasis_montaj</span><span class="p">,</span> <span class="n">depth_oasis_montaj</span><span class="p">,</span> <span class="n">model_average_rho</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># create pandas dataFrame </span>
            
            <span class="n">STD_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_oas_stepDescent</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">depres_pandas_columns</span><span class="p">)</span>
            <span class="n">ROUGH_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_oas_roughness</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">depres_pandas_columns</span><span class="p">)</span>
            <span class="n">AVER_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_oas_averageRho</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">depres_pandas_columns</span><span class="p">)</span>
            
            
            
            <span class="n">fex</span> <span class="o">=</span><span class="mi">1</span> <span class="c1"># everything where ok then take one </span>
        <span class="c1"># write files </span>
        <span class="c1"># if f== 1 : </span>
            <span class="c1"># create filename </span>
        <span class="k">if</span> <span class="n">writeType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;exc&#39;</span><span class="p">)</span><span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">writeType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;xls&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span>
            <span class="n">writeType</span> <span class="o">=</span> <span class="s1">&#39;.xlsx&#39;</span>
            <span class="k">if</span> <span class="n">fex</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span>  <span class="c1"># write all files into one worksheet </span>
                <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_cor_oas&#39;</span><span class="p">,</span><span class="n">writeType</span><span class="p">]))</span> <span class="k">as</span> <span class="n">writer</span> <span class="p">:</span>
                    <span class="k">for</span>  <span class="n">sname</span> <span class="p">,</span> <span class="n">df_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;.main.&#39;</span><span class="p">,</span> <span class="s1">&#39;_sd&#39;</span><span class="p">,</span> <span class="s1">&#39;_rr&#39;</span><span class="p">,</span> <span class="s1">&#39;_aver&#39;</span><span class="p">],</span>
                                            <span class="p">[</span><span class="n">oas_pandas</span><span class="p">,</span> <span class="n">STD_pandas</span><span class="p">,</span><span class="n">ROUGH_pandas</span><span class="p">,</span> <span class="n">AVER_pandas</span> <span class="p">]):</span>
                        <span class="n">df_</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="n">sname</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span><span class="n">writeIndex</span><span class="p">)</span>
                        
                    <span class="n">fex</span> <span class="o">=</span><span class="mi">2</span> 
            <span class="k">else</span> <span class="p">:</span> 
     
                <span class="n">oas_pandas</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;.main._cor_oas&#39;</span><span class="p">,</span> <span class="n">writeType</span><span class="p">]),</span>
                                    <span class="n">sheet_name</span><span class="o">=</span><span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;main_cor_oas&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">writeIndex</span><span class="p">)</span>  

            
        <span class="k">elif</span> <span class="n">writeType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span><span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">:</span> 
            <span class="n">writeType</span> <span class="o">=</span><span class="s1">&#39;.csv&#39;</span>
            <span class="n">oas_pandas</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;.main._cor_oas&#39;</span><span class="p">,</span><span class="n">writeType</span><span class="p">]),</span>
                              <span class="n">header</span><span class="o">=</span><span class="n">csvsetHeader</span><span class="p">,</span>
                  <span class="n">index</span> <span class="o">=</span><span class="n">writeIndex</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="n">csvsep</span><span class="p">)</span> 
            <span class="k">if</span> <span class="n">fex</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span> 
                <span class="k">for</span> <span class="n">fnx</span><span class="p">,</span> <span class="n">_df</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="p">[</span><span class="s1">&#39;_sd&#39;</span><span class="p">,</span> <span class="s1">&#39;_rr&#39;</span><span class="p">,</span> <span class="s1">&#39;_aver&#39;</span><span class="p">]</span> <span class="p">,</span>
                                    <span class="p">[</span><span class="n">STD_pandas</span><span class="p">,</span><span class="n">ROUGH_pandas</span><span class="p">,</span> <span class="n">AVER_pandas</span> <span class="p">]):</span>
                    
                    <span class="n">_df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span> <span class="o">+</span> <span class="n">fnx</span><span class="p">,</span><span class="s1">&#39;_cor_oas&#39;</span><span class="p">,</span> <span class="n">writeType</span><span class="p">]),</span>
                                <span class="n">sheet_name</span><span class="o">=</span><span class="n">filename</span> <span class="o">+</span><span class="n">fnx</span> <span class="o">+</span><span class="s1">&#39;_cor_oas&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">writeIndex</span><span class="p">)</span> 
                    
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;The type you provide is wrong. Support only *.xlsx and *.csv format&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span> <span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_geodrill_inputarguments</span><span class="p">(</span><span class="s1">&#39;wrong format =</span><span class="si">{0}</span><span class="s1"> !&#39;</span>\
                                                            <span class="s1">&#39; Could not write geo file to oasis.&#39;</span>\
                                                                <span class="s1">&#39; Support only *.xlsx or *.csv format &#39;</span><span class="p">)</span>

        <span class="c1"># export to savepath </span>
        <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="c1"># create a folder in your current work directory</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="n">savepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;_output2Oasis_&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">savepath</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">savepath</span><span class="p">)</span><span class="c1">#  mode =0o666)</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It seems the path already exists !&quot;</span><span class="p">)</span>
                
        <span class="c1">#savefile inot it savepath </span>
        <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="kn">import</span> <span class="nn">shutil</span> 
            <span class="k">try</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">fex</span> <span class="o">==</span><span class="mi">2</span> <span class="p">:</span> 
                   <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;_cor_oas&#39;</span><span class="p">,</span> <span class="n">writeType</span><span class="p">]))</span> <span class="p">,</span>
                   <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">savepath</span> <span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;_cor_oas&#39;</span><span class="p">,</span> <span class="n">writeType</span><span class="p">])))</span>
                <span class="k">else</span> <span class="p">:</span> 
                    <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>  <span class="p">[</span><span class="s1">&#39;.main.&#39;</span><span class="p">,</span> <span class="s1">&#39;_sd&#39;</span><span class="p">,</span> <span class="s1">&#39;_rr&#39;</span><span class="p">,</span> <span class="s1">&#39;_aver&#39;</span><span class="p">]):</span>
                        <span class="k">if</span> <span class="n">fex</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
                            <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> <span class="k">break</span> <span class="c1"># donc continue because other files does not exists  </span>
                        <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="s1">&#39;_cor_oas&#39;</span><span class="p">,</span> <span class="n">writeType</span><span class="p">]))</span> <span class="p">,</span>
                            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">savepath</span> <span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="s1">&#39;_cor_oas&#39;</span><span class="p">,</span> <span class="n">writeType</span><span class="p">])))</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It seems the files already exists !&quot;</span><span class="p">)</span>
        
        <span class="c1"># write Infos </span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;number of stations&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;minimum offset&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s1">&#39;m&#39;</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;maximum offset&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;m&#39;</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;maximum depth&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">geo_depth</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;m&#39;</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;spacing depth &#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">spacing_depth</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;m&#39;</span> <span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elevation</span> <span class="o">==</span><span class="mf">0.</span><span class="p">)</span> <span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt;  Elevation no added !&#39;</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> 

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;minumum elevation&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s1">&#39;m&#39;</span> <span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;maximum elevation &#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">elevation</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;m&#39;</span> <span class="p">))</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;minumum resistivity value&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span>
                                              <span class="nb">round</span><span class="p">(</span><span class="n">model_oasis_montaj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;Î©.m&#39;</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;maximum resistivity value&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span>
                                              <span class="nb">round</span><span class="p">(</span><span class="n">model_oasis_montaj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;Î©.m&#39;</span> <span class="p">))</span>
   
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Lowest sation&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">[</span> 
                                    <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nivelize_elevation</span><span class="o">==</span><span class="n">nivelize_elevation</span><span class="o">.</span><span class="n">min</span><span class="p">())[</span><span class="mi">0</span><span class="p">])]</span> <span class="p">))</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Highest site&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">[</span> 
                                    <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nivelize_elevation</span><span class="o">==</span><span class="n">nivelize_elevation</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">])]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Altitude gap&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">nivelize_elevation</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;m&#39;</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Number of running &#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> 
                                          <span class="nb">len</span><span class="p">(</span><span class="n">depres_pandas_columns</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="p">)))</span>
        
        
        <span class="k">if</span> <span class="n">fex</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; geo output file </span><span class="si">{0}</span><span class="s1">,  has been successfully written to  &lt;</span><span class="si">{1}</span><span class="s1">&gt;.&#39;</span><span class="o">.</span>\
                  <span class="nb">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;.main._cor_oas&#39;</span><span class="p">,</span> <span class="n">writeType</span><span class="p">]),</span> <span class="n">savepath</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">fex</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> <span class="c1">#read external files </span>

            <span class="n">filenames</span> <span class="o">=</span><span class="p">[</span> <span class="n">filename</span> <span class="o">+</span> <span class="n">file</span> <span class="o">+</span><span class="s1">&#39;_cor_oas&#39;</span><span class="o">+</span> <span class="n">writeType</span> <span class="k">for</span> <span class="n">file</span> <span class="p">,</span>
                        <span class="n">exten</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;main.&#39;</span><span class="p">,</span> <span class="s1">&#39;_sd&#39;</span><span class="p">,</span> <span class="s1">&#39;_rr&#39;</span><span class="p">,</span> <span class="s1">&#39;_aver&#39;</span><span class="p">],</span> 
                                     <span class="p">[</span><span class="n">writeType</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])]</span>
                        

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; geo output files </span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">  &amp; </span><span class="si">{3}</span><span class="s1"> have been successfully &#39;</span>\
                  <span class="s1">&#39;written to  &lt;</span><span class="si">{4}</span><span class="s1">&gt;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">filenames</span><span class="p">,</span> <span class="n">savepath</span><span class="p">))</span>
                

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">77</span><span class="p">)</span></div></div>
        
          
<div class="viewcode-block" id="Geosurface"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geosurface">[docs]</a><span class="k">class</span> <span class="nc">Geosurface</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read Multidata from oasis montaj output files  generated by `geodrill`</span>
<span class="sd">        module `from godrill.geoCore.geodrill import Geodrill`</span>
<span class="sd">                ` Geodrill()._to_oasis_montaj()`</span>
<span class="sd">        Build  a depth surface map for imaging . </span>
<span class="sd">        Argument:</span>
<span class="sd">        -----------</span>
<span class="sd">        **path** : string </span>
<span class="sd">            the path to oasis ouput files , frequently the files generated by</span>
<span class="sd">                                `geodrill`modules,</span>
<span class="sd">            </span>
<span class="sd">    ======================= ======== ==========================================</span>
<span class="sd">    Key Words/Attributes    type                        Description    </span>
<span class="sd">    ======================= ======== ==========================================</span>
<span class="sd">    depth _values      array_like   Values of depth for imaging .</span>
<span class="sd">                                        can be a list of depth like [38,912]</span>
<span class="sd">                            </span>
<span class="sd">    fileformat         str           output format . actually geosurface can </span>
<span class="sd">                                        only generate ouput in `csv` and `xls`.   </span>
<span class="sd">                                        *default* is   `csv`. </span>
<span class="sd">     savepath           str           full path to sve directory . If  none </span>
<span class="sd">                                         will create an a new directory </span>
<span class="sd">    ==================  ========= =========================================</span>
<span class="sd">        </span>
<span class="sd">        e.g. :: &gt;&gt;&gt; from geodrill.geoCore.geodrill import Geosurface </span>
<span class="sd">                &gt;&gt;&gt; gs_obj = geosurface (path =os.path.join(os.environ[&#39;pyCSAMT&#39;], </span>
<span class="sd">                                                   &#39;geodrill&#39;, &#39;data&#39;, </span>
<span class="sd">                                                   InputOas), </span>
<span class="sd">                                            depth_values = [28, 100])</span>
<span class="sd">                ... gs_obj.write_file()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">geo_surface_format</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span>  <span class="s2">&quot;xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;sql&quot;</span><span class="p">]</span> 
    
    <span class="n">read_dico</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;.csv&quot;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">,</span>  <span class="s2">&quot;.xlsx&quot;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">,</span><span class="s2">&quot;.json&quot;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">,</span>
                 <span class="s2">&quot;.html&quot;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">,</span><span class="s2">&quot;.sql&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">}</span>  
    
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span> <span class="o">=</span><span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">=</span><span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;depth_values&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span> <span class="p">(</span><span class="s1">&#39;fileformat&#39;</span><span class="p">,</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;savepath&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_oasis_path</span><span class="p">()</span> 
               
                        
    <span class="k">def</span> <span class="nf">_validate_oasis_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span><span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate oasis montaj files and get extension files </span>
<span class="sd">        params :</span>
<span class="sd">            path : str : full path to oasis montaj files </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>  
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span><span class="n">path</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>  <span class="c1"># get the list of files in folder </span>
                <span class="c1"># get file and be sure that format exist in </span>
                <span class="bp">self</span><span class="o">.</span><span class="n">oasis_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
                                   <span class="k">if</span> <span class="p">(</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_surface_format</span><span class="p">)]</span>
                
                <span class="c1"># print(self.oasis_data)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oasis_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oasis_data</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
                    <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;No files detected!. Please provided right path to oasis models files.&#39;</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
      
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;No path found ! Please provided a right path.&#39;</span><span class="p">)</span>
        
        <span class="c1"># get extension file </span>
        <span class="n">extension_files</span> <span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">pathfile</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">pathfile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">oasis_data</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extension_file</span> <span class="o">=</span><span class="n">extension_files</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extension_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_surface_format</span> <span class="p">:</span> 
            <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;Unacceptable format = </span><span class="si">{0}</span><span class="s1">. Could read format =</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extension_file</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_surface_format</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_file_handling</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
        
        
    <span class="nd">@property</span> 
    <span class="k">def</span> <span class="nf">extension_file</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extension_file</span>
    
    <span class="nd">@extension_file</span><span class="o">.</span><span class="n">setter</span> 
    <span class="k">def</span> <span class="nf">extension_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">get_extension</span><span class="p">):</span> 
        <span class="c1"># put on array and use np.unique to get the most frequent format</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">get_extension</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span> 
            <span class="n">get_extension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">get_extension</span><span class="p">)</span>
        <span class="n">ex</span> <span class="p">,</span> <span class="n">ex_count</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">get_extension</span> <span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extension_file</span>  <span class="o">=</span> <span class="n">ex</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">ex_count</span><span class="o">==</span> <span class="n">ex_count</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">])]</span>
        
<div class="viewcode-block" id="Geosurface.read_oasis_files"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geosurface.read_oasis_files">[docs]</a>    <span class="k">def</span> <span class="nf">read_oasis_files</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method to get depth spacing , station info  data infos, </span>
<span class="sd">         Each line becomes it own attributes </span>
<span class="sd">        components  of info values are  [Stations,	</span>
<span class="sd">                                       Easting_X_m	,Northing_Y_m,</span>
<span class="sd">                                  v_H_m,	x_m	Norm_h_m,</span>
<span class="sd">                                  sets_m	DOI_max_m]</span>
<span class="sd">            </span>
<span class="sd">        params : </span>
<span class="sd">            path : str </span>
<span class="sd">                full path to the oasis files .  </span>
<span class="sd">                </span>
<span class="sd">        eg :  &gt;&gt;&gt; from geodrill.geoCore.geodrill  import Geosurface </span>
<span class="sd">         &gt;&gt;&gt; path =  r&#39;F:/__main__csamt__\oasis data\OASISWORKS\all_data&#39;</span>
<span class="sd">         &gt;&gt;&gt; geo_surface_obj = Geosurface( path =path )</span>
<span class="sd">         &gt;&gt;&gt; geo_surface_obj.read_oasis_files()</span>
<span class="sd">         ... geofilenames = geo_surface_obj.filenames :--- &gt; to get the</span>
<span class="sd">         list of all files </span>
<span class="sd">         --- &gt; to get the values of line K1_cor_oas : &quot;K1_cor_oas.csv&quot;</span>
<span class="sd">         ... k1_obj = geo_surface_obj.K1_cor_oas </span>
<span class="sd">     </span>
<span class="sd">    </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:-^77}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;GeoSurface * Data * info&#39;</span><span class="p">))</span>
        <span class="k">def</span> <span class="nf">get_depth_values</span><span class="p">(</span><span class="n">df</span> <span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            get specific depth values from geomodel dataframe </span>
<span class="sd">            params : df : pandas.Core.DataFrame </span>
<span class="sd">                            Dataframe pandas </span>
<span class="sd">            return : </span>
<span class="sd">                        info_names  : list </span>
<span class="sd">                                        header names info , </span>
<span class="sd">                        depth_values : array_like </span>
<span class="sd">                                        spacing depth offsets </span>
<span class="sd">                        depth_spacing : float </span>
<span class="sd">                        value of spacing depth .  </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">info_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="ow">not</span>
                          <span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;dep_&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span>  <span class="ow">or</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;res_&#39;</span><span class="p">)</span><span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">]</span>
            <span class="c1"># The depth spacing value  is the same like the res  </span>
            <span class="n">depth_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;dep_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="k">for</span> 
                                     <span class="n">name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>  <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;dep_&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span>  <span class="p">])</span>
    
            <span class="k">return</span> <span class="n">info_names</span><span class="p">,</span> <span class="n">depth_values</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">depth_values</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> 
                                                     <span class="n">depth_values</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">depth_values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">def</span> <span class="nf">get_infohead_index</span><span class="p">(</span><span class="n">fnames</span><span class="p">,</span> <span class="n">info_matrix</span> <span class="p">,</span>  <span class="n">name</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            If oasis file is litthel messy about the head , better way to avoid </span>
<span class="sd">            miscomputation </span>
<span class="sd">            if to get the real index of colums names you are seeking so to</span>
<span class="sd">            get corresponding values </span>
<span class="sd">            params : </span>
<span class="sd">                fnames : list </span>
<span class="sd">                            head of info names except the depth matrix</span>
<span class="sd">                (dep_) and ressitivity matrix </span>
<span class="sd">                                (res_)</span>
<span class="sd">                name : str </span>
<span class="sd">                    name of head user are looking for </span>
<span class="sd">                info_matrix : ndarray </span>
<span class="sd">                            ndarray array of oasis montag info .</span>
<span class="sd">                start by ]station] to end normally </span>
<span class="sd">                [doi max] </span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">for</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">fnames</span> <span class="p">:</span> 
                <span class="k">if</span> <span class="n">head</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span> 
                    <span class="n">name</span> <span class="o">=</span><span class="n">head</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="n">fnames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">break</span> 
            <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">indexmatrix</span> <span class="o">=</span> <span class="n">info_matrix</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">return</span>  <span class="n">indexmatrix</span>
        
        
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_oasis_path</span><span class="p">()</span>
      
        <span class="bp">self</span><span class="o">.</span><span class="n">global_dico</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># initiliase gloabal dico to takes all files with key as survey lines </span>
        <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">vitems</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_dico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="k">if</span> <span class="n">keys</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">extension_file</span> <span class="p">:</span> 
                <span class="k">for</span> <span class="n">files</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">oasis_data</span> <span class="p">:</span> 
                     <span class="bp">self</span><span class="o">.</span><span class="n">global_dico</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="o">.</span>\
                                  <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extension_file</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">)]</span> <span class="o">=</span>\
                         <span class="n">vitems</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">info_depthvalues</span> <span class="o">=</span> <span class="p">{</span> <span class="n">filename</span> <span class="p">:</span> <span class="n">get_depth_values</span><span class="p">(</span><span class="n">df_</span><span class="p">)</span> <span class="k">for</span> <span class="n">filename</span> <span class="p">,</span>
                            <span class="n">df_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_dico</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="c1"># get the input filenames and set attributes </span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_dico</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    
            <span class="c1"># set main attributes for selects key</span>
           
        <span class="k">for</span> <span class="n">oasnames</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span> <span class="p">:</span>
            <span class="c1"># convert dataframe to numpy : numpy very fast </span>
            <span class="n">tem_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_dico</span><span class="p">[</span><span class="n">oasnames</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> 
            <span class="c1"># get the length (of head infos)</span>
            <span class="n">len_info_names</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info_depthvalues</span><span class="p">[</span><span class="n">oasnames</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> 
            <span class="c1"># get the length of depth infos </span>
            <span class="n">len_depth_offset</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info_depthvalues</span><span class="p">[</span><span class="n">oasnames</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> 
                <span class="c1"># now set temporary attributes for each limes </span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">oasnames</span><span class="p">,</span> <span class="p">(</span><span class="n">tem_array</span><span class="p">[::,</span> <span class="p">:</span><span class="n">len_info_names</span><span class="p">],</span>  <span class="c1"># info head array </span>
                                        <span class="n">tem_array</span><span class="p">[::,</span> <span class="n">len_info_names</span><span class="p">:</span><span class="n">len_info_names</span> <span class="o">+</span><span class="n">len_depth_offset</span><span class="p">],</span> <span class="c1"># depth array </span>
                                        <span class="n">tem_array</span><span class="p">[::,</span> <span class="n">len_info_names</span> <span class="o">+</span><span class="n">len_depth_offset</span><span class="p">:])</span> <span class="p">)</span> <span class="c1"># get the resistivity array </span>
           
        <span class="c1"># initiliase dictionary to hold  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geos_profile_strike_angles</span> <span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">gskeys</span><span class="p">,</span><span class="n">gsvalues</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_depthvalues</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** ----- </span><span class="si">{0}</span><span class="s1"> : --|&gt;</span><span class="si">{1:&lt;37}</span><span class="s1"> :&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="n">gskeys</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;depth spacing &#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">gsvalues</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;m&#39;</span> <span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;maximum depth&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">gsvalues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;m&#39;</span> <span class="p">))</span>
            <span class="c1"># compute profile ange and geolectrike strike </span>
            <span class="n">easting</span> <span class="o">=</span> <span class="n">get_infohead_index</span><span class="p">(</span><span class="n">fnames</span><span class="o">=</span><span class="n">gsvalues</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="n">info_matrix</span><span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gskeys</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                                         <span class="n">name</span><span class="o">=</span><span class="s1">&#39;east&#39;</span><span class="p">)</span>
          
            <span class="n">northing</span><span class="o">=</span> <span class="n">get_infohead_index</span><span class="p">(</span><span class="n">fnames</span><span class="o">=</span><span class="n">gsvalues</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="n">info_matrix</span><span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gskeys</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                                         <span class="n">name</span><span class="o">=</span><span class="s1">&#39;north&#39;</span><span class="p">)</span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="n">gstrike</span> <span class="p">,</span> <span class="n">profile_angle</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">geostrike</span><span class="o">.</span>\
                    <span class="n">compute_geoelectric_strike</span><span class="p">(</span><span class="n">easting</span><span class="o">=</span><span class="n">easting</span> <span class="p">,</span> 
                                                      <span class="n">northing</span> <span class="o">=</span> <span class="n">northing</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;profile angle &#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span>
                                                      <span class="n">profile_angle</span><span class="p">,</span> <span class="s1">&#39;degrees E of N.&#39;</span> <span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;** </span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1"> </span><span class="si">{3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;geoelectric strike&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span>
                                                      <span class="n">gstrike</span><span class="p">,</span> <span class="s1">&#39;degrees E of N.&#39;</span> <span class="p">))</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Trouble occurs when computing profile&#39;</span>\
                              <span class="s1">&#39; angle and geo electric strike.&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Trouble occurs when computing profile&#39;</span>\
                              <span class="s1">&#39; angle and geo electric strike.&#39;</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">geos_profile_strike_angles</span><span class="p">[</span><span class="n">gskeys</span><span class="p">]</span><span class="o">=</span> <span class="p">(</span><span class="n">profile_angle</span><span class="p">,</span> <span class="n">gstrike</span><span class="p">)</span></div>
                 <span class="c1"># pass when something wrong </span>
 
<div class="viewcode-block" id="Geosurface.get_depth_surfaces"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geosurface.get_depth_surfaces">[docs]</a>    <span class="k">def</span> <span class="nf">get_depth_surfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">depth_values</span> <span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the depth surfaces for multi-lines and build the numpy </span>
<span class="sd">        corresponding array  at that depth .</span>
<span class="sd">        </span>
<span class="sd">        params :</span>
<span class="sd">            depth_values :  float  or array_like </span>
<span class="sd">                                array or depth </span>
<span class="sd">                path : full path to oasis outputfiles .</span>
<span class="sd">                                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_oasis_files</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">depth_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span><span class="o">=</span> <span class="n">depth_values</span>    

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_geoinputargument</span><span class="p">(</span>
                <span class="s1">&#39;NoneType could not be computed. Please provided&#39;</span>\
                <span class="s1">&#39;  right values !&#39;</span><span class="p">)</span>
        
    
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span> 
            <span class="k">try</span> <span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_float</span><span class="p">(</span><span class="s1">&#39;Could not convert </span><span class="si">{0}</span><span class="s1"> to float&#39;</span><span class="o">.</span>\
                                              <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span><span class="p">))</span>
            <span class="k">else</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span><span class="p">])</span>
  
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span> <span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span><span class="p">)</span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_float</span><span class="p">(</span><span class="s1">&#39;Could not convert values to float!&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">get_single_surface_from_one_line</span><span class="p">(</span><span class="n">site_name</span> <span class="p">,</span> <span class="n">depth_value</span><span class="p">)</span>  <span class="p">:</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            fonction to get single surface from depth value fron one line .</span>
<span class="sd">             param : depthn value : float </span>
<span class="sd">                                     depth value to image </span>
<span class="sd">                     site_name : str </span>
<span class="sd">                                 name of site </span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get attributes array : depth and resistivity</span>
            <span class="c1">#get depth index from info_depthvalues dictionnary (key  :</span>
                    <span class="c1"># values = info_names, depth_values, depth spacing )</span>
            <span class="n">new_depth_value</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span>  <span class="n">get_closest_value</span><span class="p">(</span>
                <span class="n">values_range</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_depthvalues</span><span class="p">[</span><span class="n">site_name</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                              <span class="n">input_value</span><span class="o">=</span> <span class="n">depth_value</span><span class="p">)</span>
            <span class="c1"># now get especially array or depth and resistivy at that value</span>
            <span class="c1"># from attribute name  value attr = infomatrix , depth matrix and res matrix </span>
            <span class="n">depth</span> <span class="o">=</span>  <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_name</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:,</span> <span class="n">index</span><span class="p">]</span>
            <span class="n">res</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_name</span><span class="p">)[</span><span class="mi">2</span><span class="p">][:,</span> <span class="n">index</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">new_depth_value</span> <span class="p">,</span> <span class="n">depth</span> <span class="p">,</span> <span class="n">res</span> 
        
        <span class="c1"># for loop to concat array </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geosurface_dico</span> <span class="o">=</span><span class="p">{}</span>         <span class="c1"># dict to keep all surface matrix  </span>
        <span class="n">tem</span><span class="o">=</span><span class="p">[]</span> 
        <span class="k">for</span> <span class="n">dvalue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span> <span class="p">:</span> 
            <span class="k">for</span> <span class="n">names</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span> <span class="p">:</span> 
                <span class="n">new_depth_value</span><span class="p">,</span> <span class="n">sdepth</span> <span class="p">,</span> <span class="n">sres</span> <span class="o">=</span>\
                    <span class="n">get_single_surface_from_one_line</span><span class="p">(</span><span class="n">site_name</span><span class="o">=</span><span class="n">names</span> <span class="p">,</span> 
                                                     <span class="n">depth_value</span> <span class="o">=</span> <span class="n">dvalue</span><span class="p">)</span>
                <span class="c1">#build matrix array info depth res </span>
                <span class="n">globalmatrix</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> 
                                              <span class="n">sdepth</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sdepth</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> 
                                              <span class="n">sres</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sres</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span> 
                                             <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
                
                <span class="n">tem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">globalmatrix</span><span class="p">)</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">geosurface_dico</span><span class="p">[</span><span class="n">new_depth_value</span><span class="p">]</span> <span class="o">=</span><span class="n">tem</span>
            <span class="n">tem</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">gkey</span><span class="p">,</span> <span class="n">gvalue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geosurface_dico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="c1"># buid the array of each depth </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geosurface_dico</span><span class="p">[</span><span class="n">gkey</span><span class="p">]</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span><span class="n">gvalue</span><span class="p">)</span>
            
        <span class="c1"># create pandas dataframe </span>
        <span class="k">for</span> <span class="n">hnames</span><span class="p">,</span> <span class="n">hvalues</span>  <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_depthvalues</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span> 
            <span class="c1"># Generally for heads from oasis  are the same for all lines </span>
            <span class="c1"># the let get one: </span>
            <span class="n">headnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_depthvalues</span><span class="p">[</span><span class="n">hnames</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># break </span>
            <span class="k">break</span> 
        
        <span class="k">for</span> <span class="n">gnkey</span><span class="p">,</span> <span class="n">gnvalue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geosurface_dico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="n">columnames</span> <span class="o">=</span> <span class="n">headnames</span> <span class="o">+</span> <span class="p">[</span> <span class="s1">&#39;dep_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">gnkey</span><span class="p">))]</span> <span class="o">+</span> \
                <span class="p">[</span> <span class="s1">&#39;rho_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">gnkey</span><span class="p">))]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geosurface_dico</span><span class="p">[</span><span class="n">gnkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">gnvalue</span><span class="p">,</span>
                                                       <span class="n">columns</span> <span class="o">=</span> <span class="n">columnames</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="Geosurface.write_file"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Geosurface.write_file">[docs]</a>    <span class="k">def</span> <span class="nf">write_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">depth_values</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fileformat</span><span class="o">=</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write output files. Output files are `.xlsx` or `.csv` . </span>
<span class="sd">        params : </span>
<span class="sd">            path : str : full path to  `geodrill` ouput files </span>
<span class="sd">            depth value : float or array_like </span>
<span class="sd">                                    depth values for imaging </span>
<span class="sd">            fileformat : str </span>
<span class="sd">                    `xlsx` or `csv` are actually the acceptable formats.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">savepath</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;savepath&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">writeIndex</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;write_index&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">csvsetHeader</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;add_header&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">csvsep</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;csv_separateType&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span> <span class="o">=</span><span class="n">savepath</span> 

        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span> 
        <span class="k">if</span> <span class="n">depth_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span> <span class="o">=</span><span class="n">depth_values</span> 
        <span class="k">if</span> <span class="n">fileformat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span> <span class="o">=</span> <span class="n">fileformat</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="c1"># for consistency </span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;exc&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">or</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;xls&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span> <span class="o">=</span> <span class="s1">&#39;xlsx&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span> <span class="o">=</span><span class="s1">&#39;csv&#39;</span>
        <span class="k">else</span> <span class="p">:</span> 
            <span class="n">mess</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;--&gt;Sorry! Geosurface actually does not support the </span><span class="si">{0}</span><span class="s1"> &#39;</span><span class="p">,</span>
                          <span class="s1">&#39;format provided. Only support `xlsx` or `csv` format.&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39; Please provided the rigth format !&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="p">))</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="p">))</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_file_handling</span><span class="p">(</span>
                <span class="s1">&#39;Format provided = </span><span class="si">{0}</span><span class="s1"> is wrong ! Could output only `csv` or `xlsx`.&#39;</span><span class="o">.</span>\
                    <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="p">))</span>
            
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_values</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Need to specify the value of depth for imaging !&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Need to specify the value of depth for imaging !&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span>
                <span class="s1">&#39;! Need to specify the depth value for imaging.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Need to provide the rigth path `geodrill` model output files.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Need to provide the rigth path `geodrill` model output files.&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span>
                <span class="s1">&#39;No path detected ! Please provide a right path to `geodrill`</span><span class="se">\</span>
<span class="s1">                    oasis montaj outputfiles &#39;</span><span class="p">)</span>
  
        <span class="bp">self</span><span class="o">.</span><span class="n">get_depth_surfaces</span><span class="p">()</span> <span class="c1"># call methods to create </span>
        
        <span class="c1"># get values from dictionnary and write file </span>
        <span class="c1">#make output filename </span>
        <span class="n">filenames</span> <span class="o">=</span><span class="p">[]</span>
        <span class="n">filename</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_cor_oas&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> 
                                <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span> <span class="o">==</span><span class="s1">&#39;xlsx&#39;</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span><span class="o">+</span> 
                                         <span class="s1">&#39;_gs</span><span class="si">{0}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">month</span> <span class="p">),</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="p">]))</span> <span class="k">as</span> <span class="n">writer</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">file</span> <span class="p">,</span> <span class="n">df_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geosurface_dico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
                        <span class="n">df_</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span>
                                     <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;dep_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">),</span> 
                                     <span class="n">index</span> <span class="o">=</span><span class="n">writeIndex</span><span class="p">)</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="p">[</span><span class="n">filename</span><span class="o">+</span> 
                            <span class="s1">&#39;_gs</span><span class="si">{0}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">month</span> <span class="p">),</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="p">]))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span> <span class="o">==</span><span class="s1">&#39;csv&#39;</span><span class="p">:</span> 
            
            <span class="k">for</span> <span class="n">file</span> <span class="p">,</span> <span class="n">df_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geosurface_dico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">df_</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">),</span>
                                    <span class="s1">&#39;_gs</span><span class="si">{0}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">month</span><span class="p">),</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="p">]),</span>
                              <span class="n">header</span><span class="o">=</span><span class="n">csvsetHeader</span><span class="p">,</span>
                              <span class="n">index</span> <span class="o">=</span><span class="n">writeIndex</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="n">csvsep</span><span class="p">)</span>
                
                <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">filename</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="p">,</span>
                             <span class="s1">&#39;_gs</span><span class="si">{0}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">month</span> <span class="p">),</span> 
                             <span class="bp">self</span><span class="o">.</span><span class="n">export_format</span><span class="p">]))</span>
                
        <span class="c1"># export to savepath </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="c1"># create a folder in your current work directory</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;_outputGS_&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">)</span><span class="c1">#  mode =0o666)</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It seems the path already exists !&quot;</span><span class="p">)</span>
                
        <span class="c1">#savefile inot it savepath </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="kn">import</span> <span class="nn">shutil</span> 
            <span class="k">try</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">nfile</span> <span class="ow">in</span> <span class="n">filenames</span> <span class="p">:</span> 
                   <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                       <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>  <span class="n">nfile</span><span class="p">),</span>           
                       <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span> <span class="p">,</span> <span class="n">nfile</span><span class="p">))</span>

            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It seems files already exist !&quot;</span><span class="p">)</span>
                
        <span class="c1"># fmt =&#39;&#39;.join([&#39;{0}&#39;.format(ifile) for ifile in filenames])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Geosurfaces outputfiles :</span><span class="si">{0}</span><span class="s1"> : have been successfully &#39;</span>\
                  <span class="s1">&#39;written to  &lt;</span><span class="si">{1}</span><span class="s1">&gt;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                      <span class="p">[</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span> <span class="k">for</span> <span class="n">ifile</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">]),</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">77</span><span class="p">)</span></div></div>
           
<div class="viewcode-block" id="geostrike"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.geostrike">[docs]</a><span class="k">class</span> <span class="nc">geostrike</span> <span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to deal with computation with profile angle and geo_electrical strike.</span>
<span class="sd">    Compute Profile angle and strike angle </span>
<span class="sd">     Need to import scipy.stats as one module . Sometimes import scipy </span>
<span class="sd">    differently  with stats may not work . </span>
<span class="sd">    either `import scipy.stats` rather than `import scipy as sp` to use : </span>
<span class="sd">        `sp.stats.linregress` . </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="geostrike.compute_profile_angle"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.geostrike.compute_profile_angle">[docs]</a>    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">compute_profile_angle</span> <span class="p">(</span><span class="n">easting</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">northing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Essentially dedicated to compute geoprofile angle </span>
<span class="sd">        params : easting : array_like </span>
<span class="sd">                    easting coordiantes values </span>
<span class="sd">                northing : array_like </span>
<span class="sd">                        northing coordinates values</span>
<span class="sd">                </span>
<span class="sd">            return : tuple(profile_angle , msg )</span>
<span class="sd">        </span>
<span class="sd">                    profile_angle , float </span>
<span class="sd">                                geo_electric_strike </span>
<span class="sd">                    msg : str </span>
<span class="sd">                                message of return </span>
<span class="sd">   </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Computing  profile angle from Easting and Nothing coordinates.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">easting</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">northing</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span><span class="s1">&#39;NoneType can not be computed !&#39;</span><span class="p">)</span>
            
            <span class="c1"># use the one with the lower standard deviation</span>
        <span class="k">try</span> <span class="p">:</span>
            <span class="n">easting</span> <span class="o">=</span> <span class="n">easting</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
            <span class="n">northing</span> <span class="o">=</span> <span class="n">northing</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_float</span><span class="p">(</span><span class="s1">&#39;Could not convert input argument to float!&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">stats_import</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="n">profile1</span> <span class="o">=</span> <span class="n">spSTAT</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">easting</span><span class="p">,</span> <span class="n">northing</span><span class="p">)</span>
    
            <span class="n">profile2</span> <span class="o">=</span><span class="n">spSTAT</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">northing</span><span class="p">,</span> <span class="n">easting</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Could not find scipy.stats, cannot use method linearRegression &#39;</span>
                  <span class="s1">&#39;check installation you can get scipy from scipy.org.&#39;</span><span class="p">)</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Could not find scipy.stats, cannot use method lineaRegress &#39;</span>
                    <span class="s1">&#39;check installation you can get scipy from scipy.org.&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s1">&#39;Could not find scipy.stats, cannot use method lineaRegress &#39;</span>
                    <span class="s1">&#39;check installation you can get scipy from scipy.org.&#39;</span><span class="p">)</span>
            
        <span class="n">profile_line</span> <span class="o">=</span> <span class="n">profile1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># if the profile is rather E=E(N), the parameters have to converted  into N=N(E) form:</span>
        
        <span class="k">if</span> <span class="n">profile2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">profile1</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
            <span class="n">profile_line</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">profile2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">profile2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">profile2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># if self.profile_angle is None:</span>
        <span class="n">profile_angle</span> <span class="o">=</span> <span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">profile_line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">%</span> <span class="mi">180</span>

        <span class="c1"># otherwise: # have 90 degree ambiguity in strike determination# choose strike which offers larger angle with profile</span>
        <span class="c1"># if profile azimuth is in [0,90].</span>
        
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">profile_angle</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;Profile angle is </span><span class="si">{0:+.2f}</span><span class="s1"> degrees E of N&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">profile_angle</span><span class="p">)</span></div>
         
        
      
<div class="viewcode-block" id="geostrike.compute_geoelectric_strike"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.geostrike.compute_geoelectric_strike">[docs]</a>    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">compute_geoelectric_strike</span> <span class="p">(</span><span class="n">profile_angle</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">,</span> <span class="n">easting</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                                    <span class="n">northing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute geoelctric strike </span>
<span class="sd">        param : </span>
<span class="sd">            params : profile_angle : float </span>
<span class="sd">                                    if not provided , will comput with </span>
<span class="sd">                                    easting and northing coordinates </span>
<span class="sd">                    easting : array_like </span>
<span class="sd">                                easting coordiantes values </span>
<span class="sd">                    northing : array_like </span>
<span class="sd">                                    northing coordinates values </span>
<span class="sd">                    geo_strike : float </span>
<span class="sd">                                strike value ; if provided, will </span>
<span class="sd">                                recomputed geo_electric strike .</span>
<span class="sd">                  </span>
<span class="sd">        return : tuple(geo_electric_strike, profile_angle, msg )</span>
<span class="sd">                    profile_angle : float </span>
<span class="sd">                                        profile angle in degree E of N </span>
<span class="sd">                    geo_electric_strike , float </span>
<span class="sd">                                            geo_electric_strike  in degrees E of N</span>
<span class="sd">                    msg : str : message of return </span>
<span class="sd">                                        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gstrike</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;geo_strike&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">profile_angle</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>  <span class="n">easting</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">northing</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;None type detected for profile angle , easting and&#39;</span>\
                           <span class="s1">&#39; northing. NoneType can not be computed&#39;</span><span class="p">,</span> 
                           <span class="s1">&#39; will check whether geostrike is provided .&#39;</span><span class="p">])</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">gstrike</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                
                <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;NoneType found.Could not compute geo-electrike strike!&#39;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_inputarguments</span><span class="p">(</span>
                    <span class="s1">&#39;NoneType found. Could not compute geo-electrike strike!&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">profile_angle</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="n">easting</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">northing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">profile_angle</span> <span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">geostrike</span><span class="o">.</span><span class="n">compute_profile_angle</span><span class="p">(</span><span class="n">easting</span><span class="p">,</span> <span class="n">northing</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">gstrike</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="mi">0</span><span class="o">&lt;=</span> <span class="n">profile_angle</span> <span class="o">&lt;</span> <span class="mi">90</span> <span class="p">:</span>
                <span class="n">geo_electric_strike</span>  <span class="o">=</span> <span class="n">profile_angle</span> <span class="o">+</span> <span class="mi">90</span>  
            <span class="k">elif</span> <span class="mi">90</span><span class="o">&lt;=</span><span class="n">profile_angle</span> <span class="o">&lt;</span> <span class="mi">180</span> <span class="p">:</span>
                <span class="n">geo_electric_strike</span> <span class="o">=</span> <span class="n">profile_angle</span> <span class="o">-</span><span class="mi">90</span>
            <span class="k">elif</span> <span class="mi">180</span> <span class="o">&lt;=</span> <span class="n">profile_angle</span> <span class="o">&lt;</span><span class="mi">270</span> <span class="p">:</span>
                <span class="n">geo_electric_strike</span> <span class="o">=</span> <span class="o">-</span> <span class="n">profile_angle</span> <span class="o">+</span><span class="mi">90</span> 
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">geo_electric_strike</span>  <span class="o">=</span> <span class="o">-</span> <span class="n">profile_angle</span> <span class="o">-</span><span class="mi">90</span> 
            
            <span class="n">geo_electric_strike</span>  <span class="o">%=</span> <span class="mi">180</span>   
    
        <span class="k">if</span> <span class="n">gstrike</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="c1"># recomputed geo_electrike strike </span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">profile_angle</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">profile_angle</span> <span class="o">-</span> <span class="n">gstrike</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">45</span><span class="p">:</span>
                    <span class="n">geo_electric_strike</span>  <span class="o">=</span> <span class="n">gstrike</span><span class="o">+</span> <span class="mi">90</span>
     
            <span class="k">elif</span> <span class="mi">90</span> <span class="o">&lt;=</span> <span class="n">profile_angle</span> <span class="o">&lt;</span> <span class="mi">135</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">profile_angle</span> <span class="o">-</span> <span class="n">gstrike</span> <span class="o">&lt;</span> <span class="mi">45</span><span class="p">:</span>
                    <span class="n">geo_electric_strike</span> <span class="o">=</span> <span class="n">gstrike</span> <span class="o">-</span> <span class="mi">90</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">profile_angle</span> <span class="o">-</span> <span class="n">gstrike</span> <span class="o">&gt;=</span> <span class="mi">135</span><span class="p">:</span>
                   <span class="n">geo_electric_strike</span> <span class="o">=</span> <span class="n">gstrike</span><span class="o">+</span> <span class="mi">90</span>
            <span class="n">geo_electric_strike</span> <span class="o">%=</span>  <span class="mi">180</span>         <span class="c1"># keep value of geoelectrike strike less than 180 degree</span>
            
        <span class="n">geo_electric_strike</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">geo_electric_strike</span><span class="p">)</span>
        
        <span class="k">return</span>  <span class="n">geo_electric_strike</span><span class="p">,</span> <span class="n">profile_angle</span> <span class="p">,</span> <span class="s1">&#39;Profile angle is </span><span class="si">{0:+.2f}</span><span class="s1"> degrees E of N&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geo_electric_strike</span><span class="p">)</span></div></div>
        
      
<div class="viewcode-block" id="Drill"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Drill">[docs]</a><span class="k">class</span> <span class="nc">Drill</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is focus on well logs . How to generate well Log for Oasis:</span>
<span class="sd">        </span>
<span class="sd">    Arguments:</span>
<span class="sd">    -----------</span>
<span class="sd">            </span>
<span class="sd">            well_filename : string </span>
<span class="sd">            </span>
<span class="sd">                    The  well filename. 02 options is set : </span>
<span class="sd">                    1rst option is to build well data manually and the program will  </span>
<span class="sd">                    generate a report. </span>
<span class="sd">                    2nd option is to send to the program a typical file type to be parsed . </span>
<span class="sd">                    the programm parses only the typical well datafile. If None , </span>
<span class="sd">                    the program will redirect to build mannually option . </span>

<span class="sd">             build_manually_welldata  : bool , </span>
<span class="sd">            </span>
<span class="sd">                    option to build manually the well data . set to True , if you want to build</span>
<span class="sd">                    manually a well data . default is False</span>

<span class="sd">    </span>
<span class="sd">        ======================= ======== =======================================    </span>
<span class="sd">        Key Words/Attributes     type             Description    </span>
<span class="sd">        ======================= ======== ========================================    </span>
<span class="sd">        utm_zone                str      utm WGS84 zone. should be N or S.   </span>
<span class="sd">                                            *default* is 49N .</span>
<span class="sd">                                </span>
<span class="sd">        compute_azimuth         bool     if no azimuth is provided. </span>
<span class="sd">                                            set to True to letprogram to compute</span>
<span class="sd">                                            azimuth .*Default* is False.</span>
<span class="sd">                                 </span>
<span class="sd">        Drill_dip               float    The dip of drill hole.</span>
<span class="sd">                                            *default* is 90 . </span>
<span class="sd">                                </span>
<span class="sd">        Drill_buttom            float   The average bottom of drill , </span>
<span class="sd">                                            can be filled</span>
<span class="sd">                                            during the well buiding *default*</span>
<span class="sd">                                            is  None</span>
<span class="sd">                                </span>
<span class="sd">        mask                    int      the mask of DrillHole(DH) data. </span>
<span class="sd">                                            *Default * is 1.</span>
<span class="sd">                                 </span>
<span class="sd">        ======================= ===================================================</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        Methods                   Description</span>
<span class="sd">        ========================= =================================================</span>
<span class="sd">        _collar                  build _collar data  </span>
<span class="sd">                                    *return*  collar log dataframe  </span>
<span class="sd">                                    format</span>
<span class="sd">         dhGeology               build DH log geology  </span>
<span class="sd">                                     *return* geology log dataframe. </span>
<span class="sd">                                     </span>
<span class="sd">        dhSample                 build DH Geochemistry -Strutural sample </span>
<span class="sd">                                    *return * Sample log dataframe</span>
<span class="sd">                                    </span>
<span class="sd">        dhSurveyElevAz          build DH Elevation &amp; Azimuth logs .</span>
<span class="sd">                                    *return * Elevation &amp; Azimuth dataframes</span>
<span class="sd">        </span>
<span class="sd">        writeDHDATA             output log :</span>
<span class="sd">                                * return *  the right log to output for Oasis Montaj </span>
<span class="sd">                                    </span>
<span class="sd">        ======================= ===================================================</span>
<span class="sd">        </span>
<span class="sd">        e.g </span>
<span class="sd">            &gt;&gt;&gt; from geodrill.geoCore.geodrill import Drill </span>
<span class="sd">            &gt;&gt;&gt; parser_file =&#39;nbleDH.csv&#39;</span>
<span class="sd">            &gt;&gt;&gt; drill_obj=Drill(well_filename=os.path.join(os.environ[&#39;pyCSAMT&#39;],</span>
<span class="sd">                                                       parser_file),</span>
<span class="sd">                  build_manually_welldata=False)</span>
<span class="sd">            ... scollar=drill._collar(DH_Top=None)</span>
<span class="sd">            ... sgeo=drill.dhGeology()</span>
<span class="sd">            ... ssam=drill.dhSample()</span>
<span class="sd">            ... selevaz=drill.dhSurveyElevAz( add_elevation=None, </span>
<span class="sd">                                         add_azimuth=None)</span>
<span class="sd">            ... swrite=drill.writeDHData(data2write =&quot;*&quot;,</span>
<span class="sd">                                     savepath =None)</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">well_filename</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">build_manually_welldata</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">=</span><span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">wfilename</span><span class="o">=</span><span class="n">well_filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buildmanuel</span><span class="o">=</span><span class="n">build_manually_welldata</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;mask&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">utm_zone</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;utm_zone&quot;</span><span class="p">,</span><span class="s2">&quot;49N&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_azimuth</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;compute_azimuth&quot;</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dip</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Drill_dip&quot;</span><span class="p">,</span><span class="mi">90</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttom</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Drill_buttom&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1"># self.elevfile=kwargs.pop(&quot;elevation_file&quot;, None)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">easts</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norths</span><span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wellnames</span><span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_f</span><span class="o">=</span><span class="kc">None</span> 
        
        <span class="c1">#populate attribute later </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;DH_Hole&quot;</span> <span class="p">:</span><span class="kc">None</span><span class="p">,</span> 
                    <span class="s2">&quot;DH_East&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> 
                    <span class="s2">&quot;DH_North&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> 
                    <span class="s2">&quot;Mask&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;DH_RH&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> 
                    <span class="s1">&#39;DH_From&#39;</span><span class="p">:</span><span class="kc">None</span> <span class="p">,</span> 
                    <span class="s2">&quot;DH_To&quot;</span><span class="p">:</span> <span class="kc">None</span> <span class="p">,</span> 
                    <span class="s2">&quot;Rock&quot;</span><span class="p">:</span> <span class="kc">None</span> <span class="p">,</span> 
                    <span class="s2">&quot;DH_Azimuth&quot;</span><span class="p">:</span><span class="kc">None</span> <span class="p">,</span> 
                    <span class="s1">&#39;DH_Top&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> 
                    <span class="s1">&#39;DH_Bottom&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                    <span class="s1">&#39;DH_PlanDepth&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> 
                    <span class="s1">&#39;DH_Decr&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> 
                    <span class="s1">&#39;Sample&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                    <span class="s1">&#39;DH_Dip&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> 
                    <span class="s1">&#39;Elevation&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                    <span class="s1">&#39;DH_RL&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                    <span class="p">}</span>        
        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildmanuel</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">wfilename</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">build_wellData</span> <span class="p">(</span><span class="n">add_azimuth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                            <span class="n">utm_zone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">utm_zone</span><span class="p">,</span>
                                            <span class="n">report_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_azimuth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_East&quot;</span><span class="p">]</span>   <span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">wadata</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_North&quot;</span><span class="p">]</span>  <span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_Hole&quot;</span><span class="p">]</span>   <span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">wadata</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_Dip&#39;</span><span class="p">]</span>    <span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">wadata</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_Bottom&#39;</span><span class="p">]</span> <span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_Decr&#39;</span><span class="p">]</span> <span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_PlanDepth&#39;</span><span class="p">]</span> <span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_Azimuth&quot;</span><span class="p">]</span> <span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_f</span><span class="o">=</span><span class="mi">0</span>


        <span class="k">elif</span>  <span class="bp">self</span><span class="o">.</span><span class="n">wfilename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">parse_wellData</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wfilename</span><span class="p">,</span>
                                          <span class="n">include_azimuth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">utm_zone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">utm_zone</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;DH_East&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;DH_North&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;DH_Hole&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s1">&#39;DH_Dip&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s1">&#39;DH_PlanDepth&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">8</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;DH_Azimuth&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">5</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s1">&#39;DH_Decr&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">9</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s1">&#39;DH_Bottom&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="p">[:,</span><span class="mi">7</span><span class="p">])</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_f</span><span class="o">=</span><span class="mi">1</span>
            

        <span class="c1">#set Mask and set dr_rh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U12&#39;</span><span class="p">)</span>
        <span class="c1"># print(self.mask.shape)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;Mask&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dh_rh</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;DH_RH&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dh_rh</span><span class="p">)</span>  
        <span class="c1"># print(self.wdico[&#39;DH_RH&#39;])</span>
         
        
        <span class="c1"># print(set -attribute)</span>
        <span class="c1"># for keys , values in kwargs.items():</span>
        <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
            
            <span class="c1"># for key in not list(kwargs.keys()):</span>
            <span class="c1"># setattr(self, key, kwargs[key])</span>
            
  
    <span class="k">def</span> <span class="nf">_collar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DH_Top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">add_elevation</span> <span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to build Collar Data </span>
<span class="sd">        </span>
<span class="sd">        parameter :</span>
<span class="sd">            </span>
<span class="sd">            *DH_Top * : np.ndarray </span>
<span class="sd">                it&#39;s the Top of data for each Hole Name. ndaray (number of DH , 1) </span>
<span class="sd">                Default is None.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            pd.DataFrme </span>
<span class="sd">                collar Drillhole log</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">DH_Top</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">DH_Top</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">DH_Top</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">float</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">DH_Top</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="p">:</span>
            <span class="n">DH_Top</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">DH_Top</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U12&#39;</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="n">DH_Top</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">DH_Top</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span><span class="p">:</span>
                <span class="n">DH_Top</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">DH_Top</span><span class="p">)</span>
                
            <span class="k">assert</span> <span class="n">DH_Top</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;the input DH_Top &#39;</span>\
                <span class="s1">&#39;shape doesnt match. The convenience  shape is </span><span class="si">%d</span><span class="s1">.&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">wdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="c1"># print(DH_Top)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s1">&#39;DH_Top&#39;</span><span class="p">,</span><span class="n">DH_Top</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">add_elevation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="c1">#No topography is added , set to 0 </span>
                <span class="n">add_elevation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_EAST&#39;</span><span class="p">]),</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U12&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">add_elevation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">add_elevation</span> <span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="p">:</span>
                    <span class="n">add_elevation</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">add_elevation</span><span class="p">)</span>
                <span class="k">assert</span> <span class="n">add_elevation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_EAST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;INDEXERROR:&quot;</span>\
                    <span class="s2">&quot; The the current dimention of Elevation data is </span><span class="si">{0}</span><span class="s2">.It&#39;s must be&quot;</span>\
                        <span class="s2">&quot; the size </span><span class="si">{1}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">add_elevation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_EAST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;Elevation&quot;</span><span class="p">,</span> <span class="n">add_elevation</span><span class="p">)</span>
                    
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
            
            <span class="k">if</span> <span class="n">add_elevation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">add_elevation</span> <span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="p">:</span>
                    <span class="n">add_elevation</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">add_elevation</span><span class="p">)</span>
                <span class="k">try</span> <span class="p">:</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">add_elevation</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_East&#39;</span><span class="p">]))</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="p">:</span> 
                    <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;SIZEERROR! Try to set the elevation dimentional as &#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;same size like the collar data&#39;</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                    
            <span class="k">elif</span> <span class="n">add_elevation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">add_elevation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span> <span class="p">[</span><span class="mi">1</span><span class="p">][:,</span><span class="mi">4</span><span class="p">]</span>
        
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;Elevation&quot;</span><span class="p">,</span> <span class="n">add_elevation</span><span class="p">)</span>
        
        <span class="n">collarKeys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DH_Hole&quot;</span><span class="p">,</span>	<span class="s2">&quot;DH_East&quot;</span><span class="p">,</span>	<span class="s2">&quot;DH_North&quot;</span><span class="p">,</span>	<span class="s2">&quot;DH_RH&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DH_Dip&quot;</span><span class="p">,</span> <span class="s2">&quot;Elevation&quot;</span><span class="p">,</span> <span class="s2">&quot;DH_Azimuth&quot;</span><span class="p">,</span><span class="s2">&quot;DH_Top&quot;</span><span class="p">,</span> <span class="s2">&quot;DH_Bottom&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DH_PlanDepth&quot;</span><span class="p">,</span>	<span class="s2">&quot;DH_Decr&quot;</span><span class="p">,</span>	<span class="s2">&quot;Mask&quot;</span><span class="p">]</span> 
        
        <span class="c1"># print(self.wdico)</span>
        <span class="n">collar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="n">collarKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">collar</span><span class="o">=</span><span class="n">collar</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">collar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">ss</span><span class="p">,</span> <span class="n">collk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">collarKeys</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>  
            <span class="c1"># print(collk)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">collk</span> <span class="p">:</span>
                    <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">collar</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">collar</span><span class="p">,</span><span class="n">value</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">coLLAR</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">collar</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">collarKeys</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coLLAR</span>
    
    
<div class="viewcode-block" id="Drill.dhGeology"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Drill.dhGeology">[docs]</a>    <span class="k">def</span> <span class="nf">dhGeology</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dh_geomask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to build geology drillhole log. The name of input rock must feell exaction accordinag to</span>
<span class="sd">        a convention AGSO file . If not sure for the name of rock and Description and label .</span>
<span class="sd">        you may consult the geocode folder before building the well_filename. If the entirely</span>
<span class="sd">        rock name is given , program will search on the AGSO file the corresponding Label and code . </span>
<span class="sd">        If the rock name is  founc then it will take its CODE else it will generate exception. </span>
<span class="sd"> </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        </span>
<span class="sd">        dh_geomask : np.ndarray, optional</span>
<span class="sd">        </span>
<span class="sd">            geology mask. send mask value can take exactly</span>
<span class="sd">            the np.ndarray(num_of_geology set ,). The better way to set geology mask</span>
<span class="sd">            is to fill on the wellfilename. if not , programm will take the general mask value. </span>
<span class="sd">            The default is None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame </span>
<span class="sd">            geology drillhole log.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="n">geolKeys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DH_Hole&quot;</span><span class="p">,</span><span class="s2">&quot;DH_From&quot;</span><span class="p">,</span>	<span class="s2">&quot;DH_To&quot;</span><span class="p">,</span><span class="s2">&quot;Rock&quot;</span><span class="p">,</span>	<span class="s2">&quot;Sample&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;East&quot;</span><span class="p">,</span>	<span class="s2">&quot;DH_North&quot;</span><span class="p">,</span>	<span class="s2">&quot;DH_RH&quot;</span><span class="p">,</span>	<span class="s2">&quot;Mask&quot;</span><span class="p">]</span>
        
        <span class="n">wgeo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># print(wgeo)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s1">&#39;DH_From&#39;</span><span class="p">,</span> <span class="n">wgeo</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s1">&#39;DH_To&#39;</span><span class="p">,</span> <span class="n">wgeo</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;Rock&quot;</span><span class="p">,</span><span class="n">wgeo</span><span class="p">[:,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">dhgeopseudosamp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">wgeo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        
        <span class="c1">###### FIND AGSO MODULE #######</span>
        <span class="c1">#Try to check the name of rocks and their acronym</span>
        <span class="n">geoelm</span><span class="o">=</span><span class="n">Agso</span><span class="o">.</span><span class="n">_agso_on_dict_</span><span class="p">(</span><span class="n">set_agsoDataFrame</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_orientation</span><span class="o">=</span><span class="s2">&quot;SERIES&quot;</span><span class="p">)</span>
            <span class="c1"># #extract elem with their acronym </span>
        <span class="n">geolemDico_AGSO</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span> <span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> \
                         <span class="nb">zip</span> <span class="p">(</span><span class="n">geoelm</span><span class="p">[</span><span class="s2">&quot;CODE&quot;</span><span class="p">],</span><span class="n">geoelm</span><span class="p">[</span><span class="s1">&#39;__DESCRIPTION&#39;</span><span class="p">])}</span>
        <span class="c1"># elemgeo_AGSO=sorted(geolemDico.items())</span>
    
        
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">elm</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;Rock&#39;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">elm</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">geolemDico_AGSO</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">pass</span> 
            <span class="k">elif</span> <span class="n">elm</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">geolemDico_AGSO</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">elm</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">geolemDico_AGSO</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">geolemDico_AGSO</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">elm</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">values</span> <span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;Rock&#39;</span><span class="p">][</span><span class="n">ii</span><span class="p">]</span><span class="o">=</span><span class="n">key</span>
                <span class="k">else</span>  <span class="p">:</span>
                    <span class="n">mess</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;The Geological Name (</span><span class="si">{0}</span><span class="s1">) given in is wrong&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elm</span><span class="p">),</span>
                                <span class="s1">&#39;Please provide a right name the right Name.&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;Please consult the AGSO file in _geocodes folder&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;without changing anything.&#39;</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>

        <span class="c1">######END AGS0 ########</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dh_geoleast</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">wgeo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dh_geol_norths</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">wgeo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        
        <span class="k">for</span> <span class="n">ss</span> <span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_geoleast</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">indix</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_East&quot;</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">wgeo</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][</span><span class="n">ss</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_Hole&quot;</span><span class="p">]:</span>
                    <span class="n">value</span><span class="o">=</span><span class="n">val</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dh_geoleast</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span> <span class="o">=</span><span class="n">value</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dh_geol_norths</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_North&quot;</span><span class="p">][</span><span class="n">indix</span><span class="p">]</span>
                    
        <span class="n">dhgeopseudosamp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">wgeo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">dh_geomask</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">dh_geomask</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">maskgeo</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">wgeo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">dh_geomask</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U12&#39;</span><span class="p">)</span>
        <span class="n">dhrhgeo</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_From&#39;</span><span class="p">]])</span>
        <span class="n">dhGeol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">wgeo</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">wgeo</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_From&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_From&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_To&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_To&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;Rock&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;Rock&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="n">dhgeopseudosamp</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">dhgeopseudosamp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">dh_geoleast</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_geoleast</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">dh_geol_norths</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_geol_norths</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="n">dhrhgeo</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">dhrhgeo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="n">maskgeo</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">maskgeo</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geoDHDATA</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dhGeol</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">geolKeys</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">geoDHDATA</span></div>
    
           
<div class="viewcode-block" id="Drill.dhSample"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Drill.dhSample">[docs]</a>    <span class="k">def</span> <span class="nf">dhSample</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">path_to_agso_codefile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dh_sampmask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to build Sample log. This method focuses on the sample obtained during the DH trip.</span>
<span class="sd">        it may georeferenced as the well_filename needed. A main thing is to set the AGSO_STCODES file.</span>
<span class="sd">        AGSO_STCODES is the conventional code of structurals sample. If you have an own AGSO_STCODES ,</span>
<span class="sd">        you may provide the path * kwargs=path_to_ags_codefile * . the program will read and generate</span>
<span class="sd">        logs according to the  DESCRIPTION and STCODES figured. if None, the program will take it STCODES </span>
<span class="sd">        and set the samplelogs. When you set the Sample code aor sample name , make sur that the name match</span>
<span class="sd">        the same name on STCODES. If not , program will raises an error. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path_to_agso_codefile : str, optional</span>
<span class="sd">            path to conventional AGSO_STRUCTURAL CODES. The default is None.</span>
<span class="sd">        dh_sampmask : np.ndarray, optional</span>
<span class="sd">            Structural mask. The default is None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame </span>
<span class="sd">            Sample DH log.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">sampKeys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DH_Hole&quot;</span><span class="p">,</span><span class="s2">&quot;DH_From&quot;</span><span class="p">,</span>	<span class="s2">&quot;DH_To&quot;</span><span class="p">,</span><span class="s2">&quot;Rock&quot;</span><span class="p">,</span>	<span class="s2">&quot;Sample&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;East&quot;</span><span class="p">,</span>	<span class="s2">&quot;DH_North&quot;</span><span class="p">,</span>	<span class="s2">&quot;DH_RH&quot;</span><span class="p">,</span>	<span class="s2">&quot;Mask&quot;</span><span class="p">]</span>
        
        <span class="n">wsamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="c1"># print(wgeo)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s1">&#39;DH_From&#39;</span><span class="p">,</span> <span class="n">wsamp</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s1">&#39;DH_To&#39;</span><span class="p">,</span> <span class="n">wsamp</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;Sample&quot;</span><span class="p">,</span><span class="n">wsamp</span><span class="p">[:,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">dhsampseudorock</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">wsamp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        
        <span class="c1">###### FIND AGSO MODULE (AGSO_STCODES) #######</span>
        <span class="c1">#Try to check the name of sample and their acronym</span>
        
        <span class="k">if</span> <span class="n">path_to_agso_codefile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">path_to_agso_codefile</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span> <span class="p">[</span><span class="s1">&#39;pyCSAMT&#39;</span><span class="p">],</span>
                                                <span class="s1">&#39;geodrill&#39;</span><span class="p">,</span><span class="s1">&#39;_geocodes&#39;</span> <span class="p">)</span>
       
            <span class="n">agsofilename</span><span class="o">=</span><span class="p">[</span><span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path_to_agso_codefile</span><span class="p">)</span> 
                          <span class="k">if</span> <span class="n">file</span> <span class="o">==</span><span class="s1">&#39;AGSO_STCODES.csv&#39;</span> <span class="p">]</span>
            <span class="k">if</span> <span class="n">agsofilename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">sampelm</span><span class="o">=</span><span class="n">Agso</span><span class="o">.</span><span class="n">_agso_on_dict_</span><span class="p">(</span><span class="n">set_agsoDataFrame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                            <span class="n">return_orientation</span><span class="o">=</span><span class="s2">&quot;series&quot;</span><span class="p">,</span> 
                            <span class="n">agso_codefile</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                                <span class="n">path_to_agso_codefile</span><span class="p">,</span>
                                <span class="n">agsofilename</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">agsofilename</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s1">&#39;None AGSO_STCODES.csv file is found. Please provide the right path &#39;</span>
                                      <span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;None AGSO_STCODES.csv file is found. Please provide the right path &#39;</span><span class="p">)</span>
                                      
        <span class="k">elif</span> <span class="n">path_to_agso_codefile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="c1">#os.chdir(os.path.dirname(path_to_agso_codefile))</span>
            <span class="n">sampelm</span><span class="o">=</span><span class="n">Agso</span><span class="o">.</span><span class="n">_agso_on_dict_</span><span class="p">(</span><span class="n">set_agsoDataFrame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                        <span class="n">return_orientation</span><span class="o">=</span><span class="s2">&quot;series&quot;</span><span class="p">,</span> 
                            <span class="n">agso_codefile</span><span class="o">=</span><span class="n">path_to_agso_codefile</span><span class="p">)</span>
        
            <span class="c1"># #extrcat elem with their acronym </span>
        <span class="n">sampelmDico_AGSO</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span> <span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> \
                         <span class="nb">zip</span> <span class="p">(</span><span class="n">sampelm</span><span class="p">[</span><span class="s2">&quot;CODE&quot;</span><span class="p">],</span><span class="n">sampelm</span><span class="p">[</span><span class="s1">&#39;__DESCRIPTION&#39;</span><span class="p">])}</span>
        <span class="c1"># elemgeo_AGSO=sorted(geolemDico.items())</span>

        
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">elm</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;Sample&#39;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">elm</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">sampelmDico_AGSO</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">pass</span> 
            <span class="k">elif</span> <span class="n">elm</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sampelmDico_AGSO</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">elm</span> <span class="ow">in</span> <span class="n">sampelmDico_AGSO</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">sampelmDico_AGSO</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">elm</span>  <span class="o">==</span> <span class="n">values</span> <span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;Sample&#39;</span><span class="p">][</span><span class="n">ii</span><span class="p">]</span><span class="o">=</span><span class="n">key</span>
                <span class="k">else</span>  <span class="p">:</span>
                    <span class="n">mess</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;The Sample Name(</span><span class="si">{0}</span><span class="s1">) given in is wrong&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elm</span><span class="p">),</span>
                                <span class="s1">&#39;Please provide a right name the right Name.&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;Please consult the AGSO_STCODES.csvfile in _geocodes folder&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;without changing anything.&#39;</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>

        <span class="c1">######END AGS0_STCODES ########</span>
        
        <span class="n">dh_sampeast</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">wsamp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">dh_sampnorths</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">wsamp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        
        <span class="k">for</span> <span class="n">ss</span> <span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dh_sampeast</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">indix</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_East&quot;</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">wsamp</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][</span><span class="n">ss</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_Hole&quot;</span><span class="p">]:</span>
                    <span class="n">value</span><span class="o">=</span><span class="n">val</span>
                    <span class="n">dh_sampeast</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span> <span class="o">=</span><span class="n">value</span>
                    <span class="n">dh_sampnorths</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_North&quot;</span><span class="p">][</span><span class="n">indix</span><span class="p">]</span>
                    
        <span class="n">dhsampseudorock</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">wsamp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">dh_sampmask</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">dh_sampmask</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">masksamp</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">wsamp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">dh_sampmask</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U12&#39;</span><span class="p">)</span>
        <span class="n">dhrhsamp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_From&#39;</span><span class="p">]])</span>
        <span class="n">dhSample</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">wsamp</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">wsamp</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_From&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_From&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_To&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_To&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="n">dhsampseudorock</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">dhsampseudorock</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;Sample&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;Sample&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="n">dh_sampeast</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">dh_sampeast</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="n">dh_sampnorths</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">dh_sampnorths</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="n">dhrhsamp</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">dhrhsamp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                              <span class="n">masksamp</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">masksamp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampleDHDATA</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dhSample</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">sampKeys</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampleDHDATA</span></div>
    
<div class="viewcode-block" id="Drill.dhSurveyElevAz"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Drill.dhSurveyElevAz">[docs]</a>    <span class="k">def</span> <span class="nf">dhSurveyElevAz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add_elevation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_azimuth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to build Elevation &amp; Azimuth DH logs. if add_elevation and add_azimuth are set . </span>
<span class="sd">        The programm will ignore the computated azimuth, and it will replace to the new azimuth </span>
<span class="sd">        provided . all elevation will be ignore and set by the new elevation . *kwargs arguments </span>
<span class="sd">        {add_elevation , add-azimuth }  must match the same size like the number of Drillholes . </span>
<span class="sd">        each one must be on ndarray(num_of_holes, 1). </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            add_elevation : np.nadarray , optional</span>
<span class="sd">                elevation data (num_of_holes, 1) . The default is None.</span>
<span class="sd">            add_azimuth : np.ndarray , optional</span>
<span class="sd">                azimuth data (num_of_holes,1). The default is None.</span>
<span class="sd">                </span>
<span class="sd">            **kwargs :</span>
<span class="sd">                DH_RL :np.float [np.ndarray(num_of_hole,1)],</span>
<span class="sd">                    if not provided , it&#39;s set to 0. means No topography is added&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            pd.Dataframe </span>
<span class="sd">                Elevation DH log .</span>
<span class="sd">            pd.DataFrame </span>
<span class="sd">                Azimuth DH log.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="n">dh_rl</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;DH_RL&quot;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        
        <span class="n">sizep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_East&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">add_elevation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="c1">#No topography is added , set to 0 </span>
                <span class="n">add_elevation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_EAST&#39;</span><span class="p">]),</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U12&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">add_elevation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">add_elevation</span> <span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="p">:</span>
                    <span class="n">add_elevation</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">add_elevation</span><span class="p">)</span>
                <span class="k">assert</span> <span class="n">add_elevation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_EAST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;INDEXERROR:&quot;</span>\
                    <span class="s2">&quot; The the current dimention of Elevation data is </span><span class="si">{0}</span><span class="s2">.It&#39;s must be&quot;</span>\
                        <span class="s2">&quot; the size </span><span class="si">{1}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">add_elevation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_EAST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;Elevation&quot;</span><span class="p">,</span> <span class="n">add_elevation</span><span class="p">)</span>
                    
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
            
            <span class="k">if</span> <span class="n">add_elevation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">add_elevation</span> <span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="p">:</span>
                    <span class="n">add_elevation</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">add_elevation</span><span class="p">)</span>
                <span class="k">try</span> <span class="p">:</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">add_elevation</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_East&#39;</span><span class="p">]))</span>
                <span class="k">except</span> <span class="p">:</span>
                    <span class="n">mess</span><span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;SIZEERROR! Try to set the elevation dimentional. &#39;</span><span class="p">,</span> 
                                   <span class="s1">&#39;same like the collar data &#39;</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">add_elevation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">add_elevation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span> <span class="p">[</span><span class="mi">1</span><span class="p">][:,</span><span class="mi">4</span><span class="p">]</span>
        
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;Elevation&quot;</span><span class="p">,</span> <span class="n">add_elevation</span><span class="p">)</span>
            
        <span class="c1">#set DH_RL</span>
        <span class="k">if</span> <span class="n">dh_rl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="nb">type</span> <span class="p">(</span><span class="n">dh_rl</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="p">:</span> 
                <span class="n">dh_rl</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="p">(</span><span class="n">dh_rl</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">dh_rl</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot; DH_RL data size is out&quot;</span>\
                <span class="s2">&quot; of the range.Must be </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;DH_RL&quot;</span><span class="p">,</span><span class="n">dh_rl</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="n">dh_rl</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="c1">#if None set DH_RL to None :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;DH_RL&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="mi">0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U12&#39;</span><span class="p">))</span>
        
        <span class="c1">#set azimuth </span>
        <span class="k">if</span> <span class="n">add_azimuth</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">add_azimuth</span><span class="p">)</span> <span class="o">==</span><span class="nb">list</span> <span class="p">:</span> 
                <span class="n">add_azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">add_azimuth</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">add_azimuth</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot; Azimuth data size is out&quot;</span>\
                <span class="s2">&quot; of the range.Must be </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;DH_Azimuth&quot;</span><span class="p">,</span><span class="n">add_azimuth</span><span class="p">)</span> 
            
        <span class="k">elif</span> <span class="n">add_azimuth</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">pass</span> 
                
        <span class="n">elevazKeys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DH_Hole&#39;</span><span class="p">,</span> <span class="s1">&#39;Depth&#39;</span><span class="p">,</span><span class="s1">&#39;DH_East&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;DH_North&#39;</span><span class="p">,</span><span class="s1">&#39;Elevation&#39;</span><span class="p">,</span><span class="s1">&#39;DH_RL&#39;</span><span class="p">,</span><span class="s1">&#39;DH_Dip&#39;</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;DH_RL&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="mi">0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U12&#39;</span><span class="p">))</span>
        <span class="c1"># add Hole and Depth </span>
        
        <span class="n">surveyELEV</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_Hole&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_Hole&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_Bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_Bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))),</span>
                                       <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">surveyAZIM</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_Hole&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s1">&#39;DH_Hole&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_Bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="p">[</span><span class="s2">&quot;DH_Bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))),</span>
                                      <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">ss</span> <span class="p">,</span> <span class="n">elm</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="n">elevazKeys</span><span class="p">[</span><span class="mi">2</span><span class="p">:]):</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">elm</span><span class="o">==</span><span class="n">key</span> <span class="p">:</span>
                    <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">elm</span> <span class="o">==</span><span class="s1">&#39;DH_RL&#39;</span><span class="ow">or</span> <span class="n">elm</span><span class="o">==</span><span class="s1">&#39;DH_Dip&#39;</span><span class="p">:</span>
                        <span class="c1"># print(values)</span>
                        <span class="n">surveyAZIM</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">surveyAZIM</span><span class="p">,</span><span class="n">values</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">elif</span>  <span class="n">elm</span><span class="o">==</span><span class="s1">&#39;Elevation&#39;</span><span class="p">:</span>
                        <span class="n">surveyELEV</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">surveyELEV</span><span class="p">,</span><span class="n">values</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">surveyAZIM</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">surveyAZIM</span><span class="p">,</span><span class="n">values</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">ss</span> <span class="o">&lt;</span> <span class="n">elevazKeys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Elevation&#39;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> 
                            <span class="n">surveyELEV</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">surveyELEV</span><span class="p">,</span><span class="n">values</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                            
        
        <span class="bp">self</span><span class="o">.</span><span class="n">surveyDHELEV</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveyELEV</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">elevazKeys</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
        <span class="c1"># pop the elevation elm on the list </span>
        <span class="p">[</span><span class="n">elevazKeys</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">elm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">elevazKeys</span><span class="p">)</span> <span class="k">if</span> <span class="n">elm</span><span class="o">==</span><span class="s1">&#39;Elevation&#39;</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">surveyDHAZIM</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">surveyAZIM</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">elevazKeys</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surveyDHELEV</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surveyDHAZIM</span><span class="p">)</span></div>
        
                    
<div class="viewcode-block" id="Drill.writeDHData"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.Drill.writeDHData">[docs]</a>    <span class="k">def</span> <span class="nf">writeDHData</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data2write</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        
        <span class="sd">&quot;&quot;&quot; Method to write allDH logs. It depends to the users to sort which data </span>
<span class="sd">        want to export and which format. the program support only two format (.xlsx and .csv)</span>
<span class="sd">        if one is set , it will ouptput the convenience format. Users can give a list of </span>
<span class="sd">        the name of log he want to export. Program is dynamic and flexible. It tolerates quite </span>
<span class="sd">        symbols number to extract data logs. </span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            data2write : str or list , optional</span>
<span class="sd">                the search key. The default is None.</span>
<span class="sd">    </span>
<span class="sd">            datafn :str</span>
<span class="sd">                savepath to exported file </span>
<span class="sd">                *Default is current work directory.</span>
<span class="sd">            write_index_on_sheet : bool, </span>
<span class="sd">                choice to write the sheet with pandas.Dataframe index. </span>
<span class="sd">            writeType : str , </span>
<span class="sd">                file type . its may *.csv or *.xlsx .Default is *.xlsx</span>
<span class="sd">            encoding :str , </span>
<span class="sd">                default is utf8</span>
<span class="sd">            add_header : bool, </span>
<span class="sd">                add head on exported sheet. set False to mask heads. Default is True. </span>
<span class="sd">            csv_separateType : str , </span>
<span class="sd">                Indicated for csv exported files , </span>
<span class="sd">                the type of comma delimited . defaut is &#39;,&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            exported sheet . &quot;&quot;&quot;</span>

        
        
        <span class="n">writepath</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;savepath&quot;</span><span class="p">,</span><span class="kc">None</span> <span class="p">)</span>
        <span class="n">writeIndex</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;write_index_on_sheet&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">writeType</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;writeType&#39;</span><span class="p">,</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">)</span>
        <span class="n">csvencoding</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;encoding&#39;</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">csvsetHeader</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;add_header&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">csvsep</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;csv_separateType&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        
        
        <span class="n">wDATA</span> <span class="o">=</span><span class="p">{</span><span class="s2">&quot;collar&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collar</span><span class="p">,</span>
                 <span class="s2">&quot;geology&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dhGeology</span><span class="p">,</span>
                 <span class="s1">&#39;sample&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">dhSample</span><span class="p">,</span>
                 <span class="s1">&#39;elevazim&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">dhSurveyElevAz</span><span class="p">}</span>
        
        <span class="n">_all</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s2">&quot;all&quot;</span><span class="p">,</span><span class="s2">&quot;__all__&quot;</span><span class="p">,</span><span class="s1">&#39;CollGeoSampElevAz&#39;</span><span class="p">,</span><span class="s1">&#39;CGSAZ&#39;</span><span class="p">,</span><span class="s1">&#39;cgsaz&#39;</span><span class="p">,</span>
              <span class="p">[</span><span class="s1">&#39;Collar&#39;</span><span class="p">,</span><span class="s1">&#39;Geology&#39;</span><span class="p">,</span><span class="s1">&#39;Sample&#39;</span><span class="p">,</span><span class="s1">&#39;Elevation&#39;</span><span class="p">,</span><span class="s1">&#39;Azimuth&#39;</span><span class="p">],</span>
              <span class="s1">&#39;colgeosamelevaz&#39;</span><span class="p">,</span><span class="s1">&#39;alldata&#39;</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">]</span>
        
        <span class="n">df_collar</span><span class="o">=</span><span class="n">wDATA</span><span class="p">[</span><span class="s1">&#39;collar&#39;</span><span class="p">]()</span>
        <span class="n">df_geology</span><span class="o">=</span><span class="n">wDATA</span><span class="p">[</span><span class="s1">&#39;geology&#39;</span><span class="p">]()</span>
        <span class="n">df_sample</span><span class="o">=</span><span class="n">wDATA</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">]()</span>
        <span class="n">df_elevation</span><span class="p">,</span><span class="n">df_azimuth</span><span class="o">=</span><span class="n">wDATA</span><span class="p">[</span><span class="s1">&#39;elevazim&#39;</span><span class="p">]()</span>
        
        <span class="c1"># for df_ in  [df_collar, df_geology, df_sample, df_elevation,df_azimuth]: </span>
        <span class="c1">#         df_.set_index(setIndex) # this is unnecessary </span>
        
        <span class="n">_dHDico</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;collar&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">df_collar</span><span class="p">],</span>
                 <span class="s1">&#39;geology&#39;</span><span class="p">:[[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">],</span><span class="n">df_geology</span><span class="p">],</span>
                 <span class="s1">&#39;sample&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">],</span><span class="n">df_sample</span><span class="p">],</span>
                 <span class="s1">&#39;survey_elevation&#39;</span><span class="p">:[[</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;elev&#39;</span><span class="p">,</span> <span class="s1">&#39;topo&#39;</span><span class="p">,</span><span class="s1">&#39;topography&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="n">df_elevation</span><span class="p">],</span>
                 <span class="s1">&#39;survey_azimuth&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;-1&#39;</span><span class="p">,</span><span class="s1">&#39;azim&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],</span><span class="n">df_azimuth</span><span class="p">]}</span>
        
            
        <span class="k">if</span> <span class="n">data2write</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">data2write</span> <span class="ow">in</span> <span class="n">_all</span> <span class="p">:</span>  <span class="c1"># write all </span>

            <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">]))</span> <span class="k">as</span> <span class="n">writer</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">df_</span> <span class="ow">in</span> <span class="n">_dHDico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">df_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span><span class="n">writeIndex</span><span class="p">)</span>

                                
        <span class="k">elif</span> <span class="n">data2write</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data2write</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">data2write</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">data2write</span><span class="p">)</span>
                
                <span class="k">try</span> <span class="p">:</span>

                    <span class="k">if</span> <span class="n">writeType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span> <span class="s1">&#39;excell&#39;</span><span class="p">,</span><span class="s1">&#39;Excell&#39;</span><span class="p">,</span><span class="s1">&#39;excel&#39;</span><span class="p">,</span><span class="s1">&#39;Excel&#39;</span><span class="p">,</span><span class="s1">&#39;*.xlsx&#39;</span><span class="p">]:</span>
                        <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">_dHDico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">data2write</span> <span class="o">==</span><span class="n">keys</span> <span class="ow">or</span> <span class="n">data2write</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">keys</span> <span class="ow">or</span>  <span class="n">data2write</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                              <span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;xlsx&#39;</span><span class="p">]),</span><span class="n">sheet_name</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span><span class="n">writeIndex</span><span class="p">)</span>  

                        
                    <span class="k">elif</span> <span class="n">writeType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;comma delimited&#39;</span><span class="p">,</span><span class="s1">&#39;*.csv&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;comma-separated-value&#39;</span><span class="p">,</span><span class="s1">&#39;comma seperated value&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;comsepval&#39;</span><span class="p">]:</span>
                        <span class="c1"># print(&#39;passed&#39;)</span>
                        <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">df_</span> <span class="ow">in</span> <span class="n">_dHDico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">data2write</span> <span class="o">==</span> <span class="n">keys</span> <span class="ow">or</span> <span class="n">data2write</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">keys</span> <span class="ow">or</span> <span class="n">data2write</span> <span class="ow">in</span> <span class="n">df_</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                              <span class="n">df_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.csv&#39;</span><span class="p">]),</span> <span class="n">header</span><span class="o">=</span><span class="n">csvsetHeader</span><span class="p">,</span>
                                    <span class="n">index</span> <span class="o">=</span><span class="n">writeIndex</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="n">csvsep</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">csvencoding</span><span class="p">)</span>  

                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span> <span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span> <span class="p">(</span><span class="s1">&#39;The type you provide as WriteType argument is wrong.&#39;</span>\
                                          <span class="s1">&#39; Support only *.xlsx and *.csv format&#39;</span><span class="p">,</span><span class="n">error</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Argument writeType support only [xlsx or csv] format.&#39;</span>\
                                    <span class="s1">&#39; Must change your *.</span><span class="si">{0}</span><span class="s1"> format&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">writeType</span><span class="p">))</span>

                
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data2write</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="p">:</span>
                <span class="n">data2write</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">elm</span><span class="p">)</span> <span class="k">for</span> <span class="n">elm</span> <span class="ow">in</span> <span class="n">data2write</span><span class="p">]</span> <span class="c1"># check the string format</span>
                <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">]))</span> <span class="k">as</span> <span class="n">writer</span> <span class="p">:</span>
                    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="n">data2write</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">df__</span> <span class="ow">in</span> <span class="n">_dHDico</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">keys</span> <span class="ow">or</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> 
                                <span class="n">df__</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span><span class="n">writeIndex</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span> <span class="p">(</span><span class="s1">&#39;The key you provide  as agrument of data2write is wrong. &#39;</span>\
                                     <span class="s1">&#39;the data2write argument should be either [collar, geology,&#39;</span>\
                                         <span class="s1">&#39; sample, elevation, azimuth] or all (*). &#39;</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Wrong format of input data2write ! Argument dataType is str,&#39;</span>\
                               <span class="s1">&#39; or list of string element choosen among [collar, geology,&#39;</span>\
                                   <span class="s1">&#39;sample, elevation, azimuth] or all (*), not </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data2write</span><span class="p">))</span>
        
         <span class="c1"># export to savepath </span>
        <span class="k">if</span> <span class="n">writepath</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="c1"># create a folder in your current work directory</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="n">writepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;_outputDH_&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">writepath</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">writepath</span><span class="p">)</span><span class="c1">#  mode =0o666)</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It seems the path already exists !&quot;</span><span class="p">)</span>
        
        
        <span class="k">if</span> <span class="n">writepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="p">:</span>
            <span class="kn">import</span> <span class="nn">shutil</span>
            
            <span class="k">if</span> <span class="n">writeType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;comma delimited&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;comma-separated-value&#39;</span><span class="p">,</span><span class="s1">&#39;comma sperated value&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;comsepval&#39;</span><span class="p">]:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">move</span> <span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>
                                           <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;csv&#39;</span><span class="p">])),</span><span class="n">writepath</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Borehole output &lt;</span><span class="si">{0}</span><span class="s1">&gt; has been written to </span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span>\
                      <span class="nb">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span>
                    <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.csv&#39;</span><span class="p">])),</span> <span class="n">writepath</span><span class="p">))</span>
                
            <span class="k">elif</span> <span class="n">writeType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span> <span class="s1">&#39;excell&#39;</span><span class="p">,</span><span class="s1">&#39;Excell&#39;</span><span class="p">,</span><span class="s1">&#39;excel&#39;</span><span class="p">,</span><span class="s1">&#39;Excel&#39;</span><span class="p">]:</span>
                
                <span class="n">shutil</span><span class="o">.</span><span class="n">move</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;xlsx&#39;</span><span class="p">]),</span><span class="n">writepath</span><span class="p">)</span>
                
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Borehole output &lt;</span><span class="si">{0}</span><span class="s1">&gt; has been written to </span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span>\
                      <span class="nb">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span>
                      <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">daTA</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">])),</span> <span class="n">writepath</span><span class="p">))</span></div></div>
                
<span class="c1">#------Usefull functions --------------------------</span>
<div class="viewcode-block" id="get_closest_value"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.get_closest_value">[docs]</a><span class="k">def</span> <span class="nf">get_closest_value</span> <span class="p">(</span><span class="n">values_range</span><span class="p">,</span> <span class="n">input_value</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fonction  to get closest values when input values is not in the values range</span>
<span class="sd">    we assume that values are single on array. if the same value is repeated </span>
<span class="sd">    will take the first index and the value at that index </span>
<span class="sd">    </span>
<span class="sd">    params: </span>
<span class="sd">        values_range : array_like </span>
<span class="sd">                        values to get </span>
<span class="sd">        input_value :float</span>
<span class="sd">                        specific value </span>
<span class="sd">        </span>
<span class="sd">        return the closest value and its index</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">values_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values_range</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">values_range</span> <span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="c1"># if all element less than zero than convert </span>
                                    <span class="c1">#inoput value to negative value </span>
        <span class="k">if</span> <span class="n">input_value</span> <span class="o">&gt;</span><span class="mi">0</span> <span class="p">:</span> <span class="n">input_value</span> <span class="o">*=-</span><span class="mi">1</span>  <span class="c1"># for depth select purpose </span>
        
    <span class="k">if</span> <span class="n">input_value</span> <span class="o">&lt;</span> <span class="n">values_range</span><span class="o">.</span><span class="n">min</span><span class="p">():</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt; ! Input value =</span><span class="si">{0}</span><span class="s1"> is out  the range, min value = </span><span class="si">{1}</span><span class="s1">. Value&#39;</span>\
              <span class="s1">&#39; should be reset to =</span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input_value</span><span class="p">,</span> <span class="n">values_range</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
        
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Input value =</span><span class="si">{0}</span><span class="s1"> is out  the range ! min value = </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span>\
                      <span class="nb">format</span><span class="p">(</span><span class="n">input_value</span><span class="p">,</span> <span class="n">values_range</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
        <span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Input value =</span><span class="si">{0}</span><span class="s1"> is out  the range ! min value = </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span>\
                      <span class="nb">format</span><span class="p">(</span><span class="n">input_value</span><span class="p">,</span> <span class="n">values_range</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>  
            
        <span class="n">input_value</span> <span class="o">=</span> <span class="n">values_range</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">input_value</span> <span class="o">&gt;</span> <span class="n">values_range</span><span class="o">.</span><span class="n">max</span><span class="p">():</span> 
        
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Input value =</span><span class="si">{0}</span><span class="s1"> is out  the range ! max value = </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span>\
                      <span class="nb">format</span><span class="p">(</span><span class="n">input_value</span><span class="p">,</span> <span class="n">values_range</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
        <span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Input value =</span><span class="si">{0}</span><span class="s1"> is out  the range ! max value = </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span>\
                      <span class="nb">format</span><span class="p">(</span><span class="n">input_value</span><span class="p">,</span> <span class="n">values_range</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
            
        <span class="n">input_value</span> <span class="o">=</span> <span class="n">values_range</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!--&gt; Input value =</span><span class="si">{0}</span><span class="s1"> is out  the range , min value = </span><span class="si">{1}</span><span class="s1">. Value&#39;</span>\
              <span class="s1">&#39; should be reset to =</span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input_value</span><span class="p">,</span> <span class="n">values_range</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
        
    <span class="k">if</span> <span class="n">input_value</span> <span class="ow">in</span> <span class="n">values_range</span> <span class="p">:</span> 
        <span class="n">indexes</span><span class="p">,</span><span class="o">*</span><span class="n">_</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">values_range</span><span class="o">==</span><span class="n">input_value</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span> 
            <span class="n">index</span> <span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">indexes</span> <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">:</span> <span class="c1"># mean element is repeated then take the first index</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">indexes</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            
        <span class="n">value</span> <span class="o">=</span> <span class="n">values_range</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">value</span> <span class="p">,</span> <span class="n">index</span> 
    
    <span class="k">elif</span> <span class="n">values_range</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">input_value</span> <span class="o">&lt;</span> <span class="n">values_range</span><span class="o">.</span><span class="n">max</span><span class="p">():</span> 
        <span class="c1"># values_range = sorted(values_range)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">xx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values_range</span><span class="p">):</span> 
            <span class="k">if</span> <span class="n">xx</span> <span class="o">&gt;</span> <span class="n">input_value</span> <span class="p">:</span> 
                <span class="c1">#compute distance : </span>
                <span class="n">d0</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">input_value</span><span class="o">-</span><span class="n">xx</span><span class="p">)</span> <span class="c1"># make the diffence between distances </span>
                <span class="n">d1</span><span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">values_range</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">input_value</span><span class="p">)</span> <span class="c1"># nad take the short</span>
                <span class="k">if</span> <span class="n">d0</span> <span class="o">&lt;</span> <span class="n">d1</span> <span class="p">:</span> 
                    <span class="k">return</span>  <span class="n">xx</span> <span class="p">,</span> <span class="n">ii</span>
                <span class="k">elif</span> <span class="n">d0</span><span class="o">&gt;</span> <span class="n">d1</span> <span class="p">:</span> 
                    <span class="k">return</span>   <span class="n">values_range</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ii</span><span class="o">-</span><span class="mi">1</span></div>
                

 
<div class="viewcode-block" id="ascertain_layers_with_its_resistivities"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.ascertain_layers_with_its_resistivities">[docs]</a><span class="k">def</span> <span class="nf">ascertain_layers_with_its_resistivities</span><span class="p">(</span><span class="n">real_layer_names</span> <span class="p">,</span> 
                                            <span class="n">real_layer_resistivities</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assert the length of of real resistivites with their corresponding layers.</span>
<span class="sd">    If length of resistivities of larger that the layer&#39;s names, then will add</span>
<span class="sd">     layer that match the best the remained resistivities. If the length </span>
<span class="sd">   of layer is larger than resistivities , to avoid miscomputation , will</span>
<span class="sd">   cut out this more layer and work only the length of resistivities provided.</span>
<span class="sd">    </span>
<span class="sd">    params : </span>
<span class="sd">        real_layer_names: array_like |list : list of input layer names as real </span>
<span class="sd">        layers names encountered in area </span>
<span class="sd">        real_layer_resistivities :array_like|list  : </span>
<span class="sd">            list of resistivities get on survey area </span>
<span class="sd">    return : </span>
<span class="sd">        real_layer_names: list :</span>
<span class="sd">                        new list of input layers </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># for consistency put on string if user provide a digit</span>
    <span class="n">real_layer_names</span> <span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ly</span><span class="p">)</span> <span class="k">for</span> <span class="n">ly</span> <span class="ow">in</span> <span class="n">real_layer_names</span><span class="p">]</span>      
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_layer_resistivities</span><span class="p">)</span> <span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">real_layer_names</span><span class="p">):</span> 
        <span class="k">return</span> <span class="n">real_layer_names</span>
    
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_layer_resistivities</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_layer_names</span><span class="p">):</span> 
         <span class="c1"># get the last value of resistivities  to find the structres names ans structures sresistivities </span>
        <span class="n">sec_res</span> <span class="o">=</span> <span class="n">real_layer_resistivities</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">real_layer_names</span><span class="p">):]</span>        
       
        <span class="n">geos</span> <span class="o">=</span><span class="n">Geodrill</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">resistivities_range</span><span class="o">=</span><span class="n">sec_res</span><span class="p">)</span> <span class="c1"># get the name of structure as possible </span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">geos</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">:</span> <span class="n">tm</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
        <span class="k">else</span> <span class="p">:</span><span class="n">tm</span> <span class="o">=</span><span class="s1">&#39;&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; !We added other </span><span class="si">{0}</span><span class="s1"> geological struture</span><span class="si">{1}</span><span class="s1">.&#39;</span>\
              <span class="s1">&#39; You may ignore it.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">geos</span><span class="p">),</span> <span class="n">tm</span><span class="p">))</span>
        <span class="n">real_layer_names</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">geos</span><span class="p">)</span>                       <span class="c1"># then , extend the list </span>
        <span class="k">return</span> <span class="n">real_layer_names</span> 
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_layer_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_layer_resistivities</span><span class="p">):</span> 
        <span class="n">real_layer_names</span> <span class="o">=</span> <span class="n">real_layer_names</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">real_layer_resistivities</span><span class="p">)]</span>        <span class="c1"># truncated the list </span>
        <span class="k">return</span> <span class="n">real_layer_names</span></div>

<div class="viewcode-block" id="geo_length_checker"><a class="viewcode-back" href="../../../geocore.html#geodrill.geoCore.geodrill.geo_length_checker">[docs]</a><span class="k">def</span> <span class="nf">geo_length_checker</span><span class="p">(</span><span class="n">main_param</span><span class="p">,</span> <span class="n">optional_param</span><span class="p">,</span> <span class="n">force</span> <span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                <span class="n">param_names</span> <span class="o">=</span><span class="p">(</span><span class="s1">&#39;input_resistivities&#39;</span><span class="p">,</span> <span class="s1">&#39;input_layers&#39;</span><span class="p">),</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Geo checker is a function to check differents length of different params </span>
<span class="sd">    .the length of optional params  depend of the length of main params . if</span>
<span class="sd">    the length of optional params is larger than the length of main </span>
<span class="sd">    params, the length of optional params will be reduce to the length of main params .</span>
<span class="sd">    if the optional params  length is shorther than the length of</span>
<span class="sd">    main params, will filled it either with &quot;None&quot; if dtype param is string</span>
<span class="sd">    of 0.if dtype params is float or 0 if integer.if Force  is set True , </span>
<span class="sd">    it will absolutely check if the main params and the optional params have</span>
<span class="sd">    the same length. if not the case ,   will generate an error occurs.</span>
<span class="sd">  </span>
<span class="sd">    params : main_param : array |list </span>
<span class="sd">                        main parameter that must took </span>
<span class="sd">                        its length as reference length </span>
<span class="sd">            optional params : array|list </span>
<span class="sd">                                optional params , whom length depend </span>
<span class="sd">                                to the length of main params </span>
<span class="sd">            param_names : tuple(of str) </span>
<span class="sd">                        names of main params and optional params </span>
<span class="sd">                        so to generate error if exits.</span>
<span class="sd">            fill_value: str |float , optional  </span>
<span class="sd">                        Default value to fill thearray in the case where </span>
<span class="sd">                    the length of optional param is </span>
<span class="sd">                            less than the length of the  main param .If None ,</span>
<span class="sd">                            will fill according to array dtype</span>
<span class="sd">    return : </span>
<span class="sd">        optional params :array : optional param truncated according to the man params </span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">add_v</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fill_value&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">main_param</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
        <span class="n">main_param</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">main_param</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">optional_param</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
       <span class="n">optional_param</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">optional_param</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">main_param</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">main_param</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">main_param</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">optional_param</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">optional_param</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">optional_param</span><span class="p">)</span>
            

    <span class="n">mes</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">optional_param</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_param</span><span class="p">):</span> 
        <span class="n">mes</span> <span class="o">=</span><span class="s2">&quot;---&gt; Note ! </span><span class="si">{0}</span><span class="s2"> will be truncated to length = </span><span class="si">{1}</span><span class="s2"> as the same length of </span><span class="si">{2}</span><span class="s2"> .&quot;</span><span class="o">.</span>\
            <span class="nb">format</span><span class="p">(</span><span class="n">param_names</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_param</span><span class="p">),</span><span class="n">param_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mes</span><span class="p">)</span>
        
        <span class="n">optional_param</span><span class="o">=</span> <span class="n">optional_param</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">main_param</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">force</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;--&gt; force argument  is set &lt;True&gt;, Can not truncate </span><span class="si">{0}</span><span class="s1">&#39;</span>\
                <span class="s1">&#39; = </span><span class="si">{1}</span><span class="s1"> to match the length of </span><span class="si">{2}</span><span class="s1"> = </span><span class="si">{3}</span><span class="s1">.&#39;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param_names</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">param_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">param_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_parameter_number</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">optional_param</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_param</span><span class="p">)</span> <span class="p">:</span> 
        <span class="k">if</span> <span class="n">force</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;--&gt; force argument  is set &lt;True&gt;, Can not fill value of </span><span class="si">{0}</span><span class="s1"> &#39;</span>\
                <span class="s1">&#39;to match the length of </span><span class="si">{1}</span><span class="s1"> = </span><span class="si">{2}</span><span class="s1">.&#39;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param_names</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">param_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_parameter_number</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">add_v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">add_v</span> <span class="o">=</span><span class="p">[</span><span class="n">add_v</span> <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_param</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">optional_param</span><span class="p">))]</span> <span class="c1"># repeat the value to add </span>
            <span class="n">add_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">add_v</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">add_v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
             <span class="k">if</span> <span class="n">optional_param</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]</span> <span class="p">:</span> 
                 <span class="n">add_v</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;None&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">main_param</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">optional_param</span><span class="p">))]</span>
                 
             <span class="k">else</span> <span class="p">:</span> 
                 <span class="k">for</span> <span class="n">type_param</span><span class="p">,</span> <span class="n">fill_value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">],[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">):</span> 
                     <span class="k">if</span>  <span class="n">type_param</span>  <span class="o">==</span> <span class="n">optional_param</span><span class="o">.</span><span class="n">dtype</span> <span class="p">:</span>
                         <span class="n">add_v</span> <span class="o">=</span><span class="p">[</span><span class="n">fill_value</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">main_param</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">optional_param</span><span class="p">))]</span>

        <span class="n">mes</span> <span class="o">=</span><span class="s2">&quot;--&gt; !Note Length of </span><span class="si">{0}</span><span class="s2"> is =</span><span class="si">{1}</span><span class="s2"> which  length of </span><span class="si">{2}</span><span class="s2"> is =</span><span class="si">{3}</span><span class="s2">.&#39;</span><span class="se">\</span>
<span class="s2">            We&#39;ll add </span><span class="si">{4}</span><span class="s2"> to fill </span><span class="si">{5}</span><span class="s2"> value.&quot;</span><span class="o">.</span>\
            <span class="nb">format</span><span class="p">(</span><span class="n">param_names</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">optional_param</span><span class="p">),</span> <span class="n">param_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                   <span class="nb">len</span><span class="p">(</span><span class="n">main_param</span><span class="p">),</span> <span class="n">add_v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">param_names</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mes</span><span class="p">)</span>
        <span class="n">optional_param</span><span class="o">=</span> <span class="n">optional_param</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">optional_param</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">add_v</span><span class="p">)</span>


    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">optional_param</span><span class="p">)</span></div>
    
                                                                                 


<span class="c1"># if __name__==&quot;__main__&quot; :</span>

<span class="c1">#     path = r&#39;F:/__main__csamt__\oasis data\OASISWORKS\all_data&#39;</span>
<span class="c1">#     geo_surface_obj = Geosurface( path =path )</span>
    
<span class="c1">#     geo_surface_obj.read_oasis_files()</span>
    <span class="c1"># print(geo_surface_obj.oasis_data)</span>
    <span class="c1"># DICO= geo_surface_obj.global_dico</span>
    
    <span class="c1"># TEST0 = geo_surface_obj.K1_cor_oas</span>
    

    <span class="c1"># from scipy.signal import argrelextrema as extrema </span>
    
    <span class="c1"># maxi = extrema(geoDict[&#39;S07&#39;][:, 1], np.greater )</span>
    <span class="c1"># mini = extrema(geoDict[&#39;S07&#39;][:, 1], np.less )</span>
    <span class="c1"># print(geoDict2[&#39;S00&#39;][:,0])</span>
    


    
    
    
    
    

                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    


</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pyCSAMT v1.0.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Kouadio K. Laurent.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
    </div>
  </body>
</html>