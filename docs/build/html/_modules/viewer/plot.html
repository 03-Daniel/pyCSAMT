
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>viewer.plot &#8212; pyCSAMT v1.0.01 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pyCSAMT v1.0.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for viewer.plot</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">===============================================================================</span>
<span class="sd">    Copyright Â© 2021  Kouadio K.Laurent</span>
<span class="sd">    </span>
<span class="sd">    This file is part of pyCSAMT.</span>
<span class="sd">    </span>
<span class="sd">    pyCSAMT is free software: you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">    the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>
<span class="sd">    </span>
<span class="sd">    pyCSAMT is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU Lesser General Public License for more details.</span>
<span class="sd">    </span>
<span class="sd">    You should have received a copy of the GNU Lesser General Public License</span>
<span class="sd">    along with pyCSAMT.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>

<span class="sd">===============================================================================</span>
<span class="sd">    </span>
<span class="sd">    !From `viewer` subpackage. `plot` module is the visualization module of</span>
<span class="sd">    pyCSAMT software. All analyses , processings , corrections  are vusualized  </span>
<span class="sd">    thoughoutthis module. We decided this option so to avoid importing several time </span>
<span class="sd">    matplotlib and its properties into differents subpackages . Import Matplotlib </span>
<span class="sd">    packages into a special module allow a good visibility of scripts  and let </span>
<span class="sd">    the editor to easy customize the plots without knowning deeply the module </span>
<span class="sd">    itself.</span>
<span class="sd">    .</span>
<span class="sd">    . Plot module special plot 1d, 2d and 3D. </span>
<span class="sd">    </span>
<span class="sd">Created on Mon Dec 28 14:28:06 2020</span>

<span class="sd">@author: KLaurent alias @Daniel03</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span> <span class="o">,</span><span class="nn">re</span><span class="o">,</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span> 
<span class="kn">import</span>  <span class="nn">matplotlib.pyplot</span>  <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span> 
<span class="kn">import</span> <span class="nn">matplotlib.colorbar</span> <span class="k">as</span> <span class="nn">mplcb</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">NullLocator</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gspec</span>

<span class="kn">from</span> <span class="nn">csamtpy.ff.core.cs</span> <span class="kn">import</span> <span class="n">CSAMT</span>
<span class="kn">from</span> <span class="nn">csamtpy.ff.core.cs</span> <span class="kn">import</span> <span class="n">Profile</span>
<span class="kn">from</span> <span class="nn">csamtpy.modeling</span> <span class="kn">import</span> <span class="n">occam2d</span>

<span class="kn">from</span> <span class="nn">geodrill.geoCore</span> <span class="kn">import</span> <span class="n">geodrill</span>  <span class="k">as</span> <span class="n">geoD</span>
 

<span class="kn">from</span> <span class="nn">csamtpy.etc.infos</span> <span class="kn">import</span> <span class="n">suit</span> 

<span class="kn">from</span> <span class="nn">csamtpy.utils</span> <span class="kn">import</span> <span class="n">exceptions</span> <span class="k">as</span> <span class="n">CSex</span>
<span class="kn">from</span> <span class="nn">csamtpy.utils</span> <span class="kn">import</span> <span class="n">func_utils</span> <span class="k">as</span> <span class="n">func</span>
<span class="kn">from</span> <span class="nn">csamtpy.utils</span> <span class="kn">import</span> <span class="n">plot_utils</span> <span class="k">as</span> <span class="n">mplotus</span>  
<span class="kn">from</span> <span class="nn">csamtpy.utils._csamtpylog</span> <span class="kn">import</span> <span class="n">csamtpylog</span> 

<span class="kn">from</span> <span class="nn">csamtpy.ff.processing.corr</span> <span class="kn">import</span> <span class="n">shifting</span> <span class="k">as</span> <span class="n">Scor</span>
<span class="kn">from</span> <span class="nn">csamtpy.ff.processing</span> <span class="kn">import</span> <span class="n">zcalculator</span>  <span class="k">as</span> <span class="n">Zcc</span>
<span class="n">_logger</span><span class="o">=</span><span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="kn">from</span>  <span class="nn">windrose</span> <span class="kn">import</span>  <span class="n">WindroseAxes</span> 
    <span class="n">windrose_import</span> <span class="o">=</span><span class="kc">True</span> 
          
<span class="k">except</span> <span class="p">:</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Could not find windrose, cannot  plot Rose diagram.&#39;</span>
                  <span class="s1">&#39;Check installation you can get scipy from &#39;</span>
                  <span class="s1">&#39;https://github.com/python-windrose/windrose&#39;</span><span class="p">)</span>
    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Could not find `WindroseAxes`, cannot plot Rose Diagram&#39;</span>
                    <span class="s1">&#39;check installation you can get windrose &#39;</span>
                    <span class="s1">&#39;from http://windrose.readthedocs.io/&#39;</span><span class="p">)</span>
    
    <span class="n">windrose_import</span><span class="o">=</span><span class="kc">False</span> 


<span class="c1">###############################################################################</span>
 
<div class="viewcode-block" id="Plot1d"><a class="viewcode-back" href="../../viewer.html#viewer.plot.Plot1d">[docs]</a><span class="k">class</span> <span class="nc">Plot1d</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        plot 1d class : Deal with all 1D plots. </span>
<span class="sd">    </span>
<span class="sd">        =================== ===================================================</span>
<span class="sd">        Key Words           Description        </span>
<span class="sd">        =================== ===================================================</span>
<span class="sd">        fig_dpi             dots-per-inch resolution of the figure</span>
<span class="sd">                            *default* is 300</span>
<span class="sd">        fig_num             number of the figure instance</span>
<span class="sd">                            *default* is &#39;Mesh&#39;</span>
<span class="sd">        fig_size            size of figure in inches (width, height)</span>
<span class="sd">                            *default* is [5, 5]</span>
<span class="sd">        fs                  size of font of axis tick labels, axis labels are</span>
<span class="sd">                            fs+2. *default* is 6 </span>
<span class="sd">        ls                  [ &#39;-&#39; | &#39;.&#39; | &#39;:&#39; ] line style of mesh lines</span>
<span class="sd">                            *default* is &#39;-&#39;</span>
<span class="sd">        marker              marker of stations </span>
<span class="sd">                            *default* is r&quot;$\blacktriangledown$&quot;</span>
<span class="sd">        ms                  size of marker in points. *default* is 5</span>

<span class="sd">        =================== ===================================================</span>
<span class="sd">        =======================================================================</span>
<span class="sd">        plot_topo_sep_azim :        plot_topography , station separation and </span>
<span class="sd">                                    azimuth  profile can plot individually or </span>
<span class="sd">                                    grouped by.</span>
<span class="sd">        penetrated1D                skindepth plot. penetration depth at different</span>
<span class="sd">                                    frequencies </span>
<span class="sd">        plot_static_correction      plot rho and rho corrected by different filter</span>
<span class="sd">                                    defalut filter is TMA.</span>
<span class="sd">        plot_freqVSRhoPhase         Resistivity and phase plot. </span>
<span class="sd">        plot_curves                 plot data curves : specific for </span>
<span class="sd">                                    Zonge Engineering AVG file. </span>
<span class="sd">        plot_RhoPhase errors        plot errors bar of resistivities in ohm.m and </span>
<span class="sd">                                            phase in degree. </span>
<span class="sd">        =======================================================================</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span> <span class="o">=</span><span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_num&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_dpi&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_title</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xminorticks&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_minorticks</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;yminorticks&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_size&#39;</span><span class="p">,</span><span class="mf">3.</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_style&#39;</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">,</span> <span class="mf">6.</span><span class="p">)</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mstyle</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;maker_style&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ms</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mplfont</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span><span class="s1">&#39;cursive&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markefacecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markeredgecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ls</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lw</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lw&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span><span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="o">=</span><span class="kc">None</span> 
        
        <span class="c1"># self.elevation =None </span>
        <span class="c1"># self.station_pk =None </span>
        
    
<div class="viewcode-block" id="Plot1d.plot_topo_sep_azim"><a class="viewcode-back" href="../../viewer.html#viewer.plot.Plot1d.plot_topo_sep_azim">[docs]</a>    <span class="k">def</span> <span class="nf">plot_topo_sep_azim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fn</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">,</span> <span class="n">profile_fn</span><span class="o">=</span><span class="kc">None</span>  <span class="p">,</span> <span class="n">savefig</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to plot topographic , stations separation and azimuth profiles .</span>
<span class="sd">        User can add station_names and and set _it to let the program to plot on the corresponding </span>
<span class="sd">        figure. He can alse force the program to plot its dipole length otherwise the program will </span>
<span class="sd">        compute it automatically. If &quot;set_station_name&quot; is False , No Name of station will be visible.</span>
<span class="sd">        User has the possibility to plot one by one figure or all by using a &quot;*&quot;  symbol or 123. </span>
<span class="sd">        To polt one figure , it may use keyword argument &quot;plot&quot; following the king [&#39;topo&#39;,</span>
<span class="sd">        azimuth&#39;, &#39;sep&#39;] or integer 1|2|3.Method is flexible .User can customize the plot , marker and </span>
<span class="sd">        line as he wants by putting on list the matplotlib labels properties . The program</span>
<span class="sd">        uses the label properties on order to set configuration lines  and other properties .</span>
<span class="sd">        Topography plot correspond to index 0 , stations-separation to index 1 and azimuth to  </span>
<span class="sd">        index 2.To plot individually , User doesnt need to put properties on list. Programm will</span>
<span class="sd">        recognize and set the poperties provided according the figure He wants. </span>
<span class="sd">        </span>
<span class="sd">        params : fn : str : </span>
<span class="sd">                            full path to [EDI|J|AVG] file.</span>
<span class="sd">                profile_fn : str  </span>
<span class="sd">                            path to file : may Zonge Engineering *.stn  file .</span>
<span class="sd">                plot : str    </span>
<span class="sd">                            type of plot : default is &#39;*&#39; mean of three profile.</span>
<span class="sd">                Station_Names&#39;: list : </span>
<span class="sd">                            list of station names , User could provide. Default is None ;</span>
<span class="sd">                            compute automatically </span>

<span class="sd">                set_station_names : bool , </span>
<span class="sd">                             display the station name on figure axis . Default is False.</span>
<span class="sd">                elevation : (ndarray,1)</span>
<span class="sd">                            Array_like of elevation </span>
<span class="sd">                station_pk : array_like </span>
<span class="sd">                            array_like station dipole center value. </span>
<span class="sd">     </span>
<span class="sd">                savefig : str : path  to save figure. </span>
<span class="sd">                </span>
<span class="sd">                </span>
<span class="sd">        =================== ===================================================</span>
<span class="sd">        Key Words           Description        </span>
<span class="sd">        =================== ===================================================</span>
<span class="sd">        lw                  line width . *default* is 1.5</span>
<span class="sd">        ls                  [ &#39;-&#39; | &#39;.&#39; | &#39;:&#39; ] line style of lines</span>
<span class="sd">                            *default* is &quot;[&#39;-&#39;, &#39;:&#39;, &#39;-.&#39;]&quot; for 3 profiles.</span>
<span class="sd">        marker              marker of stations </span>
<span class="sd">                            *default* is &#39;o&#39;</span>
<span class="sd">        ms                  size of marker in points. *default* is 6</span>
<span class="sd">        color               color of line .*Default* is &#39;k&#39;</span>
<span class="sd">        alpha               Marker transparence .*Defaut* is .2 </span>
<span class="sd">        markerfacecolor     facecolor or markers .*Default*  is &#39;k&#39;</span>
<span class="sd">        markeredgecolor     eadgecolor of markers . default is &quot;[&#39;w&#39;,&#39;r&#39;, &#39;gray&#39;]&quot;</span>
<span class="sd">        xtick_label_rotation xtick rotation angle . default* is 45.</span>
<span class="sd">        ytick_label_rotation ytick rotatoion angle .default * is 45 </span>
<span class="sd">        xtick_labelsize      xtick label size .defalut* is 12.</span>
<span class="sd">        ytick_labelsize      ytick label size .defalut* is 12.</span>
<span class="sd">        </span>
<span class="sd">        =================== ===================================================</span>
<span class="sd">        </span>
<span class="sd">        e:g::     import os</span>
<span class="sd">                    &gt;&gt;&gt; file_stn=&#39;K6.stn&#39;</span>
<span class="sd">                    &gt;&gt;&gt; path =  os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">                                              &#39;csamtpy&#39;,&#39;data&#39;, file_stn)</span>
<span class="sd">                        </span>
<span class="sd">                    ...  plot_1d_obj= Plot1d()</span>
<span class="sd">                    .... plot_1d_obj.plot_topo_sep_azim(profile_fn= path , plot=&#39;*&#39;, </span>
<span class="sd">                                                        set_station_names=True,</span>
<span class="sd">                                                       dipole_length_curve=False)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Plotting Topography-Station_separations and Azimuth.&#39;</span><span class="p">)</span>
        
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">10</span>
        
        <span class="c1">#----------- set arguments ---------------------</span>
        <span class="n">plot_type</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">)</span>
        <span class="n">add_stnnames</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;station_names&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">set_stnnames</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;set_station_names&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="n">elevation_array</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;elevation&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
        <span class="n">station_pk</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;station_pk&#39;</span><span class="p">,</span> <span class="kc">None</span> <span class="p">)</span>
        <span class="n">azimuth_array</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;azimuth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">stn_separation_array</span> <span class="o">=</span><span class="p">(</span><span class="s1">&#39;stn_separation&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        
        <span class="n">DipoleLength</span> <span class="o">=</span><span class="kc">None</span> 

        <span class="c1">#----------set mpl properties ----------------- . </span>
        
        <span class="n">kws</span> <span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">share_props_for_each_plot</span><span class="p">(</span><span class="n">number_of_plot</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lw&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> 
                    <span class="n">ls</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">]),</span> 
                    <span class="n">alpha</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">),</span> 
                    <span class="n">color</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">),</span>
                    <span class="n">marker</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marker_style&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">),</span>
                    <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markerfacecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">),</span>
                    <span class="n">markeredgecolor</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markeredgecolor&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">]),</span>
                    <span class="n">xtick_label_rotation</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xtick_label_rotation&#39;</span><span class="p">,</span><span class="mf">45.</span><span class="p">),</span>
                    <span class="n">ytick_label_rotation</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ytick_label_rotation&#39;</span><span class="p">,</span><span class="mf">45.</span><span class="p">),</span>
                    <span class="n">xtick_label_size</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xtick_labelsize&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> 
                    <span class="n">ytick_label_size</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ytick_labelsize&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
                                          <span class="p">)</span>
        <span class="n">lw</span> <span class="p">,</span><span class="n">ls</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span><span class="n">kws</span><span class="p">[</span><span class="s1">&#39;lw&#39;</span><span class="p">],</span><span class="n">kws</span> <span class="p">[</span><span class="s1">&#39;ls&#39;</span><span class="p">],</span> <span class="n">kws</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span> <span class="n">kws</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span>
        
        <span class="n">x_ticklabel_rotation</span><span class="p">,</span> <span class="n">x_ticks_labelsize</span> <span class="p">,</span> <span class="n">y_ticks_labelsize</span> <span class="o">=</span> <span class="n">kws</span><span class="p">[</span><span class="s1">&#39;xtick_label_rotation&#39;</span><span class="p">],</span> \
                                                                      <span class="n">kws</span><span class="p">[</span><span class="s1">&#39;xtick_label_size&#39;</span><span class="p">],</span>\
                                                                      <span class="n">kws</span><span class="p">[</span><span class="s1">&#39;ytick_label_size&#39;</span><span class="p">]</span>
            
        <span class="n">marker_style</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="p">,</span> <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="n">kws</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">],</span> <span class="n">kws</span><span class="p">[</span><span class="s1">&#39;markerfacecolor&#39;</span><span class="p">],</span> <span class="n">kws</span><span class="p">[</span><span class="s1">&#39;markeredgecolor&#39;</span><span class="p">]</span>

        <span class="c1">#--------------- end of setting mpl properties ------------------------------- </span>
        

        <span class="c1">#  define profile object :</span>
        <span class="k">if</span> <span class="n">profile_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">profile_obj</span> <span class="o">=</span> <span class="n">Profile</span> <span class="p">(</span><span class="n">profile_fn</span> <span class="o">=</span><span class="n">profile_fn</span><span class="p">)</span>
            
            <span class="n">easting</span> <span class="p">,</span> <span class="n">northing</span> <span class="p">,</span><span class="n">elevation_array</span><span class="p">,</span> <span class="n">station_pk</span>  <span class="o">=</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">east</span><span class="p">,</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">north</span><span class="p">,</span> \
                                            <span class="n">profile_obj</span><span class="o">.</span><span class="n">elev</span><span class="p">,</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">stn_position</span>

            <span class="n">azimuth_array</span> <span class="o">=</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">azimuth</span>
            <span class="n">stn_separation_array</span> <span class="o">=</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">stn_interval</span>
            <span class="n">DipoleLength</span> <span class="o">=</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">dipole_length</span>
        <span class="c1"># elif profile_fn is None : </span>
        <span class="c1">#     DipoleLength = stn_separation_array.mean()</span>
        <span class="k">elif</span> <span class="n">profile_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">csamt_obj</span> <span class="o">=</span><span class="n">CSAMT</span><span class="p">(</span><span class="n">data_fn</span> <span class="o">=</span><span class="n">fn</span> <span class="p">)</span>
            <span class="n">easting</span><span class="p">,</span> <span class="n">northing</span><span class="p">,</span> <span class="n">elevation_array</span> <span class="p">,</span> <span class="n">station_pk</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">east</span> <span class="p">,</span> \
                <span class="n">csamt_obj</span><span class="o">.</span><span class="n">north</span> <span class="p">,</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">elev</span><span class="p">,</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">station_distance</span>
            
            <span class="n">azimuth_array</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">compute_azimuth</span><span class="p">(</span><span class="n">easting</span> <span class="o">=</span> <span class="n">easting</span><span class="p">,</span> <span class="n">northing</span> <span class="o">=</span><span class="n">northing</span><span class="p">,</span> <span class="n">extrapolate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
            <span class="n">stn_separation_array</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">station_separation</span>
            <span class="n">DipoleLength</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">dipolelength</span>
            
                
        <span class="k">elif</span> <span class="n">profile_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">fn</span> <span class="ow">is</span> <span class="kc">None</span>  <span class="p">:</span> <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span><span class="s1">&#39;None path is found. Please spceify you data path.&#39;</span><span class="p">)</span>
            
        
        <span class="c1">#-----------------------------Build fonction --------------------------------------------</span>
        <span class="k">def</span> <span class="nf">plot_topography</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">set_xlabel</span><span class="o">=</span><span class="kc">True</span> <span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            plot topography </span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">topo_profile</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">station_pk</span><span class="p">,</span> <span class="n">elevation_array</span><span class="p">,</span> 
                                     <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker_style</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span>
                                     <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">markerfacecolor</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                     <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="n">markeredgecolor</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                     <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
            <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">topo_profile</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$profile$&#39;</span><span class="p">])</span>
            <span class="c1"># topo_scatter = axes.scatter(station_pk, elevation_array, lw=lw,</span>
            <span class="c1">#                                          ls=self.ls[0] ,  </span>
            <span class="c1">#                                          alpha=alpha,</span>
            <span class="c1">#                                          marker=marker_style[0], </span>
            <span class="c1">#                                          s=self.ms,</span>
            <span class="c1">#                                          )</span>
            <span class="k">if</span> <span class="n">set_xlabel</span> <span class="p">:</span> 
                <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span> <span class="p">(</span><span class="s1">&#39;Stations&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
                <span class="c1"># axes.set_xlabel (&#39;Stations&#39;, color=&#39;k&#39;, fontdict={&#39;size&#39;: 12, &#39;weight&#39;: &#39;bold&#39;})</span>

                
            <span class="k">if</span> <span class="n">plot_type</span> <span class="o">!=</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Topographic profile&#39;</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span> <span class="p">(</span><span class="s1">&#39;Elevation(m)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>


       
        <span class="k">def</span> <span class="nf">plot_stn_separation</span><span class="p">(</span><span class="n">axes</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">set_xlabel</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            plot station _separations  x_station / h: separtion(m)</span>
<span class="sd">            params : dipole_length_curve: show the line of overage value on de site beteen all stations . </span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">stn_sep_profile</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">station_pk</span><span class="p">,</span> <span class="n">stn_separation_array</span><span class="p">,</span>
                                                              <span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> 
                                                              <span class="n">lw</span><span class="o">=</span> <span class="n">lw</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="n">marker_style</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                                              <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">markerfacecolor</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                                              <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="n">markeredgecolor</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                              <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                                              <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            
            <span class="k">if</span> <span class="n">set_xlabel</span> <span class="p">:</span> 
                <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span> <span class="p">(</span><span class="s1">&#39;Stations&#39;</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="n">plot_type</span> <span class="o">!=</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Station Separation&#39;</span><span class="p">)</span>
            
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span> <span class="p">(</span><span class="s1">&#39;Separation(m)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
            
            <span class="c1"># axes.grid(color=&#39;k&#39;, ls=&#39;--&#39;, lw =0.125, alpha=0.1, which=&#39;minor&#39;) # customize specific grid </span>

            <span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">station_pk</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">+</span> <span class="n">DipoleLength</span> <span class="p">,</span> <span class="n">stn_separation_array</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="p">,</span> 
                                          <span class="s1">&#39;$DipoleLength~:</span><span class="si">{0}</span><span class="s1">m$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DipoleLength</span><span class="p">),</span> 
                                          <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> 
                                          <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span><span class="mi">12</span> <span class="p">)</span>
            
            <span class="c1"># if dipole_length_curve is True : axes.legend( (stn_sep_profile, dip_length_pf  ), labels=[ &#39;$Separation$&#39;,&#39;$Average Bar$&#39;])</span>
            <span class="c1"># else : axes.legend(stn_sep_profile,[&#39;$separation$&#39;])</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">stn_sep_profile</span><span class="p">,[</span><span class="s1">&#39;$separation$&#39;</span><span class="p">])</span>
            
            

        <span class="k">def</span> <span class="nf">plot_azimuth</span><span class="p">(</span><span class="n">axes</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">set_xlabel</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            plot_azimuth : </span>
<span class="sd">                params : set_xlabel : show the labels of on x </span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># plot the azimuth</span>

            <span class="n">azim_profile</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">station_pk</span><span class="p">,</span> <span class="n">azimuth_array</span> <span class="p">,</span> 
                                     <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span> <span class="n">marker_style</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                 <span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ms</span> <span class="p">,</span>
                                                 <span class="n">markeredgecolor</span><span class="o">=</span><span class="n">markeredgecolor</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
                                                 <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">markerfacecolor</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
                                                  <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                  <span class="p">)</span>
            
            
            <span class="k">if</span> <span class="n">plot_type</span> <span class="o">!=</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span><span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Azimuth profile &#39;</span><span class="p">)</span>                                        
            <span class="k">if</span> <span class="n">set_xlabel</span> <span class="p">:</span> 
                <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span> <span class="p">(</span><span class="s1">&#39;stations&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">x_ticks_labelsize</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>    
            <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span> <span class="c1"># customize specific grid</span>
            <span class="c1">#add text on azimuth profile . </span>
            <span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span> <span class="n">station_pk</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">azimuth_array</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="p">,</span> 
                      <span class="s1">&#39;$Line Azimuth~:</span><span class="si">{0}</span><span class="s1">Â°$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">azimuth_array</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="mi">2</span><span class="p">)),</span> 
                      <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> 
                      <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span><span class="mi">12</span> <span class="p">)</span>
            
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span> <span class="p">(</span><span class="s1">&#39;azimuth (Â°)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span>  <span class="n">x_ticks_labelsize</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">azim_profile</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$azimuth$&#39;</span><span class="p">])</span>
            
        <span class="c1"># --------------- works on exception to let function less expensive :------------------------------- </span>
        
        <span class="k">if</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="n">plot_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> 
            <span class="k">if</span> <span class="n">suit</span><span class="o">.</span><span class="n">stn_separation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">plot_type</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span>
                <span class="k">if</span>  <span class="n">suit</span><span class="o">.</span><span class="n">topography</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">plot_type</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span><span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span> 
                    <span class="k">if</span> <span class="n">suit</span><span class="o">.</span><span class="n">azimuth</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">plot_type</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span> 
                        <span class="k">if</span> <span class="n">plot_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">]:</span>
                            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span>
                                <span class="s1">&#39;Argument provided for  plot_type is not acceptable.&#39;</span>\
                                    <span class="s1">&#39; Please use  1,2,3 or the first &#39;</span>\
                                     <span class="s1">&#39;two letter of &quot;Topography, Separation|Station &#39;</span>\
                                         <span class="s1">&#39;or Azimuth &quot; or &quot;*|123&quot; to plot the 3 profiles.&#39;</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plot_type</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">plot_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">123</span><span class="p">]:</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span><span class="s1">&#39;Only 1|2|3 is need to plot. Try again !&#39;</span><span class="p">)</span>
            <span class="n">plot_type</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

        <span class="c1"># --------------------------- plot only single figures Topo/sep/azim  ---------------------------------------</span>

        <span class="k">if</span> <span class="n">plot_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;123&#39;</span><span class="p">]:</span>
            
            <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> 
            <span class="c1"># ax= fig.add_axes([0,0,1,1])</span>
            <span class="k">if</span>  <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span> <span class="ow">or</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^to+&#39;</span><span class="p">,</span>
                                              <span class="n">plot_type</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
                <span class="n">plot_topography</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;3&quot;</span> <span class="ow">or</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^az+&#39;</span><span class="p">,</span> 
                                               <span class="n">plot_type</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
                <span class="n">plot_azimuth</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span> <span class="ow">or</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^se+&#39;</span><span class="p">,</span>
                                               <span class="n">plot_type</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>\
                <span class="ow">or</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^st+&#39;</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span><span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="c1"># if dipole_length_curve is not True : plot_stn_separation(axes=ax, dipole_length_curve=False)</span>
                 <span class="n">plot_stn_separation</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">set_stnnames</span> <span class="o">==</span><span class="kc">True</span> <span class="p">:</span> 
                <span class="k">if</span> <span class="n">add_stnnames</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                    <span class="k">if</span> <span class="nb">len</span> <span class="p">(</span><span class="n">add_stnnames</span><span class="p">)</span> <span class="o">!=</span> <span class="n">station_pk</span><span class="o">.</span><span class="n">size</span> <span class="p">:</span>
                        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_station</span><span class="p">(</span><span class="s1">&#39;Stations names provided must&#39;</span>\
                              <span class="s1">&#39; be the same length as survey points. Number of survey points are&#39;</span>\
                               <span class="s1">&#39; : &lt;</span><span class="si">{0}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">station_pk</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
                    <span class="n">xticklabel</span> <span class="o">=</span><span class="n">add_stnnames</span> 
    
                <span class="k">elif</span> <span class="n">add_stnnames</span>  <span class="ow">is</span>  <span class="kc">None</span> <span class="p">:</span> 
                    <span class="n">xticklabel</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S</span><span class="si">{0:02}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">station_pk</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span>
                    
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span> <span class="p">([</span><span class="n">station_pk</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">station_pk</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span> <span class="p">)</span>   
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span> <span class="n">station_pk</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">minor</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabel</span> <span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">x_ticklabel_rotation</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># rotate specific station </span>
            <span class="k">else</span> <span class="p">:</span> 
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span> <span class="p">([</span><span class="n">station_pk</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">station_pk</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span> <span class="p">)</span> 
            
            <span class="c1">#ax.grid(color=&#39;k&#39;, ls=&#39;--&#39;, lw =0.125, alpha=0.1) # customize specific grid </span>
                <span class="c1"># custumize xand yticks labelsize</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">x_ticks_labelsize</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">x_ticks_labelsize</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
            <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">)</span>
                
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c1">#----------------------------- plot all 3  using &#39;*&#39; ------------------------------------   </span>
        <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span><span class="s1">&#39;*&#39;</span> <span class="ow">or</span> <span class="n">plot_type</span><span class="o">==</span><span class="s1">&#39;123&#39;</span><span class="p">:</span>

            <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span>
            
            <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">axe1</span> <span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
            <span class="c1"># fig , ax =plt.subplots(3, figsize =self.fig_size, sharex =True )</span>
            <span class="n">plot_topography</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axe1</span><span class="p">,</span> <span class="n">set_xlabel</span> <span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
            
            <span class="n">axe2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">axe1</span><span class="p">)</span>
            <span class="n">plot_stn_separation</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axe2</span><span class="p">,</span> <span class="n">set_xlabel</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            
            <span class="n">axe3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">axe1</span><span class="p">)</span>
            <span class="c1"># if dipole_length_curve is False : plot_stn_separation(axes=axe3, dipole_length_curve=False)</span>
            <span class="c1"># else :</span>
            <span class="n">plot_azimuth</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axe3</span><span class="p">,</span> <span class="n">set_xlabel</span> <span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">set_stnnames</span> <span class="p">:</span> 
                <span class="k">if</span> <span class="n">add_stnnames</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                    <span class="k">if</span> <span class="nb">len</span> <span class="p">(</span><span class="n">add_stnnames</span><span class="p">)</span> <span class="o">!=</span> <span class="n">station_pk</span><span class="o">.</span><span class="n">size</span> <span class="p">:</span> 
                        <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_station</span><span class="p">(</span><span class="s1">&#39;Stations names provided must&#39;</span>
                                <span class="s1">&#39; be the same length as survey points. Number of survey points are&#39;</span>
                                  <span class="s1">&#39; : &lt;</span><span class="si">{0}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">station_pk</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
                    <span class="n">xticklabel</span> <span class="o">=</span><span class="n">add_stnnames</span> 
                <span class="k">elif</span> <span class="n">add_stnnames</span>  <span class="ow">is</span>  <span class="kc">None</span> <span class="p">:</span> 
                    <span class="n">xticklabel</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S</span><span class="si">{0:02}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">station_pk</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span>
                
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">axx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">axe1</span><span class="p">,</span> <span class="n">axe2</span><span class="p">,</span> <span class="n">axe3</span><span class="p">]):</span>
                
                <span class="k">if</span> <span class="n">set_stnnames</span><span class="p">:</span><span class="n">axx</span> <span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span> <span class="n">station_pk</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span> 
                <span class="n">axx</span> <span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">station_pk</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">station_pk</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="n">axx</span> <span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">set_stnnames</span><span class="p">:</span> <span class="n">axx</span> <span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabel</span> <span class="p">,</span> 
                                                      <span class="n">rotation</span><span class="o">=</span><span class="n">x_ticklabel_rotation</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span> <span class="c1"># ,va=&#39;center&#39;)</span>
                
            <span class="n">axe3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;stations&#39;</span><span class="p">,</span> <span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Topography-Stations separation-Station azimuth profiles&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span> 
                     <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                     <span class="n">style</span> <span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span>
                     <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;moccasin&#39;</span><span class="p">))</span>
        
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
        
        
<div class="viewcode-block" id="Plot1d.plot_static_correction"><a class="viewcode-back" href="../../viewer.html#viewer.plot.Plot1d.plot_static_correction">[docs]</a>    <span class="k">def</span> <span class="nf">plot_static_correction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_fn</span><span class="p">,</span> <span class="n">profile_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                               <span class="n">frequency_id</span>  <span class="o">=</span><span class="mi">1</span> <span class="p">,</span> <span class="n">ADD_FILTER</span> <span class="o">=</span><span class="s1">&#39;tma&#39;</span> <span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        plot coorected apparent resistivities at different stations by reducing the problem of static shift . </span>
<span class="sd">            data_fn : str : full path to file , can be [AVG|EDI|J] files</span>
<span class="sd">            profile_fn : str : pathLike : full path to Zonge Engeneering *.station file .</span>
<span class="sd">            </span>
<span class="sd">        Note : If user provide raw Zonge AVG file , may also add profile file (*.stn)  </span>
<span class="sd">        </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        params             Default                   Description </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        frequency_id      str or int        plot the filtered frequency.</span>
<span class="sd">                                            eg : frequency_id = 1023 means --&gt; </span>
<span class="sd">                                            plot  uncorrected rho and static rho </span>
<span class="sd">                                            at that frequency . set on list to plot</span>
<span class="sd">                                            multiple frequency [8,1101 ].</span>
<span class="sd">        ADD_FILTER          str             name of filter to apply . </span>
<span class="sd">                                            TMA : Trimming moving average</span>
<span class="sd">                                            AMA : Adaptative moving average </span>
<span class="sd">                                            FLMA : Fixed Length moving average</span>

<span class="sd">        ==========================================================================</span>
<span class="sd">        </span>
<span class="sd">        eg :: </span>
<span class="sd">            &gt;&gt;&gt; from from viewer.plot import Plot1d </span>
<span class="sd">            &gt;&gt;&gt; path =  os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">                          &#39;csamtpy&#39;,&#39;data&#39;, file_1)</span>
<span class="sd">            &gt;&gt;&gt; plot_1d_obj =Plot1d()</span>
<span class="sd">            ... plot_1d_obj.plot_static_correction(data_fn =path , </span>
<span class="sd">                                               profile_fn= os.path.join(os.path.dirname(path), &#39;K1.stn&#39;), </span>
<span class="sd">                                               frequency_id =1023)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">FILTER</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;tma&#39;</span><span class="p">,</span> <span class="s1">&#39;ama&#39;</span><span class="p">,</span> <span class="s1">&#39;flma&#39;</span><span class="p">]</span>
        <span class="c1">#-------------------------------------------Fonction properties -------</span>
        <span class="n">TMApoints</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;number_of_TMA_points&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        
        <span class="n">marker</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markeredgecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">lw</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lw&#39;</span><span class="p">,</span> <span class="mf">7.</span><span class="p">)</span>
        <span class="n">savefig</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;save_figure&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">orient</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">)</span>
        <span class="n">addstn</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;set_station_names&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">fill_between</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fill_between&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="c1">#--- define CSAMT objets and apply filter -----------------------------</span>
        <span class="n">csamt_obj</span> <span class="o">=</span> <span class="n">CSAMT</span><span class="p">(</span><span class="n">data_fn</span> <span class="o">=</span> <span class="n">data_fn</span><span class="p">,</span> <span class="n">profile_fn</span> <span class="o">=</span><span class="n">profile_fn</span><span class="p">)</span>
        <span class="n">csamt_freq_obj</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">freq</span> 
        <span class="n">csamt_stn_num_obj</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">station_distance</span> 
        <span class="n">csamt_res_obj</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">resistivity</span> 
        <span class="n">csamt_phase_obj</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">phase</span> 
        <span class="n">stnnames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">resistivity</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        
        <span class="k">if</span> <span class="n">ADD_FILTER</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span>  <span class="n">FILTER</span> <span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Currently , the filter availbale is Trimming Moving Average.&#39;</span>
                          <span class="s1">&#39; Later we will add other filters.Please Try to use the availabe filter.&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span><span class="s1">&#39;Input filter &lt;</span><span class="si">{0}</span><span class="s1">&gt; isnot available.&#39;</span>
                                          <span class="s1">&#39; Please use TMA , AMA, or FLMA&#39;</span><span class="p">)</span>
        
        <span class="c1">#---&gt; corrected data TMA filter  ---------</span>
        <span class="k">if</span> <span class="n">ADD_FILTER</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;tma&#39;</span><span class="p">:</span>
            <span class="n">res_cor_obj</span> <span class="o">=</span> <span class="n">Scor</span><span class="p">()</span><span class="o">.</span><span class="n">TMA</span><span class="p">(</span><span class="n">freq_array</span><span class="o">=</span><span class="n">csamt_freq_obj</span><span class="p">,</span> <span class="n">res_array</span><span class="o">=</span> <span class="n">csamt_res_obj</span><span class="p">,</span> 
                                   <span class="n">phase_array</span><span class="o">=</span> <span class="n">csamt_phase_obj</span> <span class="p">,</span> <span class="n">number_of_TMA_points</span><span class="o">=</span><span class="n">TMApoints</span><span class="p">)</span>
        
        <span class="c1"># call function to fixe freauency for plotting </span>
        <span class="n">freqID</span> <span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">get_frequency_id</span><span class="p">(</span><span class="n">freq_array</span><span class="o">=</span><span class="n">csamt_freq_obj</span><span class="p">,</span> <span class="n">frequency_id</span><span class="o">=</span><span class="n">frequency_id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">referfreq</span> <span class="ow">in</span> <span class="n">freqID</span> <span class="p">:</span> 
            <span class="c1">#-----------------------Build figure ----------------------------------</span>
            
            <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span><span class="s1">&#39;sans-serif&#39;</span>
            <span class="n">fig</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">axe</span> <span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="c1">#-------------------------------------------Build Plot ----------------</span>
            <span class="c1">#call reference frequency fonction </span>
            <span class="c1"># ---&gt; rho uncorrected data </span>
            <span class="n">RES_UNCOR</span> <span class="o">=</span> <span class="n">Zcc</span><span class="o">.</span><span class="n">get_data_from_reference_frequency</span><span class="p">(</span><span class="n">array_loc</span><span class="o">=</span><span class="n">csamt_res_obj</span><span class="p">,</span> 
                                                              <span class="n">freq_array</span><span class="o">=</span><span class="n">csamt_freq_obj</span><span class="p">,</span> 
                                                  <span class="n">reffreq_value</span><span class="o">=</span><span class="n">referfreq</span> <span class="p">)</span>
            <span class="n">RES_COR</span> <span class="o">=</span> <span class="n">Zcc</span><span class="o">.</span><span class="n">get_data_from_reference_frequency</span><span class="p">(</span><span class="n">array_loc</span><span class="o">=</span><span class="n">res_cor_obj</span><span class="p">,</span>
                                                            <span class="n">freq_array</span><span class="o">=</span><span class="n">csamt_freq_obj</span><span class="p">,</span> 
                                                  <span class="n">reffreq_value</span><span class="o">=</span><span class="n">referfreq</span> <span class="p">)</span>
            
           
            <span class="n">mark</span><span class="p">,</span>  <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">semilogy</span> <span class="p">(</span><span class="n">csamt_stn_num_obj</span><span class="p">,</span><span class="n">RES_UNCOR</span> <span class="p">,</span> <span class="n">c</span><span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                  <span class="n">markersize</span> <span class="o">=</span> <span class="n">ms</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">fs</span> <span class="p">,</span>
                                  <span class="n">markeredgecolor</span><span class="o">=</span> <span class="n">markeredgecolor</span> <span class="p">)</span>
            
            <span class="n">resPlots</span><span class="p">,</span><span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">csamt_stn_num_obj</span><span class="p">,</span><span class="n">RES_UNCOR</span> <span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="n">lw</span><span class="o">*</span><span class="n">fs</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                <span class="n">ls</span> <span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$Uncorrected apparent resistivity$&#39;</span> <span class="p">)</span>
            
            <span class="n">marki</span><span class="p">,</span>  <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">semilogy</span> <span class="p">(</span><span class="n">csamt_stn_num_obj</span><span class="p">,</span><span class="n">RES_COR</span> <span class="p">,</span> <span class="n">c</span><span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                                  <span class="n">markersize</span> <span class="o">=</span> <span class="n">ms</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">fs</span> <span class="p">,</span>
                                  <span class="n">markeredgecolor</span><span class="o">=</span> <span class="s1">&#39;blue&#39;</span> <span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            
            <span class="n">corPlots</span><span class="p">,</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">csamt_stn_num_obj</span><span class="p">,</span><span class="n">RES_COR</span> <span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="n">lw</span><span class="o">*</span><span class="n">fs</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                <span class="n">ls</span> <span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$Corrected</span><span class="se">\r</span><span class="s1">esistivity :&#39;</span>\
                                    <span class="s1">&#39; TMA filter at </span><span class="si">{0}</span><span class="s1"> points$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">TMApoints</span><span class="p">))</span>
            
            <span class="n">axe</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            
            <span class="n">axe</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">)</span> <span class="c1"># customize specific grid</span>
       
            <span class="n">axe</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$Station\ distance(m)$&#39;</span> <span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                                                <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span><span class="o">*</span><span class="mi">14</span><span class="p">,</span>
                                                                <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">})</span>
            
            <span class="n">axe</span><span class="o">.</span><span class="n">set_ylabel</span> <span class="p">(</span><span class="s1">&#39;$Resistivity(â¦.m)$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                            <span class="n">fontsize</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">y_minorticks</span><span class="o">*</span><span class="mi">14</span><span class="p">,</span> 
                            <span class="n">fontweight</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">)</span>
            <span class="c1"># axe.legend([resPlots], [&#39;$Uncorrected apparent resistivity$&#39;] )</span>
            <span class="c1"># axe.legend([corPlots], [&#39;$Corrected resistivity : TMA filter at {0} points$&#39;.format(TMApoints)] )</span>
            
            <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="p">[</span><span class="n">resPlots</span><span class="p">,</span> <span class="n">corPlots</span> <span class="p">],</span> <span class="p">[</span><span class="s1">&#39;$Uncorrected\ app. Rho$&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;$Rhofiltered: TMA\ at\ </span><span class="si">{0}</span><span class="s1">\ points$&#39;</span><span class="o">.</span>\
                                                    <span class="nb">format</span><span class="p">(</span><span class="n">TMApoints</span><span class="p">)</span> <span class="p">])</span><span class="c1"># , [&#39;$ApparentResistivity$&#39;, &#39;$TMA at {0}$&#39;.format(TMApoints)])</span>
            
            <span class="n">axe</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span> <span class="n">csamt_stn_num_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">RES_UNCOR</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="p">,</span>
                     <span class="s1">&#39;$ Filtered\ ref.frequency: &lt;</span><span class="si">{0}</span><span class="s1">&gt;Hz$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">referfreq</span><span class="p">),</span> 
                      <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span>
                      <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span><span class="mi">12</span> <span class="p">)</span>
            <span class="k">if</span> <span class="n">fill_between</span> <span class="p">:</span> <span class="n">axe</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">csamt_stn_num_obj</span><span class="p">,</span> <span class="n">RES_UNCOR</span><span class="p">,</span> <span class="n">RES_COR</span><span class="p">,</span>
                                               <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> 
                                               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;thistle&#39;</span><span class="p">,</span> 
                                               <span class="n">alpha</span> <span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">addstn</span> <span class="o">==</span><span class="kc">True</span> <span class="p">:</span> 
                <span class="n">axe</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span> <span class="n">csamt_stn_num_obj</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span> 
                <span class="c1"># axx .set_xlim([station_pk.min(), station_pk.max()])</span>
                <span class="n">axe</span> <span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                <span class="n">axe</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">stnnames</span> <span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
                
            <span class="c1"># fig.suptitle(&#39; Filtered frequency : &lt;{0}&gt;Hz&#39;.format(referfreq),  fontsize= self.font_size)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Static correction plot &#39;</span><span class="p">,</span> 
                          <span class="n">style</span> <span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span>  <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,</span> <span class="n">orientation</span> <span class="o">=</span><span class="n">orient</span><span class="p">)</span></div>
        
            

<div class="viewcode-block" id="Plot1d.plot_freqVSRhoPhase"><a class="viewcode-back" href="../../viewer.html#viewer.plot.Plot1d.plot_freqVSRhoPhase">[docs]</a>    <span class="k">def</span> <span class="nf">plot_freqVSRhoPhase</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">,</span> <span class="n">profile_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                             <span class="n">station_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rename_stations</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                             <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to plot apparent resistivity |phase vs frequency .</span>
<span class="sd">        params : fn : str : full path to [AVG|EDI|J] file : </span>
<span class="sd">                profile_fn : str : full path to station profile . </span>
<span class="sd">                </span>
<span class="sd">            NB : if user use drectly *AVG data , must provide station profile &#39;*.stn&#39;</span>
<span class="sd">            </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        params             Default                   Description </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        station_id      str or int          plot the name of station </span>
<span class="sd">                                            if string is povided make be sure that </span>
<span class="sd">                                            the station name is on the station list </span>
<span class="sd">                                            eg : station_id = 1 means --&gt; plot  S00</span>
<span class="sd">                                            station =[1,13] means plot &gt;S00,S12</span>
<span class="sd">                                            station [S05, 7, 8]--&gt;[ S05, S06, S07]</span>
<span class="sd">        rename_stations      list            bring the station name . Be sure the </span>
<span class="sd">                                            len of station name you provided match </span>
<span class="sd">                                            the data station name . </span>
<span class="sd">        show_error          bool            if True , see errobar plot. Default is </span>
<span class="sd">                                            False.</span>
<span class="sd">        ==========================================================================</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markeredgecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">lw</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lw&#39;</span><span class="p">,</span> <span class="mf">4.</span><span class="p">)</span>
        <span class="n">savefig</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;savefig&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">orient</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">)</span>
        <span class="n">rename_stations</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rename_stations&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">fontstyle</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_style&#39;</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">)</span>
        <span class="n">show_error_bar</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;show_error&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="c1"># creat CSAMT Object : </span>
        <span class="n">csamt_obj</span> <span class="o">=</span> <span class="n">CSAMT</span><span class="p">(</span><span class="n">data_fn</span> <span class="o">=</span> <span class="n">fn</span> <span class="p">,</span> <span class="n">profile_fn</span> <span class="o">=</span> <span class="n">profile_fn</span>   <span class="p">)</span>
    
        <span class="k">if</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span><span class="s1">&#39;Need absolutely frequency&#39;</span>
                                         <span class="s1">&#39; value before plotting.&#39;</span>
                                         <span class="s1">&#39;Please add your frequency data.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">resistivity</span>  <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span><span class="s1">&#39;Error plotting.Provide your resistivity values.&#39;</span><span class="p">)</span>
        
        <span class="c1">#--- assert stations length ------ </span>
        <span class="n">stations</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">resistivity</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">rename_stations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">if</span>  <span class="nb">len</span><span class="p">(</span><span class="n">stations</span> <span class="p">)</span><span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rename_stations</span><span class="p">):</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Stations provided are the lenght = </span><span class="si">{0}</span><span class="s1">,&#39;</span>
                              <span class="s1">&#39; The defalut stations length =</span><span class="si">{1}</span><span class="s1">.&#39;</span>
                              <span class="s1">&#39; Please provided new stations &#39;</span>
                              <span class="s1">&#39;list with the same length.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rename_stations</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">stations</span><span class="p">)))</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_station</span><span class="p">(</span><span class="s1">&#39;New stations provided &#39;</span>
                                                <span class="s1">&#39;must have the same length with default stations. &#39;</span><span class="p">)</span>
            <span class="n">stations</span> <span class="o">=</span> <span class="n">rename_stations</span>
            
        <span class="c1">#-- call function to specifier the user demand ---     </span>
        <span class="n">stations_for_plot</span> <span class="o">=</span><span class="n">mplotus</span><span class="o">.</span><span class="n">get_stationid</span><span class="p">(</span><span class="n">stations</span> <span class="o">=</span><span class="n">stations</span><span class="p">,</span> <span class="n">station_id</span><span class="o">=</span><span class="n">station_id</span><span class="p">)</span>
        <span class="c1">#--&gt; set objets </span>
        <span class="n">csamt_res_obj</span><span class="p">,</span> <span class="n">csamt_freq_obj</span><span class="p">,</span> <span class="n">csamt_phase_obj</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">resistivity</span><span class="p">,</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">freq</span> <span class="p">,</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">phase</span> 
        <span class="n">csamt_res_err_obj</span> <span class="p">,</span> <span class="n">csamt_phs_err_obj</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">resistivity_err</span> <span class="p">,</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">phase_err</span> 

        <span class="c1">#---&gt; loop stations </span>

        <span class="k">for</span> <span class="n">stn</span>  <span class="ow">in</span> <span class="n">stations_for_plot</span><span class="p">:</span> 
            <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
            
            <span class="n">fig</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            
            <span class="c1">#---- &gt; create axis for each plot </span>
            <span class="n">axe1</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">axe2</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">show_error_bar</span> <span class="p">:</span> 
                <span class="n">axe1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">csamt_freq_obj</span> <span class="p">,</span><span class="n">csamt_res_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">],</span> <span class="n">yerr</span><span class="o">=</span><span class="n">csamt_res_err_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">],</span> 
                               <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">ecolor</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lolims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">uplims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                               <span class="n">xlolims</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xuplims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                               <span class="n">lw</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> 
                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,)</span>
                
            
            <span class="n">mark</span><span class="p">,</span>  <span class="o">=</span> <span class="n">axe1</span><span class="o">.</span><span class="n">loglog</span> <span class="p">(</span><span class="n">csamt_freq_obj</span> <span class="p">,</span><span class="n">csamt_res_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                  <span class="n">markersize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">fs</span> <span class="p">,</span>
                                  <span class="n">markeredgecolor</span><span class="o">=</span> <span class="n">markeredgecolor</span> <span class="p">)</span>
            
            
            <span class="n">logfreqres</span><span class="o">=</span> <span class="n">axe1</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">csamt_freq_obj</span> <span class="p">,</span><span class="n">csamt_res_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span> <span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="n">lw</span> <span class="o">*</span><span class="n">fs</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                        <span class="n">ls</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ls</span><span class="p">,</span> 
                        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;App. resistivity curve&#39;</span><span class="p">)</span><span class="c1"># ,marker =&#39;D&#39;, </span>
                         <span class="c1">#alpha = 1)   </span>

            <span class="n">axe1</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>    
            <span class="n">axe1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span> <span class="c1"># customize specific grid</span>
       
            <span class="n">axe1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span> <span class="p">,</span>
                            <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span><span class="o">*</span><span class="mi">14</span><span class="p">,</span>
                                      <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span>
                                      <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="n">fontstyle</span><span class="p">})</span>
            
            <span class="n">axe1</span><span class="o">.</span><span class="n">set_ylabel</span> <span class="p">(</span><span class="s1">&#39;Resistivity(â¦.m)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                             <span class="n">fontsize</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">y_minorticks</span><span class="o">*</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">fontweight</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> 
                             <span class="n">fontstyle</span> <span class="o">=</span> <span class="n">fontstyle</span><span class="p">)</span>
            
            <span class="n">axe1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">logfreqres</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;App. resistivity curve&#39;</span><span class="p">])</span>
            
            <span class="c1"># axe1.set_title(&#39;log&#39;)</span>
            
            <span class="c1">#------------------ define axe2 ------------- </span>
            <span class="k">if</span> <span class="n">show_error_bar</span> <span class="p">:</span> 
                 <span class="n">axe2</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">csamt_freq_obj</span> <span class="p">,</span><span class="n">csamt_phase_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">],</span> <span class="n">yerr</span><span class="o">=</span><span class="n">csamt_phs_err_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">],</span> 
                                               <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">ecolor</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lolims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">uplims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                               <span class="n">xlolims</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xuplims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                               <span class="n">lw</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> 
                                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,)</span>
            
            <span class="n">marki</span><span class="p">,</span> <span class="o">=</span> <span class="n">axe2</span><span class="o">.</span><span class="n">semilogx</span> <span class="p">(</span><span class="n">csamt_freq_obj</span> <span class="p">,</span> <span class="n">csamt_phase_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">markersize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">fs</span> <span class="p">,</span>
                                        <span class="n">markeredgecolor</span><span class="o">=</span> <span class="s1">&#39;cyan&#39;</span><span class="p">)</span>
            
                
            
            <span class="n">logfreqphase</span> <span class="o">=</span><span class="n">axe2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">csamt_freq_obj</span> <span class="p">,</span> <span class="n">csamt_phase_obj</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span> <span class="p">,</span>
                                        <span class="n">lw</span><span class="o">=</span><span class="n">lw</span> <span class="o">*</span><span class="n">fs</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span><span class="s1">&#39;:&#39;</span> <span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                        <span class="n">label</span> <span class="o">=</span><span class="s1">&#39;Phase curve&#39;</span><span class="p">)</span> 
            

                                        
            <span class="n">axe2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency(Hz)&#39;</span><span class="p">,</span> 
                            <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> 
                                      <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span> <span class="o">*</span><span class="mi">14</span><span class="p">,</span> 
                                      <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> 
                                      <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="n">fontstyle</span><span class="p">})</span>
            <span class="n">axe2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase(Â°)&#39;</span><span class="p">,</span>
                            <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">y_minorticks</span> <span class="o">*</span><span class="mi">14</span><span class="p">,</span> 
                                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> 
                                                  <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="n">fontstyle</span><span class="p">})</span>
            <span class="n">axe2</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="n">axe2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span> <span class="o">.</span><span class="mi">8</span> <span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">)</span>
            <span class="n">axe2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">logfreqphase</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Phase curve&#39;</span><span class="p">])</span>
            

            
            
            
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39; ResPhase plot: station &lt;</span><span class="si">{0}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn</span><span class="p">),</span> 
                         <span class="n">fontsize</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                         <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;whitesmoke&#39;</span><span class="p">),</span>
                         <span class="n">fontstyle</span> <span class="o">=</span><span class="n">fontstyle</span><span class="p">)</span>    
            
            <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">orient</span><span class="p">)</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="Plot1d.penetrated1D"><a class="viewcode-back" href="../../viewer.html#viewer.plot.Plot1d.penetrated1D">[docs]</a>    <span class="k">def</span> <span class="nf">penetrated1D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">profile_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">selected_frequency</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pentration1D depth : Show skin depth at selected frequencies .for multiples frequencies , </span>
<span class="sd">        put argument &quot;selected_frequency&quot; on list. If frequency provided is not on the frequency</span>
<span class="sd">        range , it will be interpolated. </span>
<span class="sd">        params : </span>
<span class="sd">            fn : full path to [AVG|EDI|J] file </span>
<span class="sd">            profile_fn : full path to *stn station file . If user used  EDI or J files . Dont need to </span>
<span class="sd">                        add profile_file </span>
<span class="sd">            selected_frequency : list : list of freauency want to see the penetration depth. </span>
<span class="sd">                                must be on a list  . egg : [8, 511,1024 ]</span>
<span class="sd">                         </span>
<span class="sd">        Note : browse to see others plot config. </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        params             Default                   Description </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        rename_station      list            bring the station name . Be sure the </span>
<span class="sd">                                            len of station name you provided match </span>
<span class="sd">                                            the data station name .</span>
<span class="sd">        rotate_station      int             rotation station name  . </span>
<span class="sd">                                            * Default is 90 degree. </span>
<span class="sd">        fs                  float           can change the size of marker. </span>
<span class="sd">                                            *Default is .7 : eg ms =9*fs</span>
<span class="sd">        lw                  float           change the linewdth </span>
<span class="sd">        plot_grid           bool            add grid on your plot . </span>
<span class="sd">                                            Default is False </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        eg :: </span>
<span class="sd">            &gt;&gt;&gt; from viewer.plot import Plot1d </span>
<span class="sd">            &gt;&gt;&gt; path =  os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">                          &#39;csamtpy&#39;,&#39;data&#39;, file_1)</span>
<span class="sd">            &gt;&gt;&gt; plot_1d_obj =Plot1d()</span>
<span class="sd">            ... plot1d_depth = plot_1d_obj.penetrated1D(fn =path ,</span>
<span class="sd">                                profile_fn= os.path.join(os.path.dirname(path), &#39;K1.stn&#39;), </span>
<span class="sd">                                selected_frequency =511)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;PlotPenetration1D datapath &lt;</span><span class="si">%s</span><span class="s1">&gt;&#39;</span><span class="o">%</span> <span class="n">fn</span><span class="p">)</span>
        
        <span class="n">rotate_stn</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rotate_station_names&#39;</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
        <span class="n">plotgrid</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_grid&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">rename_station</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rename_station&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="n">fs</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lw&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="n">savefig</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;savefigure&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">orient</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">)</span>

        <span class="c1">#------BUILD CSAMTOBJ------------------------------------</span>
        <span class="n">csamt_obj</span> <span class="o">=</span> <span class="n">CSAMT</span><span class="p">(</span><span class="n">data_fn</span> <span class="o">=</span><span class="n">fn</span> <span class="p">,</span> <span class="n">profile_fn</span> <span class="o">=</span><span class="n">profile_fn</span> <span class="p">)</span>
        <span class="n">csamt_dep1D_obj</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">skindepth</span> 
        <span class="n">csamt_freq_obj</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">freq</span> 
        <span class="n">csamt_stndis_obj</span><span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">station_distance</span>
        
        
        
        <span class="k">if</span> <span class="n">selected_frequency</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;You may selected frequency between freauency range.&#39;</span>\
                           <span class="s1">&#39; If you dont know the number of frequency&#39;</span><span class="p">)</span>
            <span class="k">raise</span> 
        
        <span class="k">def</span> <span class="nf">depth1D</span> <span class="p">(</span><span class="n">freq_selected</span><span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            selected depth penetrate that match the frequency </span>
<span class="sd">            return depth1D array at that frequency.</span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">Zcc</span><span class="o">.</span><span class="n">get_data_from_reference_frequency</span><span class="p">(</span><span class="n">array_loc</span><span class="o">=</span><span class="n">csamt_dep1D_obj</span><span class="p">,</span>
                                                         <span class="n">freq_array</span><span class="o">=</span><span class="n">csamt_freq_obj</span><span class="p">,</span> 
                                                  <span class="n">reffreq_value</span><span class="o">=</span><span class="n">freq_selected</span><span class="p">)</span>
        
        <span class="n">freqSELECT</span> <span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">get_frequency_id</span><span class="p">(</span><span class="n">freq_array</span> <span class="o">=</span><span class="n">csamt_freq_obj</span><span class="p">,</span> 
                                              <span class="n">frequency_id</span><span class="o">=</span> <span class="n">selected_frequency</span><span class="p">)</span>
   
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span>
        
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
        <span class="c1"># mpl.rcParams[&#39;font.family&#39;]=&#39;sans-serif&#39;</span>
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Tahoma&#39;</span><span class="p">]</span>
        <span class="n">fig</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">axis</span> <span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        
        <span class="c1"># create a twin y to store the name of station . </span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance(m)&#39;</span><span class="p">,</span> 
                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span> <span class="o">*</span><span class="mi">14</span><span class="p">,</span>
                                    <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="s1">&#39;bold&#39;</span><span class="p">})</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Penetration depth (m)&#39;</span><span class="p">,</span>
                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">y_minorticks</span> <span class="o">*</span><span class="mi">14</span><span class="p">,</span> 
                                    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
        
        <span class="c1"># #---set the second axis ---------</span>
        <span class="n">axis2</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axis2</span><span class="o">.</span><span class="n">set_xlabel</span> <span class="p">(</span><span class="s1">&#39;stations&#39;</span> <span class="p">,</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span> <span class="o">*</span><span class="mi">14</span><span class="p">,</span> 
                                    <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="s1">&#39;bold&#39;</span><span class="p">})</span>
        
        <span class="n">csamt_stn_num_obj</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">skindepth</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">axis2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span> <span class="n">csamt_stndis_obj</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">rename_station</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rename_station</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">csamt_stn_num_obj</span><span class="p">),</span>\
                <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span><span class="s2">&quot;Error plot !rename_station and station&quot;</span>\
                                       <span class="s2">&quot; name must have the same lenght.&quot;</span><span class="p">)</span>
        
            <span class="n">csamt_stn_num_obj</span><span class="o">=</span> <span class="n">rename_station</span> 
            
        <span class="n">axis2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">csamt_stn_num_obj</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotate_stn</span><span class="p">)</span>
        <span class="c1"># axis2.minorticks_on()</span>
        <span class="n">hand_leg</span><span class="p">,</span> <span class="n">leglabel</span><span class="p">,</span> <span class="n">depmax</span><span class="p">,</span> <span class="n">freqmax</span> <span class="o">=</span><span class="p">[],</span> <span class="p">[]</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span><span class="mi">0</span>         <span class="c1"># create legend ob for appending </span>
        
        <span class="k">for</span> <span class="n">freqs</span> <span class="ow">in</span> <span class="n">freqSELECT</span><span class="p">:</span>
          
            <span class="c1"># mark, = axis.plot(csamt_stndis_obj, dep1D, marker =&#39;*&#39;, markersize =self.ms*2fs , markeredgecolor=&#39;blue&#39;)</span>
            <span class="c1"># recover the interpolated frequency </span>
            <span class="k">if</span> <span class="n">freqs</span> <span class="ow">not</span> <span class="ow">in</span>  <span class="n">csamt_freq_obj</span><span class="p">:</span> 
                <span class="n">interpFreq</span> <span class="o">=</span><span class="n">Zcc</span><span class="o">.</span><span class="n">find_reference_frequency</span><span class="p">(</span><span class="n">freq_array</span><span class="o">=</span><span class="n">csamt_freq_obj</span><span class="p">,</span> 
                                                         <span class="n">reffreq_value</span><span class="o">=</span><span class="n">freqs</span><span class="p">,</span><span class="n">sharp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">etching</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span><span class="s1">&#39;Frequency </span><span class="si">{0}</span><span class="s1"> not in frequency range. &#39;</span>\
                               <span class="s1">&#39;It will be interpolated to find maximum closest  frequency.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">freqs</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt;Input frequency &lt;</span><span class="si">{0}</span><span class="s1">&gt; Hz has been interpolated to&#39;</span>\
                      <span class="s1">&#39; &lt;</span><span class="si">{1}</span><span class="s1">Hz&gt;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span>  <span class="nb">float</span><span class="p">(</span><span class="n">interpFreq</span><span class="p">)))</span>
                <span class="n">freqs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">interpFreq</span><span class="p">)</span>
                
                
            <span class="n">penetration1d</span><span class="p">,</span>  <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">csamt_stndis_obj</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">depth1D</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span> <span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
                                        <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">fs</span> <span class="p">,</span> 
                                        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;freq </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">freqs</span><span class="p">))</span> 
            
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt;Max depth reached by freq=</span><span class="si">{0}</span><span class="s1"> Hz is &lt;</span><span class="si">{1}</span><span class="s1">&gt; km.&#39;</span><span class="o">.</span>\
                  <span class="nb">format</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span>
                         <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">depth1D</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
            
            <span class="n">axis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span> <span class="o">.</span><span class="mi">8</span> <span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">)</span>
    
            <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance(m)&#39;</span><span class="p">,</span>  <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                                      <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span> <span class="o">*</span><span class="mi">14</span><span class="p">,</span>
                                                      <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="s1">&#39;bold&#39;</span><span class="p">})</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Penetration depth (m)&#39;</span><span class="p">,</span>
                            <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> 
                                      <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">y_minorticks</span> <span class="o">*</span><span class="mi">14</span><span class="p">,</span> 
                                      <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
            
            <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">csamt_stndis_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">csamt_stndis_obj</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
            <span class="c1"># axis.minorticks_on()</span>
            <span class="k">if</span> <span class="n">plotgrid</span> <span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span> <span class="o">.</span><span class="mi">8</span> <span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
            
            <span class="c1"># legend </span>
            <span class="n">hand_leg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">penetration1d</span><span class="p">),</span> <span class="n">leglabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$f=</span><span class="si">{0}</span><span class="s1">Hz$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">freqs</span><span class="p">)))</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">hand_leg</span><span class="p">,</span> <span class="n">leglabel</span><span class="p">)</span>
            <span class="c1">#axis.legend(bbox_to_anchor=(1.05, 1), loc=&#39;upper left&#39;, borderaxespad=0.) #place al legend smaller upper left </span>
            
            <span class="k">if</span> <span class="n">depmax</span> <span class="o">&lt;</span> <span class="n">depth1D</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">:</span>
                <span class="n">depmax</span><span class="p">,</span>  <span class="n">freqmax</span> <span class="o">=</span> <span class="n">depth1D</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">freqs</span>
            
            <span class="c1">#axis.set_title(&#39; Penetraton depth plot : max depth = {0} km max depth&#39;.format(np.around(depmax*1e-3,2)),  fontsize= self.font_size)</span>
                    <span class="c1"># #---set the second axis ---------</span>
        
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">freqSELECT</span><span class="p">)</span> <span class="o">&gt;</span><span class="mi">1</span> <span class="p">:</span><span class="n">fmt</span> <span class="o">=</span><span class="s1">&#39;frequencies&#39;</span>
        <span class="k">else</span> <span class="p">:</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;frequency&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; On the set of </span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1">, max depth reached =</span><span class="si">{2}</span><span class="s1"> km at freq =</span><span class="si">{3}</span><span class="s1"> Hz.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freqSELECT</span><span class="p">),</span><span class="n">fmt</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">depmax</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">freqmax</span><span class="p">)</span>  <span class="p">))</span>
        <span class="c1"># fig.suptitle(&#39; Penetration depth plot at {0} {1} &#39;.format(len(freqSELECT), fmt),</span>
        <span class="c1">#              fontsize= self.font_size, verticalalignment=&#39;center&#39;, </span>
        <span class="c1">#              )</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39; Penetration depth plot at </span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freqSELECT</span><span class="p">),</span> <span class="n">fmt</span><span class="p">),</span> 
                         <span class="n">fontsize</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                         <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;whitesmoke&#39;</span><span class="p">),</span>
                         <span class="n">fontstyle</span> <span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,</span> <span class="n">orientation</span> <span class="o">=</span><span class="n">orient</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Plot1d.plot_curves"><a class="viewcode-back" href="../../viewer.html#viewer.plot.Plot1d.plot_curves">[docs]</a>    <span class="k">def</span> <span class="nf">plot_curves</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">savefig</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span><span class="n">selected_stations</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="o">**</span> <span class="n">kws</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot Zonge Engineering AVG file with different components E and H at differents</span>
<span class="sd">        frequencies.  </span>
<span class="sd">        </span>
<span class="sd">        params : fn : full path to Zonge Engineering file </span>
<span class="sd">                profile_fn : str : full path to profile file . </span>
<span class="sd">                savefig : str : path to figure plot </span>
<span class="sd">                </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        params             Default                   Description </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        fs                  float           can change the size of marker. </span>
<span class="sd">                                            *Default is .7 : eg ms =9*fs</span>
<span class="sd">        lw                  float           change the linewdth </span>
<span class="sd">        error_bar           bool            set to false to let invisible. </span>
<span class="sd">                                            Default is True </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">                </span>
<span class="sd">        eg ::   &gt;&gt;&gt; from viewer.plot import Plot1d </span>
<span class="sd">                &gt;&gt;&gt;path =  os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">                          &#39;csamtpy&#39;,&#39;data&#39;, file_1)</span>
<span class="sd">                &gt;&gt;&gt; plot_1d_obj =Plot1d()</span>
<span class="sd">                ... plotcurves = plot_1d_obj .plot_curves(fn = path, </span>
<span class="sd">                                                    selected_stations=[1,10, 20], </span>
<span class="sd">                                                      error_bar=True)</span>
<span class="sd">                            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Plot curves from &lt;</span><span class="si">%s</span><span class="s1">&gt;&#39;</span><span class="o">%</span> <span class="n">fn</span><span class="p">)</span>
        
        <span class="c1">#----- call Avg class and Define CSAMTobj ----</span>
        <span class="n">fontstyle</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span> <span class="p">(</span><span class="s1">&#39;font_style&#39;</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">)</span>
        <span class="n">orientation</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">)</span>
        <span class="n">errBar</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;error_bar&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">xylabelsize</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xylabel_size&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
        
        
        <span class="c1">#-----------IMPORT OBJ AND DEFINE COMPONENTS ------------------</span>
        <span class="kn">from</span> <span class="nn">csamtpy.ff.core</span> <span class="kn">import</span> <span class="n">avg</span> <span class="k">as</span> <span class="n">CSMATavg</span> 
        <span class="n">zonge_csamt_obj</span> <span class="o">=</span> <span class="n">CSMATavg</span><span class="o">.</span><span class="n">Avg</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span> <span class="n">fn</span> <span class="p">)</span>
        <span class="n">zonge_freq_obj</span> <span class="o">=</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">value</span> 
        <span class="n">zonge_res_obj</span> <span class="o">=</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Resistivity</span><span class="o">.</span><span class="n">loc</span> 
        <span class="n">zonge_emag_obj</span> <span class="o">=</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Emag</span><span class="o">.</span><span class="n">loc</span> 
        <span class="n">zonge_hmag_obj</span> <span class="o">=</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Hmag</span><span class="o">.</span><span class="n">loc</span> 
        <span class="n">zonge_stn_obj</span> <span class="o">=</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Station</span><span class="o">.</span><span class="n">names</span> 
        
        <span class="c1">#---------define _error _obj -----------------------------</span>
        <span class="n">zonge_res_err_obj</span> <span class="o">=</span> <span class="p">{</span><span class="n">stn</span> <span class="p">:</span> <span class="n">value</span> <span class="o">*</span><span class="mi">100</span> <span class="k">for</span> <span class="n">stn</span> <span class="p">,</span>
                             <span class="n">value</span> <span class="ow">in</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcRho</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> 
        <span class="n">zonge_phase_err_obj</span><span class="o">=</span> <span class="p">{</span><span class="n">stn</span> <span class="p">:</span> <span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">value</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="k">for</span> <span class="n">stn</span> <span class="p">,</span> 
                              <span class="n">value</span> <span class="ow">in</span>  <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">sPhz</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">zonge_emag_err_obj</span> <span class="o">=</span> <span class="p">{</span><span class="n">stn</span> <span class="p">:</span> <span class="n">value</span> <span class="o">*</span><span class="mi">100</span> <span class="k">for</span> <span class="n">stn</span> <span class="p">,</span> 
                              <span class="n">value</span> <span class="ow">in</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcEmag</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">zonge_hmag_err_obj</span> <span class="o">=</span> <span class="p">{</span><span class="n">stn</span> <span class="p">:</span> <span class="n">value</span> <span class="o">*</span><span class="mi">100</span> <span class="k">for</span> <span class="n">stn</span> <span class="p">,</span>
                              <span class="n">value</span> <span class="ow">in</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">pcHmag</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        
        
        <span class="c1">#--convert phase from mrad to degree </span>
        <span class="n">zonge_phase_obj</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span> <span class="p">:</span> <span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">value</span> <span class="o">*</span><span class="mf">1e-3</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">%</span><span class="mi">90</span> <span class="k">for</span> <span class="n">key</span> <span class="p">,</span> 
                           <span class="n">value</span> <span class="ow">in</span>  <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Data_section</span><span class="o">.</span><span class="n">Phase</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        
        <span class="c1"># create figure from grid2supplots </span>
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">fig</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        
        <span class="c1">#---- &gt; create axis for each plot from subplot2grid-------------------------------------- </span>
        
        <span class="n">axe_res</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">axe_phase</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>  <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">axe_emag</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">colspan</span> <span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">axe_hmag</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">colspan</span> <span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#----&gt; controlled the stations selected for plots --- </span>
        <span class="n">stnID</span> <span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">get_stationid</span><span class="p">(</span><span class="n">stations</span><span class="o">=</span><span class="n">zonge_stn_obj</span><span class="p">,</span> <span class="n">station_id</span><span class="o">=</span><span class="n">selected_stations</span><span class="p">)</span>
        
        <span class="n">handleg</span> <span class="p">,</span> <span class="n">lableg</span>  <span class="o">=</span><span class="p">[{</span><span class="s1">&#39;res&#39;</span><span class="p">:[],</span> <span class="s1">&#39;phs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;emag&#39;</span><span class="p">:[],</span> <span class="s1">&#39;hmag&#39;</span><span class="p">:[]}</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>                 <span class="c1">#for legend manager</span>
        
        <span class="k">for</span> <span class="n">stn_id</span> <span class="ow">in</span> <span class="n">stnID</span> <span class="p">:</span>
            <span class="c1">#-----RESISTIVITY PLOT -----------------------</span>
            <span class="n">mark</span><span class="p">,</span> <span class="o">=</span><span class="n">axe_res</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span><span class="n">zonge_res_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">],</span>  <span class="n">c</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                                <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="p">,</span>
                                <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">markeredgecolor</span><span class="p">)</span>
            <span class="n">rho</span><span class="p">,</span>  <span class="o">=</span> <span class="n">axe_res</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span><span class="n">zonge_res_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">]</span> <span class="p">,</span> 
                                   <span class="n">lw</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;station </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn_id</span><span class="p">))</span>
                                        <span class="c1">#marker =&#39;*&#39;, markersize =self.ms*self.fs , ) </span>
            <span class="n">axe_res</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span>  <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                                            <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span> <span class="o">*</span><span class="n">xylabelsize</span><span class="p">,</span>
                                                            <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span>
                                                            <span class="s1">&#39;style&#39;</span> <span class="p">:</span><span class="n">fontstyle</span><span class="p">})</span>
            <span class="n">axe_res</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Apparent resistivity(â¦.m)&#39;</span><span class="p">,</span> 
                               <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">y_minorticks</span> <span class="o">*</span><span class="n">xylabelsize</span><span class="p">,</span>
                                          <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="n">fontstyle</span><span class="p">})</span>
            
            <span class="n">handleg</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho</span><span class="p">),</span> <span class="n">lableg</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$station\ </span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn_id</span><span class="p">))</span>
            
            <span class="k">if</span> <span class="n">errBar</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
                <span class="k">for</span> <span class="n">xpos</span> <span class="p">,</span> <span class="n">ypos</span> <span class="p">,</span> <span class="n">err</span> <span class="ow">in</span>  <span class="nb">zip</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span><span class="n">zonge_res_obj</span><span class="p">[</span><span class="n">stn_id</span><span class="p">],</span> 
                                              <span class="n">zonge_res_err_obj</span><span class="p">[</span><span class="n">stn_id</span><span class="p">]):</span> 
                    <span class="n">axe_res</span><span class="o">.</span><span class="n">errorbar</span> <span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">err</span> <span class="p">,</span><span class="n">uplims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lolims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                      <span class="n">ecolor</span> <span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
                                      <span class="c1">#capsize =4 ,</span>
                                      <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> 
                                      <span class="c1">#ms=7, </span>
                                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                      <span class="c1">#color =&#39;magenta&#39;</span>
                                      <span class="p">)</span>
            
            <span class="c1">#---------PHASE PLOT --------------------------</span>
            <span class="n">markphs</span><span class="p">,</span> <span class="o">=</span><span class="n">axe_phase</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span><span class="n">zonge_phase_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">],</span>  <span class="n">c</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                                <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
                                <span class="n">markersize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span> <span class="p">,</span>
                                <span class="n">markeredgecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">markeredgecolor</span><span class="p">)</span>
            <span class="n">phase</span><span class="p">,</span>  <span class="o">=</span> <span class="n">axe_phase</span> <span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span><span class="n">zonge_phase_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">]</span> <span class="p">,</span>
                                          <span class="n">lw</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;station </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn_id</span><span class="p">))</span>
                                        <span class="c1">#marker =&#39;*&#39;, markersize =self.ms*self.fs , ) </span>
            <span class="n">axe_phase</span> <span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span> 
                                  <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span> <span class="o">*</span><span class="n">xylabelsize</span><span class="p">,</span>
                                            <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span> <span class="p">:</span><span class="n">fontstyle</span><span class="p">})</span>
            <span class="n">axe_phase</span> <span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase(Â°)&#39;</span><span class="p">,</span>
                                  <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> 
                                            <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">y_minorticks</span> <span class="o">*</span><span class="n">xylabelsize</span><span class="p">,</span>
                                            <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="n">fontstyle</span><span class="p">})</span>
            <span class="n">axe_phase</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
            <span class="n">handleg</span><span class="p">[</span><span class="s1">&#39;phs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phase</span><span class="p">),</span> <span class="n">lableg</span><span class="p">[</span><span class="s1">&#39;phs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$station\ </span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn_id</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">errBar</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
                <span class="k">for</span> <span class="n">xpos</span> <span class="p">,</span> <span class="n">ypos</span> <span class="p">,</span> <span class="n">err</span> <span class="ow">in</span>  <span class="nb">zip</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span><span class="n">zonge_phase_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">],</span>
                                              <span class="n">zonge_phase_err_obj</span><span class="p">[</span><span class="n">stn_id</span><span class="p">]):</span> 
                    <span class="n">axe_phase</span><span class="o">.</span><span class="n">errorbar</span> <span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">err</span> <span class="p">,</span><span class="n">uplims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lolims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                      <span class="n">ecolor</span> <span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
                                      <span class="c1">#capsize =4 ,</span>
                                      <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> 
                                      <span class="c1">#ms=7, </span>
                                      <span class="c1">#capthick=4,</span>
                                      <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
            
            <span class="c1">#---------EMAG PLOT -----------------------------</span>
            
            <span class="n">markemag</span><span class="p">,</span> <span class="o">=</span><span class="n">axe_emag</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span><span class="n">zonge_emag_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">],</span>  <span class="n">c</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                                <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="p">,)</span>
            <span class="n">emag</span><span class="p">,</span>  <span class="o">=</span> <span class="n">axe_emag</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span><span class="n">zonge_emag_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">]</span> <span class="p">,</span>
                                     <span class="n">lw</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;station </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn_id</span><span class="p">))</span>
                                        <span class="c1">#marker =&#39;*&#39;, markersize =self.ms*self.fs , ) </span>
            <span class="n">axe_emag</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span> 
                                <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span> <span class="o">*</span><span class="n">xylabelsize</span><span class="p">,</span> 
                                          <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span> <span class="p">:</span><span class="n">fontstyle</span><span class="p">})</span>
            <span class="n">axe_emag</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E-magn.(microV/Km*A)&#39;</span><span class="p">,</span>
                                <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">y_minorticks</span> <span class="o">*</span><span class="n">xylabelsize</span><span class="p">,</span>
                                          <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="n">fontstyle</span><span class="p">})</span>
            
            <span class="n">handleg</span><span class="p">[</span><span class="s1">&#39;emag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">emag</span><span class="p">),</span> <span class="n">lableg</span><span class="p">[</span><span class="s1">&#39;emag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$station\ </span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn_id</span><span class="p">))</span>  
            
            <span class="k">if</span> <span class="n">errBar</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
                <span class="k">for</span> <span class="n">xpos</span> <span class="p">,</span> <span class="n">ypos</span> <span class="p">,</span> <span class="n">err</span> <span class="ow">in</span>  <span class="nb">zip</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span>
                                              <span class="n">zonge_emag_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">],</span> <span class="n">zonge_emag_err_obj</span><span class="p">[</span><span class="n">stn_id</span><span class="p">]):</span> 
                    <span class="n">axe_emag</span><span class="o">.</span><span class="n">errorbar</span> <span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">err</span> <span class="p">,</span><span class="n">uplims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lolims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                      <span class="n">ecolor</span> <span class="o">=</span><span class="s1">&#39;dimgray&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
                                      <span class="c1">#capsize =4 ,</span>
                                      <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> 
                                      <span class="c1">#ms=7, </span>
                                      <span class="c1">#capthick=4,</span>
                                      <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            
            <span class="c1">#-----------HMAG PLOT --------------------------------------------</span>
            <span class="n">markhmag</span><span class="p">,</span> <span class="o">=</span><span class="n">axe_hmag</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span> <span class="n">zonge_hmag_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">],</span>  <span class="n">c</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                                <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="p">,</span><span class="n">alpha</span> <span class="o">=</span><span class="mf">0.8</span> <span class="p">)</span>
            <span class="n">hmag</span><span class="p">,</span>  <span class="o">=</span> <span class="n">axe_hmag</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span><span class="n">zonge_hmag_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">]</span> <span class="p">,</span> <span class="n">lw</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;station </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn_id</span><span class="p">))</span>
                                        <span class="c1">#marker =&#39;*&#39;, markersize =self.ms*self.fs , ) </span>
            <span class="n">axe_hmag</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span> 
                                <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> 
                                          <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">x_minorticks</span> <span class="o">*</span><span class="n">xylabelsize</span><span class="p">,</span>
                                          <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span> <span class="p">:</span><span class="n">fontstyle</span><span class="p">})</span>
            <span class="n">axe_hmag</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;H-magn.(picoT/A)&#39;</span><span class="p">,</span> 
                                <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">y_minorticks</span> <span class="o">*</span><span class="n">xylabelsize</span><span class="p">,</span> 
                                          <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="n">fontstyle</span><span class="p">})</span>
            
            <span class="n">handleg</span><span class="p">[</span><span class="s1">&#39;hmag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hmag</span><span class="p">),</span> <span class="n">lableg</span><span class="p">[</span><span class="s1">&#39;hmag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$station\ </span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn_id</span><span class="p">))</span>  
            
            <span class="k">if</span> <span class="n">errBar</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
                <span class="k">for</span> <span class="n">xpos</span> <span class="p">,</span> <span class="n">ypos</span> <span class="p">,</span> <span class="n">err</span> <span class="ow">in</span>  <span class="nb">zip</span><span class="p">(</span><span class="n">zonge_freq_obj</span><span class="p">,</span><span class="n">zonge_hmag_obj</span> <span class="p">[</span><span class="n">stn_id</span><span class="p">],</span> <span class="n">zonge_hmag_err_obj</span><span class="p">[</span><span class="n">stn_id</span><span class="p">]):</span> 
                    <span class="n">axe_hmag</span><span class="o">.</span><span class="n">errorbar</span> <span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">err</span> <span class="p">,</span><span class="n">uplims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lolims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                      <span class="n">ecolor</span> <span class="o">=</span><span class="s1">&#39;dimgray&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
                                      <span class="c1">#capsize =4 ,</span>
                                      <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> 
                                      <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        
        <span class="c1"># set all legend</span>
        
        <span class="k">for</span> <span class="n">axe</span> <span class="p">,</span> <span class="n">comps</span> <span class="ow">in</span> <span class="nb">zip</span> <span class="p">([</span><span class="n">axe_res</span><span class="p">,</span> <span class="n">axe_phase</span><span class="p">,</span> <span class="n">axe_emag</span><span class="p">,</span> <span class="n">axe_hmag</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">,</span> <span class="s1">&#39;phs&#39;</span><span class="p">,</span> <span class="s1">&#39;emag&#39;</span><span class="p">,</span> <span class="s1">&#39;hmag&#39;</span><span class="p">]):</span> 
            <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handleg</span><span class="p">[</span><span class="n">comps</span><span class="p">],</span> <span class="n">lableg</span><span class="p">[</span><span class="n">comps</span><span class="p">])</span>
        <span class="c1">#-----------------append necesary infos -------------------------------</span>
        <span class="n">proj_name</span> <span class="o">=</span><span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">project_name</span>
        <span class="n">custumer_info</span>  <span class="o">=</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">custumer_name</span>
        <span class="n">contractor</span><span class="o">=</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">contractor_name</span>
        <span class="n">acqdate</span> <span class="o">=</span><span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyAnnotation</span><span class="o">.</span><span class="n">acqdate</span>
        
        <span class="n">surveyType</span> <span class="o">=</span><span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyConfiguration</span><span class="o">.</span><span class="n">surveyType</span>
        <span class="n">surveyline</span> <span class="o">=</span> <span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyConfiguration</span><span class="o">.</span><span class="n">lineName</span>
        <span class="n">surveyazim</span> <span class="o">=</span><span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">SurveyConfiguration</span><span class="o">.</span><span class="n">azimuth</span>

        <span class="n">txTypeinfo</span> <span class="o">=</span><span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Tx</span><span class="o">.</span><span class="n">txType</span> 
        <span class="n">txcentinfo</span> <span class="o">=</span><span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Tx</span><span class="o">.</span><span class="n">txCenter</span>
        <span class="n">rxcomp</span> <span class="o">=</span><span class="n">zonge_csamt_obj</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Rx</span><span class="o">.</span><span class="n">rxComps</span>
        <span class="c1"># create grid plot from info </span>
        <span class="n">axe_info</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">colspan</span> <span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="n">props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">([</span><span class="n">proj_name</span><span class="p">,</span>
                                    <span class="n">custumer_info</span> <span class="p">,</span> 
                                    <span class="n">contractor</span><span class="p">,</span><span class="n">acqdate</span><span class="p">,</span>
                                  <span class="n">surveyType</span><span class="p">,</span>
                                  <span class="n">surveyType</span><span class="p">,</span> 
                                  <span class="n">surveyline</span><span class="p">,</span>
                                  <span class="n">surveyazim</span> <span class="p">,</span>
                                  <span class="n">txTypeinfo</span><span class="p">,</span>
                                  <span class="n">txcentinfo</span><span class="p">,</span><span class="n">rxcomp</span>   <span class="p">]):</span> 
            
            <span class="n">axe_info</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">ii</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> 
                          <span class="s1">&#39;$</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="p">),</span> 
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span> 
                                   <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">},</span> <span class="n">fontstyle</span> <span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span> 
                          <span class="n">verticalalignment</span> <span class="o">=</span><span class="s1">&#39;center&#39;</span> <span class="p">,</span> 
                          <span class="n">bbox</span> <span class="o">=</span> <span class="n">props</span><span class="p">,</span>
                         <span class="p">)</span>
            <span class="n">axe_info</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span> <span class="c1"># let not visible axis of info </span>
            
        <span class="c1">#--------------------------figure </span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Plot curves rho, phase, E- and Hy-magnitudes&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span> 
                     <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                     <span class="n">style</span> <span class="o">=</span><span class="n">fontstyle</span><span class="p">,</span>
                     <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;moccasin&#39;</span><span class="p">))</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span> <span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">w_pad</span> <span class="o">=</span><span class="mf">1.08</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span>
                                             <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,</span> 
                                             <span class="n">orientation</span> <span class="o">=</span><span class="n">orientation</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Plot1d.plotRMS"><a class="viewcode-back" href="../../viewer.html#viewer.plot.Plot1d.plotRMS">[docs]</a>    <span class="k">def</span>  <span class="nf">plotRMS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span><span class="n">target</span> <span class="o">=</span><span class="mf">1.</span> <span class="p">,</span><span class="n">savefig</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot RMS . If occamlogfile is not available , set rms value , </span>
<span class="sd">        iteration value at each rms and|or roughness. </span>
<span class="sd">        params  : </span>
<span class="sd">            fn : str : full path to occam2D logfile </span>
<span class="sd">            savefig : str : full directory to save fig </span>
<span class="sd">            target : float : target supposed RMS to reach . Default is 1. </span>
<span class="sd">        </span>
<span class="sd">        Additionals Notes : </span>
<span class="sd">            If occam2d logfile is availbale , dont need other parameters , except </span>
<span class="sd">            the path &quot;fn&quot; and as possible the &quot;target&quot;. </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        rms :           array_like          RootMeanSquare array . </span>
<span class="sd">        iteration       int                 number of interation reached .</span>
<span class="sd">                                            iteration starts from &quot;0&quot;. so we will</span>
<span class="sd">                                            add the number provided plus 1.</span>
<span class="sd">        roughness       array_like          deGootHeldlin roughness parameters. </span>
<span class="sd">                                            number of params =Num(RMS)-1 . so we </span>
<span class="sd">                                            excluded the starting R.M.S</span>
<span class="sd">        target          float               RMS target weexpected to reach .</span>
<span class="sd">                                             Default is   1.0</span>
<span class="sd">        ============================================================================</span>
<span class="sd">        &quot;&quot;&quot;</span>
       
        <span class="n">orientation</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_orientation&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  
        <span class="n">plot_target</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span> <span class="p">(</span><span class="s1">&#39;show_target_line&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">show_grid</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;show_grid&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">occam2d_obj</span> <span class="o">=</span><span class="n">occam2d</span><span class="o">.</span><span class="n">occamLog</span><span class="p">(</span><span class="n">fn</span> <span class="o">=</span><span class="n">fn</span> <span class="p">)</span>
            <span class="n">csamt_rms_obj</span> <span class="o">=</span> <span class="n">occam2d_obj</span><span class="o">.</span><span class="n">rms</span>
            <span class="n">csamt_iteration_obj</span> <span class="o">=</span><span class="n">occam2d_obj</span><span class="o">.</span><span class="n">iteration</span> 
            <span class="n">csamt_roughness_obj</span> <span class="o">=</span><span class="n">occam2d_obj</span><span class="o">.</span><span class="n">roughness</span>
            
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;rms&#39;</span><span class="p">,</span> <span class="s1">&#39;iteration&#39;</span><span class="p">,</span> <span class="s1">&#39;roughness&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;rms&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">csamt_rms_obj</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;rms&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">csamt_iteration_obj</span><span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;rms&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;roughness&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">csamt_roughness_obj</span> <span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;roughness&#39;</span><span class="p">]</span>
           
        <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="p">[</span><span class="n">csamt_rms_obj</span><span class="p">,</span> <span class="n">csamt_iteration_obj</span> <span class="p">]:</span>
            <span class="k">if</span> <span class="n">comp</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="p">(</span>
                    <span class="s1">&#39;R.M.S and Iteration value are required for plotting.&#39;</span>\
                        <span class="s1">&#39; Can not plot &quot;None&quot; value.&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s1">&#39;Error plotting R.M.S VS Iteration. Can not plot &quot;None&quot; value.&#39;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span><span class="s1">&#39;Error Plot R.M.S . &#39;</span>\
                                             <span class="s1">&#39;Compulsory need R.M.S value and &#39;</span>\
                                                 <span class="s1">&#39;Iteration value. Please check your value. &#39;</span><span class="p">)</span>
                
        <span class="c1"># append None to roughness value for last iteration if not exists</span>
        <span class="k">if</span> <span class="n">csamt_roughness_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">csamt_roughness_obj</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">csamt_iteration_obj</span><span class="o">.</span><span class="n">size</span> <span class="p">:</span>
                <span class="n">addnum</span> <span class="o">=</span> <span class="n">csamt_iteration_obj</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">csamt_roughness_obj</span><span class="o">.</span><span class="n">size</span> 
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">addnum</span><span class="p">):</span> <span class="n">csamt_roughness_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">csamt_roughness_obj</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1">#---------------------------------------------------------------------</span>
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;image.origin&quot;</span><span class="p">]</span> <span class="o">=</span><span class="s1">&#39;upper&#39;</span> 
        <span class="k">if</span> <span class="n">orientation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">orientation</span> <span class="o">=</span> <span class="s1">&#39;landscape&#39;</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axrms</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        
        <span class="n">leghandles</span><span class="p">,</span> <span class="n">leglabels</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

        <span class="c1">#---------RMS </span>
        <span class="n">RMS_axis</span><span class="p">,</span> <span class="o">=</span> <span class="n">axrms</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">csamt_iteration_obj</span><span class="p">,</span> <span class="n">csamt_rms_obj</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                   <span class="n">ls</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ls</span> <span class="p">,</span> 
                   <span class="n">lw</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span> <span class="p">,</span> <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
                    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                    <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,)</span>
        
        <span class="n">axrms</span><span class="o">.</span><span class="n">set_xlabel</span> <span class="p">(</span><span class="s1">&#39;Iteration number&#39;</span><span class="p">,</span> <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                                  <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> 
                                                  <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span> 
                                                  <span class="p">})</span>
        <span class="n">axrms</span><span class="o">.</span><span class="n">set_ylabel</span> <span class="p">(</span><span class="s1">&#39;R.M.S&#39;</span><span class="p">,</span> <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                                  <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> 
                                                  <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span> 
                                                  <span class="p">})</span>

        <span class="n">leghandles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RMS_axis</span><span class="p">),</span> <span class="n">leglabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$R.M.S$&#39;</span><span class="p">)</span>
        <span class="n">dx</span><span class="o">=</span> <span class="n">csamt_iteration_obj</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">axrms</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">csamt_iteration_obj</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span> <span class="n">dx</span><span class="p">,</span> <span class="n">csamt_iteration_obj</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">dx</span><span class="p">)</span>
        <span class="c1">#see only tick on yaxis </span>
        <span class="n">axrms</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
        <span class="n">axrms</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        

        <span class="k">if</span> <span class="n">show_grid</span> <span class="p">:</span>
            <span class="n">axrms</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span> <span class="o">.</span><span class="mi">8</span> <span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
        
        <span class="c1">#------plotROUGHNESS </span>
        <span class="k">if</span> <span class="n">csamt_roughness_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">axrough</span> <span class="o">=</span> <span class="n">axrms</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
            
            <span class="n">ROUGH_axis</span><span class="p">,</span> <span class="o">=</span> <span class="n">axrough</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">csamt_iteration_obj</span><span class="p">,</span> <span class="n">csamt_roughness_obj</span><span class="p">,</span>
                                       <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span> <span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> 
                     <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
            <span class="n">axrough</span><span class="o">.</span><span class="n">set_ylabel</span> <span class="p">(</span><span class="s1">&#39;Roughness param. value&#39;</span><span class="p">,</span> 
                                <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                                      <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                                      <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">,</span> 
                                                      <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span> 
                                                      <span class="p">})</span>
            <span class="n">axrough</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="n">axrough</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="c1"># axrough.tick_params(axis=&#39;x&#39;, which=&#39;minor&#39;, bottom=&#39;off&#39;)</span>
            <span class="n">leghandles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ROUGH_axis</span><span class="p">),</span> <span class="n">leglabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$Roughness\ value$&#39;</span><span class="p">)</span>
        
        <span class="c1">#----PLOT TARGET</span>
        <span class="k">if</span> <span class="n">plot_target</span> <span class="p">:</span>
            
            <span class="n">marki</span><span class="p">,</span> <span class="o">=</span> <span class="n">axrms</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">csamt_iteration_obj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">target</span><span class="p">,</span>
                                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;white&#39;</span> <span class="p">,</span>
                                <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> 
                            <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                            <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                            <span class="n">markersize</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
            
            <span class="n">ytarget_</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="n">csamt_iteration_obj</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="n">TARG_axis</span><span class="p">,</span> <span class="o">=</span> <span class="n">axrms</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">csamt_iteration_obj</span><span class="p">,</span>  <span class="n">ytarget_</span><span class="p">,</span>
                                    <span class="n">ls</span> <span class="o">=</span><span class="s1">&#39;:&#39;</span> <span class="p">,</span>
                                    <span class="n">lw</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                                    <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
                       <span class="p">)</span>
            
            <span class="n">leghandles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TARG_axis</span><span class="p">),</span> <span class="n">leglabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$R.M.S\ Target$&#39;</span><span class="p">)</span>
        
        <span class="c1"># ----set LEGEND </span>
        <span class="n">axrms</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">leghandles</span><span class="p">,</span><span class="n">leglabels</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">csamt_roughness_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39; and Roughness&#39;</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;&#39;</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Plot R.M.S</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="p">),</span>
                     <span class="n">fontsize</span><span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span> 
                     <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                     <span class="n">style</span> <span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span>
                     <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span>
                                <span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;moccasin&#39;</span><span class="p">))</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span> <span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">w_pad</span> <span class="o">=</span><span class="mf">1.08</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span>
                                             <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,</span>
                                             <span class="n">orientation</span> <span class="o">=</span><span class="n">orientation</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="Plot1d.plot_station_profile"><a class="viewcode-back" href="../../viewer.html#viewer.plot.Plot1d.plot_station_profile">[docs]</a>    <span class="k">def</span> <span class="nf">plot_station_profile</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">straighten_type</span> <span class="o">=</span><span class="s1">&#39;classic&#39;</span><span class="p">,</span> 
                              <span class="n">reajust_coordinates</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">savefig</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to plot original station profile and coordinate reajustment profiles. </span>
<span class="sd">        Deal with Zonge AVG file .</span>
<span class="sd">        params : </span>
<span class="sd">            fn : full path to profile station file (Zonge Engineering station</span>
<span class="sd">                                                    profile file ). format = *.stn</span>
<span class="sd">            straighten_type : str : type of straingther profile : it may be </span>
<span class="sd">                                            &#39;classic, equisistant or distord&#39;</span>
<span class="sd">                                see Profile().straighten_profileline.__doc__</span>
<span class="sd">            reajust_coordinates : list : list of float x, y values . </span>
<span class="sd">                                        see profile.reajust_coordinates_values.__doc__ </span>
<span class="sd">        eg : </span>
<span class="sd">                &gt;&gt;&gt; path =  os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">                          &#39;csamtpy&#39;,&#39;data&#39;, &#39;avg&#39;, &#39;K1.stn&#39;)</span>
<span class="sd">                &gt;&gt;&gt; plot_1d_obj= Plot1d()</span>
<span class="sd">                ... plot_1d_obj.plot_station_profile(fn = path)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">orientation</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">)</span>
        <span class="n">alpha</span>  <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">font_style</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_style&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">fw</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">ann_stn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;annotate_stations&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">output_reajfile</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;outputfile&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="c1"># call profile _obj abd get special attribute </span>
        <span class="n">profile_obj</span> <span class="o">=</span><span class="n">Profile</span><span class="p">(</span><span class="n">profile_fn</span><span class="o">=</span> <span class="n">fn</span> <span class="p">)</span>
        <span class="n">prof_east_obj</span> <span class="o">=</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">east</span>
        <span class="n">prof_north_obj</span> <span class="o">=</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">north</span> 
        <span class="c1"># apply readjustmen </span>
        <span class="n">profile_obj</span><span class="o">.</span><span class="n">straighten_profileline</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">prof_east_obj</span><span class="p">,</span> 
                                           <span class="n">Y</span><span class="o">=</span><span class="n">prof_north_obj</span><span class="p">,</span> 
                                           <span class="n">straight_type</span><span class="o">=</span><span class="n">straighten_type</span><span class="p">,</span> 
                                           <span class="n">reajust</span><span class="o">=</span><span class="n">reajust_coordinates</span><span class="p">,</span> 
                                           <span class="n">output</span><span class="o">=</span><span class="n">output_reajfile</span><span class="p">)</span>
        <span class="n">new_prof_east_obj</span> <span class="o">=</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">east</span> 
        <span class="n">new_prof_north_obj</span> <span class="o">=</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">north</span> 
        
        <span class="c1">#get profile name though Site_obj</span>
        <span class="n">profile_obj</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">set_site_info</span><span class="p">(</span><span class="n">data_fn</span> <span class="o">=</span><span class="n">fn</span><span class="p">)</span><span class="c1">#easting =new_prof_east_obj , northing =new_prof_north_obj)</span>

        <span class="n">profile_station_names</span> <span class="o">=</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">stn_name</span>
        
        <span class="c1"># plot station </span>
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;image.origin&quot;</span><span class="p">]</span> <span class="o">=</span><span class="s1">&#39;upper&#39;</span> 
        
        <span class="n">fig</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">axe</span> <span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">mark</span><span class="p">,</span> <span class="o">=</span>  <span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prof_east_obj</span> <span class="p">,</span> <span class="n">prof_north_obj</span><span class="p">,</span>
                          <span class="n">marker</span> <span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                          <span class="n">markersize</span><span class="o">=</span> <span class="mi">3</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span> <span class="p">,</span> 
                          <span class="n">markeredgecolor</span><span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="p">)</span>
        
        <span class="n">unscalled</span><span class="p">,</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prof_east_obj</span> <span class="p">,</span> <span class="n">prof_north_obj</span><span class="p">,</span> 
                              <span class="n">lw</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span> <span class="p">,</span> 
                              <span class="n">ls</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ls</span> <span class="p">,</span> 
                              <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
                              <span class="n">c</span><span class="o">=</span><span class="s1">&#39;dimgray&#39;</span><span class="p">,</span>
                              <span class="n">markersize</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span> <span class="p">,</span> 
                              <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> 
                              <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">mark</span><span class="p">,</span> <span class="o">=</span>  <span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">new_prof_east_obj</span><span class="p">,</span> <span class="n">new_prof_north_obj</span><span class="p">,</span>
                          <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                          <span class="n">markersize</span><span class="o">=</span> <span class="mi">3</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span> <span class="p">,</span> 
                          <span class="n">markeredgecolor</span><span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">scalled</span><span class="p">,</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">new_prof_east_obj</span><span class="p">,</span> <span class="n">new_prof_north_obj</span><span class="p">,</span>
                            <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                            <span class="n">ls</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ls</span> <span class="p">,</span> 
                            <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                            <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> 
                            <span class="n">markersize</span><span class="o">=</span> <span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span> <span class="p">,</span> 
                            <span class="n">markeredgecolor</span><span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> 
                            <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">axe</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
        <span class="n">axe</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
        <span class="n">axe</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Easting(m)&#39;</span><span class="p">,</span>  <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="n">font_style</span><span class="p">,</span> 
                                                  <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">fw</span><span class="p">}</span> <span class="p">)</span>
        <span class="n">axe</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northing(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
                       <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="n">font_style</span><span class="p">,</span> 
                                                <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                                <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">fw</span><span class="p">})</span>
        <span class="c1">#annotate station</span>
        <span class="c1">#d=find dx </span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">dipole_length</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="p">,</span> <span class="n">stn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">profile_station_names</span><span class="p">)</span> <span class="p">:</span> 
            <span class="n">axe</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">stn</span><span class="p">,</span> 
                         <span class="c1">#(new_prof_east_obj[ii],new_prof_north_obj[ii]), </span>
                         <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">new_prof_east_obj</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span> <span class="n">new_prof_north_obj</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">+</span><span class="n">dx</span><span class="p">),</span> 
                         <span class="c1">#xycoords=&#39;figure points&#39;</span>
                         <span class="p">)</span>
                
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----&gt; </span><span class="si">{0}</span><span class="s1"> stations have been plotted and reajusted successfully.&#39;</span><span class="o">.</span>\
              <span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">profile_station_names</span> <span class="p">)))</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Plot stations&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span> 
                     <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                     <span class="n">style</span> <span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span>
                     <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;moccasin&#39;</span><span class="p">))</span>
        
        <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">unscalled</span><span class="p">,</span> <span class="n">scalled</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;$Unscalled$&#39;</span><span class="p">,</span> <span class="s1">&#39;$Scalled$&#39;</span><span class="p">])</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span> <span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">w_pad</span> <span class="o">=</span><span class="mf">1.08</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,</span> <span class="n">orientation</span> <span class="o">=</span><span class="n">orientation</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="Plot1d.plot_multiStations"><a class="viewcode-back" href="../../viewer.html#viewer.plot.Plot1d.plot_multiStations">[docs]</a>    <span class="k">def</span> <span class="nf">plot_multiStations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="n">path</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                           <span class="n">profile_lines</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot multisations of site sof survey area </span>
<span class="sd">        params : </span>
<span class="sd">            path : str : full path to station profile path . In the case where </span>
<span class="sd">                        Zonge avg file is provided , use `stn` profile files. Group </span>
<span class="sd">                        all `stn` file on a folder will call automatically</span>
<span class="sd">            profile_lines  : list : name of profile lines . if profile lines is NOne </span>
<span class="sd">                                will tale all `stn` profiles in the path directory </span>
<span class="sd">            X : list :  list of arrays array of X coordinates values  for each</span>
<span class="sd">                            survey line. Can be easting or Northing </span>
<span class="sd">                                    </span>
<span class="sd">            Y:  list : list of arrays  of Y coordinates values : can be easting </span>
<span class="sd">                                    or northing</span>
<span class="sd">                    ! X and Y MUST be the same length </span>
<span class="sd">            </span>
<span class="sd">                    </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">savefig</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;savefig&#39;</span><span class="p">,</span> <span class="kc">None</span> <span class="p">)</span>
        <span class="n">straigthen_out_profile</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;straigthen_out_profile&#39;</span><span class="p">,</span> <span class="kc">True</span> <span class="p">)</span>
        <span class="n">show_station_labels</span>  <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;show_station_labels&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">scale</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
        
        <span class="c1"># scalled plots </span>
        
        <span class="k">if</span> <span class="n">scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">scale</span> <span class="o">=</span><span class="s1">&#39;m&#39;</span>
        <span class="k">if</span> <span class="n">scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;m&#39;</span> <span class="p">:</span> 
            <span class="n">dz</span> <span class="o">=</span> <span class="mf">1.</span> 
        <span class="k">elif</span> <span class="n">scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;km&#39;</span><span class="p">:</span> 
            <span class="n">dz</span> <span class="o">=</span><span class="mf">1000.</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">dz</span> <span class="o">=</span><span class="mf">1.</span>
        
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="kc">None</span> <span class="p">)</span> <span class="c1"># let initalise attr </span>
        
        <span class="k">if</span> <span class="n">X</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span> 
        <span class="k">if</span> <span class="n">Y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span><span class="n">Y</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span><span class="n">path</span> 
        <span class="c1"># initialise containers  to hold eastings and northings values from all</span>
        <span class="c1"># survey lines </span>
        <span class="n">eastings</span> <span class="p">,</span> <span class="n">northings</span> <span class="p">,</span> <span class="n">profile_angles</span><span class="p">,</span> <span class="n">gstrikes</span><span class="p">,</span> <span class="n">snames</span> <span class="o">=</span><span class="p">[</span>
                                            <span class="p">[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> 
        <span class="c1"># assert len  is values are privided </span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="c1"># controle the length </span>
    
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">):</span>
                <span class="n">mess</span><span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;X and Y must have the same length.&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;The first index has length = </span><span class="si">{0}</span><span class="s1"> and the second has&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39; length = </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">])</span>
                
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">)))</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">),</span>
                                                         <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">)))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span> 
                <span class="c1">#case where user profide only one line with easting and northings </span>
                <span class="c1"># coordinates. if X and Y not on list , then put on list. </span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">]</span> <span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">]</span> 
        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span>
                <span class="s1">&#39;Reading Zonge Engeneering `station profile` file !&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">profile_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="c1"># create fle fn to read </span>
                <span class="n">profiles_path</span> <span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="p">,</span> <span class="n">file</span><span class="p">)</span> 
                                <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">profile_lines</span><span class="p">]</span>
                <span class="n">profile_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">profile_lines</span><span class="p">]</span>
            <span class="k">else</span> <span class="p">:</span> <span class="c1"># take all profile in path directory </span>
                <span class="n">profiles_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span>
                                 <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> 
                                 <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span> <span class="p">(</span><span class="s1">&#39;.stn&#39;</span><span class="p">)]</span> <span class="c1"># ckeck when</span>
                <span class="n">profile_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">pathfile</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span>
                                 <span class="n">pathfile</span> <span class="ow">in</span> <span class="n">profiles_path</span><span class="p">]</span> <span class="c1"># keep </span>
                                        <span class="c1">#the name of profile </span>
   
            <span class="c1"># pfofiles are Stn files </span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">profiles_path</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> 
                <span class="n">msg</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
                    <span class="s1">&#39;No `.stn` profiles found . Please check your right path !&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;or provide  X and Y as lists of coordinates values.&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_profile</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; </span><span class="si">{0:02}</span><span class="s1"> *station profiles* detected !&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                            <span class="nb">len</span><span class="p">(</span><span class="n">profiles_path</span><span class="p">)))</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">profiles_path</span> <span class="p">:</span> 
                <span class="n">profile_obj</span>  <span class="o">=</span> <span class="n">Profile</span><span class="p">(</span> <span class="n">profile_fn</span><span class="o">=</span><span class="n">file</span><span class="p">)</span> 
                <span class="k">if</span> <span class="n">straigthen_out_profile</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
                    <span class="n">profile_obj</span><span class="o">.</span><span class="n">straighten_profileline</span><span class="p">()</span> <span class="c1">#straighen out profile </span>
                    
                <span class="n">profile_obj</span><span class="o">.</span><span class="n">get_profile_angle</span><span class="p">()</span>
                <span class="c1"># gstks, pangs, _= geostrike.compute_geoelectric_strike(easting =profile_obj.east,</span>
                <span class="c1">#                                       northing = profile_obj.north)</span>
                <span class="c1"># now get value reajusted : </span>
                <span class="n">eastings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">east</span><span class="p">)</span>
                <span class="n">northings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">north</span><span class="p">)</span>
                <span class="n">profile_angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">profile_angle</span><span class="p">)</span>
                <span class="n">gstrikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">geoelectric_strike</span><span class="p">)</span>
        
                <span class="c1"># get site names</span>
                <span class="n">profile_obj</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">stn_name</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">east</span><span class="p">)</span>
                <span class="n">snames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">stn_name</span><span class="p">)</span>
                
                
            <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span><span class="n">eastings</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span><span class="n">northings</span>
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">profile_obj</span> <span class="o">=</span><span class="n">Profile</span><span class="p">()</span>
            <span class="k">for</span>  <span class="n">ii</span><span class="p">,</span> <span class="n">slen</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span> <span class="p">:</span> 
                <span class="n">profile_obj</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">stn_name</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">slen</span><span class="p">)</span> <span class="c1"># build sitenames </span>
                <span class="n">snames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">stn_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">straigthen_out_profile</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># ccompute profile angle and </span>
                                                    <span class="c1">#strike angle </span>
                    <span class="n">pangles</span><span class="p">,</span> <span class="n">strikes</span> <span class="o">=</span> <span class="n">profile_obj</span><span class="o">.</span><span class="n">get_profile_angle</span><span class="p">(</span>
                                                    <span class="n">easting</span> <span class="o">=</span><span class="n">slen</span><span class="p">,</span> 
                                                   <span class="n">northing</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span> 
                                                                                
                    <span class="n">gstrikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">strikes</span><span class="p">)</span>
                    <span class="n">profile_angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pangles</span><span class="p">)</span>
                    
            <span class="n">profile_lines</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;line_</span><span class="si">{0:02}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">))]</span>
                    
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; </span><span class="si">{0:02}</span><span class="s1"> * survey* lines read !&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)))</span>
                    
        
        <span class="c1"># ------------------------DECLARE FIGURE AND PROPERTIES --------------</span>
        
        <span class="c1"># statement of figures </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,)</span> 
        <span class="c1"># plt.clf()</span>
        <span class="c1"># add a subplot to the figure with the specified aspect ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span> <span class="o">=</span><span class="s1">&#39;auto&#39;</span>
                <span class="c1">#--- using window rose to plot diagramm ------- </span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ======================================================================</span>
<span class="sd">        For the future plan : ADDED rose diagram from strikes angles   </span>
<span class="sd">        computation from all `edi` , `avg` or `j` files . Rose Diagram plot </span>
<span class="sd">        actually doesnt work , consequently we gonna plot windrose to False. </span>
<span class="sd">        because when  we use windrose , it does not give exactly what we expect</span>
<span class="sd">        to get . We intend for the future plan add this section of Rose diagram </span>
<span class="sd">        plot. </span>
<span class="sd">        ======================================================================</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">windrose_import</span> <span class="o">=</span> <span class="kc">False</span>             <span class="c1"># windrose_import BLOCKED to FALSE </span>
        <span class="k">if</span> <span class="n">windrose_import</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="n">gs</span><span class="o">=</span><span class="n">gspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figure</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
            
            <span class="n">axeProfiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="c1">#****Future plan **** </span>
            <span class="n">axeStrikes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> 

            <span class="n">axeProfiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
 
        
        <span class="c1"># get min max for easting and northing profile</span>
    
        <span class="n">Xmin</span><span class="p">,</span> <span class="n">Xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">Ymin</span><span class="p">,</span> <span class="n">Ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="p">(</span><span class="n">east</span><span class="p">,</span> <span class="n">north</span><span class="p">)</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">)):</span>
            
            <span class="k">if</span> <span class="n">east</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">Xmin</span> <span class="p">:</span> 
                <span class="n">Xmin</span> <span class="o">=</span> <span class="n">east</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">east</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">Xmax</span> <span class="p">:</span> 
                <span class="n">Xmax</span> <span class="o">=</span> <span class="n">east</span><span class="o">.</span><span class="n">max</span> <span class="p">()</span>
            <span class="k">if</span> <span class="n">north</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">Ymin</span> <span class="p">:</span> 
                <span class="n">Ymin</span> <span class="o">=</span> <span class="n">north</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">north</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">&gt;</span> <span class="n">Ymax</span><span class="p">:</span> 
                <span class="n">Ymax</span> <span class="o">=</span> <span class="n">north</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span> <span class="o">=</span>  <span class="p">(</span><span class="n">Xmin</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span> <span class="n">Xmax</span><span class="o">/</span><span class="n">dz</span> <span class="p">),</span> <span class="p">(</span><span class="n">Ymin</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span> <span class="n">Ymax</span><span class="o">/</span><span class="n">dz</span> <span class="p">)</span>
        
        <span class="c1"># -------------------------------------------------------------------</span>
        <span class="n">leghandles</span><span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)):</span> 
            
            <span class="n">mark</span><span class="p">,</span> <span class="o">=</span>  <span class="n">axeProfiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="n">dz</span> <span class="p">,</span> 
                                      <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="n">dz</span> <span class="p">,</span>
                          <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span> <span class="p">,</span> 
                          <span class="n">c</span><span class="o">=</span> <span class="s1">&#39;white&#39;</span> <span class="p">,</span> 
                          <span class="n">markersize</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">/</span><span class="mi">2</span> <span class="p">,</span> 
                          <span class="n">markeredgecolor</span><span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="p">)</span>

            <span class="n">scalled</span><span class="p">,</span> <span class="o">=</span><span class="n">axeProfiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="n">dz</span> <span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="n">dz</span> <span class="p">,</span>
                                <span class="n">lw</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                                <span class="n">ls</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ls</span> <span class="p">,</span> 
                                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> 
                                <span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">/</span><span class="mi">3</span> <span class="p">,</span> 
                                <span class="n">markeredgecolor</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">markeredgecolor</span> <span class="p">,</span> 
                                <span class="n">markerfacecolor</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">markerfacecolor</span><span class="p">,</span>
                                <span class="p">)</span>
            
            <span class="n">leghandles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scalled</span><span class="p">)</span>
            
            <span class="c1">#annotate station</span>
            
            <span class="k">if</span> <span class="n">show_station_labels</span>  <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span> 
                <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">profile_obj</span><span class="o">.</span><span class="n">dipole_length</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="c1"># get label closet to the point </span>
                <span class="c1"># dx = profile_obj.dipole_length*2</span>
    
                <span class="k">for</span> <span class="n">jj</span> <span class="p">,</span> <span class="n">stn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snames</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span> <span class="p">:</span> 
                    <span class="n">axeProfiles</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">stn</span><span class="p">,</span>  
                                 <span class="n">xy</span><span class="o">=</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">dx</span><span class="p">)</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">dx</span><span class="p">)</span><span class="o">/</span><span class="n">dz</span><span class="p">),</span> 
                                 <span class="c1">#xycoords=&#39;figure points&#39;</span>
                                 <span class="n">fontsize</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span> 
                                 
                                 <span class="p">)</span>
                    
        <span class="n">axeProfiles</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
        <span class="n">axeProfiles</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                         <span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
        <span class="n">axeProfiles</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Easting(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scale</span><span class="p">),</span>
                               <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> 
                                          <span class="s1">&#39;size&#39;</span><span class="p">:</span>  <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                          <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">}</span> <span class="p">)</span>
        <span class="n">axeProfiles</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northing(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scale</span><span class="p">),</span>
                       <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> 
                                  <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontweight</span><span class="p">})</span>
        
        <span class="c1">#reduce the number of X ad Y  ticks density </span>
        <span class="n">tick_spacing</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">2000.</span><span class="o">/</span><span class="n">dz</span><span class="p">)</span>  
        <span class="n">xticks</span> <span class="o">=</span> <span class="n">axeProfiles</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()</span>
        <span class="n">yticks</span> <span class="o">=</span><span class="n">axeProfiles</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()</span>
        
        <span class="n">axeProfiles</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">[::</span><span class="n">tick_spacing</span><span class="p">])</span>
        <span class="n">axeProfiles</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yticks</span><span class="p">[::</span><span class="n">tick_spacing</span><span class="p">])</span>
        <span class="n">axeProfiles</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> 
                                <span class="n">labelsize</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> 
                                 <span class="n">labelrotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span>
        <span class="n">axeProfiles</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> 
                                <span class="n">labelsize</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> 
                                 <span class="p">)</span>
    
        
                
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ========================================================================</span>
<span class="sd">        We abondonned idea to add Rose diagram from Windrose . We try to use  </span>
<span class="sd">        polar projection . Idea is to plot simultaneousthe profile angles as </span>
<span class="sd">        well as the strike angles of all `edi`, `avg` or `j` files. To succeed </span>
<span class="sd">        to plot , we need to recomputed , impedance `tensor Z`  so to get for </span>
<span class="sd">        each edi files an appropriate strike values. In addition for CSAMT, it&#39;s&#39; </span>
<span class="sd">        usefull sometimes to get Eyx component from Exy if strike angle is known. </span>
<span class="sd">        In that case we need  to rotate strike angle so to get the next component.</span>
<span class="sd">        Plot `strike ` without asertaining  whether data are rotated on site or  </span>
<span class="sd">        not, should  yield  a miscomputation.Therefore  we keep keep implementation </span>
<span class="sd">        of strike angle  for next realease. we expect to combine , `strike angles`</span>
<span class="sd">        , `profile azimuths` on the same polar  plot to let user cleary appreciate</span>
<span class="sd">        the results. Thus interpretations will  get an accuracies.</span>
<span class="sd">        It would be a `future plan `. </span>


<span class="sd">        ----------- FUTURE PLAN ----------------------</span>
<span class="sd">        # get plot the station angles and profiles </span>
<span class="sd">        # ax = fig.add_subplot(122, projection=&#39;polar&#39;)</span>
<span class="sd">        #Calculate the number of directions (strikes) every 10Â° using </span>
<span class="sd">        numpy.histogram.</span>

<span class="sd">        if windrose_import ==True : </span>
<span class="sd">            ws =np.deg2rad(np.array(profile_angles) )</span>
<span class="sd">            wd= np.deg2rad(np.array(gstrikes))</span>
<span class="sd">            # ws = np.random.random(500) * 6</span>
<span class="sd">            # wd = np.random.random(500) * 360</span>
<span class="sd">            # self.fig.add_subplot(gs[0,1] , projection=&#39;polar&#39; )</span>
<span class="sd">            # ax = WindroseAxes.from_ax(self.fig.add_subplot(gs[0,1]), </span>
<span class="sd">            #                           fig = self.fig, </span>
<span class="sd">            #                                    theta_labels=np.array([</span>
<span class="sd">                                                            &#39;{0}Â°&#39;.format(nn)</span>
<span class="sd">            #                                              for nn in</span>
<span class="sd">                                                            np.arange(0,</span>
<span class="sd">            #                                                         360,</span>
<span class="sd">            #                                                          10)]), </span>
<span class="sd">                    </span>
<span class="sd">            #                                   )</span>
<span class="sd">            # ax.bar(wd, ws,</span>
<span class="sd">            #                 normed=True, </span>
<span class="sd">            #                 opening=0.8,</span>
<span class="sd">            #                 edgecolor=&#39;white&#39;)</span>
<span class="sd">            </span>
<span class="sd">        # elif  windrose_import is False : </span>
<span class="sd">            # ax.set_legend()</span>
<span class="sd">            # bin_edges = np.arange(-5, 366, 10)</span>
<span class="sd">            # number_of_strikes, bin_edges = np.histogram(np.array(gstrikes), </span>
<span class="sd">                                                bin_edges)</span>
<span class="sd">            # # the last value with the first value.</span>
<span class="sd">            # number_of_strikes[0] += number_of_strikes[-1]</span>
<span class="sd">            # #Sum the first half 0-180Â° with the second half 180-360Â°</span>
<span class="sd">            to achieve the </span>
<span class="sd">            # #&quot;mirrored behavior&quot; of Rose Diagrams.</span>
<span class="sd">            # half = np.sum(np.split(number_of_strikes[:-1], 2), 0)</span>


<span class="sd">            axeStrikes.bar(np.deg2rad(np.linspace(0, 360, len(gstrikes))),</span>
<span class="sd">                           np.deg2rad(np.array(gstrikes)), </span>
<span class="sd">                           width=np.deg2rad(10),</span>
<span class="sd">                           bottom=0.0, </span>
<span class="sd">                           color=&#39;.8&#39;,</span>
<span class="sd">                           edgecolor=&#39;k&#39;)</span>
<span class="sd">            axeStrikes.set_theta_zero_location(&#39;N&#39;)</span>
<span class="sd">            axeStrikes.set_theta_direction(-1)</span>
<span class="sd">            axeStrikes.set_rticks(np.deg2rad(np.array(gstrikes)))</span>
<span class="sd">            axeStrikes.set_thetagrids(np.arange(0, 360, 30), </span>
<span class="sd">                                      labels=np.array([&#39;{0}Â°&#39;.format(nn)</span>
<span class="sd">                                                       for nn in</span>
<span class="sd">                                                       np.arange(0,</span>
<span class="sd">                                                                 360,</span>
<span class="sd">                                                                 10)]))</span>
<span class="sd">            axeStrikes.set_rgrids(np.arange(1, </span>
<span class="sd">                                np.deg2rad(np.array(gstrikes)).max() + 1, 2), </span>
<span class="sd">                                  angle=0,</span>
<span class="sd">                                  weight= &#39;black&#39;)</span>

<span class="sd">  </span>
<span class="sd">        axeStrikes.set_title(&#39;Rose Diagram of the &quot;profiles angles&quot;&#39;,</span>
<span class="sd">                             y=1.10,</span>
<span class="sd">                             fontsize = self.font_size, </span>
<span class="sd">                             va =&#39;bottom&#39;)</span>
<span class="sd">        axeStrikes.grid(True)        </span>

<span class="sd">        =======================================================================</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">show_station_labels</span><span class="p">:</span> <span class="c1"># add profiles labels </span>
        
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">profile_lines</span><span class="p">)</span> <span class="p">:</span> 
     
                <span class="n">axeProfiles</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span><span class="n">dx</span><span class="p">)</span><span class="o">/</span><span class="n">dz</span>  <span class="p">,</span>
                            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="mi">00</span><span class="p">]</span><span class="o">+</span><span class="n">dx</span><span class="p">)</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span>
                            <span class="n">s</span><span class="o">=</span> <span class="n">name</span><span class="p">,</span>
                            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                            <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> 
                                      <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">},</span>
                            <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span>
                                       <span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;rosybrown&#39;</span><span class="p">,</span> 
                                       <span class="n">alpha</span> <span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=.</span><span class="mi">2</span><span class="p">,</span> 
                                       <span class="p">)</span>
                            <span class="p">)</span>

        <span class="c1"># axeProfiles.set_title(&#39; Survey lines of the area&#39;,</span>
        <span class="c1">#                      y=1.10,</span>
        <span class="c1">#                      fontsize = </span>
        <span class="c1">#                      self.font_size, </span>
        <span class="c1">#                      va =&#39;bottom&#39;, </span>
        <span class="c1">#                      fontstyle = self.font_style, </span>
        <span class="c1">#                      fontweight = self.fontweight</span>
        <span class="c1">#                      )</span>

        
        <span class="n">profile_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">name</span> <span class="p">,</span> <span class="s1">&#39;:Azim =</span><span class="si">{0}</span><span class="s1"> Â°&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">angle</span><span class="p">)]))</span> 
                         <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">angle</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">profile_lines</span><span class="p">,</span> <span class="n">profile_angles</span><span class="p">)]</span>
                      
        <span class="n">axeProfiles</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">leghandles</span><span class="p">,</span> <span class="n">profile_lines</span><span class="p">,</span>
                           <span class="n">prop</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> 
                                <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> 
                                <span class="p">})</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----&gt; </span><span class="si">{0}</span><span class="s1"> stations plotted successfully.&#39;</span><span class="o">.</span>\
              <span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snames</span> <span class="p">)))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Plot </span><span class="si">{0:02}</span><span class="s1"> survey lines&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)),</span>
                      <span class="n">fontsize</span><span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span> 
                      <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                      <span class="n">style</span> <span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span>
                      <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;moccasin&#39;</span><span class="p">),</span> 
                      <span class="n">y</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        
        
        <span class="c1"># plt.tight_layout()</span>
        
        <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,</span> 
                                                 <span class="c1"># orientation =orientation</span>
                                                 <span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>
  
        
<div class="viewcode-block" id="Plot2d"><a class="viewcode-back" href="../../viewer.html#viewer.plot.Plot2d">[docs]</a><span class="k">class</span> <span class="nc">Plot2d</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    class to plot 2D map  : Deal with all 2D plots</span>
<span class="sd">    ======================= ===============================================</span>
<span class="sd">    keywords                description</span>
<span class="sd">    ======================= ===============================================</span>
<span class="sd">    cb_pad                  padding between axes edge and color bar </span>
<span class="sd">    cb_shrink               percentage to shrink the color bar</span>
<span class="sd">    climits                 limits of the color scale for resistivity</span>
<span class="sd">                            in log scale (min, max)</span>
<span class="sd">    cmap                    name of color map for resistivity values</span>
<span class="sd">    fig_aspect              aspect ratio between width and height of </span>
<span class="sd">                            resistivity image. 1 for equal axes</span>
<span class="sd">    fig_dpi                 resolution of figure in dots-per-inch</span>
<span class="sd">    fig_num                 number of figure instance</span>
<span class="sd">    fig_size                size of figure in inches (width, height)</span>
<span class="sd">    font_size               size of axes tick labels, axes labels is +2</span>
<span class="sd">    grid                    [ &#39;both&#39; | &#39;major&#39; |&#39;minor&#39; | None ] string </span>
<span class="sd">                            to tell the program to make a grid on the </span>
<span class="sd">                            specified axes.</span>
<span class="sd">    ms                      size of station marker </span>
<span class="sd">    plot_yn                 [ &#39;y&#39; | &#39;n&#39;]</span>
<span class="sd">                            &#39;y&#39; --&gt; to plot on instantiation</span>
<span class="sd">                            &#39;n&#39; --&gt; to not plot on instantiation</span>
<span class="sd">    station_color           color of station marker</span>
<span class="sd">    station_font_color      color station label</span>
<span class="sd">    station_font_pad        padding between station label and marker</span>
<span class="sd">    station_font_rotation   angle of station label in degrees 0 is </span>
<span class="sd">                            horizontal</span>
<span class="sd">    station_font_size       font size of station label</span>
<span class="sd">    station_font_weight     font weight of station label</span>
<span class="sd">    station_id              index to take station label from station name</span>
<span class="sd">    station_marker          station marker.  if inputing a LaTex marker</span>
<span class="sd">                            be sure to input as r&quot;LaTexMarker&quot; otherwise</span>
<span class="sd">                            might not plot properly</span>
<span class="sd">    title                   title of plot.  If None then the name of the</span>
<span class="sd">                            iteration file and containing folder will be</span>
<span class="sd">                            the title with RMS and Roughness.</span>
<span class="sd">    xlimits                 limits of plot in x-direction in (km) </span>
<span class="sd">    xminorticks             increment of minor ticks in x direction</span>
<span class="sd">    xpad                    padding in x-direction in km</span>
<span class="sd">    ylimits                 depth limits of plot positive down (km)</span>
<span class="sd">    yminorticks             increment of minor ticks in y-direction</span>
<span class="sd">    ypad                    padding in negative y-direction (km)</span>
<span class="sd">    yscale                  [ &#39;km&#39; | &#39;m&#39; ] scale of plot, if &#39;m&#39; everything</span>
<span class="sd">                            will be scaled accordingly.</span>
<span class="sd">    ======================= ===============================================</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span> 
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">=</span> <span class="n">csamtpylog</span><span class="o">.</span><span class="n">get_csamtpy_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_num&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_aspect&#39;</span><span class="p">,</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_dpi&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_size&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">aspect</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;aspect&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_style&#39;</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orient</span><span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">)</span>
        
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_style</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_style&#39;</span><span class="p">,</span> <span class="s1">&#39;imshow&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imshow_interp</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;imshow_interp&#39;</span><span class="p">,</span> <span class="s1">&#39;bicubic&#39;</span><span class="p">)</span>

        <span class="c1">#--&gt; set plot limits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;res_limits&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;phase_limits&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;fig_title&#39;</span><span class="p">,</span> <span class="s1">&#39;xlimits&#39;</span><span class="p">,</span> <span class="s1">&#39;ylimits&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span> <span class="p">)</span>
        
        <span class="c1">#--&gt; set colorbar properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cb_pad</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cb_pad&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">0375</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cb_orientation</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cb_orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cb_shrink</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cb_shrink&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cb_position</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cb_position&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">climits</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;climits&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="c1">#--&gt; set text box parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_location</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_location&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_xpad</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_xpad&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">95</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_ypad</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_ypad&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">95</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_size&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_weight</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">station_label_rotation</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;station_label_rotation&#39;</span><span class="p">,</span><span class="mi">45</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_grid</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;show_grid&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="c1"># set makers properties</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">marker</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ls</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lc</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lc&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markeredgecolor</span><span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markeredgecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markerfacecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ms</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lw</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lw&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="c1">#------ticks parameters ------------------</span>
        <span class="c1"># self.ticks_label_rotation = kws.pop(&#39;ticks_rotation&#39;,45)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fw</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth_scale</span><span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;depth_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
        
        <span class="c1"># set some figure properties to make plot occam </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">station_offsets</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">station_id</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;station_id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
  
        <span class="bp">self</span><span class="o">.</span><span class="n">station_font_size</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;station_font_size&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">station_font_pad</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;station_font_pad&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">station_font_weight</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;station_font_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
  
        <span class="bp">self</span><span class="o">.</span><span class="n">station_font_color</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;station_font_color&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">station_marker</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;station_marker&#39;</span><span class="p">,</span>
                                         <span class="sa">r</span><span class="s2">&quot;$\blacktriangledown$&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">station_color</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;station_color&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xpad</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xpad&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ypad</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ypad&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">xminorticks</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xminorticks&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yminorticks</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;yminorticks&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="s1">&#39;jet_r&#39;</span><span class="p">)</span>



        <span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kws</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> 
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">kws</span><span class="p">[</span><span class="n">keys</span><span class="p">])</span>
            
    <span class="k">def</span> <span class="nf">penetration2D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">profile_fn</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                      <span class="n">savefig</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span> <span class="s1">&#39;2km&#39;</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        plot penetration 2D </span>
<span class="sd">        params : </span>
<span class="sd">            fn : str : full path to [EDI|AVG|J] files. </span>
<span class="sd">            doi : float : depth assumed to be imaged : default is 2000m </span>
<span class="sd">                            For  CSAMT , 2km is enought to have more info about near surface.</span>
<span class="sd">                            ** Default** unit is &quot;m&quot;. 2--&gt; 2km </span>
<span class="sd">                            </span>
<span class="sd">            profile_fn : str : full path to profile *stn file </span>
<span class="sd">            savefig : str : outdir </span>
<span class="sd">            </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        params             Default                   Description </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        plot_style         str              [pycolormesh|imshow] </span>
<span class="sd">                                            Default is *pcolormesh</span>
<span class="sd">                                            *Default is .7 : eg ms =9*fs</span>
<span class="sd">        cm                  str             mpl.colormap .Default is &quot;Purples&quot;.</span>
<span class="sd">        rename_station     list             can set new_stationname. </span>
<span class="sd">        ==========================================================================</span>
<span class="sd">        eg:: </span>
<span class="sd">                    &gt;&gt;&gt; path =  os.path.join(os.environ[&quot;pyCSAMT&quot;], </span>
<span class="sd">                          &#39;csamtpy&#39;,&#39;data&#39;, K1.AVG)</span>
<span class="sd">                    &gt;&gt;&gt; plot2d_obj = plot2d()</span>
<span class="sd">                    ... plot2d_obj.penetration2D(fn = path, </span>
<span class="sd">                                            profile_fn=os.path.join(os.path.dirname(path), </span>
<span class="sd">                                                                    &#39;K1.stn&#39;) ,</span>
<span class="sd">                                             plot_style=&#39;imshow&#39;,  doi=&#39;10000m&#39;)</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Contructing 2D penetration depth&#39;</span><span class="p">)</span>
        
        <span class="n">stnnames</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rename_station&#39;</span><span class="p">,</span> <span class="kc">None</span> <span class="p">)</span>
        <span class="n">plot_style</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_style&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">alpha</span><span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">mplcmap</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">,</span> <span class="s1">&#39;twilight&#39;</span><span class="p">)</span>
        
        <span class="c1">#-----define csmat_obj_ </span>
        <span class="n">csamt_obj</span> <span class="o">=</span> <span class="n">CSAMT</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span> <span class="n">fn</span> <span class="p">,</span> <span class="n">profile_fn</span><span class="o">=</span><span class="n">profile_fn</span> <span class="p">)</span>
        <span class="n">csamt_dep1D_obj</span> <span class="o">=</span> <span class="n">csamt_obj</span><span class="o">.</span><span class="n">skindepth</span> 
        <span class="n">csamt_freq_obj</span> <span class="o">=</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">freq</span> 
        <span class="n">csamt_stnDis_obj</span> <span class="o">=</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">station_distance</span>
        <span class="n">csamt_stn_obj</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">skindepth</span> <span class="o">.</span><span class="n">keys</span><span class="p">()))</span>       <span class="c1"># get station id name :</span>

            
        <span class="k">if</span> <span class="n">stnnames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">stnnames</span> <span class="p">)</span> <span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">csamt_stn_obj</span><span class="p">),</span>\
                <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_station</span><span class="p">(</span><span class="s1">&#39;Station provided must have the &#39;</span>\
                                          <span class="s1">&#39;same lenght with default stations.&#39;</span><span class="p">)</span>
            <span class="n">csamt_stn_obj</span> <span class="o">=</span> <span class="n">stnnames</span> 
            

        <span class="k">def</span> <span class="nf">depth2D</span> <span class="p">(</span><span class="n">dep_loc</span><span class="p">,</span>  <span class="n">freq_obj</span><span class="p">,</span> <span class="n">doi</span> <span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Build matrix freq* nstation from 1D skin depth and return use station </span>
<span class="sd">            params : dep_loc : dict : obj to get create matrix . from all station </span>
<span class="sd">                    freq_obj : ndarray, 1 : freqyency array </span>
<span class="sd">                    doi : int : limit of investigation depth . </span>
<span class="sd">                retun cutoff matrix fonction to depth investigation . </span>
<span class="sd">                </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">dep2D_GRID_obj</span>  <span class="o">=</span>  <span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span>
                <span class="n">list_of_array</span><span class="o">=</span> <span class="p">[</span><span class="n">values</span> <span class="k">for</span> <span class="n">keys</span> <span class="p">,</span>
                                <span class="n">values</span>  <span class="ow">in</span> <span class="n">dep_loc</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> 
                                 <span class="n">concat_axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
             <span class="c1">#flip frequency if it is ranged lower to higher</span>
            <span class="k">if</span> <span class="n">freq_obj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">csamt_freq_obj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> 
                <span class="n">freq_obj</span> <span class="o">==</span><span class="n">freq_obj</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">dep2D_GRID_obj</span> <span class="o">=</span> <span class="n">dep2D_GRID_obj</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
 
            <span class="k">return</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">slice_matrix</span><span class="p">(</span><span class="n">base_matrix</span> <span class="o">=</span> <span class="n">dep2D_GRID_obj</span> <span class="p">,</span> 
                                        <span class="n">freq_array</span><span class="o">=</span><span class="n">freq_obj</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="n">doi</span><span class="p">)</span>
    
        <span class="c1"># select the convenient plages of data  to explore</span>
        <span class="n">dep2D_GRID_obj</span> <span class="p">,</span> <span class="n">csamt_freq_obj</span><span class="p">,</span>  <span class="n">doi</span> <span class="o">=</span> <span class="n">depth2D</span><span class="p">(</span><span class="n">dep_loc</span> <span class="o">=</span><span class="n">csamt_dep1D_obj</span><span class="p">,</span>
                                                        <span class="n">doi</span> <span class="o">=</span> <span class="n">doi</span><span class="p">,</span> 
                                                        <span class="n">freq_obj</span><span class="o">=</span><span class="n">csamt_freq_obj</span><span class="p">)</span>
        

        <span class="c1">#---------------------plotfeatures ---------------</span>
        <span class="k">if</span> <span class="n">plot_style</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plot_style</span> <span class="o">=</span> <span class="s1">&#39;pcolormesh&#39;</span>
        
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;image.origin&quot;</span><span class="p">]</span> <span class="o">=</span><span class="s1">&#39;upper&#39;</span> 
        
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">mplcmap</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        
        <span class="c1">#--- create meshgrig obj plot with pcolor mesh  ------------------------</span>
        <span class="k">if</span> <span class="n">plot_style</span> <span class="o">==</span><span class="s1">&#39;pcolormesh&#39;</span><span class="p">:</span> 
            <span class="n">ydepth</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                <span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1"># ydepth = -1* ydepth </span>
              
            
            <span class="n">xxDepth</span><span class="p">,</span>  <span class="n">yyDepth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">csamt_stnDis_obj</span> <span class="p">,</span> <span class="n">ydepth</span> <span class="p">)</span>
            <span class="n">cf</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xxDepth</span><span class="p">,</span>
                                <span class="n">yyDepth</span><span class="p">,</span>
                                <span class="n">dep2D_GRID_obj</span> <span class="p">,</span>  
                                <span class="n">vmax</span><span class="o">=</span><span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                <span class="n">vmin</span><span class="o">=</span> <span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="n">shading</span> <span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> 
                                <span class="n">cmap</span><span class="o">=</span> <span class="n">cmap</span><span class="p">,</span>


                                <span class="p">)</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
            <span class="c1">#ressetting yticks </span>
            <span class="n">axs</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">mplotus</span><span class="o">.</span><span class="n">resetting_ticks</span><span class="p">(</span><span class="n">get_xyticks</span><span class="o">=</span><span class="n">axs</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()))</span>


            <span class="c1"># cb.set_label(&#39;$Depth\ in\ {0}eters$&#39;.format(depth_scale),</span>
            <span class="c1">#               fontdict={&#39;size&#39;: 2* self.font_size})</span>
            
            <span class="n">axs</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance(m)&#39;</span><span class="p">,</span>  <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> 
                                                      <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                                      <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">}</span>
                                                                            <span class="p">)</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Penetration depth(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
                           <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> 
                                                    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                                    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">})</span>
            <span class="c1"># axs.set_yscale (&#39;log&#39;,  nonposy=&#39;clip&#39;)</span>
            

        <span class="k">if</span> <span class="n">plot_style</span> <span class="o">==</span><span class="s1">&#39;imshow&#39;</span><span class="p">:</span> 
            <span class="n">cf</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span> <span class="n">dep2D_GRID_obj</span> <span class="p">,</span>
                                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                <span class="n">vmax</span><span class="o">=</span><span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                <span class="n">vmin</span><span class="o">=</span> <span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="n">interpolation</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imshow_interp</span><span class="p">,</span>
                                <span class="n">aspect</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aspect</span><span class="p">,</span> 
                                <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> 
                                <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">csamt_stnDis_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                        <span class="n">csamt_stnDis_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                        <span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                        <span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span>
                                <span class="p">)</span>

            <span class="c1">#               fontdict={&#39;size&#39;: 2* self.font_size,})</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance(m)&#39;</span><span class="p">,</span>  <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> 
                                                      <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                                      <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">}</span>
                                                                            <span class="p">)</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Penetration depth(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
                           <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> 
                                                    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                                    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">})</span>
        <span class="c1">#set color bar properties </span>

        <span class="n">cbarmin</span> <span class="o">=</span> <span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">cbarmax</span> <span class="o">=</span> <span class="n">dep2D_GRID_obj</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">cbound</span> <span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">resetting_colorbar_bound</span><span class="p">(</span><span class="n">cbmax</span> <span class="o">=</span><span class="n">cbarmax</span><span class="p">,</span> <span class="n">cbmin</span> <span class="o">=</span><span class="n">cbarmin</span><span class="p">)</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span> <span class="p">,</span> <span class="n">ax</span><span class="o">=</span> <span class="n">axs</span><span class="p">)</span>
        <span class="c1"># mplcb.ColorbarBase(ax=axs, cmap=cmap , </span>
        <span class="c1">#                     norm =mpl.colors.Normalize(vmin=cbarmin, </span>
        <span class="c1">#                                                 vmax =cbarmax ), </span>
        <span class="c1">#                               orientation =self.cb_orientation, </span>
        <span class="c1">#                               spacing =&#39;uniform&#39;, </span>
        <span class="c1">#                         )</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">cbound</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ff</span><span class="p">))</span> <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">cbound</span><span class="p">],</span> <span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">2.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$Depth\ in\ </span><span class="si">{0}</span><span class="s1">eters$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,})</span>
        
        
        <span class="c1">#--&gt; set second axis </span>
        <span class="n">axe2</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span> 
        <span class="n">axe2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span> <span class="n">csamt_stnDis_obj</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span>  <span class="p">)</span>
        <span class="n">axe2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">csamt_stn_obj</span> <span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">station_label_rotation</span><span class="p">)</span>
        <span class="n">axe2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;stations&#39;</span><span class="p">,</span> <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> 
                                                <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                                <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">},</span> <span class="p">)</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Plot Penetration depth&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span> <span class="mi">15</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> 
                     <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                             <span class="n">style</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span>
                             <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;moccasin&#39;</span><span class="p">))</span>
            
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span> <span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">w_pad</span> <span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mf">1.08</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> 
                                             <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,</span>
                                             <span class="n">orientation</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orient</span><span class="p">)</span>
        
        
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">pseudocrossResPhase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span> <span class="p">,</span> <span class="n">profile_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span>
                            <span class="n">savefig</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        plot Pseudocrossection of resistivity and phase </span>
<span class="sd">        params : fn :str : full path to [AVG\EDI\J] file . </span>
<span class="sd">                profile_fn :str : full path to profile station file  in the case fn </span>
<span class="sd">                                    is *AVG. </span>
<span class="sd">                savefig : str : path to save figure </span>
<span class="sd">                </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">controle_delineate_curve</span><span class="p">(</span><span class="n">res_deline</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">phase_deline</span> <span class="o">=</span><span class="kc">None</span> <span class="p">):</span> 
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            fonction to controle delineate value given  and return value ceilling . </span>
<span class="sd">            params : res_deline|phase_deline : float|int|list  : resistiviry or phase value to</span>
<span class="sd">                                                delineate. </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">fmt</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;resistivity, phase&#39;</span><span class="p">]</span>
 
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">xx_deline</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">res_deline</span> <span class="p">,</span> <span class="n">phase_deline</span><span class="p">]):</span> 
                <span class="k">if</span> <span class="n">xx_deline</span> <span class="ow">is</span>  <span class="ow">not</span> <span class="kc">None</span>  <span class="p">:</span> 
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
                        <span class="k">try</span> <span class="p">:</span><span class="n">xx_deline</span><span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">)</span>
                        <span class="k">except</span> <span class="p">:</span> 
                            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span>
                                <span class="s1">&#39;Value &lt;</span><span class="si">{0}</span><span class="s1">&gt; to delineate &lt;</span><span class="si">{1}</span><span class="s1">&gt; is unacceptable.&#39;</span>\
                                 <span class="s1">&#39; Please ckeck your value.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">,</span> <span class="n">fmt</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span>
                        <span class="k">else</span> <span class="p">:</span>
                            <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">))]</span>
                            <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">)]</span>
      
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xx_deline</span> <span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                        <span class="n">xx_deline</span> <span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">xx_deline</span><span class="p">)</span>
                        <span class="k">try</span> <span class="p">:</span>
                            <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
                                <span class="n">xx_deline</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">xx</span><span class="p">)))</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">xx_deline</span><span class="p">]</span>
                            <span class="k">elif</span>  <span class="n">ii</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
                                <span class="n">xx_deline</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">xx_deline</span><span class="p">]</span>
                                
                        <span class="k">except</span> <span class="p">:</span> 
                            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot</span><span class="p">(</span><span class="s1">&#39;Value to delineate &lt;</span><span class="si">{0}</span><span class="s1">&gt; is unacceptable.&#39;</span>\
                                                              <span class="s1">&#39; Please ckeck your value.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span>
                        <span class="k">else</span> <span class="p">:</span> 
                            <span class="k">return</span> <span class="n">xx_deline</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Construction of PseudocSection of Resistivity&#39;</span>\
                            <span class="s1">&#39; and Phase from &lt;</span><span class="si">{0}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fn</span><span class="p">)))</span>
        
        <span class="n">delineate_resistivity_curve</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;delineate_resistivity&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1">#tolerance_value =kws.pop(&#39;atol&#39;, 0.2)</span>
        <span class="n">delineate_phase_curve</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;delineate_phase&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">mplcmap</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">,</span> <span class="s1">&#39;seismic&#39;</span><span class="p">)</span>
        <span class="n">contourlines</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;contour_lines_styles&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">contourcolors</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;contour_lines_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
        
        <span class="c1">#--create obj ----</span>
        <span class="n">csamt_obj</span> <span class="o">=</span><span class="n">CSAMT</span><span class="p">(</span><span class="n">data_fn</span><span class="o">=</span><span class="n">fn</span> <span class="p">,</span> <span class="n">profile_fn</span><span class="o">=</span><span class="n">profile_fn</span><span class="p">)</span>
        <span class="n">csamt_phase_obj</span> <span class="o">=</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">phase</span> 
        <span class="n">csamt_res_obj</span> <span class="o">=</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">resistivity</span> 
        <span class="n">csamt_freq_obj</span> <span class="o">=</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">freq</span>
        <span class="n">csamt_stnDis_obj</span> <span class="o">=</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">station_distance</span>
        
        <span class="n">csamt_stn_obj</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">csamt_obj</span><span class="o">.</span><span class="n">station</span><span class="p">)</span>
        
        <span class="c1">#--- create matrix of Res and Phase </span>
        <span class="n">csamt_RES_obj</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span>
            <span class="n">list_of_array</span><span class="o">=</span> <span class="p">[</span><span class="n">resvalues</span> <span class="k">for</span> <span class="n">keys</span> <span class="p">,</span>
                             <span class="n">resvalues</span>  <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">csamt_res_obj</span><span class="o">.</span><span class="n">items</span><span class="p">())],</span> <span class="n">concat_axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">csamt_PHS_obj</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">concat_array_from_list</span><span class="p">(</span>
            <span class="n">list_of_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">phsvalues</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">phsvalues</span> <span class="ow">in</span> <span class="n">csamt_phase_obj</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">],</span> 
                             <span class="n">concat_axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        
        <span class="c1">#convert Res and Phase values on logarithme scale .</span>
        
        <span class="n">csamt_RES_obj</span> <span class="p">,</span><span class="n">csamt_freq_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="n">csamt_RES_obj</span><span class="p">),</span>\
            <span class="n">np</span><span class="o">.</span><span class="n">log10</span> <span class="p">(</span><span class="n">csamt_freq_obj</span> <span class="p">)</span> 
        
        <span class="c1">#--&gt; get delineate curve , if exist .</span>
    
        <span class="k">if</span> <span class="n">delineate_phase_curve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">delineate_phase_curve</span>  <span class="o">=</span> <span class="p">[</span><span class="n">ss</span><span class="o">%</span><span class="mi">90</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> \
                                      <span class="n">controle_delineate_curve</span><span class="p">(</span><span class="n">phase_deline</span><span class="o">=</span><span class="n">delineate_phase_curve</span><span class="p">)</span> <span class="p">]</span> 
        <span class="k">if</span> <span class="n">delineate_resistivity_curve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">delineate_resistivity_curve</span> <span class="o">=</span> <span class="n">controle_delineate_curve</span><span class="p">(</span><span class="n">res_deline</span><span class="o">=</span><span class="n">delineate_resistivity_curve</span><span class="p">)</span>
                                                      
        <span class="c1">#-----------------------PLOT ---------------------------------------</span>
        <span class="k">if</span> <span class="n">plot_style</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plot_style</span> <span class="o">=</span> <span class="s1">&#39;pcolormesh&#39;</span>
        
        <span class="c1">#--------------------figure params -----------</span>
        
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">fig</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">axe_res</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">axe_phase</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span> <span class="n">mplcmap</span><span class="p">)</span>
 

        <span class="k">if</span> <span class="n">plot_style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;pcolormesh&#39;</span><span class="p">:</span> 
            <span class="n">xres_matrix</span> <span class="p">,</span> <span class="n">yres_matrix</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">csamt_stnDis_obj</span><span class="p">,</span> <span class="n">csamt_freq_obj</span><span class="p">)</span> 
            <span class="n">xphase_matrix</span> <span class="p">,</span> <span class="n">yphase_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">csamt_stnDis_obj</span><span class="p">,</span> <span class="n">csamt_freq_obj</span><span class="p">)</span>
            
            <span class="c1">#---res map </span>
            <span class="n">app_rho_axe</span> <span class="o">=</span> <span class="n">axe_res</span><span class="o">.</span><span class="n">pcolormesh</span> <span class="p">(</span><span class="n">xres_matrix</span><span class="p">,</span> <span class="n">yres_matrix</span> <span class="p">,</span><span class="n">csamt_RES_obj</span><span class="p">,</span>
                                              <span class="n">vmax</span> <span class="o">=</span> <span class="n">csamt_RES_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                              <span class="n">vmin</span> <span class="o">=</span> <span class="n">csamt_RES_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                                              <span class="n">shading</span><span class="o">=</span> <span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> 
                                              <span class="n">cmap</span> <span class="o">=</span><span class="n">cmap</span><span class="p">,</span> 
                                              <span class="p">)</span>
         
            <span class="c1">#---phase map </span>
            <span class="n">phase_axe</span> <span class="o">=</span> <span class="n">axe_phase</span><span class="o">.</span><span class="n">pcolormesh</span> <span class="p">(</span><span class="n">xphase_matrix</span> <span class="p">,</span> <span class="n">yphase_matrix</span> <span class="p">,</span><span class="n">csamt_PHS_obj</span><span class="p">,</span> 
                                              <span class="n">vmax</span> <span class="o">=</span> <span class="n">csamt_PHS_obj</span> <span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                              <span class="n">vmin</span> <span class="o">=</span> <span class="n">csamt_PHS_obj</span> <span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                                              <span class="n">shading</span><span class="o">=</span> <span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> 
                                              <span class="n">cmap</span> <span class="o">=</span><span class="n">cmap</span><span class="p">,</span> 
                                              <span class="p">)</span>
            
            <span class="n">MAT</span> <span class="o">=</span> <span class="p">[[</span><span class="n">xres_matrix</span><span class="p">,</span> <span class="n">yres_matrix</span> <span class="p">,</span><span class="n">csamt_RES_obj</span><span class="p">],</span> <span class="p">[</span><span class="n">xphase_matrix</span> <span class="p">,</span> <span class="n">yphase_matrix</span> <span class="p">,</span><span class="n">csamt_PHS_obj</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="p">(</span><span class="n">axe</span><span class="p">,</span> <span class="n">deline</span><span class="p">)</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="nb">zip</span> <span class="p">([</span><span class="n">axe_res</span><span class="p">,</span> <span class="n">axe_phase</span><span class="p">],</span> 
                                      <span class="p">[</span><span class="n">delineate_resistivity_curve</span><span class="p">,</span><span class="n">delineate_phase_curve</span><span class="p">]))</span> <span class="p">:</span> <span class="c1"># loop the dict and get value </span>
                <span class="k">if</span>  <span class="n">deline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                    <span class="n">contps</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="o">*</span><span class="n">MAT</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">colors</span> <span class="o">=</span><span class="n">contourcolors</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="n">contourlines</span><span class="p">)</span>
                    <span class="n">axe</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contps</span><span class="p">,</span> <span class="n">deline</span> <span class="p">,</span>
                                    <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="n">fontsize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                              <span class="p">)</span>
        <span class="k">if</span> <span class="n">plot_style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;imshow&#39;</span><span class="p">:</span> 
            <span class="n">xres_matrix</span> <span class="p">,</span> <span class="n">yres_matrix</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">csamt_stnDis_obj</span><span class="p">,</span> <span class="n">csamt_freq_obj</span><span class="p">)</span> 
            <span class="n">xphase_matrix</span> <span class="p">,</span> <span class="n">yphase_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">csamt_stnDis_obj</span><span class="p">,</span> <span class="n">csamt_freq_obj</span><span class="p">)</span>
            
            <span class="c1">#---res map </span>
            <span class="n">app_rho_axe</span> <span class="o">=</span> <span class="n">axe_res</span><span class="o">.</span><span class="n">imshow</span> <span class="p">(</span><span class="n">csamt_RES_obj</span><span class="p">,</span>
                                          <span class="n">vmax</span> <span class="o">=</span> <span class="n">csamt_RES_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                          <span class="n">vmin</span> <span class="o">=</span> <span class="n">csamt_RES_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                                          <span class="n">interpolation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imshow_interp</span><span class="p">,</span> 
                                          <span class="n">cmap</span> <span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                          <span class="n">aspect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span> <span class="p">,</span>
                                          <span class="n">origin</span><span class="o">=</span> <span class="s1">&#39;upper&#39;</span><span class="p">,</span> 
                                          <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">csamt_stnDis_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                                        <span class="n">csamt_stnDis_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                                        <span class="n">csamt_freq_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                                                        <span class="n">csamt_freq_obj</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                                              <span class="p">)</span>
            <span class="n">axe_res</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">csamt_freq_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">csamt_freq_obj</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
 
            <span class="c1">#---phase map </span>
            <span class="n">phase_axe</span> <span class="o">=</span> <span class="n">axe_phase</span><span class="o">.</span><span class="n">imshow</span> <span class="p">(</span> <span class="n">csamt_PHS_obj</span><span class="p">,</span> 
                                              <span class="n">vmax</span> <span class="o">=</span> <span class="n">csamt_PHS_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                              <span class="n">vmin</span> <span class="o">=</span> <span class="n">csamt_PHS_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                                              <span class="n">interpolation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imshow_interp</span><span class="p">,</span> 
                                              <span class="n">aspect</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span> <span class="p">,</span>
                                              <span class="n">cmap</span> <span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                              <span class="n">origin</span><span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> 
                                               <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">csamt_stnDis_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                                       <span class="n">csamt_stnDis_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                                       <span class="n">csamt_freq_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                                                        <span class="n">csamt_freq_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                                       <span class="p">),</span>
                                              <span class="p">)</span>
   
            <span class="n">MAT</span> <span class="o">=</span> <span class="p">[</span><span class="n">csamt_RES_obj</span><span class="p">,</span> <span class="n">csamt_PHS_obj</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="p">(</span><span class="n">axe</span><span class="p">,</span> <span class="n">deline</span><span class="p">)</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="nb">zip</span> <span class="p">([</span><span class="n">axe_res</span><span class="p">,</span> <span class="n">axe_phase</span><span class="p">],</span> 
                                      <span class="p">[</span><span class="n">delineate_resistivity_curve</span><span class="p">,</span><span class="n">delineate_phase_curve</span><span class="p">]))</span> <span class="p">:</span> <span class="c1"># loop the dict and get value </span>
                <span class="k">if</span>  <span class="n">deline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> <span class="n">origin</span> <span class="o">=</span><span class="s1">&#39;upper&#39;</span>
                    <span class="k">else</span> <span class="p">:</span> <span class="n">origin</span> <span class="o">=</span><span class="s1">&#39;lower&#39;</span>
                    <span class="n">contps</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">MAT</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">colors</span> <span class="o">=</span><span class="n">contourcolors</span><span class="p">,</span> 
                                          <span class="n">vmax</span><span class="o">=</span><span class="n">MAT</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                            <span class="n">vmin</span> <span class="o">=</span> <span class="n">MAT</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                                            <span class="n">linestyles</span><span class="o">=</span><span class="n">contourlines</span><span class="p">,</span> 
                                            <span class="n">extent</span> <span class="o">=</span><span class="p">(</span><span class="n">csamt_stnDis_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                                    <span class="n">csamt_stnDis_obj</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                                    <span class="n">csamt_freq_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                                                   <span class="n">csamt_freq_obj</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
                                            <span class="n">extend</span> <span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span> <span class="n">origin</span> <span class="p">,</span>  
                                           <span class="p">)</span>
                    <span class="n">axe</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contps</span><span class="p">,</span> <span class="n">deline</span> <span class="p">,</span>
                                    <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="n">fontsize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                              <span class="p">)</span>
                    <span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span> <span class="p">(</span><span class="n">csamt_freq_obj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">csamt_freq_obj</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            
        
        <span class="c1">#for twin axes </span>
        
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">axe_res</span><span class="p">,</span> <span class="n">axe_phase</span><span class="p">]):</span>
            
             <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
                 <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance(m)&#39;</span><span class="p">,</span> 
                               <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span>
                                   <span class="c1">#&#39;style&#39;: self.font_style, </span>
                                                  <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">}</span>
                                                                        <span class="p">)</span>
             <span class="c1">#if plot_style ==&#39;pcolormesh&#39;: </span>
             <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;log10(Frequency)[Hz]&#39;</span><span class="p">,</span>
                          <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span>
                                  <span class="c1">#&#39;style&#39;: self.font_style, </span>
                                           <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                           <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">})</span>
             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_grid</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
                 <span class="n">axe_res</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
                 <span class="n">axe_res</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
                 <span class="n">axe_phase</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
                 <span class="n">axe_phase</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
            <span class="c1"># congigure color bar </span>
             <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> 
  
                 <span class="n">labex</span> <span class="p">,</span> <span class="n">cf</span> <span class="o">=</span> <span class="s1">&#39;$log10(App.Res)[â¦.m]$&#39;</span><span class="p">,</span> <span class="n">app_rho_axe</span>
             <span class="k">elif</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
                 <span class="n">labex</span><span class="p">,</span> <span class="n">cf</span> <span class="o">=</span> <span class="s1">&#39;$Phase(deg)$&#39;</span><span class="p">,</span> <span class="n">phase_axe</span>
                 
             <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span> <span class="p">,</span> <span class="n">ax</span><span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
             <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
             <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
             
             <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">labex</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">})</span>
                              
            <span class="c1">#--&gt; set second axis </span>
             
            
             <span class="n">axe2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span> 
             <span class="n">axe2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span> <span class="n">csamt_stnDis_obj</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
             <span class="n">axe2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">csamt_stn_obj</span> <span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">station_label_rotation</span><span class="p">)</span>
             <span class="k">if</span> <span class="n">ii</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                 <span class="n">axe2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Stations&#39;</span><span class="p">,</span> <span class="n">fontdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> 
                                                        <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span>
                                                        <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">},</span> <span class="p">)</span>
             <span class="k">if</span> <span class="n">ii</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                 <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axe2</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                 <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axe2</span><span class="o">.</span><span class="n">get_xlabel</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Plot PseudocrossResistivity and Phase&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span> <span class="mi">15</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> 
                     <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                             <span class="n">style</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span>
                             <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;moccasin&#39;</span><span class="p">))</span>
            
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span> <span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">w_pad</span> <span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mf">1.08</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,</span> <span class="n">orientation</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orient</span><span class="p">)</span>
        
        
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">plot_occam2dModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_fn</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">iter_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                          <span class="n">mesh_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">data_fn</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span>
        
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plotoccam Model  form Occam Model class </span>
<span class="sd">                    arguments : model_fn : str : full path to Occam 2Dmodel file </span>
<span class="sd">        ========================================================================</span>
<span class="sd">        params                      type           Description </span>
<span class="sd">        ========================================================================</span>
<span class="sd">        </span>
<span class="sd">            iter_fn                 : str        : full path to occam iteration file </span>
<span class="sd">            mesh_fn                 : str        : full path to mesh_fn file </span>
<span class="sd">            data_fn                 : str        : full path to occam_data file </span>
<span class="sd">            doi                     : str        : depth of investigation might </span>
<span class="sd">                                                    be float or str like &quot;1km&quot; =1000</span>
<span class="sd">            depth_scale             :str         : scale of imaging depth can be </span>
<span class="sd">                                                   &quot;km&quot; or &quot;m&quot;. Default is&quot;m&quot;</span>
<span class="sd">        ========================================================================</span>
<span class="sd">            </span>
<span class="sd">        eg : </span>
<span class="sd">            &gt;&gt;&gt; data=&#39;OccamDataFile.dat&#39;</span>
<span class="sd">            &gt;&gt;&gt; mesh = &#39;Occam2DMesh&#39;</span>
<span class="sd">            &gt;&gt;&gt; model = &#39;Occam2DModel&#39;</span>
<span class="sd">            &gt;&gt;&gt; iter_=&#39;ITER17.iter&#39;</span>
<span class="sd">            </span>
<span class="sd">            ... path =os.path.join(os.environ [&#39;pyCSAMT&#39;], &#39;csamtpy&#39;, &#39;data&#39;, &#39;occam2D&#39;, mesh)</span>
<span class="sd">            ... plot2d_obj = plot2d()</span>
<span class="sd">            ... plot2d_obj.plot_occam2dModel(mesh_fn=path, </span>
<span class="sd">                                        iter_fn = os.path.join(os.path.dirname(path), iter_), </span>
<span class="sd">                                        model_fn =os.path.join(os.path.dirname(path), model) , </span>
<span class="sd">                                        data_fn =os.path.join(os.path.dirname(path), data ), doi=&#39;1km&#39;)</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Plot occamModel 2D&#39;</span><span class="p">)</span>
        <span class="n">depth_scale</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;depth_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
        
        <span class="n">savefig</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;savefig&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">change_station_id</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;new_station_names&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        
        <span class="n">plot_style</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_style&#39;</span><span class="p">,</span> <span class="kc">None</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">plot_style</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plot_style</span> <span class="o">=</span> <span class="s1">&#39;imshow&#39;</span><span class="c1">#&#39;pcolormesh&#39;</span>
        
        
        <span class="n">show_contour</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;show_contour&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">contourlines</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;contour_lines_styles&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">contourcolors</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;contour_lines_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="n">delineate_resistivity_curve</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;delineate_rho&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">grid_alpha</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">show_report</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;show_report&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        
        <span class="n">set_station_label</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;show_station_id&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">file</span> <span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span> <span class="p">(</span> <span class="p">[</span><span class="n">iter_fn</span><span class="p">,</span> <span class="n">mesh_fn</span> <span class="p">,</span> <span class="n">data_fn</span> <span class="p">],</span> 
                                 <span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">,</span> <span class="s1">&#39;mesh&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">]):</span> 
            <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">mess</span><span class="o">=</span> <span class="s1">&#39;No </span><span class="si">{0}</span><span class="s1">-file found !Please input your </span><span class="si">{0}</span><span class="s1"> file.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Iteration, mesh , data files are essential for plotting.&#39;</span><span class="o">+</span> <span class="n">mess</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span> 
                <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_occam2d_plot</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span> 
                
        <span class="c1"># scaled data and x values plots </span>
        <span class="k">if</span> <span class="n">depth_scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_scale</span><span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">depth_scale</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> 
        <span class="k">if</span> <span class="n">depth_scale</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;km&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">]:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">depth_scale</span><span class="o">=</span> <span class="s2">&quot;m&quot;</span>
            <span class="n">mess</span> <span class="o">=</span><span class="s2">&quot;--&gt; ! Depth scale provided =</span><span class="si">{}</span><span class="s2"> is unrecognized. We reset to &#39;m&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_scale</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">debug</span> <span class="p">(</span><span class="n">mess</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_scale</span> <span class="o">==</span> <span class="s1">&#39;km&#39;</span><span class="p">:</span>
            <span class="n">dz</span>  <span class="o">=</span> <span class="mf">1000.</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_scale</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="c1"># for CSAMT , we use default as meter&quot;m&quot;.</span>
            <span class="n">dz</span> <span class="o">=</span> <span class="mf">1.</span>


        
        
        <span class="c1">#---&gt; get delineate rho curve --- </span>
        <span class="k">if</span> <span class="n">delineate_resistivity_curve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">delineate_resistivity_curve</span> <span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">controle_delineate_curve</span><span class="p">(</span>
                <span class="n">res_deline</span><span class="o">=</span><span class="n">delineate_resistivity_curve</span><span class="p">)</span>
            <span class="c1">#assert value to put on float rounded to 1 </span>
            <span class="c1"># note that value of resistivity for delineate MUST be on OHM- M not log10 resistivity </span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="c1"># for consistency </span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="n">delineate_resistivity_curve</span><span class="p">,</span> <span class="nb">list</span> <span class="p">):</span> 
                    <span class="n">delineate_resistivity_curve</span><span class="o">=</span><span class="p">[</span><span class="n">delineate_resistivity_curve</span> <span class="p">]</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="c1"># be sure to stay on the same output value if something wrong happen </span>
                
                <span class="n">delineate_resistivity_curve</span><span class="o">=</span><span class="n">delineate_resistivity_curve</span>
                <span class="k">pass</span> 
                
        <span class="c1"># -------------FIND OBJECTS ----------------------------</span>

        <span class="c1"># Read occam 2d model object </span>
        <span class="n">occam_model_obj</span> <span class="o">=</span> <span class="n">occam2d</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">iter_fn</span><span class="o">=</span><span class="n">iter_fn</span> <span class="p">,</span> 
                                        <span class="n">model_fn</span> <span class="o">=</span> <span class="n">model_fn</span> <span class="p">,</span> <span class="n">mesh_fn</span> <span class="o">=</span><span class="n">mesh_fn</span><span class="p">)</span>
        <span class="n">occam_data_obj</span> <span class="o">=</span> <span class="n">occam2d</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">data_fn</span> <span class="o">=</span> <span class="n">data_fn</span><span class="p">)</span>
        
        <span class="c1"># get station names and station offsetS objs </span>
        
        <span class="n">occam_data_station_offsets</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">occam_data_obj</span><span class="o">.</span><span class="n">data_offsets</span><span class="p">)</span>
        <span class="c1"># generally data from occam_station offset are normalized then get the dipole length to normalize </span>
        <span class="c1"># xpad </span>
        <span class="n">dl</span> <span class="o">=</span> <span class="n">occam_data_station_offsets</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">occam_data_station_offsets</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xpad</span> <span class="o">=</span> <span class="p">(</span><span class="n">dl</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">dz</span> 

        <span class="n">occam_data_station_names</span> <span class="o">=</span><span class="n">occam_data_obj</span><span class="o">.</span><span class="n">data_sites</span>
        
        <span class="k">if</span> <span class="n">change_station_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>  <span class="c1"># call fonction to build a nu</span>
            <span class="n">occam_data_station_names</span> <span class="p">,</span> <span class="n">mess</span><span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">build_new_station_id</span><span class="p">(</span>
                <span class="n">station_id</span> <span class="o">=</span><span class="n">occam_data_station_names</span> <span class="p">,</span>
                <span class="n">new_station_name</span> <span class="o">=</span><span class="n">change_station_id</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>

                                                
        
        <span class="c1"># --&gt; get plot objects for model class </span>
        
        <span class="n">plot_x_axis</span>  <span class="o">=</span>  <span class="n">occam_model_obj</span><span class="o">.</span><span class="n">model_station_offsets</span>
        <span class="n">plot_z_axis</span>  <span class="o">=</span>  <span class="n">occam_model_obj</span><span class="o">.</span><span class="n">model_depth_offsets</span>
        <span class="n">occam_model_resistiviy_obj</span> <span class="o">=</span> <span class="n">occam_model_obj</span><span class="o">.</span><span class="n">model_resistivity</span>
        
        <span class="c1">#--------------------END Objects statements ----------------------------</span>
        
        <span class="c1">#-----handles depth of investigation or depth of imaging {doi}:--------- </span>
            
        <span class="c1"># --&gt; check doi value provided , and convert to default unit {meters}  </span>
        <span class="n">doi</span> <span class="o">=</span><span class="n">mplotus</span><span class="o">.</span><span class="n">depth_of_investigation</span><span class="p">(</span><span class="n">doi</span><span class="o">=</span><span class="n">doi</span><span class="p">)</span>
        
   
                
        <span class="c1"># set boundaries of stations offsets and depth </span>
        <span class="n">spec_f</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">doi</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">dz</span>  <span class="c1"># assume that depth will  start by 0 then substract add value so </span>
                                        <span class="c1"># to get space for station names text</span>

        <span class="c1">#-25 +0 : 1300 +25 (xpad = 25 )                              </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="o">=</span><span class="p">(</span><span class="n">occam_data_station_offsets</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">/</span><span class="n">dz</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">xpad</span>  <span class="p">,</span> 
                      <span class="n">occam_data_station_offsets</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">dz</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">xpad</span> <span class="p">)</span>

        
        <span class="c1">#then new_sation offset becomes </span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span> <span class="o">=</span><span class="p">(</span><span class="n">spec_f</span><span class="p">,</span> <span class="n">doi</span><span class="o">/</span><span class="n">dz</span><span class="p">)</span> 

        <span class="c1"># plot ---------------figure and properties  ---------------------</span>

        <span class="n">subplot_right</span> <span class="o">=</span> <span class="o">.</span><span class="mi">99</span>
        <span class="n">subplot_left</span> <span class="o">=</span> <span class="o">.</span><span class="mi">085</span>
        <span class="n">subplot_top</span> <span class="o">=</span> <span class="o">.</span><span class="mi">92</span>
        <span class="n">subplot_bottom</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
        
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subplot_left</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.right&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subplot_right</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.bottom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subplot_bottom</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.top&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">subplot_top</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">)</span>
        <span class="c1"># plt.clf()</span>
        
        <span class="c1"># add a subplot to the figure with the specified aspect ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span> <span class="o">=</span><span class="s1">&#39;auto&#39;</span>
        <span class="n">axm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span><span class="p">)</span>
        
        
        <span class="c1">#---------------------PLOTS STATEMENTS -----------------------------------------</span>
                <span class="c1">#fist option is &quot;pcolormesh &quot; </span>
        <span class="k">if</span> <span class="n">plot_style</span> <span class="o">==</span><span class="s1">&#39;pcolormesh&#39;</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Ready to plot Model with matplotlib &quot;pcolormesh&quot;&#39;</span><span class="p">)</span>
            <span class="c1"># if you keep plot_x_axis and plot_z_axis in meter , be sure to divided py dz </span>
            <span class="c1"># meshes respectively </span>
            
            <span class="n">mesh_x</span>  <span class="p">,</span> <span class="n">mesh_z</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">plot_x_axis</span>  <span class="p">,</span>  <span class="n">plot_z_axis</span> <span class="p">)</span>
            
            <span class="n">rho_axm</span> <span class="o">=</span> <span class="n">axm</span><span class="o">.</span><span class="n">pcolormesh</span> <span class="p">(</span><span class="n">mesh_x</span><span class="o">/</span><span class="n">dz</span>  <span class="p">,</span> 
                                          <span class="n">mesh_z</span><span class="o">/</span><span class="n">dz</span> <span class="p">,</span>
                                          <span class="n">occam_model_resistiviy_obj</span><span class="p">,</span>
                                              <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                              <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  
                                              <span class="n">shading</span><span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
                                              <span class="n">cmap</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> 
                                              <span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                                              
                                              <span class="p">)</span>
         

            <span class="k">if</span> <span class="n">show_contour</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>
                <span class="n">contps</span> <span class="o">=</span> <span class="n">axm</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">mesh_x</span><span class="o">/</span><span class="n">dz</span>  <span class="p">,</span> <span class="n">mesh_z</span> <span class="o">/</span><span class="n">dz</span> <span class="p">,</span><span class="n">occam_model_resistiviy_obj</span><span class="p">,</span>
                                      <span class="n">colors</span> <span class="o">=</span><span class="n">contourcolors</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="n">contourlines</span><span class="p">)</span>
                <span class="k">if</span>  <span class="n">delineate_resistivity_curve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                    <span class="n">axm</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contps</span><span class="p">,</span>  <span class="n">delineate_resistivity_curve</span> <span class="p">,</span>
                                    <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="n">fontsize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                      <span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Ready to plot Model with matplotlib &quot;imshow&quot;&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">plot_style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;imshow&#39;</span><span class="p">:</span> 
            <span class="n">mesh_x</span>  <span class="p">,</span> <span class="n">mesh_z</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">plot_x_axis</span>  <span class="p">,</span> <span class="n">plot_z_axis</span> <span class="p">)</span>

            <span class="n">axm</span><span class="o">.</span><span class="n">imshow</span> <span class="p">(</span><span class="n">occam_model_resistiviy_obj</span><span class="p">,</span>
                                <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                <span class="n">vmin</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                <span class="n">interpolation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imshow_interp</span><span class="p">,</span> 
                                <span class="n">cmap</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
                                <span class="n">aspect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span><span class="p">,</span>
                                <span class="n">origin</span><span class="o">=</span> <span class="s1">&#39;upper&#39;</span><span class="p">,</span> 
                                <span class="n">extent</span><span class="o">=</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">spec_f</span><span class="p">),</span> <span class="c1"># to get the origine =0 of the plot </span>

                                    <span class="p">)</span>

 
            <span class="k">if</span> <span class="n">delineate_resistivity_curve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">origin</span> <span class="o">=</span><span class="s1">&#39;upper&#39;</span>
                <span class="n">contps</span> <span class="o">=</span> <span class="n">axm</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">occam_model_resistiviy_obj</span><span class="p">,</span> <span class="n">colors</span> <span class="o">=</span><span class="n">contourcolors</span><span class="p">,</span> 
                                      <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                      <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                        <span class="n">linestyles</span><span class="o">=</span><span class="n">contourlines</span><span class="p">,</span> 
                                        <span class="n">extent</span> <span class="o">=</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                                  <span class="c1">#self.ylimits[0], </span>
                                                  <span class="c1">#self.ylimits[1]),</span>
                                        <span class="n">extend</span> <span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                        <span class="n">origin</span><span class="o">=</span> <span class="n">origin</span> <span class="p">,</span>  
                                       <span class="p">)</span>
                <span class="n">axm</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contps</span><span class="p">,</span> <span class="n">delineate_resistivity_curve</span> <span class="p">,</span>
                                <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f</span><span class="s1">&#39;</span><span class="p">,</span>
                                <span class="n">fontsize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                          <span class="p">)</span>
        
        
        <span class="c1">#-----------------------END PLOTS STATEMENTS--------------------------------------</span>
            <span class="c1">#set xlimits and y limits for model axes </span>
        <span class="c1"># for making a color bar </span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">)</span>
        
        <span class="n">axm</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">axm</span><span class="o">.</span><span class="n">set_ylim</span> <span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> 
        
       
        
        <span class="c1">#--------------SET TWIN axes for station ticks and labels -------------------------</span>
        
        <span class="c1"># create twin axis to set ticks to tehe top station</span>
        <span class="n">axe2</span><span class="o">=</span><span class="n">axm</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axe2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># let keep only the axe lines </span>
    

        <span class="c1"># show station maker points : </span>
            
        <span class="k">for</span> <span class="n">offset</span> <span class="p">,</span> <span class="n">names</span> <span class="ow">in</span> <span class="nb">zip</span> <span class="p">(</span><span class="n">occam_data_station_offsets</span><span class="p">,</span> <span class="n">occam_data_station_names</span><span class="p">):</span>
            <span class="c1"># plot the station marker &#39; black triangle down &#39; </span>
            <span class="c1"># always plots at the surface.</span>
            <span class="n">axm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">offset</span><span class="o">/</span><span class="n">dz</span>  <span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">spec_f</span><span class="p">,</span>  
                    <span class="n">s</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_marker</span><span class="p">,</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                    <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> 
                              <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_color</span><span class="p">},</span>
                    <span class="p">)</span>
            
            <span class="k">if</span> <span class="n">set_station_label</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>  <span class="c1"># then plot label id </span>
                <span class="n">axm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">offset</span><span class="o">/</span><span class="n">dz</span> <span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># get station name closest to station text.  </span>
                        <span class="n">s</span><span class="o">=</span> <span class="n">names</span><span class="p">,</span>
                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> 
                                  <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_color</span><span class="p">},</span>
                        <span class="n">rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_label_rotation</span><span class="p">,</span>
                            <span class="p">)</span>
     
           
        <span class="k">if</span> <span class="n">set_station_label</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="n">axm</span><span class="o">.</span><span class="n">text</span> <span class="p">((</span><span class="n">occam_data_station_offsets</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">dz</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> 
                       <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> 
                        <span class="n">s</span><span class="o">=</span> <span class="s1">&#39;Stations&#39;</span><span class="p">,</span>
                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> 
                                  <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> 
                                  <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span>
                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">},</span>
                        <span class="p">)</span>
        
       
        <span class="c1"># put a grid on if set to True </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_grid</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># axm.grid(alpha=.3, which=&#39;major&#39;, lw=.35)</span>
            <span class="n">axm</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="n">axm</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">grid_alpha</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
        

         <span class="c1">#set color bar properties </span>
        <span class="n">cbx</span> <span class="o">=</span> <span class="n">mplcb</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">axm</span><span class="p">,</span>  <span class="n">shrink</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_shrink</span><span class="p">,</span>
                              <span class="n">pad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_pad</span> <span class="p">,</span> <span class="n">location</span> <span class="o">=</span><span class="s1">&#39;right&#39;</span> <span class="p">)</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">mplcb</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cbx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
                        <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                        <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Resistivity ($\Omega \cdot$m)&#39;</span><span class="p">,</span>
                  <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> 
                            <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
        
        <span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="c1"># cb.ax.tick_params(axis=&#39;y&#39;, direction=&#39;in&#39;, pad=2.)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;10$^</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                      <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
       
        <span class="c1"># set axes labels</span>
        <span class="n">axm</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance (</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_scale</span><span class="p">),</span>
                      <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
        <span class="n">axm</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_scale</span><span class="p">),</span>
                      <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">show_report</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
            
            <span class="c1"># povided model offsets  slce matrix to keep the model value that we need </span>
            <span class="n">occam_model_offsets</span> <span class="o">=</span> <span class="n">occam_model_obj</span><span class="o">.</span><span class="n">model_station_offsets</span>
            <span class="n">new_station_offsets</span><span class="p">,</span>  <span class="n">new_depth_offsets</span><span class="p">,</span> <span class="n">new_block_matrix</span><span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">slice_csamt_matrix</span><span class="p">(</span>
                                        <span class="n">block_matrix</span> <span class="o">=</span><span class="n">occam_model_resistiviy_obj</span>  <span class="p">,</span>
                                       <span class="n">station_offsets</span> <span class="o">=</span> <span class="n">occam_model_offsets</span> <span class="p">,</span>
                                       <span class="n">depth_offsets</span> <span class="o">=</span><span class="n">occam_model_obj</span><span class="o">.</span><span class="n">model_depth_offsets</span><span class="p">,</span>
                                       <span class="n">offset_MinMax</span><span class="o">=</span><span class="p">(</span><span class="n">occam_data_station_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                                      <span class="n">occam_data_station_offsets</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                                       <span class="n">doi</span><span class="o">=</span><span class="s1">&#39;1km&#39;</span><span class="p">)</span>
            
            <span class="c1"># new_station_offsets,  new_depth_offsets, new_block_matrix</span>
            <span class="n">mplotus</span><span class="o">.</span><span class="n">get_conductive_and_resistive_zone</span> <span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">new_block_matrix</span><span class="p">,</span>
                                                       <span class="n">site_names</span> <span class="o">=</span><span class="n">occam_data_station_names</span><span class="p">,</span> 
                                                        <span class="n">model_offsets</span> <span class="o">=</span>  <span class="n">new_station_offsets</span><span class="p">,</span> 
                                                        <span class="n">site_offsets</span> <span class="o">=</span> <span class="n">occam_data_station_offsets</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Plot Resistivity Model :RMS=</span><span class="si">{0}</span><span class="s1">, Roughness=</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span>\
                          <span class="nb">format</span><span class="p">(</span><span class="n">occam_model_obj</span><span class="o">.</span><span class="n">model_rms</span><span class="p">,</span> 
                                <span class="n">occam_model_obj</span><span class="o">.</span><span class="n">model_roughness</span><span class="p">),</span>
                  <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
          <span class="n">fontsize</span><span class="o">=</span> <span class="mi">15</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> 
          <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
          <span class="n">style</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span>
          <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;moccasin&#39;</span><span class="p">),</span> 
          <span class="n">y</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        

        <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">plot_Response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span>
                      <span class="n">response_fn</span> <span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">mode</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span>   <span class="o">**</span><span class="n">kws</span> <span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to plot forward value , and residual value fROM </span>
<span class="sd">        Occam 2D</span>
<span class="sd">        </span>
<span class="sd">        =======================================================================</span>
<span class="sd">        params                      type                        Description </span>
<span class="sd">        =======================================================================</span>
<span class="sd">        </span>
<span class="sd">            response_fn             : str            : full path to occam </span>
<span class="sd">                                                            iteration file </span>
<span class="sd">            data_fn                 : str            : full path to occam_data </span>
<span class="sd">                                                                file </span>
<span class="sd">            doi                     : str            : depth of investigation</span>
<span class="sd">                                                        might be float or str </span>
<span class="sd">                                                            like &quot;1km&quot; =1000</span>
<span class="sd">            show_station_id         :str                : show station names </span>
<span class="sd">        =======================================================================</span>
<span class="sd">            </span>
<span class="sd">        eg : </span>
<span class="sd">            &gt;&gt;&gt; pathresp =os.path.join(os.environ [&#39;pyCSAMT&#39;],</span>
<span class="sd">                                       &#39;csamtpy&#39;, &#39;data&#39;, &#39;occam2D&#39;,&#39;RESP17.resp&#39;)</span>
<span class="sd">            &gt;&gt;&gt; path_data =os.path.join(os.environ [&#39;pyCSAMT&#39;],</span>
<span class="sd">                                        &#39;csamtpy&#39;, &#39;data&#39;, &#39;occam2D&#39;,&#39;OccamDataFile.dat&#39; )</span>
<span class="sd">            &gt;&gt;&gt; plot2d_obj = plot2d()</span>
<span class="sd">            ... plot2d_obj.plot_Response(data_fn =path_data , response_fn=  pathresp )</span>
<span class="sd"> </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Plot occam pseudosection of forward , residual value &#39;</span><span class="p">)</span>
        <span class="n">plot_style</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_style&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="n">contourlines</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;contour_lines_styles&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">contourcolors</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;contour_lines_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="n">delineate_resistivity_curve</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;delineate_rho&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
        <span class="n">show_contour</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;show_contour&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">show_report</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;show_report&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        
        <span class="n">grid_alpha</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">savefig</span> <span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;savefig&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">set_station_label</span><span class="o">=</span><span class="n">kws</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;show_station_id&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1">#------------------------STATEMENT RESPONSE OBJECT ----------------------</span>
        <span class="n">resp_obj</span> <span class="o">=</span> <span class="n">occam2d</span><span class="o">.</span><span class="n">Response</span> <span class="p">(</span><span class="n">data_fn</span> <span class="o">=</span><span class="n">data_fn</span> <span class="p">,</span> <span class="n">response_fn</span><span class="o">=</span><span class="n">response_fn</span><span class="p">)</span>
        <span class="c1"># get occam data type  and build large list of possible mode </span>
        
        <span class="n">make_mode</span> <span class="o">=</span> <span class="n">resp_obj</span><span class="o">.</span><span class="n">occam_dtype</span> <span class="o">+</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span><span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">resp_obj</span><span class="o">.</span><span class="n">occam_mode</span><span class="p">]</span>
        
        <span class="n">resp_occam_dtype_obj</span> <span class="o">=</span> <span class="n">resp_obj</span><span class="o">.</span><span class="n">occam_dtype</span>
        
        
        <span class="c1">#---------------------------------MANAGE OCCAM PLOT MODE -------------------------</span>
        <span class="c1"># if mode is not provided , then take the first occam mode </span>

        <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">resp_occam_dtype_obj</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">mode</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> 
        
  
        <span class="c1"># check the mode if provided </span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span>  <span class="n">make_mode</span>  <span class="p">:</span> 
            <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;Occam mode provided =</span><span class="si">{0}</span><span class="s1"> is wrong !. Occam2D data mode is =</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span>\
                           <span class="nb">format</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">make_mode</span> <span class="p">),</span> 
                                  <span class="s1">&#39;Please select the right mode.&#39;</span><span class="p">])</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span> <span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            
        <span class="c1"># check the mode provided , can be str </span>
        <span class="k">for</span> <span class="n">im</span> <span class="p">,</span> <span class="n">imode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">resp_obj</span><span class="o">.</span><span class="n">occam_mode</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">imode</span> <span class="o">==</span><span class="n">mode</span> <span class="p">:</span> 
                <span class="n">resp_occam_dtype_obj</span>  <span class="o">=</span>  <span class="n">resp_occam_dtype_obj</span> <span class="p">[</span><span class="n">im</span><span class="p">]</span>
                
        <span class="k">for</span> <span class="n">im</span> <span class="p">,</span> <span class="n">imode</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span> <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">resp_obj</span><span class="o">.</span><span class="n">occam_mode</span><span class="p">]):</span> 
            <span class="k">if</span> <span class="n">imode</span> <span class="o">==</span><span class="n">mode</span> <span class="p">:</span> 
                <span class="n">resp_occam_dtype_obj</span>  <span class="o">=</span>  <span class="n">resp_occam_dtype_obj</span> <span class="p">[</span><span class="n">im</span><span class="p">]</span>  
            
        <span class="c1">#-------------------------MANAGE COUNTOUR PLOT -----------------------------------------</span>
         <span class="c1">#---&gt; get delineate rho curve --- </span>
        <span class="k">if</span> <span class="n">delineate_resistivity_curve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">delineate_resistivity_curve</span> <span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">controle_delineate_curve</span><span class="p">(</span>
                <span class="n">res_deline</span><span class="o">=</span><span class="n">delineate_resistivity_curve</span><span class="p">)</span>
            <span class="c1">#assert value to put on float rounded to 1 </span>
            <span class="c1"># note that value of resistivity for delineate MUST be on OHM- M not log10 resistivity </span>
            <span class="k">try</span> <span class="p">:</span> 
                <span class="c1"># for consistency </span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="n">delineate_resistivity_curve</span><span class="p">,</span> <span class="nb">list</span> <span class="p">):</span> 
                    <span class="n">delineate_resistivity_curve</span><span class="o">=</span><span class="p">[</span><span class="n">delineate_resistivity_curve</span> <span class="p">]</span>
            <span class="k">except</span> <span class="p">:</span> 
                <span class="c1"># be sure to stay on the same output value if something wrong happen </span>
                
                <span class="n">delineate_resistivity_curve</span><span class="o">=</span><span class="n">delineate_resistivity_curve</span>
                <span class="k">pass</span> 
        <span class="c1">#--------------------------------MANAGE PRINT INFO ------------------------------------------------</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:=^77}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Occam Response plot infos&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Occam 2D plot Mode  = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">mode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">delineate_resistivity_curve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Occam 2D contour delineate value = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="n">delineate_resistivity_curve</span><span class="p">)))</span>
            
        
       
        <span class="c1">#----------------------- CALL RESPONSE OCJECT USEFULL FOR PLOTTING------------------------------------</span>
        <span class="c1"># Now get attributes of forward and residual values </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resp_forward</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">resp_obj</span><span class="p">,</span> <span class="s1">&#39;resp_</span><span class="si">{0}</span><span class="s1">_forward&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span> <span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">resp_obj</span><span class="p">,</span> <span class="s1">&#39;resp_</span><span class="si">{0}</span><span class="s1">_residual&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resp_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">resp_obj</span><span class="p">,</span> <span class="s1">&#39;data_frequencies&#39;</span><span class="p">))</span>
        <span class="c1">#let elimitale - frequency the lowest one </span>
        <span class="c1"># self.resp_freq = self.resp_freq [:-1]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_names</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">resp_obj</span><span class="p">,</span> <span class="s1">&#39;data_sites&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">resp_obj</span><span class="p">,</span> <span class="s1">&#39;data_offsets&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">delineate_resistivity_curve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Occam 2D contour delineate value = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="n">delineate_resistivity_curve</span><span class="p">)))</span>
        
        <span class="c1"># ------------------------DECLARE FIGURE AND PROPERTIES --------------------------------------------</span>

        
        <span class="c1"># statement of figures </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">,)</span> <span class="c1"># constrained_layout=True)</span>
        <span class="c1"># plt.clf()</span>
        <span class="c1"># add a subplot to the figure with the specified aspect ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span> <span class="o">=</span><span class="s1">&#39;auto&#39;</span>
        <span class="n">gs</span><span class="o">=</span><span class="n">gspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figure</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
        
        <span class="n">axeFW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
        <span class="c1"># axeresd = self.fig.add_subplot(2, 1, 1, aspect=self.fig_aspect)</span>
        <span class="n">axeRESI</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>  <span class="p">,</span><span class="n">sharex</span> <span class="o">=</span> <span class="n">axeFW</span> <span class="p">)</span>
        <span class="c1">#                               </span>
        <span class="c1"># axeRESI = self.fig.add_subplot(2, 1, 2, aspect=self.fig_aspect, </span>
        <span class="c1">#                                sharex = axefw )</span>
        
        <span class="c1">#-------- SET XY  LIMITS ---------</span>

        <span class="c1"># try to make stations separation the same distance between sites </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> 
                                             <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                      <span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_freq</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_freq</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
        
        
        <span class="c1">#---------------------------------------PLOT STATEMENT -------------------------------------------------</span>
        
        <span class="c1"># plotstyle is None take a default as pcolormesh</span>
        <span class="k">if</span> <span class="n">plot_style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plot_style</span> <span class="o">=</span><span class="n">plot_style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">plot_style</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plot_style</span> <span class="o">=</span><span class="s1">&#39;imshow&#39;</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&gt; Occam 2D plot style  = &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plot_style</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">plot_style</span> <span class="o">==</span><span class="s1">&#39;pcolormesh&#39;</span><span class="p">:</span> 
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Ready to plot Forward with matplotlib &quot;pcolormesh&quot;&#39;</span><span class="p">)</span>
            <span class="c1">#make mesh_grid </span>
            <span class="n">mesh_x</span> <span class="p">,</span> <span class="n">mesh_y</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_freq</span><span class="p">,</span> 
                                          <span class="p">)</span>
            
            <span class="c1"># if you keep plot_x_axis and plot_z_axis in meter , be sure to divided py dz </span>
            <span class="c1"># meshes respectively </span>
            
            <span class="c1">#------plot forward response -------</span>
            <span class="n">axeFW</span><span class="o">.</span><span class="n">pcolormesh</span> <span class="p">(</span><span class="n">mesh_x</span> <span class="p">,</span> 
                            <span class="n">mesh_y</span> <span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">resp_forward</span><span class="p">,</span>
                                <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  
                                <span class="n">shading</span><span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
                                <span class="n">cmap</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> 
                                <span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                                              
                                              <span class="p">)</span>
  
                    
            <span class="c1">#------plot residual -------------</span>
            
            <span class="n">axeRESI</span><span class="o">.</span><span class="n">pcolormesh</span> <span class="p">(</span><span class="n">mesh_x</span> <span class="p">,</span> 
                                   <span class="n">mesh_y</span> <span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span><span class="p">,</span>
                                    <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                    <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>  
                                    <span class="n">shading</span><span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
                                    <span class="n">cmap</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> 
                                    <span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                                    
                                              <span class="p">)</span>
         

            
        <span class="k">if</span> <span class="n">plot_style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;imshow&#39;</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Ready to plot forward  with matplotlib &quot;imshow&quot;&#39;</span><span class="p">)</span>
            <span class="n">mesh_x</span> <span class="p">,</span> <span class="n">mesh_y</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_freq</span><span class="p">,</span> 
                                          <span class="p">)</span>
            <span class="n">axeFW</span><span class="o">.</span><span class="n">imshow</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_forward</span><span class="p">,</span>
                                <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                <span class="n">vmin</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                <span class="n">interpolation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imshow_interp</span><span class="p">,</span> 
                                <span class="n">cmap</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
                                <span class="n">aspect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span><span class="p">,</span>
                                <span class="n">origin</span><span class="o">=</span> <span class="s1">&#39;upper&#39;</span><span class="p">,</span> 
                                <span class="n">extent</span><span class="o">=</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span> <span class="c1"># to get the origine =0 of the plot </span>

                                    <span class="p">)</span>
            <span class="n">axeRESI</span><span class="o">.</span><span class="n">imshow</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span><span class="p">,</span>
                                <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> 
                                <span class="n">vmin</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                                <span class="n">interpolation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imshow_interp</span><span class="p">,</span> 
                                <span class="n">cmap</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
                                <span class="n">aspect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span><span class="p">,</span>
                                <span class="n">origin</span><span class="o">=</span> <span class="s1">&#39;upper&#39;</span><span class="p">,</span> 
                                <span class="n">extent</span><span class="o">=</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span> <span class="c1"># to get the origine =0 of the plot </span>

                                    <span class="p">)</span>

 

        <span class="c1">#-------SET AXIS LIMIT -------------------------</span>
        <span class="n">axeFW</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">axeFW</span><span class="o">.</span><span class="n">set_ylim</span> <span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> 
        
        <span class="n">axeRESI</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">axeRESI</span><span class="o">.</span><span class="n">set_ylim</span> <span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> 
        
        <span class="c1"># set delineate cure </span>
        <span class="k">for</span> <span class="n">axe</span><span class="p">,</span> <span class="n">grid_response</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">axeFW</span><span class="p">,</span> <span class="n">axeRESI</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_forward</span><span class="p">,</span> 
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span><span class="p">]):</span> 
            <span class="k">if</span> <span class="n">show_contour</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>
                <span class="n">contps</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">mesh_x</span>  <span class="p">,</span> 
                                     <span class="n">mesh_y</span> <span class="p">,</span>
                                     <span class="n">grid_response</span><span class="p">,</span>
                                      <span class="n">colors</span> <span class="o">=</span><span class="n">contourcolors</span><span class="p">,</span> 
                                      <span class="n">linestyles</span><span class="o">=</span><span class="n">contourlines</span><span class="p">)</span>
                <span class="k">if</span>  <span class="n">delineate_resistivity_curve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                    <span class="n">axe</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contps</span><span class="p">,</span>  <span class="n">delineate_resistivity_curve</span> <span class="p">,</span>
                                    <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="n">fontsize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                      <span class="p">)</span>
                    
            <span class="k">if</span> <span class="n">delineate_resistivity_curve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
               <span class="n">origin</span> <span class="o">=</span><span class="s1">&#39;upper&#39;</span>
               <span class="k">if</span> <span class="n">axe</span> <span class="o">==</span> <span class="n">axeFW</span> <span class="p">:</span> 
                   <span class="n">vmax</span> <span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
               <span class="k">else</span> <span class="p">:</span> <span class="n">vmax</span> <span class="p">,</span> <span class="n">vmin</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">resisual</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
                  
               <span class="n">contps</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">grid_response</span><span class="p">,</span> <span class="n">colors</span> <span class="o">=</span><span class="n">contourcolors</span><span class="p">,</span> 
                                     <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                     <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span> 
                                       <span class="n">linestyles</span><span class="o">=</span><span class="n">contourlines</span><span class="p">,</span> 
                                       <span class="n">extent</span> <span class="o">=</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                                 <span class="c1">#self.ylimits[0], </span>
                                                 <span class="c1">#self.ylimits[1]),</span>
                                       <span class="n">extend</span> <span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                       <span class="n">origin</span><span class="o">=</span> <span class="n">origin</span> <span class="p">,</span>  
                                      <span class="p">)</span>
               <span class="n">axe</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contps</span><span class="p">,</span> <span class="n">delineate_resistivity_curve</span> <span class="p">,</span>
                               <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                               <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f</span><span class="s1">&#39;</span><span class="p">,</span>
                               <span class="n">fontsize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                         <span class="p">)</span>
        
            
        <span class="k">for</span> <span class="n">offs</span> <span class="p">,</span> <span class="n">names</span> <span class="ow">in</span> <span class="nb">zip</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_names</span><span class="p">):</span>
            <span class="c1"># plot the station marker &#39; black triangle down &#39; </span>
            <span class="c1"># always plots at the surface.</span>
            <span class="n">axeFW</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">offs</span>  <span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  
                    <span class="n">s</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_marker</span><span class="p">,</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                    <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> 
                              <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_color</span><span class="p">},</span>
                    <span class="p">)</span>
            
            <span class="k">if</span> <span class="n">set_station_label</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>  <span class="c1"># then plot label id </span>
                <span class="n">axeFW</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">offs</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">2.5</span><span class="p">),</span>  <span class="c1"># get station name closest to station text.  </span>
                        <span class="n">s</span><span class="o">=</span> <span class="n">names</span><span class="p">,</span>
                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> 
                                  <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_color</span><span class="p">},</span>
                        <span class="n">rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_label_rotation</span><span class="p">,</span>
                            <span class="p">)</span>
        <span class="k">if</span> <span class="n">set_station_label</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="n">axeFW</span><span class="o">.</span><span class="n">text</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_offsets</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="c1">#take the center point and add value to top </span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1.25</span><span class="p">),</span> 
                        <span class="n">s</span><span class="o">=</span> <span class="s1">&#39;Stations&#39;</span><span class="p">,</span>
                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> 
                                  <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> 
                                  <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span>
                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">},</span>
                        <span class="p">)</span>
        
   
        <span class="c1"># put a grid on if set to True </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_grid</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># axm.grid(alpha=.3, which=&#39;major&#39;, lw=.35)</span>
            <span class="n">axeFW</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="n">axeRESI</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="n">axeFW</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">grid_alpha</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
            <span class="n">axeRESI</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">grid_alpha</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>

        <span class="c1">#---&gt; set color bar properties </span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">axe</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">axeFW</span><span class="p">,</span> <span class="n">axeRESI</span><span class="p">]):</span>
            
            <span class="n">cbx</span> <span class="o">=</span> <span class="n">mplcb</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">axe</span><span class="p">,</span>  <span class="n">shrink</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_shrink</span> <span class="o">*</span><span class="mf">1.5</span><span class="p">,</span>
                                  <span class="n">pad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_pad</span> <span class="p">,</span> <span class="n">location</span> <span class="o">=</span><span class="s1">&#39;right&#39;</span> <span class="p">)</span>
            
            <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
                <span class="n">cb</span> <span class="o">=</span> <span class="n">mplcb</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cbx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
                                <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Resistivity ($\Omega \cdot$m)&#39;</span><span class="p">,</span>
                      <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> 
                                <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
            
                <span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="c1"># cb.ax.tick_params(axis=&#39;y&#39;, direction=&#39;in&#39;, pad=2.)</span>
                <span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;10$^</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                              <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
                

            <span class="k">elif</span> <span class="n">ii</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span> 
                <span class="c1">#set new color bar limits ....</span>
                <span class="n">cmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
                <span class="n">cmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_residual</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                
                <span class="n">cb</span> <span class="o">=</span> <span class="n">mplcb</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cbx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
                                <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span>
                                                <span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">))</span>

                <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Resistivity ($\Omega \cdot$m)&#39;</span><span class="p">,</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> 
                                    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
                
                <span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cmin</span><span class="p">),</span>
                                       <span class="nb">int</span><span class="p">(</span><span class="n">cmax</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

                <span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;$</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">))</span> <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cmin</span><span class="p">),</span>
                                              <span class="nb">int</span><span class="p">(</span><span class="n">cmax</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
                
                <span class="n">axeRESI</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance (</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
           
        <span class="c1"># ---&gt; set axes labels</span>
           
            <span class="n">axeFW</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;log10 Frequency (</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Hz&#39;</span><span class="p">),</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
            <span class="n">axeRESI</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;log10 Frequency (</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Hz&#39;</span><span class="p">),</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
        
        <span class="c1"># let set the axis of forward invisible </span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axeFW</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_report</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
            <span class="n">mplotus</span><span class="o">.</span><span class="n">get_conductive_and_resistive_zone</span> <span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_forward</span><span class="p">,</span>
                                                       <span class="n">site_names</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_sites_names</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Occam 2D : Forward response &amp; Residual&#39;</span><span class="p">,</span>
                  <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
          <span class="n">fontsize</span><span class="o">=</span> <span class="mi">10</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> 
          <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
          <span class="n">style</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span>
          <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;moccasin&#39;</span><span class="p">))</span>
        
        <span class="c1"># tigh_layout plt.tight_layout</span>
        <span class="c1"># ---------------------Print Reprot ----------------------------</span>
       
        
        <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">plot_Pseudolog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">station_id</span><span class="o">=</span> <span class="s1">&#39;S00&#39;</span><span class="p">,</span> <span class="n">iter_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span>
                       <span class="n">mesh_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">data_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">iter2dat_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> 
                      <span class="n">bln_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="n">model_fn</span><span class="o">=</span><span class="kc">None</span> <span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build pseudodrill from the model resistivity . Deal with true value </span>
<span class="sd">        of ressitivity obtained during survey .In fact , How to input these </span>
<span class="sd">        values into our model to produce an accuracy  underground map is the</span>
<span class="sd">        chalenge.Building pseudolog allow to know how layers are</span>
<span class="sd">         disposal in underground so to emphasize the large conductive </span>
<span class="sd">        zone in the case of groundwater exploration.   It is combinaison with </span>
<span class="sd">        geophysic data especially inversion data with geological data. Actually </span>
<span class="sd">        the program deal with  Occam 2D inverison file or  Bo Yang (x,y,z) file</span>
<span class="sd">        . We will extend this program later with other external softares </span>
<span class="sd">        files extension. If user have a golder software installed on its </span>
<span class="sd">        computer ,  can output the files generated by  pCSAMT and to produce 2D </span>
<span class="sd">        map so to compare both . Model map and detail-sequences map to see</span>
<span class="sd">        the difference Details sequences map  is most closest to the reality .</span>
<span class="sd">        When step descent parameter is smal , the detail sequences </span>
<span class="sd">        trend to model map . So More geological values are , more the accuracy</span>
<span class="sd">        of detail sequences logs becomes . Geological data allow to harmonize </span>
<span class="sd">         the value of resistivity produced by our model so to force the pogramm</span>
<span class="sd">        to make a correlation between data from true layers and the model values.</span>
<span class="sd">        </span>
<span class="sd">        params : </span>
<span class="sd">            station_id :  str !int  : Number or the site id of the survey area </span>
<span class="sd">                                    numer starts from 1 to the end .</span>
<span class="sd">            Note : User caneither use Occam 2D inversions files to plot or </span>
<span class="sd">                    BoYang (x, y, file)+ station location file (*bln) to plot </span>
<span class="sd">                if the two types of files are provided , program with give </span>
<span class="sd">                priority to Occam 2D inversion files.</span>
<span class="sd">            </span>
<span class="sd">        ============================================================================</span>
<span class="sd">        params                      type                        Description </span>
<span class="sd">        ============================================================================</span>
<span class="sd">        model_fn                : str          full path to Occam model file .</span>
<span class="sd">        iter_fn                 : str          full path to occam iteration file </span>
<span class="sd">        data_fn                 : str          full path to occam_data file </span>
<span class="sd">        doi                     : str          depth of investigation might be </span>
<span class="sd">                                                float or str like &quot;1km&quot; =1000</span>
<span class="sd">        depth_scale             :str           scale of imaging depth can be </span>
<span class="sd">                                                &quot;km&quot; or &quot;m&quot;. Default is&quot;m&quot;</span>
<span class="sd">        step_descent            :float         step to enforce the model </span>
<span class="sd">                                                resistivities to keep the </span>
<span class="sd">                                                truth layers values as reference. </span>
<span class="sd">                                                if step descent is egal</span>
<span class="sd">                                                to doi (max investigation depth), </span>
<span class="sd">                                                data looks like the model </span>
<span class="sd">                                                at 99.99%. Mean the capacity to</span>
<span class="sd">                                                differenciate  the resistivity that</span>
<span class="sd">                                                match nderground layers. Step decent</span>
<span class="sd">                                                if function of depth and rho.</span>
<span class="sd">        constrained_electrical\</span>
<span class="sd">            _properties_of_rocks : bool :       keep the Truth layers </span>
<span class="sd">                                                resistivities with their </span>
<span class="sd">                                                 as reference resistivities.</span>
<span class="sd">                                                 if false will check in our  </span>
<span class="sd">                                                 data base to find the </span>
<span class="sd">                                                 resistivities that match better </span>
<span class="sd">                                                 gthe given resistivities of </span>
<span class="sd">                                                 the layers. Default is True.</span>
<span class="sd">        lc_AD_curves            :tuple           :customize line color of average</span>
<span class="sd">                                                curve and details sequneces </span>
<span class="sd">                                                logs  eg : ((0.5, 0.8, 0.), </span>
<span class="sd">                                                &#39;blue&#39;)</span>
<span class="sd">        </span>
<span class="sd">        default_unknow_lcolor   : str           : In the case  the name of layer   </span>
<span class="sd">                                                    is notin our data base ,</span>
<span class="sd">                                                    customize the layer color .</span>
<span class="sd">                                                    default is &quot;(1.0, 1.0, 1.0)&quot;.</span>
<span class="sd">        default_unknow_lpattern  :str               : In the case  the name of layer  </span>
<span class="sd">                                                            is not in our data base ,</span>
<span class="sd">                                                        customize the layer pattern </span>
<span class="sd">                                                        default is &quot;+.+.+.&quot;</span>
<span class="sd">            </span>
<span class="sd">        ==============================================================================</span>
<span class="sd">        </span>
<span class="sd">        !Customize your plot using matplotlib properties. </span>
<span class="sd">        </span>
<span class="sd">        eg : &gt;&gt;&gt; from viewer.plot impor Plot2d </span>
<span class="sd">            &gt;&gt;&gt; path =os.path.join(os.environ [&#39;pyCSAMT&#39;], &#39;csamtpy&#39;, &#39;data&#39;, &#39;occam2D&#39;)</span>
<span class="sd">            &gt;&gt;&gt; plot2d_obj = Plot2d(station_label_rotation=None, </span>
<span class="sd">                                show_grid=True, </span>
<span class="sd">                                font_size =8, </span>
<span class="sd">                                lc=&#39;r&#39;, </span>
<span class="sd">                                fig_size=[5,8], </span>
<span class="sd">                                markerfacecolor=&#39;k&#39;, </span>
<span class="sd">                                markeredgecolor=&#39;k&#39;)</span>
<span class="sd">            </span>
<span class="sd">            ... plot2d_obj.plot_Pseudolog( station_id=[43], </span>
<span class="sd">                                            input_resistivities=[300, 500,</span>
<span class="sd">                                                                 1000, 2000,</span>
<span class="sd">                                                                 4000, 6000],</span>
<span class="sd">                                            input_layers =[&#39;alluvium&#39;, </span>
<span class="sd">                                                           &#39;amphibolite&#39;,</span>
<span class="sd">                                                           &#39;altered rock&#39;,</span>
<span class="sd">                                                            &#39;augen gneiss&#39;,</span>
<span class="sd">                                                            &#39;granite&#39;],</span>
<span class="sd">                                        mesh_fn=os.path.join(path, </span>
<span class="sd">                                                             &#39;Occam2DMesh&#39;)</span>
<span class="sd">                                        iter_fn = os.path.join(path,</span>
<span class="sd">                                                               &#39;ITER17.iter&#39;), </span>
<span class="sd">                                        model_fn =os.path.join(path,</span>
<span class="sd">                                                               &#39;Occam2DModel&#39;) , </span>
<span class="sd">                                        data_fn =os.path.join(path, </span>
<span class="sd">                                                              &#39;OccamDataFile.dat&#39;),</span>
<span class="sd">                                        doi=&#39;1km&#39;, </span>
<span class="sd">                                        step_descent=200., </span>
<span class="sd">                                        plot_style= &#39;pcolormesh&#39;)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Building pseudo drill and pseudostratigraphy .&#39;</span><span class="p">)</span>
        
        <span class="c1">#set other important kwargs argumenents </span>
        
        <span class="n">savefig</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;savefigure&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">input_layers</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_layers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">input_resistivities</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_resistivities&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">doi</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;doi&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>           <span class="c1"># if None , default is 1km </span>
        <span class="n">mfontdict</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_dict_site&#39;</span><span class="p">,</span> 
                              <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">6</span> <span class="p">,</span> 
                                                  <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;saddlebrown&#39;</span><span class="p">,</span> 
                                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">,</span> 
                                                  <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;italic&#39;</span><span class="p">},</span> 
                                                                       <span class="p">)</span>
        
        <span class="n">pseudo_plot_style</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_style&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">depth_scale</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">step_descent</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;step_descent&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cdict_average_detailsC</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lc_AD_curves&#39;</span><span class="p">,</span> 
                                           <span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
                                           <span class="p">)</span>
        
        <span class="n">constrained_electrical_properties_of_rocks</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
            <span class="s1">&#39;constrained_electrical_properties_of_rocks&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">default_unknow_lcolor</span> <span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;unknow_layer_color&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="n">default_unknow_lpattern</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;unknow_layer_pattern&#39;</span><span class="p">,</span> <span class="s1">&#39;+.+.+.&#39;</span><span class="p">)</span>
        
        
        <span class="c1"># ----------------- Ascertainment of differents files --------------------------</span>
        <span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>                 <span class="c1"># indicator with file provided for reading , program withcheck the corresponding files </span>
                                <span class="c1"># even mayfiles is provied , default is read Occam 2D files </span>
                                
        <span class="n">imf</span><span class="p">,</span> <span class="n">imp</span> <span class="o">=</span><span class="p">[[]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
        
                   <span class="c1"># intend to read occam 2D files , let assert files now </span>
        
        <span class="k">for</span> <span class="n">nn</span><span class="p">,</span> <span class="n">mm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;model_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;iter_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;mesh_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;data_fn&#39;</span><span class="p">],</span>
                      <span class="p">[</span><span class="n">model_fn</span> <span class="p">,</span> <span class="n">iter_fn</span> <span class="p">,</span> <span class="n">mesh_fn</span><span class="p">,</span> <span class="n">data_fn</span><span class="p">]):</span> 
            <span class="k">if</span> <span class="n">mm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="n">mm</span><span class="p">)</span>
                <span class="n">f</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="k">else</span> <span class="p">:</span>  <span class="n">imf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">f</span> <span class="o">!=</span><span class="mi">4</span> <span class="p">:</span> 
            <span class="k">for</span> <span class="n">nn</span><span class="p">,</span> <span class="n">mm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;iter2dat_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;bln_fn&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">iter2dat_fn</span><span class="p">,</span> <span class="n">bln_fn</span><span class="p">]):</span> 
                <span class="k">if</span> <span class="n">mm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> 
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="n">mm</span><span class="p">)</span>
                    <span class="n">p</span> <span class="o">+=</span><span class="mi">1</span>
                <span class="k">else</span> <span class="p">:</span><span class="n">imp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>
                    
        <span class="k">if</span> <span class="n">p</span> <span class="o">!=</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">f</span><span class="o">!=</span><span class="mi">4</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">p</span><span class="o">!=</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">p</span><span class="o">!=</span><span class="mi">0</span> <span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt; Expected 02 files , only </span><span class="si">{0}</span><span class="s1">  is given !&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">imp</span> <span class="p">:</span> 
                    <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39; ! &lt;</span><span class="si">%s</span><span class="s1">&gt; is not provided ! Could not possible to &#39;</span>\
                        <span class="s1">&#39;build pseudodrill and stratigraphy log.&#39;</span>\
                        <span class="s1">&#39; Please provide &lt;</span><span class="si">%s</span><span class="s1">&gt; file.&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span><span class="n">ss</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> 
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span> <span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ss</span><span class="o">==</span><span class="s1">&#39;bln_fn&#39;</span><span class="p">:</span> 
                         <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                             <span class="p">[</span><span class="s1">&#39; ! No station station locations file &#39;</span>
                              <span class="s1">&#39;found like *bln file ! Can not plot pseudodrill and &#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;pseudostratigraphy log. Please provided a station&#39;</span>
                                    <span class="s1">&#39; location file. You can use Iter2Dat model ::&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;from csamtpy.modeling.occam2d import Iter2Dat:: &#39;</span>
                                    <span class="s1">&#39;or Profile module :: from csamtpy.ff.core.cs import Profile:: to&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;build a station location file.&#39;</span><span class="p">])</span>
                         <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span> <span class="p">(</span><span class="n">mess</span><span class="p">)</span>
 
                
            <span class="k">if</span> <span class="n">f</span> <span class="o">!=</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">f</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">f</span> <span class="o">&gt;</span><span class="mi">2</span> <span class="p">:</span> <span class="n">mt</span><span class="o">=</span><span class="s1">&#39;are&#39;</span>
                <span class="k">else</span> <span class="p">:</span><span class="n">mt</span><span class="o">=</span><span class="s1">&#39;is&#39;</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt; Expected 04 files , only </span><span class="si">{0}</span><span class="s1"> one </span><span class="si">{1}</span><span class="s1"> given !&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">mt</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">oss</span> <span class="ow">in</span> <span class="n">imf</span> <span class="p">:</span> 
                    <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39; ! </span><span class="si">{0}</span><span class="s1"> is not provided ! &#39;</span>\
                        <span class="s1">&#39;Could not possible to build pseudodrill and stratigraphy log.&#39;</span>\
                            <span class="s1">&#39; Please provide </span><span class="si">{0}</span><span class="s1"> file.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">oss</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">p</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">f</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
                <span class="n">mess</span> <span class="o">=</span><span class="s1">&#39;None files are found ! Please provided either &#39;</span>\
                    <span class="s1">&#39;Occam2D outputfiles {Mesh|Model|Data|iter} &#39;</span>\
                    <span class="s1">&#39;or Bo Yang Data File output files {Iter2dat|bln}.&#39;</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
        
            <span class="k">raise</span> <span class="n">CSex</span><span class="o">.</span><span class="n">pyCSAMTError_plot_geoinputargument</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">p</span><span class="o">==</span><span class="mi">2</span> <span class="ow">or</span> <span class="n">f</span><span class="o">==</span><span class="mi">4</span> <span class="p">:</span>                 <span class="c1">#----Finish ascertainement then build object and read ----------------------</span>
            <span class="k">if</span> <span class="n">f</span><span class="o">==</span><span class="mi">4</span> <span class="p">:</span>                       <span class="c1"># priority to Occam2D data files </span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;**</span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s1">&#39; Occam Input files &#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span> <span class="p">,</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span>
                                                       <span class="n">file</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model_fn</span> <span class="p">,</span> 
                                                                <span class="bp">self</span><span class="o">.</span><span class="n">mesh_fn</span> <span class="p">,</span> 
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span><span class="p">,</span> 
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">iter_fn</span><span class="p">]])))</span> <span class="c1"># show message to user</span>
                
                <span class="n">geo_obj</span> <span class="o">=</span><span class="n">geoD</span><span class="o">.</span><span class="n">Geodrill</span><span class="p">(</span><span class="n">model_fn</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_fn</span> <span class="p">,</span> 
                              <span class="n">data_fn</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_fn</span> <span class="p">,</span> 
                              <span class="n">mesh_fn</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_fn</span> <span class="p">,</span> 
                              <span class="n">iter_fn</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iter_fn</span> <span class="p">,</span> 
                              <span class="n">input_layers</span> <span class="o">=</span> <span class="n">input_layers</span> <span class="p">,</span> 
                              <span class="n">input_resistivities</span> <span class="o">=</span><span class="n">input_resistivities</span><span class="p">,</span> 
                              <span class="n">doi</span> <span class="o">=</span><span class="n">doi</span> <span class="p">)</span>
                
                <span class="c1"># geo_obj.geo_replace_rho()</span>
                
            <span class="k">elif</span> <span class="n">p</span><span class="o">==</span><span class="mi">2</span> <span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;**</span><span class="si">{0:&lt;37}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s1">&#39; Iter Input files &#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span> <span class="p">,</span> <span class="nb">tuple</span><span class="p">([</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> 
                                                      <span class="n">file</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">iter2dat_fn</span> <span class="p">,</span> 
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">bln_fn</span> <span class="p">]])))</span> 
                
                <span class="n">geo_obj</span> <span class="o">=</span><span class="n">geoD</span><span class="o">.</span><span class="n">Geodrill</span><span class="p">(</span><span class="n">iter2dat_fn</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iter2dat_fn</span><span class="p">,</span> 
                                       <span class="n">bln_fn</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bln_fn</span> <span class="p">,</span> 
                                       <span class="n">input_layers</span> <span class="o">=</span><span class="n">input_layers</span> <span class="p">,</span> 
                                       <span class="n">input_resistivities</span> <span class="o">=</span><span class="n">input_resistivities</span><span class="p">,</span> 
                                       <span class="n">doi</span> <span class="o">=</span><span class="n">doi</span> <span class="p">)</span>
                <span class="c1">#------------------ if input resistivities is None , let get input fron specail station ID -----------------</span>
                

                
        <span class="c1"># ----------&gt; Get all other attributes from geo_obj -------------------</span>
        <span class="c1"># Note data extract here are all in ohm meter not in log10 resistivities </span>
        <span class="c1"># let get geo_d == dictionnaries of sation and resistivities framed </span>
        <span class="c1"># get geodeth is investigation depth depth </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_stations_dict</span> <span class="o">=</span> <span class="n">geo_obj</span><span class="o">.</span><span class="n">geo_d</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span> <span class="o">=</span> <span class="n">geo_obj</span><span class="o">.</span><span class="n">geo_depth</span> 
    
        <span class="bp">self</span><span class="o">.</span><span class="n">station_names</span> <span class="o">=</span> <span class="n">geo_obj</span><span class="o">.</span><span class="n">station_names</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">station_location</span> <span class="o">=</span><span class="n">geo_obj</span><span class="o">.</span><span class="n">station_location</span> 
        
        <span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span> <span class="o">=</span> <span class="n">step_descent</span>
        
        <span class="c1">#-------------------------Get the corresponding stationid  to Plot --------- ------------------</span>
        <span class="c1"># user have possibility for multiples plot by puting station id into a list </span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">station_id</span> <span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">get_stationid</span><span class="p">(</span><span class="n">stations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">,</span>
                                                <span class="n">station_id</span><span class="o">=</span><span class="n">station_id</span><span class="p">)</span> <span class="c1"># get station names on list </span>
        
            <span class="c1"># build em dict from station to get a special  input resistivities layers -------</span>
        
        <span class="c1">#for stn , res_values in self.geo_stations_dict.items(): </span>
        <span class="k">if</span> <span class="n">input_resistivities</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span> <span class="o">=</span><span class="p">{</span><span class="n">stn</span> <span class="p">:</span>
                                       <span class="n">mplotus</span><span class="o">.</span><span class="n">get_station_id_input_resistivities</span><span class="p">(</span>
                                           <span class="n">station_rho_value</span><span class="o">=</span><span class="n">res_values</span><span class="p">)</span> 
                                           <span class="k">for</span> <span class="n">stn</span> <span class="p">,</span> <span class="n">res_values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_stations_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        
        <span class="c1">#---------------------Figure statements and properties -------------------------</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span> <span class="p">)</span><span class="c1">#, constrained_layout=True)</span>
  
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span> <span class="o">=</span><span class="s1">&#39;auto&#39;</span>                     <span class="c1"># blocked to automatic , can not change </span>
        
        <span class="n">gs</span><span class="o">=</span><span class="n">gspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">figure</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>  <span class="c1"># grid spect into three grid </span>
        
        <span class="n">axe_Titles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">6</span><span class="p">])</span>
        <span class="n">axe_Titles</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                           <span class="c1"># make title axes invisible  </span>
        
        
        <span class="n">axePseudodrill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">axeLogRho</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">sharey</span><span class="o">=</span> <span class="n">axePseudodrill</span><span class="p">)</span>
        <span class="n">axePseudosequences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">:],</span> <span class="n">sharey</span><span class="o">=</span>  <span class="n">axePseudodrill</span><span class="p">)</span>
  
  
        <span class="n">axe_Legends_rho_sequences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="p">:</span><span class="mi">4</span><span class="p">])</span>
        
        <span class="n">axe_Legends_rho_sequences</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">axe_Legends_rho_sequences</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        

        
        <span class="c1"># ----&gt; Manage XY limits --------------------------------------</span>
        
        <span class="c1"># build  the distance separation by  rounding value using function round dipole length </span>
        
        <span class="n">df</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">round_dipole_length</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                                          <span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_location</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">dx</span> <span class="o">=</span><span class="n">df</span><span class="o">/</span><span class="mi">5</span>        <span class="c1"># xpad = dx</span>
        <span class="n">dy</span><span class="o">=</span><span class="mi">30</span>           <span class="c1"># ypad =dy      to locate station</span>
        
        
        <span class="c1"># ---&gt;          build a smallsites offsets set x pseudodrill limits  of hree stations </span>
        
        <span class="n">plot_sites_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">df</span> <span class="p">,</span> <span class="n">df</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ids</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_id</span> <span class="p">:</span> <span class="c1"># take the indice and find two next statiion and build corresponding stationnames </span>
            <span class="n">ids</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ids</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">ids</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span>                                            <span class="c1"># the first station </span>
                <span class="n">plot_sites_names</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;S</span><span class="si">{0:02}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>  <span class="c1"># if station is the first station names </span>
                
            <span class="k">elif</span> <span class="n">ids</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span>                    <span class="c1"># that means the last stations </span>
                <span class="n">plot_sites_names</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S</span><span class="si">{0:02}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span>
                                   <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> 
                                                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">))</span> <span class="p">]</span>
            <span class="k">else</span> <span class="p">:</span> 
                <span class="n">plot_sites_names</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S</span><span class="si">{0:02}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ids</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># let framed the main station id </span>
                                                             <span class="n">ids</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="p">]</span>
      
       
        
        <span class="c1">#-----------------------------------let get default plot and set scale --------------------------------------------------- </span>
        <span class="k">if</span> <span class="n">pseudo_plot_style</span><span class="o">==</span><span class="kc">None</span>  <span class="p">:</span>
            <span class="n">pseudo_plot_style</span> <span class="o">=</span> <span class="s1">&#39;imshow&#39;</span>
            
        <span class="k">if</span> <span class="n">depth_scale</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">depth_scale</span> <span class="o">=</span><span class="s1">&#39;m&#39;</span>
       
        <span class="k">if</span> <span class="n">depth_scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;m&#39;</span><span class="p">:</span>
            <span class="n">dz</span><span class="o">=</span> <span class="mf">1.</span>
        <span class="k">elif</span> <span class="n">depth_scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;km&#39;</span><span class="p">:</span> 
            <span class="n">dz</span><span class="o">=</span><span class="mf">1000.</span>
        <span class="k">else</span> <span class="p">:</span>                          <span class="c1"># in the case a wrong value is provided</span>
            <span class="n">dz</span><span class="o">=</span><span class="mf">1.</span>
            
            
        <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="o">=</span><span class="p">((</span><span class="n">plot_sites_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dx</span><span class="p">)</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span>
                      <span class="p">(</span><span class="n">plot_sites_offsets</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dx</span><span class="p">)</span><span class="o">/</span><span class="n">dz</span><span class="p">)</span>            <span class="c1"># let graduate to eg [-10 +160] --&gt;if df=50 as step </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">dz</span> <span class="p">)</span>         <span class="c1"># reversed axis order     </span>
            
            
        <span class="k">for</span> <span class="n">stn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_id</span> <span class="p">:</span> 
            <span class="c1">#--------------------------------READ OBJECT AND PUT THE SPECIAL INPUT RESISTIVITIES -------------</span>
            <span class="k">if</span> <span class="n">input_resistivities</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> 
                <span class="n">input_resistivities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_resistivities</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span>
            
            <span class="n">geo_obj</span><span class="o">.</span><span class="n">geo_build_strata_logs</span><span class="p">(</span><span class="n">step_descent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span><span class="p">)</span>
           
            
            <span class="bp">self</span><span class="o">.</span><span class="n">stations_replaced_rho</span> <span class="o">=</span> <span class="n">geo_obj</span><span class="o">.</span><span class="n">geo_drr</span>
            
            <span class="c1"># set xlog limits  return to log10 resistivities</span>
 
            <span class="n">maxlog</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_stations_dict</span><span class="p">[</span><span class="n">stn</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            
            <span class="n">minlog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_stations_dict</span><span class="p">[</span><span class="n">stn</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xloglimits</span><span class="o">=</span> <span class="p">(</span><span class="n">minlog</span><span class="p">,</span> <span class="n">maxlog</span><span class="p">)</span> 
            
                    <span class="c1">#--------------------------------BUILD PSEUDO DRILL ------------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Build Pseudo drill from Occam 2D models.&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">pseudo_plot_style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;pcolormesh&#39;</span><span class="p">:</span> 
                
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Ready to plot Pseudodrill  with matplotlib &quot;pcolormesh&quot;&#39;</span><span class="p">)</span>
                
                <span class="n">mesh_x</span> <span class="p">,</span> <span class="n">mesh_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">plot_sites_offsets</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">/</span><span class="n">dz</span><span class="p">)</span>

                <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">pcolormesh</span> <span class="p">(</span><span class="n">mesh_x</span> <span class="p">,</span> 
                                           <span class="n">mesh_y</span> <span class="p">,</span>
                                           <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_stations_dict</span><span class="p">[</span><span class="n">stn</span><span class="p">]),</span>
                                    <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  
                                    <span class="n">shading</span><span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
                                    <span class="n">cmap</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> 
                                    <span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                                                  <span class="p">)</span>
            
            <span class="k">if</span> <span class="n">pseudo_plot_style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;imshow&#39;</span><span class="p">:</span> 
                
                <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span> <span class="p">(</span><span class="s1">&#39;Ready to plot  Pseudodrill with matplotlib &quot;imshow&quot;&#39;</span><span class="p">)</span>
                
                <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">imshow</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_stations_dict</span><span class="p">[</span><span class="n">stn</span><span class="p">]),</span>
                                    <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                    <span class="n">vmin</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                    <span class="n">interpolation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imshow_interp</span><span class="p">,</span> 
                                    <span class="n">cmap</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
                                    <span class="n">aspect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_aspect</span><span class="p">,</span>
                                    <span class="n">origin</span><span class="o">=</span> <span class="s1">&#39;upper&#39;</span><span class="p">,</span> 
                                    <span class="n">extent</span><span class="o">=</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
                                    <span class="p">)</span>
                <span class="c1"># to get the origine =0 of the plot </span>
            
            <span class="c1"># put a grid on if set to True </span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_grid</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
                <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                    <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span>
                                    <span class="n">lw</span> <span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
                                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                                    <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
                

            <span class="c1">#---- Locate the axe station id</span>
            
   
            <span class="k">for</span> <span class="n">offs</span> <span class="p">,</span> <span class="n">names</span> <span class="ow">in</span> <span class="nb">zip</span> <span class="p">(</span><span class="n">plot_sites_offsets</span><span class="p">,</span> <span class="n">plot_sites_names</span><span class="p">):</span>
                <span class="c1"># plot the station marker &#39; black triangle down &#39; </span>
                <span class="c1"># always plots at the surface.</span>
                <span class="k">if</span> <span class="n">names</span> <span class="o">==</span> <span class="n">stn</span> <span class="p">:</span>

                    <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">offs</span><span class="o">/</span><span class="n">dz</span>  <span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">dy</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span>  
                        <span class="n">s</span><span class="o">=</span> <span class="n">names</span><span class="p">,</span>
                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                        <span class="n">fontdict</span><span class="o">=</span><span class="n">mfontdict</span>
                        <span class="p">)</span>
                    <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">offs</span><span class="o">/</span><span class="n">dz</span>  <span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  
                        <span class="n">s</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_marker</span><span class="p">,</span>
                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span> 
                                  <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">mfontdict</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]},</span>     
                        <span class="p">)</span>
                
                    
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">fdict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> 
                                  <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_color</span><span class="p">}</span> 
                    
                    <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">offs</span><span class="o">/</span><span class="n">dz</span>  <span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  
                            <span class="n">s</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_marker</span><span class="p">,</span>
                            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                            <span class="n">fontdict</span><span class="o">=</span><span class="n">fdict</span>
                            <span class="p">)</span>

                                                    
            <span class="c1"># create a temporary axe to hold station names </span>
            <span class="n">tempax</span><span class="o">=</span> <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
            <span class="c1"># customize frame stations id </span>
            
            <span class="k">for</span> <span class="n">jj</span> <span class="p">,</span> <span class="n">istn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_sites_names</span><span class="p">)</span> <span class="p">:</span> 
                <span class="k">if</span> <span class="n">istn</span> <span class="o">==</span><span class="n">stn</span> <span class="p">:</span>
                    <span class="n">new_names</span> <span class="o">=</span> <span class="n">plot_sites_names</span> <span class="c1"># make a copy of plot names an doffsets </span>
                    <span class="n">new_offs</span> <span class="o">=</span> <span class="n">plot_sites_offsets</span><span class="o">/</span><span class="n">dz</span>
                    <span class="k">del</span><span class="p">(</span><span class="n">new_names</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span>
                    <span class="n">new_offs</span><span class="o">=</span> <span class="n">new_offs</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                    <span class="k">del</span><span class="p">(</span><span class="n">new_offs</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span>
    
                    <span class="n">tempax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span> <span class="n">new_offs</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span> <span class="c1"># plot only sites except the main station id </span>
                    <span class="n">tempax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span> <span class="n">new_names</span><span class="p">,</span>               <span class="c1"># beacause it already names above </span>
                               <span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">station_label_rotation</span><span class="p">,</span>
                               <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">3</span><span class="p">}</span>
                              <span class="p">)</span>

            <span class="c1"># set y labels of pseudodrill plots </span>
            <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">depth_scale</span><span class="p">),</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> 
                                    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">,</span> 
                                    <span class="p">})</span>
            
            <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">)</span>
            
   
            
            <span class="n">tempax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Stations&#39;</span><span class="p">,</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> 
                                    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">,</span> 
                                    <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">})</span>
            
            <span class="n">tempax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="c1"># set the x twins limits the same as the x of pseudodrill </span>


             <span class="c1">#------------------------------plot LOGRHO----------------------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Build  Plot1D resistivities sounding curves.&#39;</span><span class="p">)</span>
            
            <span class="c1"># Create twin axe to host log 10 rho values and xlables  </span>
            <span class="n">axisLogcurve</span><span class="o">=</span><span class="n">axeLogRho</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_grid</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span> 
                <span class="n">axeLogRho</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
            <span class="c1">#Xloglimits = np.arange(int(minlog)-1, int(maxlog)+2, 1) # No need , let do it automatically</span>
      
            
            <span class="c1"># get the index of station id to plot </span>
            <span class="n">mms</span> <span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">stn</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">mms</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span> 
                <span class="n">indexplot</span> <span class="o">=</span><span class="mi">0</span> 
            <span class="k">elif</span> <span class="n">mms</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_names</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span>     <span class="c1"># mean we are at the last station </span>
                <span class="n">indexplot</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span> <span class="p">:</span> <span class="n">indexplot</span> <span class="o">=</span><span class="mi">1</span>                         <span class="c1"># plot the framed station </span>
            

            <span class="c1"># get the array value at the main station id framed into Two </span>
            <span class="n">plot_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_stations_dict</span><span class="p">[</span><span class="n">stn</span><span class="p">][:,</span> <span class="n">indexplot</span><span class="p">]</span> <span class="c1">#3,1</span>
            <span class="c1"># plot the replace rho using the same index stn  </span>
            <span class="n">AverageLogcurve</span><span class="p">,</span> <span class="o">=</span>  <span class="n">axisLogcurve</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stations_replaced_rho</span><span class="p">[</span><span class="n">stn</span><span class="p">][:,</span> <span class="n">indexplot</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span> 
                            <span class="n">lw</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="o">*</span><span class="mi">2</span> <span class="p">,</span> 
                            <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ls</span><span class="p">,</span>
                            <span class="n">c</span><span class="o">=</span> <span class="n">cdict_average_detailsC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                            <span class="n">label</span> <span class="o">=</span><span class="s1">&#39;Average logcurve (Î©.m)/station </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn</span><span class="p">)</span>
                           
                            <span class="p">)</span>
            <span class="c1"># plot the details log curves using the step descent </span>
            <span class="n">DetailLogcurve</span><span class="p">,</span> <span class="o">=</span>  <span class="n">axisLogcurve</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span> 
                <span class="n">geo_obj</span><span class="o">.</span><span class="n">geo_dstep_descent</span><span class="p">[</span><span class="n">stn</span><span class="p">][:,</span> <span class="n">indexplot</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span> 
                            <span class="n">lw</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span> <span class="o">*</span><span class="mi">2</span> <span class="p">,</span> 
                            <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ls</span><span class="p">,</span>
                            <span class="n">c</span><span class="o">=</span> <span class="n">cdict_average_detailsC</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Detailsequence logcurve(Î©.m) :step_decsent =</span><span class="si">{0}{1}</span><span class="s1">.&#39;</span><span class="o">.</span>\
                                <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span> <span class="n">depth_scale</span><span class="p">),</span> 
                            
                            <span class="p">)</span>
            
            <span class="c1"># make a marker (optional) to better mark the curve </span>
            <span class="n">mark</span><span class="p">,</span> <span class="o">=</span>  <span class="n">axisLogcurve</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">plot_y</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span>
                          <span class="n">marker</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                          <span class="n">c</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                          <span class="n">markersize</span><span class="o">=</span> <span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span> <span class="p">,</span> 
                          
                          <span class="n">markeredgecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">markeredgecolor</span><span class="p">,</span> 
                          <span class="n">markerfacecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">markerfacecolor</span>
                          <span class="p">)</span> 
            <span class="c1"># make the sounding cure at  the main station id </span>
            <span class="n">ResLogcurve</span> <span class="p">,</span> <span class="o">=</span>  <span class="n">axisLogcurve</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">plot_y</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">geo_depth</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span> 
                           <span class="n">lw</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span> <span class="p">,</span> 
                           <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ls</span><span class="p">,</span>
                           <span class="n">c</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc</span><span class="p">,</span>
                           <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Resistivity logcurve (Î©.m)&#39;</span><span class="p">,</span> 
                           
                          
                           <span class="p">)</span>

            <span class="c1"># setlog grid , turn on minorticks </span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_grid</span>  <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span> 
                <span class="n">axisLogcurve</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
                <span class="n">axisLogcurve</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> 
                                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> 
                                  <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> 
                                  <span class="n">lw</span> <span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> 
                                  <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        
            <span class="n">axisLogcurve</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Log10(Rho)/Î©.m&#39;</span><span class="p">,</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">})</span>
            
            <span class="c1"># annotate step descent </span>
            <span class="n">axisLogcurve</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">plot_y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                              <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                              <span class="s1">&#39;$Step\ descent = </span><span class="si">{0}{1}</span><span class="s1">.$&#39;</span><span class="o">.</span>\
                                  <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_descent</span><span class="o">/</span><span class="n">dz</span> <span class="p">,</span> <span class="n">depth_scale</span><span class="p">),</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> 
                               <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="o">/</span><span class="mf">1.5</span><span class="p">)</span>
                             
                               
            <span class="c1">#                    )</span>
            <span class="c1"># ----set LEGEND vers </span>
            <span class="n">axe_Legends_rho_sequences</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span> <span class="n">ResLogcurve</span><span class="p">,</span> 
                                              <span class="n">AverageLogcurve</span><span class="p">,</span>
                                              <span class="n">DetailLogcurve</span><span class="p">],</span> 
                         <span class="p">[</span><span class="s1">&#39;Resistivity soundingcurve (Î©.m)/Station = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn</span><span class="p">),</span>
                          <span class="s1">&#39;Average resistivity logcurve (Î©.m) based on resistivity calculation&#39;</span><span class="p">,</span>
                         <span class="s1">&#39; Pseudo details-sequences logcurve&#39;</span><span class="p">,</span>
                        
                          <span class="p">],</span> 
                         <span class="c1"># ncol= 3,</span>
                         <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> 
                               <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw</span><span class="p">,</span> 
                               <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">},</span> 
                          <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;expand&#39;</span><span class="p">,</span>
                         <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                         <span class="p">)</span>
            
           
            
            <span class="c1">#----------------------------PLOT PSEUDSEDQUENCES  --------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s1">&#39;Build Pseudo sequences with delais logs&#39;</span>\
                    <span class="s1">&#39; sequences curve and average curves..&#39;</span><span class="p">)</span>
            <span class="c1"># call the speudosecquence object from geo_obj </span>

            <span class="bp">self</span><span class="o">.</span><span class="n">geo_dpseudo_sequence_thickness</span> <span class="o">=</span><span class="n">geo_obj</span><span class="o">.</span><span class="n">geo_dpseudo_sequence</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">geo_dpseudo_sequence_rho</span> <span class="o">=</span> <span class="n">geo_obj</span><span class="o">.</span><span class="n">geo_dpseudo_sequence_rho</span> <span class="c1"># resistivities at every layer thickess </span>
            <span class="c1"># resseting layer names , color, and pattern according to their resitivities </span>

            <span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_color</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_pattern</span> <span class="o">=</span> \
                <span class="n">geo_obj</span><span class="o">.</span><span class="n">get_geo_formation_properties</span><span class="p">(</span>
                    <span class="n">structures_resistivities</span> <span class="o">=</span> \
                     <span class="bp">self</span><span class="o">.</span><span class="n">geo_dpseudo_sequence_rho</span><span class="p">[</span><span class="n">stn</span><span class="p">],</span> 
                     <span class="n">real_layer_names</span> <span class="o">=</span> <span class="n">input_layers</span><span class="p">,</span> 
                      <span class="n">constrained_electrical_properties_of_rocks</span><span class="o">=</span><span class="n">constrained_electrical_properties_of_rocks</span><span class="p">,</span> 
                       <span class="n">default_layer_color</span> <span class="o">=</span><span class="n">default_unknow_lcolor</span>  <span class="p">,</span> 
                       <span class="n">default_layer_pattern</span> <span class="o">=</span> <span class="n">default_unknow_lpattern</span><span class="p">,</span>
                                                     <span class="p">)</span>
                    
            
            <span class="n">axePS</span> <span class="o">=</span> <span class="n">axePseudosequences</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>          <span class="c1"># create twniny so to get station at the top </span>
            
            <span class="c1"># prepare a list of cumulative sum for bar plot setting everytimes ,</span>
            <span class="c1"># the bottom as the top of the next bar </span>
            <span class="c1"># loop value of pseudo_sequences  and create bar plot </span>
            
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">pseuds</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_dpseudo_sequence_thickness</span><span class="p">[</span><span class="n">stn</span><span class="p">]):</span>
    
                <span class="n">next_bottom_bar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_dpseudo_sequence_thickness</span><span class="p">[</span><span class="n">stn</span><span class="p">][:</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># sum all the previous bars sequences</span>
     
                <span class="n">axePS</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">plot_sites_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dz</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span> 
                          <span class="n">pseuds</span><span class="p">,</span> 
                          <span class="n">bottom</span> <span class="o">=</span><span class="n">next_bottom_bar</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span> 
                          <span class="n">width</span><span class="o">=</span><span class="n">df</span><span class="o">/</span><span class="p">(</span><span class="n">dz</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span> 
                          <span class="n">linewidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> 
                          <span class="n">edgecolor</span> <span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> 
                          <span class="n">hatch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_pattern</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> 
                          <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_color</span> <span class="p">[</span><span class="n">ii</span><span class="p">],</span> 
                          <span class="n">alpha</span> <span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
            
                          <span class="p">)</span>

            <span class="c1"># prepare a cumul sum  for annotation starting to 0 and terminate at the depth minums 1 </span>
            <span class="n">annotate_cumsum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_dpseudo_sequence_thickness</span><span class="p">[</span><span class="n">stn</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
            <span class="n">annotate_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span><span class="n">annotate_cumsum</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
              
            <span class="n">_</span><span class="p">,</span> <span class="n">annotate_lnames</span> <span class="o">=</span> <span class="n">mplotus</span><span class="o">.</span><span class="n">annotate_tip</span><span class="p">(</span><span class="n">layer_thickness</span><span class="o">=</span> \
                                                                  <span class="n">annotate_cumsum</span> <span class="p">,</span>
                                                                  <span class="n">layer_names</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input_layers</span> <span class="p">)</span>

 
            
            <span class="n">axePS</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">plot_sites_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dz</span> <span class="o">*</span><span class="mi">2</span><span class="p">),</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">dy</span><span class="o">/</span><span class="n">dz</span><span class="p">,</span>  <span class="c1"># get station name closest to station text.  </span>
                      <span class="n">s</span><span class="o">=</span> <span class="n">stn</span><span class="p">,</span>
                      <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                      <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                      <span class="n">fontdict</span><span class="o">=</span><span class="n">mfontdict</span><span class="p">,</span>
                      <span class="n">rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_label_rotation</span><span class="p">,</span>
                      
                          <span class="p">)</span>
            
            <span class="c1"># axePS.set_xticks</span>
            <span class="c1"># location of the station marker </span>
            <span class="n">axePS</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">plot_sites_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dz</span> <span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  
                        <span class="n">s</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_marker</span><span class="p">,</span>
                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ms</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span> 
                                  <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">mfontdict</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]}</span> <span class="p">,</span>
                        <span class="p">)</span>
 
                
            <span class="n">axePS</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span> <span class="n">ln</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">annotate_lnames</span><span class="p">],</span> 
                         <span class="n">loc</span> <span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> 
                         <span class="n">prop</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> 
                                <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">,</span> 
                                <span class="p">},</span> 
                         <span class="n">edgecolor</span> <span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                         <span class="p">)</span>
  
            
           
            <span class="c1"># position of site and marker </span>
            <span class="c1"># create a temporary axe t ohost x labels </span>
            <span class="n">axePS</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="n">plot_sites_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dz</span> <span class="o">*</span><span class="mi">2</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
            <span class="n">axePS</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">stn</span><span class="p">]</span> <span class="p">,</span> 
                                  <span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">station_label_rotation</span><span class="p">,</span> 
                                  <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                  <span class="p">)</span>

            
            
            <span class="n">axePS</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pseudo-sequences&#39;</span><span class="p">,</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;style&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_style</span><span class="p">})</span>
   
            
            <span class="c1">#---&gt; set color bar properties </span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">)</span>
            
            <span class="n">cbx</span> <span class="o">=</span> <span class="n">mplcb</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">axePseudosequences</span><span class="p">,</span>  
                                  <span class="n">shrink</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_shrink</span> <span class="o">*</span><span class="mf">1.3</span><span class="p">,</span>
                                  <span class="n">pad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_pad</span> <span class="p">,</span> 
                                  <span class="n">location</span> <span class="o">=</span><span class="s1">&#39;right&#39;</span> <span class="p">)</span>

            <span class="n">cb</span> <span class="o">=</span> <span class="n">mplcb</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cbx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
                            <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                            <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                            <span class="p">)</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Resistivity ($\Omega \cdot$m)&#39;</span><span class="p">,</span>
                  <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="p">,</span> 
                            <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">})</span>
        
            <span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
                                   <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

            <span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;10$^</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                          <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">climits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
                
            <span class="c1">#-------SETUP  ALL AXIS LIMIT SALL (3 plots)  ------------------------------------</span>
            
            <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">axePseudodrill</span><span class="o">.</span><span class="n">set_ylim</span> <span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> 
            <span class="c1">#make both axes sites invisibles </span>
            <span class="n">axePS</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># start lmits at 0 </span>
            
            <span class="c1"># axePS.set_xticks([])</span>
            <span class="n">axePseudosequences</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span> 
            
        
            <span class="c1"># let set the axis of three plots invisibles </span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axePseudodrill</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axePseudosequences</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axeLogRho</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axePseudosequences</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            
            <span class="c1"># make axis invisible to clearly let the legend </span>
            <span class="n">axe_Legends_rho_sequences</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
            
            <span class="n">axeLogRho</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>

            <span class="c1"># axePseudodrill.set_xticks([])  </span>
    
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Pseudo-stratigraphy log construction: Station : </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stn</span><span class="p">),</span>
                         <span class="n">fontsize</span><span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> 
                         <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                         <span class="n">style</span> <span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span>
                         <span class="n">bbox</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span><span class="s1">&#39;moccasin&#39;</span><span class="p">),</span> 
                         <span class="n">y</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
            
  
            <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span> <span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">)</span></div>
        
        
    
<span class="c1"># if __name__ == &#39;__main__&#39;:</span>
<span class="c1">#     path_to_profiles =os.path.join(os.environ[&#39;pyCSAMT&#39;], &#39;data&#39;, &#39;stn_profiles&#39;)</span>
<span class="c1">#     plot1d_obj = Plot1d( fig_size =[5,3])</span>
<span class="c1">#     plot1d_obj.plot_multiStations(path = path_to_profiles, </span>
<span class="c1">#                                     profile_lines =[&#39;K{0}.stn&#39;.format(i+6) for i in range(4)], </span>
<span class="c1">#                                   scale =&#39;km&#39;)</span>
    

    
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pyCSAMT v1.0.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Kouadio K. Laurent.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
    </div>
  </body>
</html>